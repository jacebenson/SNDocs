<!DOCTYPE html>

<html>
<head>
  <title>service.spAria.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page_wrapper">
            <div id="jump_page">
              
                
                <a class="source" href="service.AMB.html">
                  service.AMB.js
                </a>
              
                
                <a class="source" href="service.authInterceptor.html">
                  service.authInterceptor.js
                </a>
              
                
                <a class="source" href="service.avatarProfilePersister.html">
                  service.avatarProfilePersister.js
                </a>
              
                
                <a class="source" href="service.i18n.html">
                  service.i18n.js
                </a>
              
                
                <a class="source" href="service.progressDialog.html">
                  service.progressDialog.js
                </a>
              
                
                <a class="source" href="service.snComplexPopoverService.html">
                  service.snComplexPopoverService.js
                </a>
              
                
                <a class="source" href="service.snComposingPresence.html">
                  service.snComposingPresence.js
                </a>
              
                
                <a class="source" href="service.snCustomEvent.html">
                  service.snCustomEvent.js
                </a>
              
                
                <a class="source" href="service.snMention.html">
                  service.snMention.js
                </a>
              
                
                <a class="source" href="service.snNotification.html">
                  service.snNotification.js
                </a>
              
                
                <a class="source" href="service.snNotifier.html">
                  service.snNotifier.js
                </a>
              
                
                <a class="source" href="service.spAnnouncement.html">
                  service.spAnnouncement.js
                </a>
              
                
                <a class="source" href="service.spAria.html">
                  service.spAria.js
                </a>
              
                
                <a class="source" href="service.spAriaFocusManager.html">
                  service.spAriaFocusManager.js
                </a>
              
                
                <a class="source" href="service.spCodeEditorAutocomplete.html">
                  service.spCodeEditorAutocomplete.js
                </a>
              
                
                <a class="source" href="service.spIs.html">
                  service.spIs.js
                </a>
              
                
                <a class="source" href="service.spMetatags.html">
                  service.spMetatags.js
                </a>
              
                
                <a class="source" href="service.spModal.html">
                  service.spModal.js
                </a>
              
                
                <a class="source" href="service.spNavStateManager.html">
                  service.spNavStateManager.js
                </a>
              
                
                <a class="source" href="service.spPreference.html">
                  service.spPreference.js
                </a>
              
                
                <a class="source" href="service.spThrottle.html">
                  service.spThrottle.js
                </a>
              
            </div>
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>service.spAria.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-comment">/*! RESOURCE: /scripts/app.$sp/service.spAria.js */</span>
angular.module(<span class="hljs-string">'sn.$sp'</span>)
.factory(<span class="hljs-string">'spAriaUtil'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$window</span>) </span>{
<span class="hljs-meta">'use strict'</span>;
<span class="hljs-keyword">var</span> g_accessibility = $<span class="hljs-built_in">window</span>.g_accessibility;
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">link</span>(<span class="hljs-params">role, forced, index</span>) </span>{
<span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$scope, $element, attr</span>) </span>{
<span class="hljs-keyword">if</span> (g_accessibility &amp;&amp; (_.isEmpty(attr[<span class="hljs-string">'role'</span>]) || forced))
$element.attr(<span class="hljs-string">'role'</span>, role);
tabindex($element, attr, index);
}
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">tabindex</span>(<span class="hljs-params">$element, attr, index</span>) </span>{
<span class="hljs-keyword">if</span> (!_.isEmpty(attr[<span class="hljs-string">'tabindex'</span>]))
index = attr[<span class="hljs-string">'tabindex'</span>];
<span class="hljs-keyword">if</span> (!_.isEmpty(index))
$element.attr(<span class="hljs-string">'tabindex'</span>, index);
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">attr</span>(<span class="hljs-params">$element, name, value</span>) </span>{
<span class="hljs-keyword">if</span> (g_accessibility)
$element.attr(name, value);
}
<span class="hljs-keyword">var</span> liveMessageHandler;
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">registerLiveMessageHandler</span>(<span class="hljs-params">callbackFn</span>) </span>{
liveMessageHandler = callbackFn;
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sendLiveMessage</span>(<span class="hljs-params">message</span>) </span>{
<span class="hljs-keyword">if</span> (liveMessageHandler)
liveMessageHandler(message);
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isAccessibilityEnabled</span>(<span class="hljs-params"></span>) </span>{
<span class="hljs-keyword">return</span> g_accessibility === <span class="hljs-literal">true</span> || g_accessibility === <span class="hljs-string">'true'</span>;
}
<span class="hljs-keyword">return</span> {
<span class="hljs-attr">link</span> : link,
<span class="hljs-attr">tabindex</span> : tabindex,
<span class="hljs-attr">g_accessibility</span> : g_accessibility,
<span class="hljs-attr">sendLiveMessage</span>: sendLiveMessage,
<span class="hljs-attr">onLiveMessage</span>: registerLiveMessageHandler,
<span class="hljs-attr">isAccessibilityEnabled</span>: isAccessibilityEnabled
}
})
.directive(<span class="hljs-string">'spa11y'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">spAriaUtil</span>) </span>{
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">link</span>(<span class="hljs-params">$scope, $element, attr</span>) </span>{
$element.attr(<span class="hljs-string">'accessibility'</span>, g_accessibility);
}
<span class="hljs-keyword">return</span> {
<span class="hljs-attr">restrict</span> : <span class="hljs-string">'A'</span>,
<span class="hljs-attr">link</span> : link
}
})
.directive(<span class="hljs-string">'spAria'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">spAriaUtil</span>) </span>{
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">link</span>(<span class="hljs-params">$scope, $element, attr</span>) </span>{
<span class="hljs-keyword">var</span> role = attr[<span class="hljs-string">'spAria'</span>];
<span class="hljs-keyword">if</span> (spAriaUtil.g_accessibility &amp;&amp; !_.isEmpty(role))
$element.attr(<span class="hljs-string">'role'</span>, role);
}
<span class="hljs-keyword">return</span> {
<span class="hljs-attr">restrict</span> : <span class="hljs-string">'A'</span>,
<span class="hljs-attr">link</span> : link
}
})
.directive(<span class="hljs-string">'a'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">spAriaUtil</span>) </span>{
<span class="hljs-keyword">return</span> {
<span class="hljs-attr">restrict</span> : <span class="hljs-string">'E'</span>,
<span class="hljs-attr">link</span> : spAriaUtil.link(<span class="hljs-string">'link'</span>, <span class="hljs-literal">false</span>, <span class="hljs-number">0</span>)
}
})
.directive(<span class="hljs-string">'body'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">spAriaUtil, spAriaFocusManager, $location</span>) </span>{
<span class="hljs-keyword">return</span> {
<span class="hljs-attr">restrict</span> : <span class="hljs-string">'E'</span>,
<span class="hljs-attr">link</span> : <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">scope, elem</span>) </span>{
angular.element(elem, <span class="hljs-string">'a'</span>).on(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
scope.$applyAsync(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
spAriaFocusManager.navigateToLink($location.url());
});
});
}
}
})
.directive(<span class="hljs-string">'button'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">spAriaUtil</span>) </span>{
<span class="hljs-keyword">return</span> {
<span class="hljs-attr">restrict</span> : <span class="hljs-string">'E'</span>,
<span class="hljs-attr">link</span> : spAriaUtil.link(<span class="hljs-string">'button'</span>, <span class="hljs-literal">false</span>, <span class="hljs-number">0</span>)
}
});
angular.module(<span class="hljs-string">'sn.$sp'</span>).directive(<span class="hljs-string">'header'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">spAriaUtil</span>) </span>{
<span class="hljs-keyword">return</span> {
<span class="hljs-attr">restrict</span> : <span class="hljs-string">'E'</span>,
<span class="hljs-attr">link</span> : spAriaUtil.link(<span class="hljs-string">'banner'</span>)
}
})
.directive(<span class="hljs-string">'footer'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">spAriaUtil</span>) </span>{
<span class="hljs-keyword">return</span> {
<span class="hljs-attr">restrict</span> : <span class="hljs-string">'E'</span>,
<span class="hljs-attr">link</span> : spAriaUtil.link(<span class="hljs-string">'contentinfo'</span>)
}
})
.directive(<span class="hljs-string">'nav'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">spAriaUtil</span>) </span>{
<span class="hljs-keyword">return</span> {
<span class="hljs-attr">restrict</span> : <span class="hljs-string">'E'</span>,
<span class="hljs-attr">link</span> : spAriaUtil.link(<span class="hljs-string">'navigation'</span>)
}
})
.directive(<span class="hljs-string">'form'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">spAriaUtil</span>) </span>{
<span class="hljs-keyword">return</span> {
<span class="hljs-attr">restrict</span> : <span class="hljs-string">'E'</span>,
<span class="hljs-attr">link</span> : spAriaUtil.link(<span class="hljs-string">'form'</span>)
}
})
.directive(<span class="hljs-string">'img'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">spAriaUtil</span>) </span>{
<span class="hljs-keyword">return</span> {
<span class="hljs-attr">restrict</span> : <span class="hljs-string">'E'</span>,
<span class="hljs-attr">link</span> : spAriaUtil.link(<span class="hljs-string">'presentation'</span>)
}
})
.directive(<span class="hljs-string">'textarea'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">spAriaUtil</span>) </span>{
<span class="hljs-keyword">return</span> {
<span class="hljs-attr">restrict</span> : <span class="hljs-string">'E'</span>,
<span class="hljs-attr">link</span> : spAriaUtil.link(<span class="hljs-string">'textbox'</span>, <span class="hljs-literal">false</span>, <span class="hljs-number">0</span>)
}
})
.directive(<span class="hljs-string">'input'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">spAriaUtil</span>) </span>{
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">link</span>(<span class="hljs-params">$scope, $element, attr</span>) </span>{
<span class="hljs-keyword">var</span> role;
<span class="hljs-keyword">switch</span> (attr[<span class="hljs-string">'type'</span>]) {
<span class="hljs-keyword">case</span> <span class="hljs-string">'email'</span>:
<span class="hljs-keyword">case</span> <span class="hljs-string">'password'</span>:
<span class="hljs-keyword">case</span> <span class="hljs-string">'tel'</span>:
<span class="hljs-keyword">case</span> <span class="hljs-string">'text'</span>:
<span class="hljs-keyword">case</span> <span class="hljs-string">'url'</span>:
role = <span class="hljs-string">'textbox'</span>;
<span class="hljs-keyword">break</span>;
<span class="hljs-keyword">case</span> <span class="hljs-string">'button'</span>:
<span class="hljs-keyword">case</span> <span class="hljs-string">'checkbox'</span>:
<span class="hljs-keyword">case</span> <span class="hljs-string">'radio'</span>:
role = attr[<span class="hljs-string">'type'</span>];
<span class="hljs-keyword">break</span>;
<span class="hljs-keyword">case</span> <span class="hljs-string">'hidden'</span>:
<span class="hljs-keyword">break</span>;
<span class="hljs-keyword">case</span> <span class="hljs-string">'image'</span>:
<span class="hljs-keyword">case</span> <span class="hljs-string">'reset'</span>:
<span class="hljs-keyword">case</span> <span class="hljs-string">'submit'</span>:
role = <span class="hljs-string">'button'</span>;
<span class="hljs-keyword">break</span>;
<span class="hljs-keyword">case</span> <span class="hljs-string">'number'</span>:
role = <span class="hljs-string">'spinbutton'</span>;
<span class="hljs-keyword">break</span>;
<span class="hljs-keyword">case</span> <span class="hljs-string">'range'</span>:
role = <span class="hljs-string">'slider'</span>;
<span class="hljs-keyword">break</span>;
<span class="hljs-keyword">case</span> <span class="hljs-string">'search'</span>:
role = <span class="hljs-string">'searchbox'</span>;
<span class="hljs-keyword">break</span>;
}
<span class="hljs-keyword">if</span> (spAriaUtil.g_accessibility &amp;&amp; !_.isEmpty(role))
spAriaUtil.link(role, <span class="hljs-literal">false</span>, <span class="hljs-number">0</span>)($scope, $element, attr);
}
<span class="hljs-keyword">return</span> {
<span class="hljs-attr">restrict</span> : <span class="hljs-string">'E'</span>,
<span class="hljs-attr">link</span> : link
}
})
.directive(<span class="hljs-string">'span'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">spAriaUtil</span>) </span>{
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">link</span>(<span class="hljs-params">$scope, $element, attr</span>) </span>{
<span class="hljs-keyword">var</span> role;
<span class="hljs-keyword">if</span> (attr[<span class="hljs-string">'style'</span>] &amp;&amp; attr[<span class="hljs-string">'style'</span>].indexOf(<span class="hljs-string">'background'</span>) &gt; <span class="hljs-number">-1</span>) {
role = <span class="hljs-string">'presentation'</span>;
attr[<span class="hljs-string">'aria-hidden'</span>] = <span class="hljs-literal">true</span>;
}
<span class="hljs-keyword">if</span> (spAriaUtil.g_accessibility &amp;&amp; !_.isEmpty(role))
spAriaUtil.link(role, <span class="hljs-literal">false</span>, <span class="hljs-number">0</span>)($scope, $element, attr);
}
<span class="hljs-keyword">return</span> {
<span class="hljs-attr">restrict</span> : <span class="hljs-string">'E'</span>,
<span class="hljs-attr">link</span> : link
}
})
.directive(<span class="hljs-string">'role'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">spAriaUtil</span>) </span>{
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">link</span>(<span class="hljs-params">$scope, $element, attr</span>) </span>{
<span class="hljs-keyword">var</span> role = attr[<span class="hljs-string">'role'</span>];
<span class="hljs-keyword">if</span> (role === <span class="hljs-string">'slider'</span>) {
spAriaUtil.tabindex($element, attr, <span class="hljs-number">-1</span>);
$element.find(<span class="hljs-string">'i[aria-valuetext]'</span>).each(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> idx, el </span>) </span>{
$(el).attr(<span class="hljs-string">'tabindex'</span>, <span class="hljs-number">0</span>);
});
}
}
<span class="hljs-keyword">return</span> {
<span class="hljs-attr">restrict</span> : <span class="hljs-string">'A'</span>,
<span class="hljs-attr">link</span> : link
}
})
.directive(<span class="hljs-string">'spAriaLive'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">spAriaUtil</span>) </span>{
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">link</span>(<span class="hljs-params">scope, elem, attr</span>) </span>{
scope.message = <span class="hljs-string">""</span>;
spAriaUtil.onLiveMessage(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">msg</span>) </span>{
scope.message = msg;
setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
scope.message = <span class="hljs-string">""</span>;
}, <span class="hljs-number">1000</span>);
});
}
<span class="hljs-keyword">return</span> {
<span class="hljs-attr">template</span>: <span class="hljs-string">'&lt;div class="sr-only" aria-live="assertive"&gt;{{message}}&lt;/div&gt;'</span>,
<span class="hljs-attr">restrict</span> : <span class="hljs-string">'E'</span>,
<span class="hljs-attr">link</span>: link
}
});
;</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
