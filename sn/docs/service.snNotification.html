<!DOCTYPE html>

<html>
<head>
  <title>service.snNotification.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page_wrapper">
            <div id="jump_page">
              
                
                <a class="source" href="service.AMB.html">
                  service.AMB.js
                </a>
              
                
                <a class="source" href="service.authInterceptor.html">
                  service.authInterceptor.js
                </a>
              
                
                <a class="source" href="service.avatarProfilePersister.html">
                  service.avatarProfilePersister.js
                </a>
              
                
                <a class="source" href="service.i18n.html">
                  service.i18n.js
                </a>
              
                
                <a class="source" href="service.progressDialog.html">
                  service.progressDialog.js
                </a>
              
                
                <a class="source" href="service.snComplexPopoverService.html">
                  service.snComplexPopoverService.js
                </a>
              
                
                <a class="source" href="service.snComposingPresence.html">
                  service.snComposingPresence.js
                </a>
              
                
                <a class="source" href="service.snCustomEvent.html">
                  service.snCustomEvent.js
                </a>
              
                
                <a class="source" href="service.snMention.html">
                  service.snMention.js
                </a>
              
                
                <a class="source" href="service.snNotification.html">
                  service.snNotification.js
                </a>
              
                
                <a class="source" href="service.snNotifier.html">
                  service.snNotifier.js
                </a>
              
                
                <a class="source" href="service.spAnnouncement.html">
                  service.spAnnouncement.js
                </a>
              
                
                <a class="source" href="service.spAria.html">
                  service.spAria.js
                </a>
              
                
                <a class="source" href="service.spAriaFocusManager.html">
                  service.spAriaFocusManager.js
                </a>
              
                
                <a class="source" href="service.spCodeEditorAutocomplete.html">
                  service.spCodeEditorAutocomplete.js
                </a>
              
                
                <a class="source" href="service.spIs.html">
                  service.spIs.js
                </a>
              
                
                <a class="source" href="service.spMetatags.html">
                  service.spMetatags.js
                </a>
              
                
                <a class="source" href="service.spModal.html">
                  service.spModal.js
                </a>
              
                
                <a class="source" href="service.spNavStateManager.html">
                  service.spNavStateManager.js
                </a>
              
                
                <a class="source" href="service.spPreference.html">
                  service.spPreference.js
                </a>
              
                
                <a class="source" href="service.spThrottle.html">
                  service.spThrottle.js
                </a>
              
            </div>
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>service.snNotification.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-comment">/*! RESOURCE: /scripts/sn/common/notification/service.snNotification.js */</span>
angular.module(<span class="hljs-string">'sn.common.notification'</span>).factory(<span class="hljs-string">'snNotification'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$document, $templateCache, $compile, $rootScope, $timeout, $q, getTemplateUrl, $http, i18n</span>) </span>{
<span class="hljs-meta">'use strict'</span>;
<span class="hljs-keyword">var</span> openNotifications = [],
timeouts = {},
options = {
<span class="hljs-attr">top</span>: <span class="hljs-number">20</span>,
<span class="hljs-attr">gap</span>: <span class="hljs-number">10</span>,
<span class="hljs-attr">duration</span>: <span class="hljs-number">5000</span>
};
<span class="hljs-keyword">return</span> {
<span class="hljs-attr">show</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">type, message, duration, onClick, container</span>) </span>{
<span class="hljs-keyword">return</span> createNotificationElement(type, message).then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">element</span>) </span>{
displayNotification(element, container);
checkAndSetDestroyDuration(element, duration);
<span class="hljs-keyword">return</span> element;
});
},
<span class="hljs-attr">hide</span>: hide,
<span class="hljs-attr">setOptions</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">opts</span>) </span>{
<span class="hljs-keyword">if</span> (angular.isObject(opts))
angular.extend(options, opts);
}
};
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getTemplate</span>(<span class="hljs-params"></span>) </span>{
<span class="hljs-keyword">var</span> templateName = <span class="hljs-string">'sn_notification.xml'</span>,
template = $templateCache.get(templateName),
deferred = $q.defer();
<span class="hljs-keyword">if</span> (!template) {
<span class="hljs-keyword">var</span> url = getTemplateUrl(templateName);
$http.get(url).then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">result</span>) </span>{
$templateCache.put(templateName, result.data);
deferred.resolve(result.data);
},
<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">reason</span>) </span>{
<span class="hljs-keyword">return</span> $q.reject(reason);
});
} <span class="hljs-keyword">else</span>
deferred.resolve(template);
<span class="hljs-keyword">return</span> deferred.promise;
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createNotificationElement</span>(<span class="hljs-params">type, message</span>) </span>{
<span class="hljs-keyword">var</span> thisScope, thisElement;
<span class="hljs-keyword">var</span> icon = <span class="hljs-string">'icon-info'</span>;
<span class="hljs-keyword">if</span> (type == <span class="hljs-string">'error'</span>) {
icon = <span class="hljs-string">'icon-cross-circle'</span>;
} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (type == <span class="hljs-string">'warning'</span>) {
icon = <span class="hljs-string">'icon-alert'</span>;
} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (type = <span class="hljs-string">'success'</span>) {
icon = <span class="hljs-string">'icon-check-circle'</span>;
}
<span class="hljs-keyword">return</span> getTemplate().then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">template</span>) </span>{
thisScope = $rootScope.$<span class="hljs-keyword">new</span>();
thisScope.type = type;
thisScope.message = message;
thisScope.icon = icon;
thisElement = $compile(template)(thisScope);
<span class="hljs-keyword">return</span> angular.element(thisElement[<span class="hljs-number">0</span>]);
});
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">displayNotification</span>(<span class="hljs-params">element, container</span>) </span>{
<span class="hljs-keyword">var</span> container = $<span class="hljs-built_in">document</span>.find(container || <span class="hljs-string">'body'</span>),
id = <span class="hljs-string">'elm'</span> + <span class="hljs-built_in">Date</span>.now(),
pos;
container.append(element);
pos = options.top + openNotifications.length * getElementHeight(element);
positionElement(element, pos);
element.addClass(<span class="hljs-string">'visible'</span>);
element.attr(<span class="hljs-string">'id'</span>, id);
element.find(<span class="hljs-string">'button'</span>).bind(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
hideElement(element);
});
openNotifications.push(element);
<span class="hljs-keyword">if</span> (options.duration &gt; <span class="hljs-number">0</span>)
timeouts[id] = $timeout(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
hideNext();
}, options.duration);
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hide</span>(<span class="hljs-params">element</span>) </span>{
$timeout.cancel(timeouts[element.attr(<span class="hljs-string">'id'</span>)]);
element.removeClass(<span class="hljs-string">'visible'</span>);
element.addClass(<span class="hljs-string">'hidden'</span>);
element.find(<span class="hljs-string">'button'</span>).eq(<span class="hljs-number">0</span>).unbind();
element.scope().$destroy();
element.remove();
repositionAll();
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hideElement</span>(<span class="hljs-params">element</span>) </span>{
<span class="hljs-keyword">var</span> index = openNotifications.indexOf(element);
openNotifications.splice(index, <span class="hljs-number">1</span>);
hide(element);
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hideNext</span>(<span class="hljs-params"></span>) </span>{
<span class="hljs-keyword">var</span> element = openNotifications.shift();
<span class="hljs-keyword">if</span> (element)
hide(element);
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getElementHeight</span>(<span class="hljs-params">element</span>) </span>{
<span class="hljs-keyword">return</span> element[<span class="hljs-number">0</span>].offsetHeight + options.gap;
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">positionElement</span>(<span class="hljs-params">element, pos</span>) </span>{
element[<span class="hljs-number">0</span>].style.top = pos + <span class="hljs-string">'px'</span>;
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">repositionAll</span>(<span class="hljs-params"></span>) </span>{
<span class="hljs-keyword">var</span> pos = options.top;
openNotifications.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">element</span>) </span>{
positionElement(element, pos);
pos += getElementHeight(element);
});
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">checkAndSetDestroyDuration</span>(<span class="hljs-params">element, duration</span>)</span>{
<span class="hljs-keyword">if</span> (duration){
timeouts[element.attr(<span class="hljs-string">'id'</span>)] = $timeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
hideElement(element);
}, duration);
}
}
});
;</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
