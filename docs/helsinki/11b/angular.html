<!DOCTYPE html>

<html>
<head>
  <title>angular.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page_wrapper">
            <div id="jump_page">
              
                
                <a class="source" href="AJAXCompleter.html">
                  AJAXCompleter.js
                </a>
              
                
                <a class="source" href="AJAXEmailClientCompleter.html">
                  AJAXEmailClientCompleter.js
                </a>
              
                
                <a class="source" href="AJAXReferenceChoice.html">
                  AJAXReferenceChoice.js
                </a>
              
                
                <a class="source" href="AJAXReferenceCompleter.html">
                  AJAXReferenceCompleter.js
                </a>
              
                
                <a class="source" href="AJAXReferenceCompleterMulti.html">
                  AJAXReferenceCompleterMulti.js
                </a>
              
                
                <a class="source" href="AJAXReferenceControls.html">
                  AJAXReferenceControls.js
                </a>
              
                
                <a class="source" href="AJAXTableCompleter.html">
                  AJAXTableCompleter.js
                </a>
              
                
                <a class="source" href="AttachmentUploader.html">
                  AttachmentUploader.js
                </a>
              
                
                <a class="source" href="AutoComplete.html">
                  AutoComplete.js
                </a>
              
                
                <a class="source" href="BoundsUtil2.html">
                  BoundsUtil2.js
                </a>
              
                
                <a class="source" href="CookieJar.html">
                  CookieJar.js
                </a>
              
                
                <a class="source" href="CustomEventManager.html">
                  CustomEventManager.js
                </a>
              
                
                <a class="source" href="DaysOfWeekElement.html">
                  DaysOfWeekElement.js
                </a>
              
                
                <a class="source" href="Draggable2.html">
                  Draggable2.js
                </a>
              
                
                <a class="source" href="DropTarget2.html">
                  DropTarget2.js
                </a>
              
                
                <a class="source" href="FieldListElement.html">
                  FieldListElement.js
                </a>
              
                
                <a class="source" href="GlideAPI1.html">
                  GlideAPI1.js
                </a>
              
                
                <a class="source" href="GlideAjax.html">
                  GlideAjax.js
                </a>
              
                
                <a class="source" href="GlideAjaxForm.html">
                  GlideAjaxForm.js
                </a>
              
                
                <a class="source" href="GlideBox.html">
                  GlideBox.js
                </a>
              
                
                <a class="source" href="GlideClientCache.html">
                  GlideClientCache.js
                </a>
              
                
                <a class="source" href="GlideDialogForm.html">
                  GlideDialogForm.js
                </a>
              
                
                <a class="source" href="GlideDialogWindow.html">
                  GlideDialogWindow.js
                </a>
              
                
                <a class="source" href="GlideDuration.html">
                  GlideDuration.js
                </a>
              
                
                <a class="source" href="GlideEvent.html">
                  GlideEvent.js
                </a>
              
                
                <a class="source" href="GlideEventHandler.html">
                  GlideEventHandler.js
                </a>
              
                
                <a class="source" href="GlideFilter14.html">
                  GlideFilter14.js
                </a>
              
                
                <a class="source" href="GlideFilterDate.html">
                  GlideFilterDate.js
                </a>
              
                
                <a class="source" href="GlideFilterDescription.html">
                  GlideFilterDescription.js
                </a>
              
                
                <a class="source" href="GlideFilterHandlers.html">
                  GlideFilterHandlers.js
                </a>
              
                
                <a class="source" href="GlideFilterItemVariables.html">
                  GlideFilterItemVariables.js
                </a>
              
                
                <a class="source" href="GlideFilterLabels.html">
                  GlideFilterLabels.js
                </a>
              
                
                <a class="source" href="GlideFilterQuestions.html">
                  GlideFilterQuestions.js
                </a>
              
                
                <a class="source" href="GlideFilterReference.html">
                  GlideFilterReference.js
                </a>
              
                
                <a class="source" href="GlideFilterReferenceMulti.html">
                  GlideFilterReferenceMulti.js
                </a>
              
                
                <a class="source" href="GlideFilterVariables.html">
                  GlideFilterVariables.js
                </a>
              
                
                <a class="source" href="GlideForm14.html">
                  GlideForm14.js
                </a>
              
                
                <a class="source" href="GlideHeaderSearch.html">
                  GlideHeaderSearch.js
                </a>
              
                
                <a class="source" href="GlideList2.html">
                  GlideList2.js
                </a>
              
                
                <a class="source" href="GlideList2FilterUtil.html">
                  GlideList2FilterUtil.js
                </a>
              
                
                <a class="source" href="GlideList2Handlers.html">
                  GlideList2Handlers.js
                </a>
              
                
                <a class="source" href="GlideList2InitEvents.html">
                  GlideList2InitEvents.js
                </a>
              
                
                <a class="source" href="GlideList2Statics.html">
                  GlideList2Statics.js
                </a>
              
                
                <a class="source" href="GlideListEditorMessaging.html">
                  GlideListEditorMessaging.js
                </a>
              
                
                <a class="source" href="GlideListWidget.html">
                  GlideListWidget.js
                </a>
              
                
                <a class="source" href="GlideListv3Compatibility.html">
                  GlideListv3Compatibility.js
                </a>
              
                
                <a class="source" href="GlideModal.html">
                  GlideModal.js
                </a>
              
                
                <a class="source" href="GlideNavigation.html">
                  GlideNavigation.js
                </a>
              
                
                <a class="source" href="GlideOverlay.html">
                  GlideOverlay.js
                </a>
              
                
                <a class="source" href="GlidePane.html">
                  GlidePane.js
                </a>
              
                
                <a class="source" href="GlidePaneForm.html">
                  GlidePaneForm.js
                </a>
              
                
                <a class="source" href="GlideRecord.html">
                  GlideRecord.js
                </a>
              
                
                <a class="source" href="GlideTabs2Tab.html">
                  GlideTabs2Tab.js
                </a>
              
                
                <a class="source" href="GlideTimeElement.html">
                  GlideTimeElement.js
                </a>
              
                
                <a class="source" href="GlideTransactionScope.html">
                  GlideTransactionScope.js
                </a>
              
                
                <a class="source" href="GlideUIDefault.html">
                  GlideUIDefault.js
                </a>
              
                
                <a class="source" href="GlideUIElement.html">
                  GlideUIElement.js
                </a>
              
                
                <a class="source" href="GlideUINotification.html">
                  GlideUINotification.js
                </a>
              
                
                <a class="source" href="GlideURL.html">
                  GlideURL.js
                </a>
              
                
                <a class="source" href="GlideURLElement.html">
                  GlideURLElement.js
                </a>
              
                
                <a class="source" href="GlideUser.html">
                  GlideUser.js
                </a>
              
                
                <a class="source" href="GlideUserImageElement.html">
                  GlideUserImageElement.js
                </a>
              
                
                <a class="source" href="GlideWidgetActions.html">
                  GlideWidgetActions.js
                </a>
              
                
                <a class="source" href="GlideWidgetFilter.html">
                  GlideWidgetFilter.js
                </a>
              
                
                <a class="source" href="GlideWidgetHideOnEmpty.html">
                  GlideWidgetHideOnEmpty.js
                </a>
              
                
                <a class="source" href="GlideWidgetSearch.html">
                  GlideWidgetSearch.js
                </a>
              
                
                <a class="source" href="GlideWidgetVCR.html">
                  GlideWidgetVCR.js
                </a>
              
                
                <a class="source" href="GlideWindow.html">
                  GlideWindow.js
                </a>
              
                
                <a class="source" href="GuidedTourElementTranslator.html">
                  GuidedTourElementTranslator.js
                </a>
              
                
                <a class="source" href="GwtCellEditor.html">
                  GwtCellEditor.js
                </a>
              
                
                <a class="source" href="GwtContextMenu.html">
                  GwtContextMenu.js
                </a>
              
                
                <a class="source" href="GwtCursor.html">
                  GwtCursor.js
                </a>
              
                
                <a class="source" href="GwtDraggable.html">
                  GwtDraggable.js
                </a>
              
                
                <a class="source" href="GwtDraggableSnap.html">
                  GwtDraggableSnap.js
                </a>
              
                
                <a class="source" href="GwtExportScheduleDialog.html">
                  GwtExportScheduleDialog.js
                </a>
              
                
                <a class="source" href="GwtListEditAjaxChangeSaver.html">
                  GwtListEditAjaxChangeSaver.js
                </a>
              
                
                <a class="source" href="GwtListEditAjaxValueLoader.html">
                  GwtListEditAjaxValueLoader.js
                </a>
              
                
                <a class="source" href="GwtListEditBoolean.html">
                  GwtListEditBoolean.js
                </a>
              
                
                <a class="source" href="GwtListEditCalendar.html">
                  GwtListEditCalendar.js
                </a>
              
                
                <a class="source" href="GwtListEditDependent.html">
                  GwtListEditDependent.js
                </a>
              
                
                <a class="source" href="GwtListEditDuration.html">
                  GwtListEditDuration.js
                </a>
              
                
                <a class="source" href="GwtListEditEncryptedText.html">
                  GwtListEditEncryptedText.js
                </a>
              
                
                <a class="source" href="GwtListEditError.html">
                  GwtListEditError.js
                </a>
              
                
                <a class="source" href="GwtListEditInternalType.html">
                  GwtListEditInternalType.js
                </a>
              
                
                <a class="source" href="GwtListEditJournal.html">
                  GwtListEditJournal.js
                </a>
              
                
                <a class="source" href="GwtListEditMultiText.html">
                  GwtListEditMultiText.js
                </a>
              
                
                <a class="source" href="GwtListEditPassword.html">
                  GwtListEditPassword.js
                </a>
              
                
                <a class="source" href="GwtListEditRecordDecorations.html">
                  GwtListEditRecordDecorations.js
                </a>
              
                
                <a class="source" href="GwtListEditReference.html">
                  GwtListEditReference.js
                </a>
              
                
                <a class="source" href="GwtListEditRelatedTags.html">
                  GwtListEditRelatedTags.js
                </a>
              
                
                <a class="source" href="GwtListEditSavePolicy.html">
                  GwtListEditSavePolicy.js
                </a>
              
                
                <a class="source" href="GwtListEditSelect.html">
                  GwtListEditSelect.js
                </a>
              
                
                <a class="source" href="GwtListEditTableController.html">
                  GwtListEditTableController.js
                </a>
              
                
                <a class="source" href="GwtListEditTablename.html">
                  GwtListEditTablename.js
                </a>
              
                
                <a class="source" href="GwtListEditText.html">
                  GwtListEditText.js
                </a>
              
                
                <a class="source" href="GwtListEditTranslatedField.html">
                  GwtListEditTranslatedField.js
                </a>
              
                
                <a class="source" href="GwtListEditUpdateTablename.html">
                  GwtListEditUpdateTablename.js
                </a>
              
                
                <a class="source" href="GwtListEditValueRenderer.html">
                  GwtListEditValueRenderer.js
                </a>
              
                
                <a class="source" href="GwtListEditWindow.html">
                  GwtListEditWindow.js
                </a>
              
                
                <a class="source" href="GwtListEditorPendingChanges.html">
                  GwtListEditorPendingChanges.js
                </a>
              
                
                <a class="source" href="GwtMessage14.html">
                  GwtMessage14.js
                </a>
              
                
                <a class="source" href="GwtObservable.html">
                  GwtObservable.js
                </a>
              
                
                <a class="source" href="GwtPollDialog.html">
                  GwtPollDialog.js
                </a>
              
                
                <a class="source" href="InPlaceEdit.html">
                  InPlaceEdit.js
                </a>
              
                
                <a class="source" href="ListDraggableRow2.html">
                  ListDraggableRow2.js
                </a>
              
                
                <a class="source" href="ListSelectManager2.html">
                  ListSelectManager2.js
                </a>
              
                
                <a class="source" href="ListSortDual2.html">
                  ListSortDual2.js
                </a>
              
                
                <a class="source" href="ListSortWindow2.html">
                  ListSortWindow2.js
                </a>
              
                
                <a class="source" href="NOW.messaging.html">
                  NOW.messaging.js
                </a>
              
                
                <a class="source" href="NOW.messaging.record.html">
                  NOW.messaging.record.js
                </a>
              
                
                <a class="source" href="NameMapEntry.html">
                  NameMapEntry.js
                </a>
              
                
                <a class="source" href="NotificationMessage.html">
                  NotificationMessage.js
                </a>
              
                
                <a class="source" href="PageTiming14.html">
                  PageTiming14.js
                </a>
              
                
                <a class="source" href="Point.html">
                  Point.js
                </a>
              
                
                <a class="source" href="SLARepairClient.html">
                  SLARepairClient.js
                </a>
              
                
                <a class="source" href="ScriptLoader.html">
                  ScriptLoader.js
                </a>
              
                
                <a class="source" href="Select.html">
                  Select.js
                </a>
              
                
                <a class="source" href="SlushBucket.html">
                  SlushBucket.js
                </a>
              
                
                <a class="source" href="SortDraggable2.html">
                  SortDraggable2.js
                </a>
              
                
                <a class="source" href="SortDropTarget2.html">
                  SortDropTarget2.js
                </a>
              
                
                <a class="source" href="SortListManager2.html">
                  SortListManager2.js
                </a>
              
                
                <a class="source" href="SortUtil2.html">
                  SortUtil2.js
                </a>
              
                
                <a class="source" href="StopWatch.html">
                  StopWatch.js
                </a>
              
                
                <a class="source" href="TableElement.html">
                  TableElement.js
                </a>
              
                
                <a class="source" href="TableExtension.html">
                  TableExtension.js
                </a>
              
                
                <a class="source" href="TemplateRecord.html">
                  TemplateRecord.js
                </a>
              
                
                <a class="source" href="TextAreaElement.html">
                  TextAreaElement.js
                </a>
              
                
                <a class="source" href="UserRolesElement.html">
                  UserRolesElement.js
                </a>
              
                
                <a class="source" href="UtilityAndOverrides2.html">
                  UtilityAndOverrides2.js
                </a>
              
                
                <a class="source" href="_module.html">
                  _module.js
                </a>
              
                
                <a class="source" href="ac.html">
                  ac.js
                </a>
              
                
                <a class="source" href="ac_derived_field_support.html">
                  ac_derived_field_support.js
                </a>
              
                
                <a class="source" href="affix.html">
                  affix.js
                </a>
              
                
                <a class="source" href="alert.html">
                  alert.js
                </a>
              
                
                <a class="source" href="amb.ChannelListener.html">
                  amb.ChannelListener.js
                </a>
              
                
                <a class="source" href="amb.ChannelRedirect.html">
                  amb.ChannelRedirect.js
                </a>
              
                
                <a class="source" href="amb.Logger.html">
                  amb.Logger.js
                </a>
              
                
                <a class="source" href="amb.MessageClient.html">
                  amb.MessageClient.js
                </a>
              
                
                <a class="source" href="amb.MessageClientBuilder.html">
                  amb.MessageClientBuilder.js
                </a>
              
                
                <a class="source" href="amb.ServerConnection.html">
                  amb.ServerConnection.js
                </a>
              
                
                <a class="source" href="amb_initialize.html">
                  amb_initialize.js
                </a>
              
                
                <a class="source" href="angular-animate.html">
                  angular-animate.js
                </a>
              
                
                <a class="source" href="angular-sanitize.html">
                  angular-sanitize.js
                </a>
              
                
                <a class="source" href="angular.html">
                  angular.js
                </a>
              
                
                <a class="source" href="app.form_presence.html">
                  app.form_presence.js
                </a>
              
                
                <a class="source" href="app_guided_tours.html">
                  app_guided_tours.js
                </a>
              
                
                <a class="source" href="button.html">
                  button.js
                </a>
              
                
                <a class="source" href="calendar.html">
                  calendar.js
                </a>
              
                
                <a class="source" href="carousel.html">
                  carousel.js
                </a>
              
                
                <a class="source" href="collapse.html">
                  collapse.js
                </a>
              
                
                <a class="source" href="cometd.html">
                  cometd.js
                </a>
              
                
                <a class="source" href="condition14_new.html">
                  condition14_new.js
                </a>
              
                
                <a class="source" href="condition14_reporting.html">
                  condition14_reporting.js
                </a>
              
                
                <a class="source" href="condition14_templates.html">
                  condition14_templates.js
                </a>
              
                
                <a class="source" href="condition_global_variables14.html">
                  condition_global_variables14.js
                </a>
              
                
                <a class="source" href="constants_embedded_help.html">
                  constants_embedded_help.js
                </a>
              
                
                <a class="source" href="context_actions.html">
                  context_actions.js
                </a>
              
                
                <a class="source" href="controller.guidedTours.html">
                  controller.guidedTours.js
                </a>
              
                
                <a class="source" href="deferred_related_lists.html">
                  deferred_related_lists.js
                </a>
              
                
                <a class="source" href="depends.html">
                  depends.js
                </a>
              
                
                <a class="source" href="directive.snBindPopoverSelection.html">
                  directive.snBindPopoverSelection.js
                </a>
              
                
                <a class="source" href="directive.snComplexPopover.html">
                  directive.snComplexPopover.js
                </a>
              
                
                <a class="source" href="dropdown.html">
                  dropdown.js
                </a>
              
                
                <a class="source" href="dropdowns.html">
                  dropdowns.js
                </a>
              
                
                <a class="source" href="email_activity.html">
                  email_activity.js
                </a>
              
                
                <a class="source" href="event_initialize.html">
                  event_initialize.js
                </a>
              
                
                <a class="source" href="fixedHeaders.html">
                  fixedHeaders.js
                </a>
              
                
                <a class="source" href="form_submitted_mask.html">
                  form_submitted_mask.js
                </a>
              
                
                <a class="source" href="form_tags.html">
                  form_tags.js
                </a>
              
                
                <a class="source" href="formatting.html">
                  formatting.js
                </a>
              
                
                <a class="source" href="functions.html">
                  functions.js
                </a>
              
                
                <a class="source" href="functions_attachments.html">
                  functions_attachments.js
                </a>
              
                
                <a class="source" href="functions_bootstrap14.html">
                  functions_bootstrap14.js
                </a>
              
                
                <a class="source" href="functions_calendar.html">
                  functions_calendar.js
                </a>
              
                
                <a class="source" href="functions_clipboard.html">
                  functions_clipboard.js
                </a>
              
                
                <a class="source" href="functions_email.html">
                  functions_email.js
                </a>
              
                
                <a class="source" href="functions_fontsizer.html">
                  functions_fontsizer.js
                </a>
              
                
                <a class="source" href="functions_onchange.html">
                  functions_onchange.js
                </a>
              
                
                <a class="source" href="functions_reference.html">
                  functions_reference.js
                </a>
              
                
                <a class="source" href="functions_showloading.html">
                  functions_showloading.js
                </a>
              
                
                <a class="source" href="functions_user_image.html">
                  functions_user_image.js
                </a>
              
                
                <a class="source" href="glide-highcharts-v5.html">
                  glide-highcharts-v5.js
                </a>
              
                
                <a class="source" href="guided_tours_template.html">
                  guided_tours_template.js
                </a>
              
                
                <a class="source" href="heisenberg_all.html">
                  heisenberg_all.js
                </a>
              
                
                <a class="source" href="jquery-1.11.0_no_conflict.html">
                  jquery-1.11.0_no_conflict.js
                </a>
              
                
                <a class="source" href="jquery-2.1.html">
                  jquery-2.1.js
                </a>
              
                
                <a class="source" href="jquery-ui-1.9.2.custom.html">
                  jquery-ui-1.9.2.custom.js
                </a>
              
                
                <a class="source" href="jquery_clean.html">
                  jquery_clean.js
                </a>
              
                
                <a class="source" href="jquery_includes.html">
                  jquery_includes.js
                </a>
              
                
                <a class="source" href="jquery_no_conflict.html">
                  jquery_no_conflict.js
                </a>
              
                
                <a class="source" href="js_guided_tours_includes.html">
                  js_guided_tours_includes.js
                </a>
              
                
                <a class="source" href="js_includes_amb.html">
                  js_includes_amb.js
                </a>
              
                
                <a class="source" href="js_includes_customer.html">
                  js_includes_customer.js
                </a>
              
                
                <a class="source" href="js_includes_doctype.html">
                  js_includes_doctype.js
                </a>
              
                
                <a class="source" href="js_includes_form_presence.html">
                  js_includes_form_presence.js
                </a>
              
                
                <a class="source" href="js_includes_last_doctype.html">
                  js_includes_last_doctype.js
                </a>
              
                
                <a class="source" href="js_includes_list_edit_doctype.html">
                  js_includes_list_edit_doctype.js
                </a>
              
                
                <a class="source" href="js_includes_listv2_doctype.html">
                  js_includes_listv2_doctype.js
                </a>
              
                
                <a class="source" href="js_includes_sorting_new.html">
                  js_includes_sorting_new.js
                </a>
              
                
                <a class="source" href="js_includes_sp.html">
                  js_includes_sp.js
                </a>
              
                
                <a class="source" href="js_includes_sp_deps.html">
                  js_includes_sp_deps.js
                </a>
              
                
                <a class="source" href="js_includes_ui_popover.html">
                  js_includes_ui_popover.js
                </a>
              
                
                <a class="source" href="list_filter.html">
                  list_filter.js
                </a>
              
                
                <a class="source" href="magellan.CreateFavoriteModal.html">
                  magellan.CreateFavoriteModal.js
                </a>
              
                
                <a class="source" href="modal.html">
                  modal.js
                </a>
              
                
                <a class="source" href="modals.html">
                  modals.js
                </a>
              
                
                <a class="source" href="newtag-it.html">
                  newtag-it.js
                </a>
              
                
                <a class="source" href="popover.html">
                  popover.js
                </a>
              
                
                <a class="source" href="popovers.html">
                  popovers.js
                </a>
              
                
                <a class="source" href="popups.html">
                  popups.js
                </a>
              
                
                <a class="source" href="prototype.effects.html">
                  prototype.effects.js
                </a>
              
                
                <a class="source" href="prototype.hidefix.html">
                  prototype.hidefix.js
                </a>
              
                
                <a class="source" href="prototype.html">
                  prototype.js
                </a>
              
                
                <a class="source" href="prototype.plugin.html">
                  prototype.plugin.js
                </a>
              
                
                <a class="source" href="prototype.template.html">
                  prototype.template.js
                </a>
              
                
                <a class="source" href="scoped_object_generators.html">
                  scoped_object_generators.js
                </a>
              
                
                <a class="source" href="scrollable.html">
                  scrollable.js
                </a>
              
                
                <a class="source" href="scrollspy.html">
                  scrollspy.js
                </a>
              
                
                <a class="source" href="section.html">
                  section.js
                </a>
              
                
                <a class="source" href="service.guidedToursService.html">
                  service.guidedToursService.js
                </a>
              
                
                <a class="source" href="service.snComplexPopoverService.html">
                  service.snComplexPopoverService.js
                </a>
              
                
                <a class="source" href="service.userData.html">
                  service.userData.js
                </a>
              
                
                <a class="source" href="simpleStorage.html">
                  simpleStorage.js
                </a>
              
                
                <a class="source" href="snPopover.html">
                  snPopover.js
                </a>
              
                
                <a class="source" href="tabs2_14.html">
                  tabs2_14.js
                </a>
              
                
                <a class="source" href="textutil.html">
                  textutil.js
                </a>
              
                
                <a class="source" href="timeAgo.html">
                  timeAgo.js
                </a>
              
                
                <a class="source" href="tooltip.html">
                  tooltip.js
                </a>
              
                
                <a class="source" href="tooltips.html">
                  tooltips.js
                </a>
              
                
                <a class="source" href="transaction_scope_includes.html">
                  transaction_scope_includes.js
                </a>
              
                
                <a class="source" href="transition.html">
                  transition.js
                </a>
              
                
                <a class="source" href="ui_policy.html">
                  ui_policy.js
                </a>
              
                
                <a class="source" href="utils14.html">
                  utils14.js
                </a>
              
                
                <a class="source" href="xmlhttp.html">
                  xmlhttp.js
                </a>
              
                
                <a class="source" href="z_last_include.html">
                  z_last_include.js
                </a>
              
            </div>
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>angular.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-comment">/*! RESOURCE: /scripts/angular_1.5.3/angular.js */</span>
(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">window, document, undefined</span>) </span>{
<span class="hljs-meta">    'use strict'</span>;

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">minErr</span>(<span class="hljs-params">module, ErrorConstructor</span>) </span>{
      ErrorConstructor = ErrorConstructor || <span class="hljs-built_in">Error</span>;
      <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> SKIP_INDEXES = <span class="hljs-number">2</span>;
        <span class="hljs-keyword">var</span> templateArgs = <span class="hljs-built_in">arguments</span>,
          code = templateArgs[<span class="hljs-number">0</span>],
          message = <span class="hljs-string">'['</span> + (<span class="hljs-built_in">module</span> ? <span class="hljs-built_in">module</span> + <span class="hljs-string">':'</span> : <span class="hljs-string">''</span>) + code + <span class="hljs-string">'] '</span>,
          template = templateArgs[<span class="hljs-number">1</span>],
          paramPrefix, i;
        message += template.replace(<span class="hljs-regexp">/\{\d+\}/g</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">match</span>) </span>{
          <span class="hljs-keyword">var</span> index = +match.slice(<span class="hljs-number">1</span>, <span class="hljs-number">-1</span>),
            shiftedIndex = index + SKIP_INDEXES;
          <span class="hljs-keyword">if</span> (shiftedIndex &lt; templateArgs.length) {
            <span class="hljs-keyword">return</span> toDebugString(templateArgs[shiftedIndex]);
          }
          <span class="hljs-keyword">return</span> match;
        });
        message += <span class="hljs-string">'\nhttp://errors.angularjs.org/1.5.3/'</span> +
          (<span class="hljs-built_in">module</span> ? <span class="hljs-built_in">module</span> + <span class="hljs-string">'/'</span> : <span class="hljs-string">''</span>) + code;
        <span class="hljs-keyword">for</span> (i = SKIP_INDEXES, paramPrefix = <span class="hljs-string">'?'</span>; i &lt; templateArgs.length; i++, paramPrefix = <span class="hljs-string">'&amp;'</span>) {
          message += paramPrefix + <span class="hljs-string">'p'</span> + (i - SKIP_INDEXES) + <span class="hljs-string">'='</span> +
            <span class="hljs-built_in">encodeURIComponent</span>(toDebugString(templateArgs[i]));
        }
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ErrorConstructor(message);
      };
    }
    <span class="hljs-keyword">var</span> REGEX_STRING_REGEXP = <span class="hljs-regexp">/^\/(.+)\/([a-z]*)$/</span>;
    <span class="hljs-keyword">var</span> VALIDITY_STATE_PROPERTY = <span class="hljs-string">'validity'</span>;
    <span class="hljs-keyword">var</span> hasOwnProperty = <span class="hljs-built_in">Object</span>.prototype.hasOwnProperty;
    <span class="hljs-keyword">var</span> lowercase = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">string</span>) </span>{
      <span class="hljs-keyword">return</span> isString(string) ? string.toLowerCase() : string;
    };
    <span class="hljs-keyword">var</span> uppercase = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">string</span>) </span>{
      <span class="hljs-keyword">return</span> isString(string) ? string.toUpperCase() : string;
    };
    <span class="hljs-keyword">var</span> manualLowercase = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">s</span>) </span>{
      <span class="hljs-keyword">return</span> isString(s) ?
        s.replace(<span class="hljs-regexp">/[A-Z]/g</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">ch</span>) </span>{
          <span class="hljs-keyword">return</span> <span class="hljs-built_in">String</span>.fromCharCode(ch.charCodeAt(<span class="hljs-number">0</span>) | <span class="hljs-number">32</span>);
        }) :
        s;
    };
    <span class="hljs-keyword">var</span> manualUppercase = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">s</span>) </span>{
      <span class="hljs-keyword">return</span> isString(s) ?
        s.replace(<span class="hljs-regexp">/[a-z]/g</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">ch</span>) </span>{
          <span class="hljs-keyword">return</span> <span class="hljs-built_in">String</span>.fromCharCode(ch.charCodeAt(<span class="hljs-number">0</span>) &amp; ~<span class="hljs-number">32</span>);
        }) :
        s;
    };
    <span class="hljs-keyword">if</span> (<span class="hljs-string">'i'</span> !== <span class="hljs-string">'I'</span>.toLowerCase()) {
      lowercase = manualLowercase;
      uppercase = manualUppercase;
    }
    <span class="hljs-keyword">var</span>
      msie,
      jqLite,
      jQuery,
      slice = [].slice,
      splice = [].splice,
      push = [].push,
      toString = <span class="hljs-built_in">Object</span>.prototype.toString,
      getPrototypeOf = <span class="hljs-built_in">Object</span>.getPrototypeOf,
      ngMinErr = minErr(<span class="hljs-string">'ng'</span>),
      angular = <span class="hljs-built_in">window</span>.angular || (<span class="hljs-built_in">window</span>.angular = {}),
      angularModule,
      uid = <span class="hljs-number">0</span>;
    msie = <span class="hljs-built_in">document</span>.documentMode;

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isArrayLike</span>(<span class="hljs-params">obj</span>) </span>{
      <span class="hljs-keyword">if</span> (obj == <span class="hljs-literal">null</span> || isWindow(obj)) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
      <span class="hljs-keyword">if</span> (isArray(obj) || isString(obj) || (jqLite &amp;&amp; obj <span class="hljs-keyword">instanceof</span> jqLite)) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
      <span class="hljs-keyword">var</span> length = <span class="hljs-string">"length"</span> <span class="hljs-keyword">in</span> <span class="hljs-built_in">Object</span>(obj) &amp;&amp; obj.length;
      <span class="hljs-keyword">return</span> isNumber(length) &amp;&amp;
        (length &gt;= <span class="hljs-number">0</span> &amp;&amp; ((length - <span class="hljs-number">1</span>) <span class="hljs-keyword">in</span> obj || obj <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Array</span>) || <span class="hljs-keyword">typeof</span> obj.item == <span class="hljs-string">'function'</span>);
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">forEach</span>(<span class="hljs-params">obj, iterator, context</span>) </span>{
      <span class="hljs-keyword">var</span> key, length;
      <span class="hljs-keyword">if</span> (obj) {
        <span class="hljs-keyword">if</span> (isFunction(obj)) {
          <span class="hljs-keyword">for</span> (key <span class="hljs-keyword">in</span> obj) {
            <span class="hljs-keyword">if</span> (key != <span class="hljs-string">'prototype'</span> &amp;&amp; key != <span class="hljs-string">'length'</span> &amp;&amp; key != <span class="hljs-string">'name'</span> &amp;&amp; (!obj.hasOwnProperty || obj.hasOwnProperty(key))) {
              iterator.call(context, obj[key], key, obj);
            }
          }
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (isArray(obj) || isArrayLike(obj)) {
          <span class="hljs-keyword">var</span> isPrimitive = <span class="hljs-keyword">typeof</span> obj !== <span class="hljs-string">'object'</span>;
          <span class="hljs-keyword">for</span> (key = <span class="hljs-number">0</span>, length = obj.length; key &lt; length; key++) {
            <span class="hljs-keyword">if</span> (isPrimitive || key <span class="hljs-keyword">in</span> obj) {
              iterator.call(context, obj[key], key, obj);
            }
          }
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (obj.forEach &amp;&amp; obj.forEach !== forEach) {
          obj.forEach(iterator, context, obj);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (isBlankObject(obj)) {
          <span class="hljs-keyword">for</span> (key <span class="hljs-keyword">in</span> obj) {
            iterator.call(context, obj[key], key, obj);
          }
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> obj.hasOwnProperty === <span class="hljs-string">'function'</span>) {
          <span class="hljs-keyword">for</span> (key <span class="hljs-keyword">in</span> obj) {
            <span class="hljs-keyword">if</span> (obj.hasOwnProperty(key)) {
              iterator.call(context, obj[key], key, obj);
            }
          }
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">for</span> (key <span class="hljs-keyword">in</span> obj) {
            <span class="hljs-keyword">if</span> (hasOwnProperty.call(obj, key)) {
              iterator.call(context, obj[key], key, obj);
            }
          }
        }
      }
      <span class="hljs-keyword">return</span> obj;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">forEachSorted</span>(<span class="hljs-params">obj, iterator, context</span>) </span>{
      <span class="hljs-keyword">var</span> keys = <span class="hljs-built_in">Object</span>.keys(obj).sort();
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; keys.length; i++) {
        iterator.call(context, obj[keys[i]], keys[i]);
      }
      <span class="hljs-keyword">return</span> keys;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">reverseParams</span>(<span class="hljs-params">iteratorFn</span>) </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value, key</span>) </span>{
        iteratorFn(key, value);
      };
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">nextUid</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">return</span> ++uid;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setHashKey</span>(<span class="hljs-params">obj, h</span>) </span>{
      <span class="hljs-keyword">if</span> (h) {
        obj.$$hashKey = h;
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">delete</span> obj.$$hashKey;
      }
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">baseExtend</span>(<span class="hljs-params">dst, objs, deep</span>) </span>{
      <span class="hljs-keyword">var</span> h = dst.$$hashKey;
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, ii = objs.length; i &lt; ii; ++i) {
        <span class="hljs-keyword">var</span> obj = objs[i];
        <span class="hljs-keyword">if</span> (!isObject(obj) &amp;&amp; !isFunction(obj)) <span class="hljs-keyword">continue</span>;
        <span class="hljs-keyword">var</span> keys = <span class="hljs-built_in">Object</span>.keys(obj);
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> j = <span class="hljs-number">0</span>, jj = keys.length; j &lt; jj; j++) {
          <span class="hljs-keyword">var</span> key = keys[j];
          <span class="hljs-keyword">var</span> src = obj[key];
          <span class="hljs-keyword">if</span> (deep &amp;&amp; isObject(src)) {
            <span class="hljs-keyword">if</span> (isDate(src)) {
              dst[key] = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(src.valueOf());
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (isRegExp(src)) {
              dst[key] = <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(src);
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (src.nodeName) {
              dst[key] = src.cloneNode(<span class="hljs-literal">true</span>);
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (isElement(src)) {
              dst[key] = src.clone();
            } <span class="hljs-keyword">else</span> {
              <span class="hljs-keyword">if</span> (!isObject(dst[key])) dst[key] = isArray(src) ? [] : {};
              baseExtend(dst[key], [src], <span class="hljs-literal">true</span>);
            }
          } <span class="hljs-keyword">else</span> {
            dst[key] = src;
          }
        }
      }
      setHashKey(dst, h);
      <span class="hljs-keyword">return</span> dst;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">extend</span>(<span class="hljs-params">dst</span>) </span>{
      <span class="hljs-keyword">return</span> baseExtend(dst, slice.call(<span class="hljs-built_in">arguments</span>, <span class="hljs-number">1</span>), <span class="hljs-literal">false</span>);
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">merge</span>(<span class="hljs-params">dst</span>) </span>{
      <span class="hljs-keyword">return</span> baseExtend(dst, slice.call(<span class="hljs-built_in">arguments</span>, <span class="hljs-number">1</span>), <span class="hljs-literal">true</span>);
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toInt</span>(<span class="hljs-params">str</span>) </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-built_in">parseInt</span>(str, <span class="hljs-number">10</span>);
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">inherit</span>(<span class="hljs-params">parent, extra</span>) </span>{
      <span class="hljs-keyword">return</span> extend(<span class="hljs-built_in">Object</span>.create(parent), extra);
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">noop</span>(<span class="hljs-params"></span>) </span>{}
    noop.$inject = [];

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">identity</span>(<span class="hljs-params">$</span>) </span>{
      <span class="hljs-keyword">return</span> $;
    }
    identity.$inject = [];

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">valueFn</span>(<span class="hljs-params">value</span>) </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">valueRef</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> value;
      };
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hasCustomToString</span>(<span class="hljs-params">obj</span>) </span>{
      <span class="hljs-keyword">return</span> isFunction(obj.toString) &amp;&amp; obj.toString !== toString;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isUndefined</span>(<span class="hljs-params">value</span>) </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> value === <span class="hljs-string">'undefined'</span>;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isDefined</span>(<span class="hljs-params">value</span>) </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> value !== <span class="hljs-string">'undefined'</span>;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isObject</span>(<span class="hljs-params">value</span>) </span>{
      <span class="hljs-keyword">return</span> value !== <span class="hljs-literal">null</span> &amp;&amp; <span class="hljs-keyword">typeof</span> value === <span class="hljs-string">'object'</span>;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isBlankObject</span>(<span class="hljs-params">value</span>) </span>{
      <span class="hljs-keyword">return</span> value !== <span class="hljs-literal">null</span> &amp;&amp; <span class="hljs-keyword">typeof</span> value === <span class="hljs-string">'object'</span> &amp;&amp; !getPrototypeOf(value);
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isString</span>(<span class="hljs-params">value</span>) </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> value === <span class="hljs-string">'string'</span>;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isNumber</span>(<span class="hljs-params">value</span>) </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> value === <span class="hljs-string">'number'</span>;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isDate</span>(<span class="hljs-params">value</span>) </span>{
      <span class="hljs-keyword">return</span> toString.call(value) === <span class="hljs-string">'[object Date]'</span>;
    }
    <span class="hljs-keyword">var</span> isArray = <span class="hljs-built_in">Array</span>.isArray;

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isFunction</span>(<span class="hljs-params">value</span>) </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> value === <span class="hljs-string">'function'</span>;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isRegExp</span>(<span class="hljs-params">value</span>) </span>{
      <span class="hljs-keyword">return</span> toString.call(value) === <span class="hljs-string">'[object RegExp]'</span>;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isWindow</span>(<span class="hljs-params">obj</span>) </span>{
      <span class="hljs-keyword">return</span> obj &amp;&amp; obj.window === obj;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isScope</span>(<span class="hljs-params">obj</span>) </span>{
      <span class="hljs-keyword">return</span> obj &amp;&amp; obj.$evalAsync &amp;&amp; obj.$watch;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isFile</span>(<span class="hljs-params">obj</span>) </span>{
      <span class="hljs-keyword">return</span> toString.call(obj) === <span class="hljs-string">'[object File]'</span>;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isFormData</span>(<span class="hljs-params">obj</span>) </span>{
      <span class="hljs-keyword">return</span> toString.call(obj) === <span class="hljs-string">'[object FormData]'</span>;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isBlob</span>(<span class="hljs-params">obj</span>) </span>{
      <span class="hljs-keyword">return</span> toString.call(obj) === <span class="hljs-string">'[object Blob]'</span>;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isBoolean</span>(<span class="hljs-params">value</span>) </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> value === <span class="hljs-string">'boolean'</span>;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isPromiseLike</span>(<span class="hljs-params">obj</span>) </span>{
      <span class="hljs-keyword">return</span> obj &amp;&amp; isFunction(obj.then);
    }
    <span class="hljs-keyword">var</span> TYPED_ARRAY_REGEXP = <span class="hljs-regexp">/^\[object (?:Uint8|Uint8Clamped|Uint16|Uint32|Int8|Int16|Int32|Float32|Float64)Array\]$/</span>;

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isTypedArray</span>(<span class="hljs-params">value</span>) </span>{
      <span class="hljs-keyword">return</span> value &amp;&amp; isNumber(value.length) &amp;&amp; TYPED_ARRAY_REGEXP.test(toString.call(value));
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isArrayBuffer</span>(<span class="hljs-params">obj</span>) </span>{
      <span class="hljs-keyword">return</span> toString.call(obj) === <span class="hljs-string">'[object ArrayBuffer]'</span>;
    }
    <span class="hljs-keyword">var</span> trim = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>) </span>{
      <span class="hljs-keyword">return</span> isString(value) ? value.trim() : value;
    };
    <span class="hljs-keyword">var</span> escapeForRegexp = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">s</span>) </span>{
      <span class="hljs-keyword">return</span> s.replace(<span class="hljs-regexp">/([-()\[\]{}+?*.$\^|,:#&lt;!\\])/g</span>, <span class="hljs-string">'\\$1'</span>).
      replace(<span class="hljs-regexp">/\x08/g</span>, <span class="hljs-string">'\\x08'</span>);
    };

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isElement</span>(<span class="hljs-params">node</span>) </span>{
      <span class="hljs-keyword">return</span> !!(node &amp;&amp;
        (node.nodeName ||
          (node.prop &amp;&amp; node.attr &amp;&amp; node.find)));
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">makeMap</span>(<span class="hljs-params">str</span>) </span>{
      <span class="hljs-keyword">var</span> obj = {},
        items = str.split(<span class="hljs-string">','</span>),
        i;
      <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; items.length; i++) {
        obj[items[i]] = <span class="hljs-literal">true</span>;
      }
      <span class="hljs-keyword">return</span> obj;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">nodeName_</span>(<span class="hljs-params">element</span>) </span>{
      <span class="hljs-keyword">return</span> lowercase(element.nodeName || (element[<span class="hljs-number">0</span>] &amp;&amp; element[<span class="hljs-number">0</span>].nodeName));
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">includes</span>(<span class="hljs-params">array, obj</span>) </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-built_in">Array</span>.prototype.indexOf.call(array, obj) != <span class="hljs-number">-1</span>;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">arrayRemove</span>(<span class="hljs-params">array, value</span>) </span>{
      <span class="hljs-keyword">var</span> index = array.indexOf(value);
      <span class="hljs-keyword">if</span> (index &gt;= <span class="hljs-number">0</span>) {
        array.splice(index, <span class="hljs-number">1</span>);
      }
      <span class="hljs-keyword">return</span> index;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">copy</span>(<span class="hljs-params">source, destination</span>) </span>{
      <span class="hljs-keyword">var</span> stackSource = [];
      <span class="hljs-keyword">var</span> stackDest = [];
      <span class="hljs-keyword">if</span> (destination) {
        <span class="hljs-keyword">if</span> (isTypedArray(destination) || isArrayBuffer(destination)) {
          <span class="hljs-keyword">throw</span> ngMinErr(<span class="hljs-string">'cpta'</span>, <span class="hljs-string">"Can't copy! TypedArray destination cannot be mutated."</span>);
        }
        <span class="hljs-keyword">if</span> (source === destination) {
          <span class="hljs-keyword">throw</span> ngMinErr(<span class="hljs-string">'cpi'</span>, <span class="hljs-string">"Can't copy! Source and destination are identical."</span>);
        }
        <span class="hljs-keyword">if</span> (isArray(destination)) {
          destination.length = <span class="hljs-number">0</span>;
        } <span class="hljs-keyword">else</span> {
          forEach(destination, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value, key</span>) </span>{
            <span class="hljs-keyword">if</span> (key !== <span class="hljs-string">'$$hashKey'</span>) {
              <span class="hljs-keyword">delete</span> destination[key];
            }
          });
        }
        stackSource.push(source);
        stackDest.push(destination);
        <span class="hljs-keyword">return</span> copyRecurse(source, destination);
      }
      <span class="hljs-keyword">return</span> copyElement(source);

      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">copyRecurse</span>(<span class="hljs-params">source, destination</span>) </span>{
        <span class="hljs-keyword">var</span> h = destination.$$hashKey;
        <span class="hljs-keyword">var</span> key;
        <span class="hljs-keyword">if</span> (isArray(source)) {
          <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, ii = source.length; i &lt; ii; i++) {
            destination.push(copyElement(source[i]));
          }
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (isBlankObject(source)) {
          <span class="hljs-keyword">for</span> (key <span class="hljs-keyword">in</span> source) {
            destination[key] = copyElement(source[key]);
          }
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (source &amp;&amp; <span class="hljs-keyword">typeof</span> source.hasOwnProperty === <span class="hljs-string">'function'</span>) {
          <span class="hljs-keyword">for</span> (key <span class="hljs-keyword">in</span> source) {
            <span class="hljs-keyword">if</span> (source.hasOwnProperty(key)) {
              destination[key] = copyElement(source[key]);
            }
          }
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">for</span> (key <span class="hljs-keyword">in</span> source) {
            <span class="hljs-keyword">if</span> (hasOwnProperty.call(source, key)) {
              destination[key] = copyElement(source[key]);
            }
          }
        }
        setHashKey(destination, h);
        <span class="hljs-keyword">return</span> destination;
      }

      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">copyElement</span>(<span class="hljs-params">source</span>) </span>{
        <span class="hljs-keyword">if</span> (!isObject(source)) {
          <span class="hljs-keyword">return</span> source;
        }
        <span class="hljs-keyword">var</span> index = stackSource.indexOf(source);
        <span class="hljs-keyword">if</span> (index !== <span class="hljs-number">-1</span>) {
          <span class="hljs-keyword">return</span> stackDest[index];
        }
        <span class="hljs-keyword">if</span> (isWindow(source) || isScope(source)) {
          <span class="hljs-keyword">throw</span> ngMinErr(<span class="hljs-string">'cpws'</span>,
            <span class="hljs-string">"Can't copy! Making copies of Window or Scope instances is not supported."</span>);
        }
        <span class="hljs-keyword">var</span> needsRecurse = <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">var</span> destination = copyType(source);
        <span class="hljs-keyword">if</span> (destination === <span class="hljs-literal">undefined</span>) {
          destination = isArray(source) ? [] : <span class="hljs-built_in">Object</span>.create(getPrototypeOf(source));
          needsRecurse = <span class="hljs-literal">true</span>;
        }
        stackSource.push(source);
        stackDest.push(destination);
        <span class="hljs-keyword">return</span> needsRecurse ?
          copyRecurse(source, destination) :
          destination;
      }

      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">copyType</span>(<span class="hljs-params">source</span>) </span>{
        <span class="hljs-keyword">switch</span> (toString.call(source)) {
          <span class="hljs-keyword">case</span> <span class="hljs-string">'[object Int8Array]'</span>:
          <span class="hljs-keyword">case</span> <span class="hljs-string">'[object Int16Array]'</span>:
          <span class="hljs-keyword">case</span> <span class="hljs-string">'[object Int32Array]'</span>:
          <span class="hljs-keyword">case</span> <span class="hljs-string">'[object Float32Array]'</span>:
          <span class="hljs-keyword">case</span> <span class="hljs-string">'[object Float64Array]'</span>:
          <span class="hljs-keyword">case</span> <span class="hljs-string">'[object Uint8Array]'</span>:
          <span class="hljs-keyword">case</span> <span class="hljs-string">'[object Uint8ClampedArray]'</span>:
          <span class="hljs-keyword">case</span> <span class="hljs-string">'[object Uint16Array]'</span>:
          <span class="hljs-keyword">case</span> <span class="hljs-string">'[object Uint32Array]'</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> source.constructor(copyElement(source.buffer));
          <span class="hljs-keyword">case</span> <span class="hljs-string">'[object ArrayBuffer]'</span>:
            <span class="hljs-keyword">if</span> (!source.slice) {
              <span class="hljs-keyword">var</span> copied = <span class="hljs-keyword">new</span> <span class="hljs-built_in">ArrayBuffer</span>(source.byteLength);
              <span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(copied).set(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(source));
              <span class="hljs-keyword">return</span> copied;
            }
            <span class="hljs-keyword">return</span> source.slice(<span class="hljs-number">0</span>);
          <span class="hljs-keyword">case</span> <span class="hljs-string">'[object Boolean]'</span>:
          <span class="hljs-keyword">case</span> <span class="hljs-string">'[object Number]'</span>:
          <span class="hljs-keyword">case</span> <span class="hljs-string">'[object String]'</span>:
          <span class="hljs-keyword">case</span> <span class="hljs-string">'[object Date]'</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> source.constructor(source.valueOf());
          <span class="hljs-keyword">case</span> <span class="hljs-string">'[object RegExp]'</span>:
            <span class="hljs-keyword">var</span> re = <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(source.source, source.toString().match(<span class="hljs-regexp">/[^\/]*$/</span>)[<span class="hljs-number">0</span>]);
            re.lastIndex = source.lastIndex;
            <span class="hljs-keyword">return</span> re;
          <span class="hljs-keyword">case</span> <span class="hljs-string">'[object Blob]'</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> source.constructor([source], {
              <span class="hljs-attr">type</span>: source.type
            });
        }
        <span class="hljs-keyword">if</span> (isFunction(source.cloneNode)) {
          <span class="hljs-keyword">return</span> source.cloneNode(<span class="hljs-literal">true</span>);
        }
      }
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">shallowCopy</span>(<span class="hljs-params">src, dst</span>) </span>{
      <span class="hljs-keyword">if</span> (isArray(src)) {
        dst = dst || [];
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, ii = src.length; i &lt; ii; i++) {
          dst[i] = src[i];
        }
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (isObject(src)) {
        dst = dst || {};
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> key <span class="hljs-keyword">in</span> src) {
          <span class="hljs-keyword">if</span> (!(key.charAt(<span class="hljs-number">0</span>) === <span class="hljs-string">'$'</span> &amp;&amp; key.charAt(<span class="hljs-number">1</span>) === <span class="hljs-string">'$'</span>)) {
            dst[key] = src[key];
          }
        }
      }
      <span class="hljs-keyword">return</span> dst || src;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">equals</span>(<span class="hljs-params">o1, o2</span>) </span>{
      <span class="hljs-keyword">if</span> (o1 === o2) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
      <span class="hljs-keyword">if</span> (o1 === <span class="hljs-literal">null</span> || o2 === <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
      <span class="hljs-keyword">if</span> (o1 !== o1 &amp;&amp; o2 !== o2) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
      <span class="hljs-keyword">var</span> t1 = <span class="hljs-keyword">typeof</span> o1,
        t2 = <span class="hljs-keyword">typeof</span> o2,
        length, key, keySet;
      <span class="hljs-keyword">if</span> (t1 == t2 &amp;&amp; t1 == <span class="hljs-string">'object'</span>) {
        <span class="hljs-keyword">if</span> (isArray(o1)) {
          <span class="hljs-keyword">if</span> (!isArray(o2)) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
          <span class="hljs-keyword">if</span> ((length = o1.length) == o2.length) {
            <span class="hljs-keyword">for</span> (key = <span class="hljs-number">0</span>; key &lt; length; key++) {
              <span class="hljs-keyword">if</span> (!equals(o1[key], o2[key])) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
            }
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
          }
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (isDate(o1)) {
          <span class="hljs-keyword">if</span> (!isDate(o2)) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
          <span class="hljs-keyword">return</span> equals(o1.getTime(), o2.getTime());
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (isRegExp(o1)) {
          <span class="hljs-keyword">if</span> (!isRegExp(o2)) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
          <span class="hljs-keyword">return</span> o1.toString() == o2.toString();
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">if</span> (isScope(o1) || isScope(o2) || isWindow(o1) || isWindow(o2) ||
            isArray(o2) || isDate(o2) || isRegExp(o2)) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
          keySet = createMap();
          <span class="hljs-keyword">for</span> (key <span class="hljs-keyword">in</span> o1) {
            <span class="hljs-keyword">if</span> (key.charAt(<span class="hljs-number">0</span>) === <span class="hljs-string">'$'</span> || isFunction(o1[key])) <span class="hljs-keyword">continue</span>;
            <span class="hljs-keyword">if</span> (!equals(o1[key], o2[key])) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
            keySet[key] = <span class="hljs-literal">true</span>;
          }
          <span class="hljs-keyword">for</span> (key <span class="hljs-keyword">in</span> o2) {
            <span class="hljs-keyword">if</span> (!(key <span class="hljs-keyword">in</span> keySet) &amp;&amp;
              key.charAt(<span class="hljs-number">0</span>) !== <span class="hljs-string">'$'</span> &amp;&amp;
              isDefined(o2[key]) &amp;&amp;
              !isFunction(o2[key])) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
          }
          <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        }
      }
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
    <span class="hljs-keyword">var</span> csp = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">if</span> (!isDefined(csp.rules)) {
        <span class="hljs-keyword">var</span> ngCspElement = (<span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">'[ng-csp]'</span>) ||
          <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">'[data-ng-csp]'</span>));
        <span class="hljs-keyword">if</span> (ngCspElement) {
          <span class="hljs-keyword">var</span> ngCspAttribute = ngCspElement.getAttribute(<span class="hljs-string">'ng-csp'</span>) ||
            ngCspElement.getAttribute(<span class="hljs-string">'data-ng-csp'</span>);
          csp.rules = {
            <span class="hljs-attr">noUnsafeEval</span>: !ngCspAttribute || (ngCspAttribute.indexOf(<span class="hljs-string">'no-unsafe-eval'</span>) !== <span class="hljs-number">-1</span>),
            <span class="hljs-attr">noInlineStyle</span>: !ngCspAttribute || (ngCspAttribute.indexOf(<span class="hljs-string">'no-inline-style'</span>) !== <span class="hljs-number">-1</span>)
          };
        } <span class="hljs-keyword">else</span> {
          csp.rules = {
            <span class="hljs-attr">noUnsafeEval</span>: noUnsafeEval(),
            <span class="hljs-attr">noInlineStyle</span>: <span class="hljs-literal">false</span>
          };
        }
      }
      <span class="hljs-keyword">return</span> csp.rules;

      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">noUnsafeEval</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">try</span> {
          <span class="hljs-keyword">new</span> <span class="hljs-built_in">Function</span>(<span class="hljs-string">''</span>);
          <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        } <span class="hljs-keyword">catch</span> (e) {
          <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        }
      }
    };
    <span class="hljs-keyword">var</span> jq = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">if</span> (isDefined(jq.name_)) <span class="hljs-keyword">return</span> jq.name_;
      <span class="hljs-keyword">var</span> el;
      <span class="hljs-keyword">var</span> i, ii = ngAttrPrefixes.length,
        prefix, name;
      <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; ii; ++i) {
        prefix = ngAttrPrefixes[i];
        <span class="hljs-keyword">if</span> (el = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">'['</span> + prefix.replace(<span class="hljs-string">':'</span>, <span class="hljs-string">'\\:'</span>) + <span class="hljs-string">'jq]'</span>)) {
          name = el.getAttribute(prefix + <span class="hljs-string">'jq'</span>);
          <span class="hljs-keyword">break</span>;
        }
      }
      <span class="hljs-keyword">return</span> (jq.name_ = name);
    };

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">concat</span>(<span class="hljs-params">array1, array2, index</span>) </span>{
      <span class="hljs-keyword">return</span> array1.concat(slice.call(array2, index));
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sliceArgs</span>(<span class="hljs-params">args, startIndex</span>) </span>{
      <span class="hljs-keyword">return</span> slice.call(args, startIndex || <span class="hljs-number">0</span>);
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bind</span>(<span class="hljs-params">self, fn</span>) </span>{
      <span class="hljs-keyword">var</span> curryArgs = <span class="hljs-built_in">arguments</span>.length &gt; <span class="hljs-number">2</span> ? sliceArgs(<span class="hljs-built_in">arguments</span>, <span class="hljs-number">2</span>) : [];
      <span class="hljs-keyword">if</span> (isFunction(fn) &amp;&amp; !(fn <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">RegExp</span>)) {
        <span class="hljs-keyword">return</span> curryArgs.length ?
          <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-built_in">arguments</span>.length ?
              fn.apply(self, concat(curryArgs, <span class="hljs-built_in">arguments</span>, <span class="hljs-number">0</span>)) :
              fn.apply(self, curryArgs);
          } :
          <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-built_in">arguments</span>.length ?
              fn.apply(self, <span class="hljs-built_in">arguments</span>) :
              fn.call(self);
          };
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">return</span> fn;
      }
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toJsonReplacer</span>(<span class="hljs-params">key, value</span>) </span>{
      <span class="hljs-keyword">var</span> val = value;
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> key === <span class="hljs-string">'string'</span> &amp;&amp; key.charAt(<span class="hljs-number">0</span>) === <span class="hljs-string">'$'</span> &amp;&amp; key.charAt(<span class="hljs-number">1</span>) === <span class="hljs-string">'$'</span>) {
        val = <span class="hljs-literal">undefined</span>;
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (isWindow(value)) {
        val = <span class="hljs-string">'$WINDOW'</span>;
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (value &amp;&amp; <span class="hljs-built_in">document</span> === value) {
        val = <span class="hljs-string">'$DOCUMENT'</span>;
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (isScope(value)) {
        val = <span class="hljs-string">'$SCOPE'</span>;
      }
      <span class="hljs-keyword">return</span> val;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toJson</span>(<span class="hljs-params">obj, pretty</span>) </span>{
      <span class="hljs-keyword">if</span> (isUndefined(obj)) <span class="hljs-keyword">return</span> <span class="hljs-literal">undefined</span>;
      <span class="hljs-keyword">if</span> (!isNumber(pretty)) {
        pretty = pretty ? <span class="hljs-number">2</span> : <span class="hljs-literal">null</span>;
      }
      <span class="hljs-keyword">return</span> <span class="hljs-built_in">JSON</span>.stringify(obj, toJsonReplacer, pretty);
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fromJson</span>(<span class="hljs-params">json</span>) </span>{
      <span class="hljs-keyword">return</span> isString(json) ?
        <span class="hljs-built_in">JSON</span>.parse(json) :
        json;
    }
    <span class="hljs-keyword">var</span> ALL_COLONS = <span class="hljs-regexp">/:/g</span>;

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">timezoneToOffset</span>(<span class="hljs-params">timezone, fallback</span>) </span>{
      timezone = timezone.replace(ALL_COLONS, <span class="hljs-string">''</span>);
      <span class="hljs-keyword">var</span> requestedTimezoneOffset = <span class="hljs-built_in">Date</span>.parse(<span class="hljs-string">'Jan 01, 1970 00:00:00 '</span> + timezone) / <span class="hljs-number">60000</span>;
      <span class="hljs-keyword">return</span> <span class="hljs-built_in">isNaN</span>(requestedTimezoneOffset) ? fallback : requestedTimezoneOffset;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addDateMinutes</span>(<span class="hljs-params">date, minutes</span>) </span>{
      date = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(date.getTime());
      date.setMinutes(date.getMinutes() + minutes);
      <span class="hljs-keyword">return</span> date;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">convertTimezoneToLocal</span>(<span class="hljs-params">date, timezone, reverse</span>) </span>{
      reverse = reverse ? <span class="hljs-number">-1</span> : <span class="hljs-number">1</span>;
      <span class="hljs-keyword">var</span> dateTimezoneOffset = date.getTimezoneOffset();
      <span class="hljs-keyword">var</span> timezoneOffset = timezoneToOffset(timezone, dateTimezoneOffset);
      <span class="hljs-keyword">return</span> addDateMinutes(date, reverse * (timezoneOffset - dateTimezoneOffset));
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">startingTag</span>(<span class="hljs-params">element</span>) </span>{
      element = jqLite(element).clone();
      <span class="hljs-keyword">try</span> {
        element.empty();
      } <span class="hljs-keyword">catch</span> (e) {}
      <span class="hljs-keyword">var</span> elemHtml = jqLite(<span class="hljs-string">'&lt;div&gt;'</span>).append(element).html();
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">return</span> element[<span class="hljs-number">0</span>].nodeType === NODE_TYPE_TEXT ? lowercase(elemHtml) :
          elemHtml.
        match(<span class="hljs-regexp">/^(&lt;[^&gt;]+&gt;)/</span>)[<span class="hljs-number">1</span>].
        replace(<span class="hljs-regexp">/^&lt;([\w\-]+)/</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">match, nodeName</span>) </span>{
          <span class="hljs-keyword">return</span> <span class="hljs-string">'&lt;'</span> + lowercase(nodeName);
        });
      } <span class="hljs-keyword">catch</span> (e) {
        <span class="hljs-keyword">return</span> lowercase(elemHtml);
      }
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">tryDecodeURIComponent</span>(<span class="hljs-params">value</span>) </span>{
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">decodeURIComponent</span>(value);
      } <span class="hljs-keyword">catch</span> (e) {}
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">parseKeyValue</span>(<span class="hljs-params">keyValue</span>) </span>{
      <span class="hljs-keyword">var</span> obj = {};
      forEach((keyValue || <span class="hljs-string">""</span>).split(<span class="hljs-string">'&amp;'</span>), <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">keyValue</span>) </span>{
        <span class="hljs-keyword">var</span> splitPoint, key, val;
        <span class="hljs-keyword">if</span> (keyValue) {
          key = keyValue = keyValue.replace(<span class="hljs-regexp">/\+/g</span>, <span class="hljs-string">'%20'</span>);
          splitPoint = keyValue.indexOf(<span class="hljs-string">'='</span>);
          <span class="hljs-keyword">if</span> (splitPoint !== <span class="hljs-number">-1</span>) {
            key = keyValue.substring(<span class="hljs-number">0</span>, splitPoint);
            val = keyValue.substring(splitPoint + <span class="hljs-number">1</span>);
          }
          key = tryDecodeURIComponent(key);
          <span class="hljs-keyword">if</span> (isDefined(key)) {
            val = isDefined(val) ? tryDecodeURIComponent(val) : <span class="hljs-literal">true</span>;
            <span class="hljs-keyword">if</span> (!hasOwnProperty.call(obj, key)) {
              obj[key] = val;
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (isArray(obj[key])) {
              obj[key].push(val);
            } <span class="hljs-keyword">else</span> {
              obj[key] = [obj[key], val];
            }
          }
        }
      });
      <span class="hljs-keyword">return</span> obj;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toKeyValue</span>(<span class="hljs-params">obj</span>) </span>{
      <span class="hljs-keyword">var</span> parts = [];
      forEach(obj, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value, key</span>) </span>{
        <span class="hljs-keyword">if</span> (isArray(value)) {
          forEach(value, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">arrayValue</span>) </span>{
            parts.push(encodeUriQuery(key, <span class="hljs-literal">true</span>) +
              (arrayValue === <span class="hljs-literal">true</span> ? <span class="hljs-string">''</span> : <span class="hljs-string">'='</span> + encodeUriQuery(arrayValue, <span class="hljs-literal">true</span>)));
          });
        } <span class="hljs-keyword">else</span> {
          parts.push(encodeUriQuery(key, <span class="hljs-literal">true</span>) +
            (value === <span class="hljs-literal">true</span> ? <span class="hljs-string">''</span> : <span class="hljs-string">'='</span> + encodeUriQuery(value, <span class="hljs-literal">true</span>)));
        }
      });
      <span class="hljs-keyword">return</span> parts.length ? parts.join(<span class="hljs-string">'&amp;'</span>) : <span class="hljs-string">''</span>;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">encodeUriSegment</span>(<span class="hljs-params">val</span>) </span>{
      <span class="hljs-keyword">return</span> encodeUriQuery(val, <span class="hljs-literal">true</span>).
      replace(<span class="hljs-regexp">/%26/gi</span>, <span class="hljs-string">'&amp;'</span>).
      replace(<span class="hljs-regexp">/%3D/gi</span>, <span class="hljs-string">'='</span>).
      replace(<span class="hljs-regexp">/%2B/gi</span>, <span class="hljs-string">'+'</span>);
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">encodeUriQuery</span>(<span class="hljs-params">val, pctEncodeSpaces</span>) </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-built_in">encodeURIComponent</span>(val).
      replace(<span class="hljs-regexp">/%40/gi</span>, <span class="hljs-string">'@'</span>).
      replace(<span class="hljs-regexp">/%3A/gi</span>, <span class="hljs-string">':'</span>).
      replace(<span class="hljs-regexp">/%24/g</span>, <span class="hljs-string">'$'</span>).
      replace(<span class="hljs-regexp">/%2C/gi</span>, <span class="hljs-string">','</span>).
      replace(<span class="hljs-regexp">/%3B/gi</span>, <span class="hljs-string">';'</span>).
      replace(<span class="hljs-regexp">/%20/g</span>, (pctEncodeSpaces ? <span class="hljs-string">'%20'</span> : <span class="hljs-string">'+'</span>));
    }
    <span class="hljs-keyword">var</span> ngAttrPrefixes = [<span class="hljs-string">'ng-'</span>, <span class="hljs-string">'data-ng-'</span>, <span class="hljs-string">'ng:'</span>, <span class="hljs-string">'x-ng-'</span>];

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getNgAttribute</span>(<span class="hljs-params">element, ngAttr</span>) </span>{
      <span class="hljs-keyword">var</span> attr, i, ii = ngAttrPrefixes.length;
      <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; ii; ++i) {
        attr = ngAttrPrefixes[i] + ngAttr;
        <span class="hljs-keyword">if</span> (isString(attr = element.getAttribute(attr))) {
          <span class="hljs-keyword">return</span> attr;
        }
      }
      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">angularInit</span>(<span class="hljs-params">element, bootstrap</span>) </span>{
      <span class="hljs-keyword">var</span> appElement,
        <span class="hljs-built_in">module</span>,
        config = {};
      forEach(ngAttrPrefixes, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">prefix</span>) </span>{
        <span class="hljs-keyword">var</span> name = prefix + <span class="hljs-string">'app'</span>;
        <span class="hljs-keyword">if</span> (!appElement &amp;&amp; element.hasAttribute &amp;&amp; element.hasAttribute(name)) {
          appElement = element;
          <span class="hljs-built_in">module</span> = element.getAttribute(name);
        }
      });
      forEach(ngAttrPrefixes, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">prefix</span>) </span>{
        <span class="hljs-keyword">var</span> name = prefix + <span class="hljs-string">'app'</span>;
        <span class="hljs-keyword">var</span> candidate;
        <span class="hljs-keyword">if</span> (!appElement &amp;&amp; (candidate = element.querySelector(<span class="hljs-string">'['</span> + name.replace(<span class="hljs-string">':'</span>, <span class="hljs-string">'\\:'</span>) + <span class="hljs-string">']'</span>))) {
          appElement = candidate;
          <span class="hljs-built_in">module</span> = candidate.getAttribute(name);
        }
      });
      <span class="hljs-keyword">if</span> (appElement) {
        config.strictDi = getNgAttribute(appElement, <span class="hljs-string">"strict-di"</span>) !== <span class="hljs-literal">null</span>;
        bootstrap(appElement, <span class="hljs-built_in">module</span> ? [<span class="hljs-built_in">module</span>] : [], config);
      }
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bootstrap</span>(<span class="hljs-params">element, modules, config</span>) </span>{
      <span class="hljs-keyword">if</span> (!isObject(config)) config = {};
      <span class="hljs-keyword">var</span> defaultConfig = {
        <span class="hljs-attr">strictDi</span>: <span class="hljs-literal">false</span>
      };
      config = extend(defaultConfig, config);
      <span class="hljs-keyword">var</span> doBootstrap = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        element = jqLite(element);
        <span class="hljs-keyword">if</span> (element.injector()) {
          <span class="hljs-keyword">var</span> tag = (element[<span class="hljs-number">0</span>] === <span class="hljs-built_in">document</span>) ? <span class="hljs-string">'document'</span> : startingTag(element);
          <span class="hljs-keyword">throw</span> ngMinErr(
            <span class="hljs-string">'btstrpd'</span>,
            <span class="hljs-string">"App Already Bootstrapped with this Element '{0}'"</span>,
            tag.replace(<span class="hljs-regexp">/&lt;/</span>, <span class="hljs-string">'&amp;lt;'</span>).replace(<span class="hljs-regexp">/&gt;/</span>, <span class="hljs-string">'&amp;gt;'</span>));
        }
        modules = modules || [];
        modules.unshift([<span class="hljs-string">'$provide'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$provide</span>) </span>{
          $provide.value(<span class="hljs-string">'$rootElement'</span>, element);
        }]);
        <span class="hljs-keyword">if</span> (config.debugInfoEnabled) {
          modules.push([<span class="hljs-string">'$compileProvider'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$compileProvider</span>) </span>{
            $compileProvider.debugInfoEnabled(<span class="hljs-literal">true</span>);
          }]);
        }
        modules.unshift(<span class="hljs-string">'ng'</span>);
        <span class="hljs-keyword">var</span> injector = createInjector(modules, config.strictDi);
        injector.invoke([<span class="hljs-string">'$rootScope'</span>, <span class="hljs-string">'$rootElement'</span>, <span class="hljs-string">'$compile'</span>, <span class="hljs-string">'$injector'</span>,
          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bootstrapApply</span>(<span class="hljs-params">scope, element, compile, injector</span>) </span>{
            scope.$apply(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
              element.data(<span class="hljs-string">'$injector'</span>, injector);
              compile(element)(scope);
            });
          }
        ]);
        <span class="hljs-keyword">return</span> injector;
      };
      <span class="hljs-keyword">var</span> NG_ENABLE_DEBUG_INFO = <span class="hljs-regexp">/^NG_ENABLE_DEBUG_INFO!/</span>;
      <span class="hljs-keyword">var</span> NG_DEFER_BOOTSTRAP = <span class="hljs-regexp">/^NG_DEFER_BOOTSTRAP!/</span>;
      <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span> &amp;&amp; NG_ENABLE_DEBUG_INFO.test(<span class="hljs-built_in">window</span>.name)) {
        config.debugInfoEnabled = <span class="hljs-literal">true</span>;
        <span class="hljs-built_in">window</span>.name = <span class="hljs-built_in">window</span>.name.replace(NG_ENABLE_DEBUG_INFO, <span class="hljs-string">''</span>);
      }
      <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span> &amp;&amp; !NG_DEFER_BOOTSTRAP.test(<span class="hljs-built_in">window</span>.name)) {
        <span class="hljs-keyword">return</span> doBootstrap();
      }
      <span class="hljs-built_in">window</span>.name = <span class="hljs-built_in">window</span>.name.replace(NG_DEFER_BOOTSTRAP, <span class="hljs-string">''</span>);
      angular.resumeBootstrap = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">extraModules</span>) </span>{
        forEach(extraModules, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">module</span>) </span>{
          modules.push(<span class="hljs-built_in">module</span>);
        });
        <span class="hljs-keyword">return</span> doBootstrap();
      };
      <span class="hljs-keyword">if</span> (isFunction(angular.resumeDeferredBootstrap)) {
        angular.resumeDeferredBootstrap();
      }
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">reloadWithDebugInfo</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-built_in">window</span>.name = <span class="hljs-string">'NG_ENABLE_DEBUG_INFO!'</span> + <span class="hljs-built_in">window</span>.name;
      <span class="hljs-built_in">window</span>.location.reload();
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getTestability</span>(<span class="hljs-params">rootElement</span>) </span>{
      <span class="hljs-keyword">var</span> injector = angular.element(rootElement).injector();
      <span class="hljs-keyword">if</span> (!injector) {
        <span class="hljs-keyword">throw</span> ngMinErr(<span class="hljs-string">'test'</span>,
          <span class="hljs-string">'no injector found for element argument to getTestability'</span>);
      }
      <span class="hljs-keyword">return</span> injector.get(<span class="hljs-string">'$$testability'</span>);
    }
    <span class="hljs-keyword">var</span> SNAKE_CASE_REGEXP = <span class="hljs-regexp">/[A-Z]/g</span>;

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">snake_case</span>(<span class="hljs-params">name, separator</span>) </span>{
      separator = separator || <span class="hljs-string">'_'</span>;
      <span class="hljs-keyword">return</span> name.replace(SNAKE_CASE_REGEXP, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">letter, pos</span>) </span>{
        <span class="hljs-keyword">return</span> (pos ? separator : <span class="hljs-string">''</span>) + letter.toLowerCase();
      });
    }
    <span class="hljs-keyword">var</span> bindJQueryFired = <span class="hljs-literal">false</span>;

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bindJQuery</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> originalCleanData;
      <span class="hljs-keyword">if</span> (bindJQueryFired) {
        <span class="hljs-keyword">return</span>;
      }
      <span class="hljs-keyword">var</span> jqName = jq();
      jQuery = isUndefined(jqName) ? <span class="hljs-built_in">window</span>.jQuery :
        !jqName ? <span class="hljs-literal">undefined</span> :
        <span class="hljs-built_in">window</span>[jqName];
      <span class="hljs-keyword">if</span> (jQuery &amp;&amp; jQuery.fn.on) {
        jqLite = jQuery;
        extend(jQuery.fn, {
          <span class="hljs-attr">scope</span>: JQLitePrototype.scope,
          <span class="hljs-attr">isolateScope</span>: JQLitePrototype.isolateScope,
          <span class="hljs-attr">controller</span>: JQLitePrototype.controller,
          <span class="hljs-attr">injector</span>: JQLitePrototype.injector,
          <span class="hljs-attr">inheritedData</span>: JQLitePrototype.inheritedData
        });
        originalCleanData = jQuery.cleanData;
        jQuery.cleanData = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">elems</span>) </span>{
          <span class="hljs-keyword">var</span> events;
          <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, elem;
            (elem = elems[i]) != <span class="hljs-literal">null</span>; i++) {
            events = jQuery._data(elem, <span class="hljs-string">"events"</span>);
            <span class="hljs-keyword">if</span> (events &amp;&amp; events.$destroy) {
              jQuery(elem).triggerHandler(<span class="hljs-string">'$destroy'</span>);
            }
          }
          originalCleanData(elems);
        };
      } <span class="hljs-keyword">else</span> {
        jqLite = JQLite;
      }
      angular.element = jqLite;
      bindJQueryFired = <span class="hljs-literal">true</span>;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">assertArg</span>(<span class="hljs-params">arg, name, reason</span>) </span>{
      <span class="hljs-keyword">if</span> (!arg) {
        <span class="hljs-keyword">throw</span> ngMinErr(<span class="hljs-string">'areq'</span>, <span class="hljs-string">"Argument '{0}' is {1}"</span>, (name || <span class="hljs-string">'?'</span>), (reason || <span class="hljs-string">"required"</span>));
      }
      <span class="hljs-keyword">return</span> arg;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">assertArgFn</span>(<span class="hljs-params">arg, name, acceptArrayAnnotation</span>) </span>{
      <span class="hljs-keyword">if</span> (acceptArrayAnnotation &amp;&amp; isArray(arg)) {
        arg = arg[arg.length - <span class="hljs-number">1</span>];
      }
      assertArg(isFunction(arg), name, <span class="hljs-string">'not a function, got '</span> +
        (arg &amp;&amp; <span class="hljs-keyword">typeof</span> arg === <span class="hljs-string">'object'</span> ? arg.constructor.name || <span class="hljs-string">'Object'</span> : <span class="hljs-keyword">typeof</span> arg));
      <span class="hljs-keyword">return</span> arg;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">assertNotHasOwnProperty</span>(<span class="hljs-params">name, context</span>) </span>{
      <span class="hljs-keyword">if</span> (name === <span class="hljs-string">'hasOwnProperty'</span>) {
        <span class="hljs-keyword">throw</span> ngMinErr(<span class="hljs-string">'badname'</span>, <span class="hljs-string">"hasOwnProperty is not a valid {0} name"</span>, context);
      }
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getter</span>(<span class="hljs-params">obj, path, bindFnToScope</span>) </span>{
      <span class="hljs-keyword">if</span> (!path) <span class="hljs-keyword">return</span> obj;
      <span class="hljs-keyword">var</span> keys = path.split(<span class="hljs-string">'.'</span>);
      <span class="hljs-keyword">var</span> key;
      <span class="hljs-keyword">var</span> lastInstance = obj;
      <span class="hljs-keyword">var</span> len = keys.length;
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) {
        key = keys[i];
        <span class="hljs-keyword">if</span> (obj) {
          obj = (lastInstance = obj)[key];
        }
      }
      <span class="hljs-keyword">if</span> (!bindFnToScope &amp;&amp; isFunction(obj)) {
        <span class="hljs-keyword">return</span> bind(lastInstance, obj);
      }
      <span class="hljs-keyword">return</span> obj;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getBlockNodes</span>(<span class="hljs-params">nodes</span>) </span>{
      <span class="hljs-keyword">var</span> node = nodes[<span class="hljs-number">0</span>];
      <span class="hljs-keyword">var</span> endNode = nodes[nodes.length - <span class="hljs-number">1</span>];
      <span class="hljs-keyword">var</span> blockNodes;
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">1</span>; node !== endNode &amp;&amp; (node = node.nextSibling); i++) {
        <span class="hljs-keyword">if</span> (blockNodes || nodes[i] !== node) {
          <span class="hljs-keyword">if</span> (!blockNodes) {
            blockNodes = jqLite(slice.call(nodes, <span class="hljs-number">0</span>, i));
          }
          blockNodes.push(node);
        }
      }
      <span class="hljs-keyword">return</span> blockNodes || nodes;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createMap</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-built_in">Object</span>.create(<span class="hljs-literal">null</span>);
    }
    <span class="hljs-keyword">var</span> NODE_TYPE_ELEMENT = <span class="hljs-number">1</span>;
    <span class="hljs-keyword">var</span> NODE_TYPE_ATTRIBUTE = <span class="hljs-number">2</span>;
    <span class="hljs-keyword">var</span> NODE_TYPE_TEXT = <span class="hljs-number">3</span>;
    <span class="hljs-keyword">var</span> NODE_TYPE_COMMENT = <span class="hljs-number">8</span>;
    <span class="hljs-keyword">var</span> NODE_TYPE_DOCUMENT = <span class="hljs-number">9</span>;
    <span class="hljs-keyword">var</span> NODE_TYPE_DOCUMENT_FRAGMENT = <span class="hljs-number">11</span>;

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setupModuleLoader</span>(<span class="hljs-params">window</span>) </span>{
      <span class="hljs-keyword">var</span> $injectorMinErr = minErr(<span class="hljs-string">'$injector'</span>);
      <span class="hljs-keyword">var</span> ngMinErr = minErr(<span class="hljs-string">'ng'</span>);

      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ensure</span>(<span class="hljs-params">obj, name, factory</span>) </span>{
        <span class="hljs-keyword">return</span> obj[name] || (obj[name] = factory());
      }
      <span class="hljs-keyword">var</span> angular = ensure(<span class="hljs-built_in">window</span>, <span class="hljs-string">'angular'</span>, <span class="hljs-built_in">Object</span>);
      angular.$$minErr = angular.$$minErr || minErr;
      <span class="hljs-keyword">return</span> ensure(angular, <span class="hljs-string">'module'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> modules = {};
        <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">module</span>(<span class="hljs-params">name, requires, configFn</span>) </span>{
          <span class="hljs-keyword">var</span> assertNotHasOwnProperty = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name, context</span>) </span>{
            <span class="hljs-keyword">if</span> (name === <span class="hljs-string">'hasOwnProperty'</span>) {
              <span class="hljs-keyword">throw</span> ngMinErr(<span class="hljs-string">'badname'</span>, <span class="hljs-string">'hasOwnProperty is not a valid {0} name'</span>, context);
            }
          };
          assertNotHasOwnProperty(name, <span class="hljs-string">'module'</span>);
          <span class="hljs-keyword">if</span> (requires &amp;&amp; modules.hasOwnProperty(name)) {
            modules[name] = <span class="hljs-literal">null</span>;
          }
          <span class="hljs-keyword">return</span> ensure(modules, name, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">if</span> (!requires) {
              <span class="hljs-keyword">throw</span> $injectorMinErr(<span class="hljs-string">'nomod'</span>, <span class="hljs-string">"Module '{0}' is not available! You either misspelled "</span> +
                <span class="hljs-string">"the module name or forgot to load it. If registering a module ensure that you "</span> +
                <span class="hljs-string">"specify the dependencies as the second argument."</span>, name);
            }
            <span class="hljs-keyword">var</span> invokeQueue = [];
            <span class="hljs-keyword">var</span> configBlocks = [];
            <span class="hljs-keyword">var</span> runBlocks = [];
            <span class="hljs-keyword">var</span> config = invokeLater(<span class="hljs-string">'$injector'</span>, <span class="hljs-string">'invoke'</span>, <span class="hljs-string">'push'</span>, configBlocks);
            <span class="hljs-keyword">var</span> moduleInstance = {
              <span class="hljs-attr">_invokeQueue</span>: invokeQueue,
              <span class="hljs-attr">_configBlocks</span>: configBlocks,
              <span class="hljs-attr">_runBlocks</span>: runBlocks,
              <span class="hljs-attr">requires</span>: requires,
              <span class="hljs-attr">name</span>: name,
              <span class="hljs-attr">provider</span>: invokeLaterAndSetModuleName(<span class="hljs-string">'$provide'</span>, <span class="hljs-string">'provider'</span>),
              <span class="hljs-attr">factory</span>: invokeLaterAndSetModuleName(<span class="hljs-string">'$provide'</span>, <span class="hljs-string">'factory'</span>),
              <span class="hljs-attr">service</span>: invokeLaterAndSetModuleName(<span class="hljs-string">'$provide'</span>, <span class="hljs-string">'service'</span>),
              <span class="hljs-attr">value</span>: invokeLater(<span class="hljs-string">'$provide'</span>, <span class="hljs-string">'value'</span>),
              <span class="hljs-attr">constant</span>: invokeLater(<span class="hljs-string">'$provide'</span>, <span class="hljs-string">'constant'</span>, <span class="hljs-string">'unshift'</span>),
              <span class="hljs-attr">decorator</span>: invokeLaterAndSetModuleName(<span class="hljs-string">'$provide'</span>, <span class="hljs-string">'decorator'</span>),
              <span class="hljs-attr">animation</span>: invokeLaterAndSetModuleName(<span class="hljs-string">'$animateProvider'</span>, <span class="hljs-string">'register'</span>),
              <span class="hljs-attr">filter</span>: invokeLaterAndSetModuleName(<span class="hljs-string">'$filterProvider'</span>, <span class="hljs-string">'register'</span>),
              <span class="hljs-attr">controller</span>: invokeLaterAndSetModuleName(<span class="hljs-string">'$controllerProvider'</span>, <span class="hljs-string">'register'</span>),
              <span class="hljs-attr">directive</span>: invokeLaterAndSetModuleName(<span class="hljs-string">'$compileProvider'</span>, <span class="hljs-string">'directive'</span>),
              <span class="hljs-attr">component</span>: invokeLaterAndSetModuleName(<span class="hljs-string">'$compileProvider'</span>, <span class="hljs-string">'component'</span>),
              <span class="hljs-attr">config</span>: config,
              <span class="hljs-attr">run</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">block</span>) </span>{
                runBlocks.push(block);
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
              }
            };
            <span class="hljs-keyword">if</span> (configFn) {
              config(configFn);
            }
            <span class="hljs-keyword">return</span> moduleInstance;

            <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">invokeLater</span>(<span class="hljs-params">provider, method, insertMethod, queue</span>) </span>{
              <span class="hljs-keyword">if</span> (!queue) queue = invokeQueue;
              <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                queue[insertMethod || <span class="hljs-string">'push'</span>]([provider, method, <span class="hljs-built_in">arguments</span>]);
                <span class="hljs-keyword">return</span> moduleInstance;
              };
            }

            <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">invokeLaterAndSetModuleName</span>(<span class="hljs-params">provider, method</span>) </span>{
              <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">recipeName, factoryFunction</span>) </span>{
                <span class="hljs-keyword">if</span> (factoryFunction &amp;&amp; isFunction(factoryFunction)) factoryFunction.$$moduleName = name;
                invokeQueue.push([provider, method, <span class="hljs-built_in">arguments</span>]);
                <span class="hljs-keyword">return</span> moduleInstance;
              };
            }
          });
        };
      });
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">serializeObject</span>(<span class="hljs-params">obj</span>) </span>{
      <span class="hljs-keyword">var</span> seen = [];
      <span class="hljs-keyword">return</span> <span class="hljs-built_in">JSON</span>.stringify(obj, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">key, val</span>) </span>{
        val = toJsonReplacer(key, val);
        <span class="hljs-keyword">if</span> (isObject(val)) {
          <span class="hljs-keyword">if</span> (seen.indexOf(val) &gt;= <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">'...'</span>;
          seen.push(val);
        }
        <span class="hljs-keyword">return</span> val;
      });
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toDebugString</span>(<span class="hljs-params">obj</span>) </span>{
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> obj === <span class="hljs-string">'function'</span>) {
        <span class="hljs-keyword">return</span> obj.toString().replace(<span class="hljs-regexp">/ \{[\s\S]*$/</span>, <span class="hljs-string">''</span>);
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (isUndefined(obj)) {
        <span class="hljs-keyword">return</span> <span class="hljs-string">'undefined'</span>;
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> obj !== <span class="hljs-string">'string'</span>) {
        <span class="hljs-keyword">return</span> serializeObject(obj);
      }
      <span class="hljs-keyword">return</span> obj;
    }
    <span class="hljs-keyword">var</span> version = {
      <span class="hljs-attr">full</span>: <span class="hljs-string">'1.5.3'</span>,
      <span class="hljs-attr">major</span>: <span class="hljs-number">1</span>,
      <span class="hljs-attr">minor</span>: <span class="hljs-number">5</span>,
      <span class="hljs-attr">dot</span>: <span class="hljs-number">3</span>,
      <span class="hljs-attr">codeName</span>: <span class="hljs-string">'diplohaplontic-meiosis'</span>
    };

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">publishExternalAPI</span>(<span class="hljs-params">angular</span>) </span>{
      extend(angular, {
        <span class="hljs-string">'bootstrap'</span>: bootstrap,
        <span class="hljs-string">'copy'</span>: copy,
        <span class="hljs-string">'extend'</span>: extend,
        <span class="hljs-string">'merge'</span>: merge,
        <span class="hljs-string">'equals'</span>: equals,
        <span class="hljs-string">'element'</span>: jqLite,
        <span class="hljs-string">'forEach'</span>: forEach,
        <span class="hljs-string">'injector'</span>: createInjector,
        <span class="hljs-string">'noop'</span>: noop,
        <span class="hljs-string">'bind'</span>: bind,
        <span class="hljs-string">'toJson'</span>: toJson,
        <span class="hljs-string">'fromJson'</span>: fromJson,
        <span class="hljs-string">'identity'</span>: identity,
        <span class="hljs-string">'isUndefined'</span>: isUndefined,
        <span class="hljs-string">'isDefined'</span>: isDefined,
        <span class="hljs-string">'isString'</span>: isString,
        <span class="hljs-string">'isFunction'</span>: isFunction,
        <span class="hljs-string">'isObject'</span>: isObject,
        <span class="hljs-string">'isNumber'</span>: isNumber,
        <span class="hljs-string">'isElement'</span>: isElement,
        <span class="hljs-string">'isArray'</span>: isArray,
        <span class="hljs-string">'version'</span>: version,
        <span class="hljs-string">'isDate'</span>: isDate,
        <span class="hljs-string">'lowercase'</span>: lowercase,
        <span class="hljs-string">'uppercase'</span>: uppercase,
        <span class="hljs-string">'callbacks'</span>: {
          <span class="hljs-attr">counter</span>: <span class="hljs-number">0</span>
        },
        <span class="hljs-string">'getTestability'</span>: getTestability,
        <span class="hljs-string">'$$minErr'</span>: minErr,
        <span class="hljs-string">'$$csp'</span>: csp,
        <span class="hljs-string">'reloadWithDebugInfo'</span>: reloadWithDebugInfo
      });
      angularModule = setupModuleLoader(<span class="hljs-built_in">window</span>);
      angularModule(<span class="hljs-string">'ng'</span>, [<span class="hljs-string">'ngLocale'</span>], [<span class="hljs-string">'$provide'</span>,
        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ngModule</span>(<span class="hljs-params">$provide</span>) </span>{
          $provide.provider({
            <span class="hljs-attr">$$sanitizeUri</span>: $$SanitizeUriProvider
          });
          $provide.provider(<span class="hljs-string">'$compile'</span>, $CompileProvider).
          directive({
            <span class="hljs-attr">a</span>: htmlAnchorDirective,
            <span class="hljs-attr">input</span>: inputDirective,
            <span class="hljs-attr">textarea</span>: inputDirective,
            <span class="hljs-attr">form</span>: formDirective,
            <span class="hljs-attr">script</span>: scriptDirective,
            <span class="hljs-attr">select</span>: selectDirective,
            <span class="hljs-attr">style</span>: styleDirective,
            <span class="hljs-attr">option</span>: optionDirective,
            <span class="hljs-attr">ngBind</span>: ngBindDirective,
            <span class="hljs-attr">ngBindHtml</span>: ngBindHtmlDirective,
            <span class="hljs-attr">ngBindTemplate</span>: ngBindTemplateDirective,
            <span class="hljs-attr">ngClass</span>: ngClassDirective,
            <span class="hljs-attr">ngClassEven</span>: ngClassEvenDirective,
            <span class="hljs-attr">ngClassOdd</span>: ngClassOddDirective,
            <span class="hljs-attr">ngCloak</span>: ngCloakDirective,
            <span class="hljs-attr">ngController</span>: ngControllerDirective,
            <span class="hljs-attr">ngForm</span>: ngFormDirective,
            <span class="hljs-attr">ngHide</span>: ngHideDirective,
            <span class="hljs-attr">ngIf</span>: ngIfDirective,
            <span class="hljs-attr">ngInclude</span>: ngIncludeDirective,
            <span class="hljs-attr">ngInit</span>: ngInitDirective,
            <span class="hljs-attr">ngNonBindable</span>: ngNonBindableDirective,
            <span class="hljs-attr">ngPluralize</span>: ngPluralizeDirective,
            <span class="hljs-attr">ngRepeat</span>: ngRepeatDirective,
            <span class="hljs-attr">ngShow</span>: ngShowDirective,
            <span class="hljs-attr">ngStyle</span>: ngStyleDirective,
            <span class="hljs-attr">ngSwitch</span>: ngSwitchDirective,
            <span class="hljs-attr">ngSwitchWhen</span>: ngSwitchWhenDirective,
            <span class="hljs-attr">ngSwitchDefault</span>: ngSwitchDefaultDirective,
            <span class="hljs-attr">ngOptions</span>: ngOptionsDirective,
            <span class="hljs-attr">ngTransclude</span>: ngTranscludeDirective,
            <span class="hljs-attr">ngModel</span>: ngModelDirective,
            <span class="hljs-attr">ngList</span>: ngListDirective,
            <span class="hljs-attr">ngChange</span>: ngChangeDirective,
            <span class="hljs-attr">pattern</span>: patternDirective,
            <span class="hljs-attr">ngPattern</span>: patternDirective,
            <span class="hljs-attr">required</span>: requiredDirective,
            <span class="hljs-attr">ngRequired</span>: requiredDirective,
            <span class="hljs-attr">minlength</span>: minlengthDirective,
            <span class="hljs-attr">ngMinlength</span>: minlengthDirective,
            <span class="hljs-attr">maxlength</span>: maxlengthDirective,
            <span class="hljs-attr">ngMaxlength</span>: maxlengthDirective,
            <span class="hljs-attr">ngValue</span>: ngValueDirective,
            <span class="hljs-attr">ngModelOptions</span>: ngModelOptionsDirective
          }).
          directive({
            <span class="hljs-attr">ngInclude</span>: ngIncludeFillContentDirective
          }).
          directive(ngAttributeAliasDirectives).
          directive(ngEventDirectives);
          $provide.provider({
            <span class="hljs-attr">$anchorScroll</span>: $AnchorScrollProvider,
            <span class="hljs-attr">$animate</span>: $AnimateProvider,
            <span class="hljs-attr">$animateCss</span>: $CoreAnimateCssProvider,
            <span class="hljs-attr">$$animateJs</span>: $$CoreAnimateJsProvider,
            <span class="hljs-attr">$$animateQueue</span>: $$CoreAnimateQueueProvider,
            <span class="hljs-attr">$$AnimateRunner</span>: $$AnimateRunnerFactoryProvider,
            <span class="hljs-attr">$$animateAsyncRun</span>: $$AnimateAsyncRunFactoryProvider,
            <span class="hljs-attr">$browser</span>: $BrowserProvider,
            <span class="hljs-attr">$cacheFactory</span>: $CacheFactoryProvider,
            <span class="hljs-attr">$controller</span>: $ControllerProvider,
            <span class="hljs-attr">$document</span>: $DocumentProvider,
            <span class="hljs-attr">$exceptionHandler</span>: $ExceptionHandlerProvider,
            <span class="hljs-attr">$filter</span>: $FilterProvider,
            <span class="hljs-attr">$$forceReflow</span>: $$ForceReflowProvider,
            <span class="hljs-attr">$interpolate</span>: $InterpolateProvider,
            <span class="hljs-attr">$interval</span>: $IntervalProvider,
            <span class="hljs-attr">$http</span>: $HttpProvider,
            <span class="hljs-attr">$httpParamSerializer</span>: $HttpParamSerializerProvider,
            <span class="hljs-attr">$httpParamSerializerJQLike</span>: $HttpParamSerializerJQLikeProvider,
            <span class="hljs-attr">$httpBackend</span>: $HttpBackendProvider,
            <span class="hljs-attr">$xhrFactory</span>: $xhrFactoryProvider,
            <span class="hljs-attr">$location</span>: $LocationProvider,
            <span class="hljs-attr">$log</span>: $LogProvider,
            <span class="hljs-attr">$parse</span>: $ParseProvider,
            <span class="hljs-attr">$rootScope</span>: $RootScopeProvider,
            <span class="hljs-attr">$q</span>: $QProvider,
            <span class="hljs-attr">$$q</span>: $$QProvider,
            <span class="hljs-attr">$sce</span>: $SceProvider,
            <span class="hljs-attr">$sceDelegate</span>: $SceDelegateProvider,
            <span class="hljs-attr">$sniffer</span>: $SnifferProvider,
            <span class="hljs-attr">$templateCache</span>: $TemplateCacheProvider,
            <span class="hljs-attr">$templateRequest</span>: $TemplateRequestProvider,
            <span class="hljs-attr">$$testability</span>: $$TestabilityProvider,
            <span class="hljs-attr">$timeout</span>: $TimeoutProvider,
            <span class="hljs-attr">$window</span>: $WindowProvider,
            <span class="hljs-attr">$$rAF</span>: $$RAFProvider,
            <span class="hljs-attr">$$jqLite</span>: $$jqLiteProvider,
            <span class="hljs-attr">$$HashMap</span>: $$HashMapProvider,
            <span class="hljs-attr">$$cookieReader</span>: $$CookieReaderProvider
          });
        }
      ]);
    }
    JQLite.expando = <span class="hljs-string">'ng339'</span>;
    <span class="hljs-keyword">var</span> jqCache = JQLite.cache = {},
      jqId = <span class="hljs-number">1</span>,
      addEventListenerFn = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">element, type, fn</span>) </span>{
        element.addEventListener(type, fn, <span class="hljs-literal">false</span>);
      },
      removeEventListenerFn = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">element, type, fn</span>) </span>{
        element.removeEventListener(type, fn, <span class="hljs-literal">false</span>);
      };
    JQLite._data = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">node</span>) </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.cache[node[<span class="hljs-keyword">this</span>.expando]] || {};
    };

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">jqNextId</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">return</span> ++jqId;
    }
    <span class="hljs-keyword">var</span> SPECIAL_CHARS_REGEXP = <span class="hljs-regexp">/([\:\-\_]+(.))/g</span>;
    <span class="hljs-keyword">var</span> MOZ_HACK_REGEXP = <span class="hljs-regexp">/^moz([A-Z])/</span>;
    <span class="hljs-keyword">var</span> MOUSE_EVENT_MAP = {
      <span class="hljs-attr">mouseleave</span>: <span class="hljs-string">"mouseout"</span>,
      <span class="hljs-attr">mouseenter</span>: <span class="hljs-string">"mouseover"</span>
    };
    <span class="hljs-keyword">var</span> jqLiteMinErr = minErr(<span class="hljs-string">'jqLite'</span>);

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">camelCase</span>(<span class="hljs-params">name</span>) </span>{
      <span class="hljs-keyword">return</span> name.
      replace(SPECIAL_CHARS_REGEXP, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">_, separator, letter, offset</span>) </span>{
        <span class="hljs-keyword">return</span> offset ? letter.toUpperCase() : letter;
      }).
      replace(MOZ_HACK_REGEXP, <span class="hljs-string">'Moz$1'</span>);
    }
    <span class="hljs-keyword">var</span> SINGLE_TAG_REGEXP = <span class="hljs-regexp">/^&lt;([\w-]+)\s*\/?&gt;(?:&lt;\/\1&gt;|)$/</span>;
    <span class="hljs-keyword">var</span> HTML_REGEXP = <span class="hljs-regexp">/&lt;|&amp;#?\w+;/</span>;
    <span class="hljs-keyword">var</span> TAG_NAME_REGEXP = <span class="hljs-regexp">/&lt;([\w:-]+)/</span>;
    <span class="hljs-keyword">var</span> XHTML_TAG_REGEXP = <span class="hljs-regexp">/&lt;(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^&gt;]*)\/&gt;/gi</span>;
    <span class="hljs-keyword">var</span> wrapMap = {
      <span class="hljs-string">'option'</span>: [<span class="hljs-number">1</span>, <span class="hljs-string">'&lt;select multiple="multiple"&gt;'</span>, <span class="hljs-string">'&lt;/select&gt;'</span>],
      <span class="hljs-string">'thead'</span>: [<span class="hljs-number">1</span>, <span class="hljs-string">'&lt;table&gt;'</span>, <span class="hljs-string">'&lt;/table&gt;'</span>],
      <span class="hljs-string">'col'</span>: [<span class="hljs-number">2</span>, <span class="hljs-string">'&lt;table&gt;&lt;colgroup&gt;'</span>, <span class="hljs-string">'&lt;/colgroup&gt;&lt;/table&gt;'</span>],
      <span class="hljs-string">'tr'</span>: [<span class="hljs-number">2</span>, <span class="hljs-string">'&lt;table&gt;&lt;tbody&gt;'</span>, <span class="hljs-string">'&lt;/tbody&gt;&lt;/table&gt;'</span>],
      <span class="hljs-string">'td'</span>: [<span class="hljs-number">3</span>, <span class="hljs-string">'&lt;table&gt;&lt;tbody&gt;&lt;tr&gt;'</span>, <span class="hljs-string">'&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;'</span>],
      <span class="hljs-string">'_default'</span>: [<span class="hljs-number">0</span>, <span class="hljs-string">""</span>, <span class="hljs-string">""</span>]
    };
    wrapMap.optgroup = wrapMap.option;
    wrapMap.tbody = wrapMap.tfoot = wrapMap.colgroup = wrapMap.caption = wrapMap.thead;
    wrapMap.th = wrapMap.td;

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">jqLiteIsTextNode</span>(<span class="hljs-params">html</span>) </span>{
      <span class="hljs-keyword">return</span> !HTML_REGEXP.test(html);
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">jqLiteAcceptsData</span>(<span class="hljs-params">node</span>) </span>{
      <span class="hljs-keyword">var</span> nodeType = node.nodeType;
      <span class="hljs-keyword">return</span> nodeType === NODE_TYPE_ELEMENT || !nodeType || nodeType === NODE_TYPE_DOCUMENT;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">jqLiteHasData</span>(<span class="hljs-params">node</span>) </span>{
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> key <span class="hljs-keyword">in</span> jqCache[node.ng339]) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
      }
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">jqLiteCleanData</span>(<span class="hljs-params">nodes</span>) </span>{
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, ii = nodes.length; i &lt; ii; i++) {
        jqLiteRemoveData(nodes[i]);
      }
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">jqLiteBuildFragment</span>(<span class="hljs-params">html, context</span>) </span>{
      <span class="hljs-keyword">var</span> tmp, tag, wrap,
        fragment = context.createDocumentFragment(),
        nodes = [],
        i;
      <span class="hljs-keyword">if</span> (jqLiteIsTextNode(html)) {
        nodes.push(context.createTextNode(html));
      } <span class="hljs-keyword">else</span> {
        tmp = tmp || fragment.appendChild(context.createElement(<span class="hljs-string">"div"</span>));
        tag = (TAG_NAME_REGEXP.exec(html) || [<span class="hljs-string">""</span>, <span class="hljs-string">""</span>])[<span class="hljs-number">1</span>].toLowerCase();
        wrap = wrapMap[tag] || wrapMap._default;
        tmp.innerHTML = wrap[<span class="hljs-number">1</span>] + html.replace(XHTML_TAG_REGEXP, <span class="hljs-string">"&lt;$1&gt;&lt;/$2&gt;"</span>) + wrap[<span class="hljs-number">2</span>];
        i = wrap[<span class="hljs-number">0</span>];
        <span class="hljs-keyword">while</span> (i--) {
          tmp = tmp.lastChild;
        }
        nodes = concat(nodes, tmp.childNodes);
        tmp = fragment.firstChild;
        tmp.textContent = <span class="hljs-string">""</span>;
      }
      fragment.textContent = <span class="hljs-string">""</span>;
      fragment.innerHTML = <span class="hljs-string">""</span>;
      forEach(nodes, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">node</span>) </span>{
        fragment.appendChild(node);
      });
      <span class="hljs-keyword">return</span> fragment;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">jqLiteParseHTML</span>(<span class="hljs-params">html, context</span>) </span>{
      context = context || <span class="hljs-built_in">document</span>;
      <span class="hljs-keyword">var</span> parsed;
      <span class="hljs-keyword">if</span> ((parsed = SINGLE_TAG_REGEXP.exec(html))) {
        <span class="hljs-keyword">return</span> [context.createElement(parsed[<span class="hljs-number">1</span>])];
      }
      <span class="hljs-keyword">if</span> ((parsed = jqLiteBuildFragment(html, context))) {
        <span class="hljs-keyword">return</span> parsed.childNodes;
      }
      <span class="hljs-keyword">return</span> [];
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">jqLiteWrapNode</span>(<span class="hljs-params">node, wrapper</span>) </span>{
      <span class="hljs-keyword">var</span> parent = node.parentNode;
      <span class="hljs-keyword">if</span> (parent) {
        parent.replaceChild(wrapper, node);
      }
      wrapper.appendChild(node);
    }
    <span class="hljs-keyword">var</span> jqLiteContains = Node.prototype.contains || <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">arg</span>) </span>{
      <span class="hljs-keyword">return</span> !!(<span class="hljs-keyword">this</span>.compareDocumentPosition(arg) &amp; <span class="hljs-number">16</span>);
    };

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">JQLite</span>(<span class="hljs-params">element</span>) </span>{
      <span class="hljs-keyword">if</span> (element <span class="hljs-keyword">instanceof</span> JQLite) {
        <span class="hljs-keyword">return</span> element;
      }
      <span class="hljs-keyword">var</span> argIsString;
      <span class="hljs-keyword">if</span> (isString(element)) {
        element = trim(element);
        argIsString = <span class="hljs-literal">true</span>;
      }
      <span class="hljs-keyword">if</span> (!(<span class="hljs-keyword">this</span> <span class="hljs-keyword">instanceof</span> JQLite)) {
        <span class="hljs-keyword">if</span> (argIsString &amp;&amp; element.charAt(<span class="hljs-number">0</span>) != <span class="hljs-string">'&lt;'</span>) {
          <span class="hljs-keyword">throw</span> jqLiteMinErr(<span class="hljs-string">'nosel'</span>, <span class="hljs-string">'Looking up elements via selectors is not supported by jqLite! See: http://docs.angularjs.org/api/angular.element'</span>);
        }
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> JQLite(element);
      }
      <span class="hljs-keyword">if</span> (argIsString) {
        jqLiteAddNodes(<span class="hljs-keyword">this</span>, jqLiteParseHTML(element));
      } <span class="hljs-keyword">else</span> {
        jqLiteAddNodes(<span class="hljs-keyword">this</span>, element);
      }
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">jqLiteClone</span>(<span class="hljs-params">element</span>) </span>{
      <span class="hljs-keyword">return</span> element.cloneNode(<span class="hljs-literal">true</span>);
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">jqLiteDealoc</span>(<span class="hljs-params">element, onlyDescendants</span>) </span>{
      <span class="hljs-keyword">if</span> (!onlyDescendants) jqLiteRemoveData(element);
      <span class="hljs-keyword">if</span> (element.querySelectorAll) {
        <span class="hljs-keyword">var</span> descendants = element.querySelectorAll(<span class="hljs-string">'*'</span>);
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, l = descendants.length; i &lt; l; i++) {
          jqLiteRemoveData(descendants[i]);
        }
      }
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">jqLiteOff</span>(<span class="hljs-params">element, type, fn, unsupported</span>) </span>{
      <span class="hljs-keyword">if</span> (isDefined(unsupported)) <span class="hljs-keyword">throw</span> jqLiteMinErr(<span class="hljs-string">'offargs'</span>, <span class="hljs-string">'jqLite#off() does not support the `selector` argument'</span>);
      <span class="hljs-keyword">var</span> expandoStore = jqLiteExpandoStore(element);
      <span class="hljs-keyword">var</span> events = expandoStore &amp;&amp; expandoStore.events;
      <span class="hljs-keyword">var</span> handle = expandoStore &amp;&amp; expandoStore.handle;
      <span class="hljs-keyword">if</span> (!handle) <span class="hljs-keyword">return</span>;
      <span class="hljs-keyword">if</span> (!type) {
        <span class="hljs-keyword">for</span> (type <span class="hljs-keyword">in</span> events) {
          <span class="hljs-keyword">if</span> (type !== <span class="hljs-string">'$destroy'</span>) {
            removeEventListenerFn(element, type, handle);
          }
          <span class="hljs-keyword">delete</span> events[type];
        }
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">var</span> removeHandler = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">type</span>) </span>{
          <span class="hljs-keyword">var</span> listenerFns = events[type];
          <span class="hljs-keyword">if</span> (isDefined(fn)) {
            arrayRemove(listenerFns || [], fn);
          }
          <span class="hljs-keyword">if</span> (!(isDefined(fn) &amp;&amp; listenerFns &amp;&amp; listenerFns.length &gt; <span class="hljs-number">0</span>)) {
            removeEventListenerFn(element, type, handle);
            <span class="hljs-keyword">delete</span> events[type];
          }
        };
        forEach(type.split(<span class="hljs-string">' '</span>), <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">type</span>) </span>{
          removeHandler(type);
          <span class="hljs-keyword">if</span> (MOUSE_EVENT_MAP[type]) {
            removeHandler(MOUSE_EVENT_MAP[type]);
          }
        });
      }
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">jqLiteRemoveData</span>(<span class="hljs-params">element, name</span>) </span>{
      <span class="hljs-keyword">var</span> expandoId = element.ng339;
      <span class="hljs-keyword">var</span> expandoStore = expandoId &amp;&amp; jqCache[expandoId];
      <span class="hljs-keyword">if</span> (expandoStore) {
        <span class="hljs-keyword">if</span> (name) {
          <span class="hljs-keyword">delete</span> expandoStore.data[name];
          <span class="hljs-keyword">return</span>;
        }
        <span class="hljs-keyword">if</span> (expandoStore.handle) {
          <span class="hljs-keyword">if</span> (expandoStore.events.$destroy) {
            expandoStore.handle({}, <span class="hljs-string">'$destroy'</span>);
          }
          jqLiteOff(element);
        }
        <span class="hljs-keyword">delete</span> jqCache[expandoId];
        element.ng339 = <span class="hljs-literal">undefined</span>;
      }
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">jqLiteExpandoStore</span>(<span class="hljs-params">element, createIfNecessary</span>) </span>{
      <span class="hljs-keyword">var</span> expandoId = element.ng339,
        expandoStore = expandoId &amp;&amp; jqCache[expandoId];
      <span class="hljs-keyword">if</span> (createIfNecessary &amp;&amp; !expandoStore) {
        element.ng339 = expandoId = jqNextId();
        expandoStore = jqCache[expandoId] = {
          <span class="hljs-attr">events</span>: {},
          <span class="hljs-attr">data</span>: {},
          <span class="hljs-attr">handle</span>: <span class="hljs-literal">undefined</span>
        };
      }
      <span class="hljs-keyword">return</span> expandoStore;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">jqLiteData</span>(<span class="hljs-params">element, key, value</span>) </span>{
      <span class="hljs-keyword">if</span> (jqLiteAcceptsData(element)) {
        <span class="hljs-keyword">var</span> isSimpleSetter = isDefined(value);
        <span class="hljs-keyword">var</span> isSimpleGetter = !isSimpleSetter &amp;&amp; key &amp;&amp; !isObject(key);
        <span class="hljs-keyword">var</span> massGetter = !key;
        <span class="hljs-keyword">var</span> expandoStore = jqLiteExpandoStore(element, !isSimpleGetter);
        <span class="hljs-keyword">var</span> data = expandoStore &amp;&amp; expandoStore.data;
        <span class="hljs-keyword">if</span> (isSimpleSetter) {
          data[key] = value;
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">if</span> (massGetter) {
            <span class="hljs-keyword">return</span> data;
          } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">if</span> (isSimpleGetter) {
              <span class="hljs-keyword">return</span> data &amp;&amp; data[key];
            } <span class="hljs-keyword">else</span> {
              extend(data, key);
            }
          }
        }
      }
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">jqLiteHasClass</span>(<span class="hljs-params">element, selector</span>) </span>{
      <span class="hljs-keyword">if</span> (!element.getAttribute) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
      <span class="hljs-keyword">return</span> ((<span class="hljs-string">" "</span> + (element.getAttribute(<span class="hljs-string">'class'</span>) || <span class="hljs-string">''</span>) + <span class="hljs-string">" "</span>).replace(<span class="hljs-regexp">/[\n\t]/g</span>, <span class="hljs-string">" "</span>).indexOf(<span class="hljs-string">" "</span> + selector + <span class="hljs-string">" "</span>) &gt; <span class="hljs-number">-1</span>);
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">jqLiteRemoveClass</span>(<span class="hljs-params">element, cssClasses</span>) </span>{
      <span class="hljs-keyword">if</span> (cssClasses &amp;&amp; element.setAttribute) {
        forEach(cssClasses.split(<span class="hljs-string">' '</span>), <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">cssClass</span>) </span>{
          element.setAttribute(<span class="hljs-string">'class'</span>, trim(
            (<span class="hljs-string">" "</span> + (element.getAttribute(<span class="hljs-string">'class'</span>) || <span class="hljs-string">''</span>) + <span class="hljs-string">" "</span>)
            .replace(<span class="hljs-regexp">/[\n\t]/g</span>, <span class="hljs-string">" "</span>)
            .replace(<span class="hljs-string">" "</span> + trim(cssClass) + <span class="hljs-string">" "</span>, <span class="hljs-string">" "</span>)));
        });
      }
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">jqLiteAddClass</span>(<span class="hljs-params">element, cssClasses</span>) </span>{
      <span class="hljs-keyword">if</span> (cssClasses &amp;&amp; element.setAttribute) {
        <span class="hljs-keyword">var</span> existingClasses = (<span class="hljs-string">' '</span> + (element.getAttribute(<span class="hljs-string">'class'</span>) || <span class="hljs-string">''</span>) + <span class="hljs-string">' '</span>)
          .replace(<span class="hljs-regexp">/[\n\t]/g</span>, <span class="hljs-string">" "</span>);
        forEach(cssClasses.split(<span class="hljs-string">' '</span>), <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">cssClass</span>) </span>{
          cssClass = trim(cssClass);
          <span class="hljs-keyword">if</span> (existingClasses.indexOf(<span class="hljs-string">' '</span> + cssClass + <span class="hljs-string">' '</span>) === <span class="hljs-number">-1</span>) {
            existingClasses += cssClass + <span class="hljs-string">' '</span>;
          }
        });
        element.setAttribute(<span class="hljs-string">'class'</span>, trim(existingClasses));
      }
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">jqLiteAddNodes</span>(<span class="hljs-params">root, elements</span>) </span>{
      <span class="hljs-keyword">if</span> (elements) {
        <span class="hljs-keyword">if</span> (elements.nodeType) {
          root[root.length++] = elements;
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">var</span> length = elements.length;
          <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> length === <span class="hljs-string">'number'</span> &amp;&amp; elements.window !== elements) {
            <span class="hljs-keyword">if</span> (length) {
              <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; length; i++) {
                root[root.length++] = elements[i];
              }
            }
          } <span class="hljs-keyword">else</span> {
            root[root.length++] = elements;
          }
        }
      }
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">jqLiteController</span>(<span class="hljs-params">element, name</span>) </span>{
      <span class="hljs-keyword">return</span> jqLiteInheritedData(element, <span class="hljs-string">'$'</span> + (name || <span class="hljs-string">'ngController'</span>) + <span class="hljs-string">'Controller'</span>);
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">jqLiteInheritedData</span>(<span class="hljs-params">element, name, value</span>) </span>{
      <span class="hljs-keyword">if</span> (element.nodeType == NODE_TYPE_DOCUMENT) {
        element = element.documentElement;
      }
      <span class="hljs-keyword">var</span> names = isArray(name) ? name : [name];
      <span class="hljs-keyword">while</span> (element) {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, ii = names.length; i &lt; ii; i++) {
          <span class="hljs-keyword">if</span> (isDefined(value = jqLite.data(element, names[i]))) <span class="hljs-keyword">return</span> value;
        }
        element = element.parentNode || (element.nodeType === NODE_TYPE_DOCUMENT_FRAGMENT &amp;&amp; element.host);
      }
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">jqLiteEmpty</span>(<span class="hljs-params">element</span>) </span>{
      jqLiteDealoc(element, <span class="hljs-literal">true</span>);
      <span class="hljs-keyword">while</span> (element.firstChild) {
        element.removeChild(element.firstChild);
      }
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">jqLiteRemove</span>(<span class="hljs-params">element, keepData</span>) </span>{
      <span class="hljs-keyword">if</span> (!keepData) jqLiteDealoc(element);
      <span class="hljs-keyword">var</span> parent = element.parentNode;
      <span class="hljs-keyword">if</span> (parent) parent.removeChild(element);
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">jqLiteDocumentLoaded</span>(<span class="hljs-params">action, win</span>) </span>{
      win = win || <span class="hljs-built_in">window</span>;
      <span class="hljs-keyword">if</span> (win.document.readyState === <span class="hljs-string">'complete'</span>) {
        win.setTimeout(action);
      } <span class="hljs-keyword">else</span> {
        jqLite(win).on(<span class="hljs-string">'load'</span>, action);
      }
    }
    <span class="hljs-keyword">var</span> JQLitePrototype = JQLite.prototype = {
      <span class="hljs-attr">ready</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fn</span>) </span>{
        <span class="hljs-keyword">var</span> fired = <span class="hljs-literal">false</span>;

        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">trigger</span>(<span class="hljs-params"></span>) </span>{
          <span class="hljs-keyword">if</span> (fired) <span class="hljs-keyword">return</span>;
          fired = <span class="hljs-literal">true</span>;
          fn();
        }
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">document</span>.readyState === <span class="hljs-string">'complete'</span>) {
          setTimeout(trigger);
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">this</span>.on(<span class="hljs-string">'DOMContentLoaded'</span>, trigger);
          JQLite(<span class="hljs-built_in">window</span>).on(<span class="hljs-string">'load'</span>, trigger);
        }
      },
      <span class="hljs-attr">toString</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> value = [];
        forEach(<span class="hljs-keyword">this</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
          value.push(<span class="hljs-string">''</span> + e);
        });
        <span class="hljs-keyword">return</span> <span class="hljs-string">'['</span> + value.join(<span class="hljs-string">', '</span>) + <span class="hljs-string">']'</span>;
      },
      <span class="hljs-attr">eq</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">index</span>) </span>{
        <span class="hljs-keyword">return</span> (index &gt;= <span class="hljs-number">0</span>) ? jqLite(<span class="hljs-keyword">this</span>[index]) : jqLite(<span class="hljs-keyword">this</span>[<span class="hljs-keyword">this</span>.length + index]);
      },
      <span class="hljs-attr">length</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">push</span>: push,
      <span class="hljs-attr">sort</span>: [].sort,
      <span class="hljs-attr">splice</span>: [].splice
    };
    <span class="hljs-keyword">var</span> BOOLEAN_ATTR = {};
    forEach(<span class="hljs-string">'multiple,selected,checked,disabled,readOnly,required,open'</span>.split(<span class="hljs-string">','</span>), <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>) </span>{
      BOOLEAN_ATTR[lowercase(value)] = value;
    });
    <span class="hljs-keyword">var</span> BOOLEAN_ELEMENTS = {};
    forEach(<span class="hljs-string">'input,select,option,textarea,button,form,details'</span>.split(<span class="hljs-string">','</span>), <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>) </span>{
      BOOLEAN_ELEMENTS[value] = <span class="hljs-literal">true</span>;
    });
    <span class="hljs-keyword">var</span> ALIASED_ATTR = {
      <span class="hljs-string">'ngMinlength'</span>: <span class="hljs-string">'minlength'</span>,
      <span class="hljs-string">'ngMaxlength'</span>: <span class="hljs-string">'maxlength'</span>,
      <span class="hljs-string">'ngMin'</span>: <span class="hljs-string">'min'</span>,
      <span class="hljs-string">'ngMax'</span>: <span class="hljs-string">'max'</span>,
      <span class="hljs-string">'ngPattern'</span>: <span class="hljs-string">'pattern'</span>
    };

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getBooleanAttrName</span>(<span class="hljs-params">element, name</span>) </span>{
      <span class="hljs-keyword">var</span> booleanAttr = BOOLEAN_ATTR[name.toLowerCase()];
      <span class="hljs-keyword">return</span> booleanAttr &amp;&amp; BOOLEAN_ELEMENTS[nodeName_(element)] &amp;&amp; booleanAttr;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getAliasedAttrName</span>(<span class="hljs-params">name</span>) </span>{
      <span class="hljs-keyword">return</span> ALIASED_ATTR[name];
    }
    forEach({
      <span class="hljs-attr">data</span>: jqLiteData,
      <span class="hljs-attr">removeData</span>: jqLiteRemoveData,
      <span class="hljs-attr">hasData</span>: jqLiteHasData,
      <span class="hljs-attr">cleanData</span>: jqLiteCleanData
    }, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fn, name</span>) </span>{
      JQLite[name] = fn;
    });
    forEach({
      <span class="hljs-attr">data</span>: jqLiteData,
      <span class="hljs-attr">inheritedData</span>: jqLiteInheritedData,
      <span class="hljs-attr">scope</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">element</span>) </span>{
        <span class="hljs-keyword">return</span> jqLite.data(element, <span class="hljs-string">'$scope'</span>) || jqLiteInheritedData(element.parentNode || element, [<span class="hljs-string">'$isolateScope'</span>, <span class="hljs-string">'$scope'</span>]);
      },
      <span class="hljs-attr">isolateScope</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">element</span>) </span>{
        <span class="hljs-keyword">return</span> jqLite.data(element, <span class="hljs-string">'$isolateScope'</span>) || jqLite.data(element, <span class="hljs-string">'$isolateScopeNoTemplate'</span>);
      },
      <span class="hljs-attr">controller</span>: jqLiteController,
      <span class="hljs-attr">injector</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">element</span>) </span>{
        <span class="hljs-keyword">return</span> jqLiteInheritedData(element, <span class="hljs-string">'$injector'</span>);
      },
      <span class="hljs-attr">removeAttr</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">element, name</span>) </span>{
        element.removeAttribute(name);
      },
      <span class="hljs-attr">hasClass</span>: jqLiteHasClass,
      <span class="hljs-attr">css</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">element, name, value</span>) </span>{
        name = camelCase(name);
        <span class="hljs-keyword">if</span> (isDefined(value)) {
          element.style[name] = value;
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">return</span> element.style[name];
        }
      },
      <span class="hljs-attr">attr</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">element, name, value</span>) </span>{
        <span class="hljs-keyword">var</span> nodeType = element.nodeType;
        <span class="hljs-keyword">if</span> (nodeType === NODE_TYPE_TEXT || nodeType === NODE_TYPE_ATTRIBUTE || nodeType === NODE_TYPE_COMMENT) {
          <span class="hljs-keyword">return</span>;
        }
        <span class="hljs-keyword">var</span> lowercasedName = lowercase(name);
        <span class="hljs-keyword">if</span> (BOOLEAN_ATTR[lowercasedName]) {
          <span class="hljs-keyword">if</span> (isDefined(value)) {
            <span class="hljs-keyword">if</span> (!!value) {
              element[name] = <span class="hljs-literal">true</span>;
              element.setAttribute(name, lowercasedName);
            } <span class="hljs-keyword">else</span> {
              element[name] = <span class="hljs-literal">false</span>;
              element.removeAttribute(lowercasedName);
            }
          } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> (element[name] ||
                (element.attributes.getNamedItem(name) || noop).specified) ?
              lowercasedName :
              <span class="hljs-literal">undefined</span>;
          }
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (isDefined(value)) {
          element.setAttribute(name, value);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (element.getAttribute) {
          <span class="hljs-keyword">var</span> ret = element.getAttribute(name, <span class="hljs-number">2</span>);
          <span class="hljs-keyword">return</span> ret === <span class="hljs-literal">null</span> ? <span class="hljs-literal">undefined</span> : ret;
        }
      },
      <span class="hljs-attr">prop</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">element, name, value</span>) </span>{
        <span class="hljs-keyword">if</span> (isDefined(value)) {
          element[name] = value;
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">return</span> element[name];
        }
      },
      <span class="hljs-attr">text</span>: (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        getText.$dv = <span class="hljs-string">''</span>;
        <span class="hljs-keyword">return</span> getText;

        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getText</span>(<span class="hljs-params">element, value</span>) </span>{
          <span class="hljs-keyword">if</span> (isUndefined(value)) {
            <span class="hljs-keyword">var</span> nodeType = element.nodeType;
            <span class="hljs-keyword">return</span> (nodeType === NODE_TYPE_ELEMENT || nodeType === NODE_TYPE_TEXT) ? element.textContent : <span class="hljs-string">''</span>;
          }
          element.textContent = value;
        }
      })(),
      <span class="hljs-attr">val</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">element, value</span>) </span>{
        <span class="hljs-keyword">if</span> (isUndefined(value)) {
          <span class="hljs-keyword">if</span> (element.multiple &amp;&amp; nodeName_(element) === <span class="hljs-string">'select'</span>) {
            <span class="hljs-keyword">var</span> result = [];
            forEach(element.options, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">option</span>) </span>{
              <span class="hljs-keyword">if</span> (option.selected) {
                result.push(option.value || option.text);
              }
            });
            <span class="hljs-keyword">return</span> result.length === <span class="hljs-number">0</span> ? <span class="hljs-literal">null</span> : result;
          }
          <span class="hljs-keyword">return</span> element.value;
        }
        element.value = value;
      },
      <span class="hljs-attr">html</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">element, value</span>) </span>{
        <span class="hljs-keyword">if</span> (isUndefined(value)) {
          <span class="hljs-keyword">return</span> element.innerHTML;
        }
        jqLiteDealoc(element, <span class="hljs-literal">true</span>);
        element.innerHTML = value;
      },
      <span class="hljs-attr">empty</span>: jqLiteEmpty
    }, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fn, name</span>) </span>{
      JQLite.prototype[name] = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">arg1, arg2</span>) </span>{
        <span class="hljs-keyword">var</span> i, key;
        <span class="hljs-keyword">var</span> nodeCount = <span class="hljs-keyword">this</span>.length;
        <span class="hljs-keyword">if</span> (fn !== jqLiteEmpty &amp;&amp;
          (isUndefined((fn.length == <span class="hljs-number">2</span> &amp;&amp; (fn !== jqLiteHasClass &amp;&amp; fn !== jqLiteController)) ? arg1 : arg2))) {
          <span class="hljs-keyword">if</span> (isObject(arg1)) {
            <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; nodeCount; i++) {
              <span class="hljs-keyword">if</span> (fn === jqLiteData) {
                fn(<span class="hljs-keyword">this</span>[i], arg1);
              } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">for</span> (key <span class="hljs-keyword">in</span> arg1) {
                  fn(<span class="hljs-keyword">this</span>[i], key, arg1[key]);
                }
              }
            }
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
          } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">var</span> value = fn.$dv;
            <span class="hljs-keyword">var</span> jj = (isUndefined(value)) ? <span class="hljs-built_in">Math</span>.min(nodeCount, <span class="hljs-number">1</span>) : nodeCount;
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> j = <span class="hljs-number">0</span>; j &lt; jj; j++) {
              <span class="hljs-keyword">var</span> nodeValue = fn(<span class="hljs-keyword">this</span>[j], arg1, arg2);
              value = value ? value + nodeValue : nodeValue;
            }
            <span class="hljs-keyword">return</span> value;
          }
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; nodeCount; i++) {
            fn(<span class="hljs-keyword">this</span>[i], arg1, arg2);
          }
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
        }
      };
    });

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createEventHandler</span>(<span class="hljs-params">element, events</span>) </span>{
      <span class="hljs-keyword">var</span> eventHandler = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event, type</span>) </span>{
        event.isDefaultPrevented = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
          <span class="hljs-keyword">return</span> event.defaultPrevented;
        };
        <span class="hljs-keyword">var</span> eventFns = events[type || event.type];
        <span class="hljs-keyword">var</span> eventFnsLength = eventFns ? eventFns.length : <span class="hljs-number">0</span>;
        <span class="hljs-keyword">if</span> (!eventFnsLength) <span class="hljs-keyword">return</span>;
        <span class="hljs-keyword">if</span> (isUndefined(event.immediatePropagationStopped)) {
          <span class="hljs-keyword">var</span> originalStopImmediatePropagation = event.stopImmediatePropagation;
          event.stopImmediatePropagation = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            event.immediatePropagationStopped = <span class="hljs-literal">true</span>;
            <span class="hljs-keyword">if</span> (event.stopPropagation) {
              event.stopPropagation();
            }
            <span class="hljs-keyword">if</span> (originalStopImmediatePropagation) {
              originalStopImmediatePropagation.call(event);
            }
          };
        }
        event.isImmediatePropagationStopped = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
          <span class="hljs-keyword">return</span> event.immediatePropagationStopped === <span class="hljs-literal">true</span>;
        };
        <span class="hljs-keyword">var</span> handlerWrapper = eventFns.specialHandlerWrapper || defaultHandlerWrapper;
        <span class="hljs-keyword">if</span> ((eventFnsLength &gt; <span class="hljs-number">1</span>)) {
          eventFns = shallowCopy(eventFns);
        }
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; eventFnsLength; i++) {
          <span class="hljs-keyword">if</span> (!event.isImmediatePropagationStopped()) {
            handlerWrapper(element, event, eventFns[i]);
          }
        }
      };
      eventHandler.elem = element;
      <span class="hljs-keyword">return</span> eventHandler;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">defaultHandlerWrapper</span>(<span class="hljs-params">element, event, handler</span>) </span>{
      handler.call(element, event);
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">specialMouseHandlerWrapper</span>(<span class="hljs-params">target, event, handler</span>) </span>{
      <span class="hljs-keyword">var</span> related = event.relatedTarget;
      <span class="hljs-keyword">if</span> (!related || (related !== target &amp;&amp; !jqLiteContains.call(target, related))) {
        handler.call(target, event);
      }
    }
    forEach({
      <span class="hljs-attr">removeData</span>: jqLiteRemoveData,
      <span class="hljs-attr">on</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">jqLiteOn</span>(<span class="hljs-params">element, type, fn, unsupported</span>) </span>{
        <span class="hljs-keyword">if</span> (isDefined(unsupported)) <span class="hljs-keyword">throw</span> jqLiteMinErr(<span class="hljs-string">'onargs'</span>, <span class="hljs-string">'jqLite#on() does not support the `selector` or `eventData` parameters'</span>);
        <span class="hljs-keyword">if</span> (!jqLiteAcceptsData(element)) {
          <span class="hljs-keyword">return</span>;
        }
        <span class="hljs-keyword">var</span> expandoStore = jqLiteExpandoStore(element, <span class="hljs-literal">true</span>);
        <span class="hljs-keyword">var</span> events = expandoStore.events;
        <span class="hljs-keyword">var</span> handle = expandoStore.handle;
        <span class="hljs-keyword">if</span> (!handle) {
          handle = expandoStore.handle = createEventHandler(element, events);
        }
        <span class="hljs-keyword">var</span> types = type.indexOf(<span class="hljs-string">' '</span>) &gt;= <span class="hljs-number">0</span> ? type.split(<span class="hljs-string">' '</span>) : [type];
        <span class="hljs-keyword">var</span> i = types.length;
        <span class="hljs-keyword">var</span> addHandler = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">type, specialHandlerWrapper, noEventListener</span>) </span>{
          <span class="hljs-keyword">var</span> eventFns = events[type];
          <span class="hljs-keyword">if</span> (!eventFns) {
            eventFns = events[type] = [];
            eventFns.specialHandlerWrapper = specialHandlerWrapper;
            <span class="hljs-keyword">if</span> (type !== <span class="hljs-string">'$destroy'</span> &amp;&amp; !noEventListener) {
              addEventListenerFn(element, type, handle);
            }
          }
          eventFns.push(fn);
        };
        <span class="hljs-keyword">while</span> (i--) {
          type = types[i];
          <span class="hljs-keyword">if</span> (MOUSE_EVENT_MAP[type]) {
            addHandler(MOUSE_EVENT_MAP[type], specialMouseHandlerWrapper);
            addHandler(type, <span class="hljs-literal">undefined</span>, <span class="hljs-literal">true</span>);
          } <span class="hljs-keyword">else</span> {
            addHandler(type);
          }
        }
      },
      <span class="hljs-attr">off</span>: jqLiteOff,
      <span class="hljs-attr">one</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">element, type, fn</span>) </span>{
        element = jqLite(element);
        element.on(type, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onFn</span>(<span class="hljs-params"></span>) </span>{
          element.off(type, fn);
          element.off(type, onFn);
        });
        element.on(type, fn);
      },
      <span class="hljs-attr">replaceWith</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">element, replaceNode</span>) </span>{
        <span class="hljs-keyword">var</span> index, parent = element.parentNode;
        jqLiteDealoc(element);
        forEach(<span class="hljs-keyword">new</span> JQLite(replaceNode), <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">node</span>) </span>{
          <span class="hljs-keyword">if</span> (index) {
            parent.insertBefore(node, index.nextSibling);
          } <span class="hljs-keyword">else</span> {
            parent.replaceChild(node, element);
          }
          index = node;
        });
      },
      <span class="hljs-attr">children</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">element</span>) </span>{
        <span class="hljs-keyword">var</span> children = [];
        forEach(element.childNodes, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">element</span>) </span>{
          <span class="hljs-keyword">if</span> (element.nodeType === NODE_TYPE_ELEMENT) {
            children.push(element);
          }
        });
        <span class="hljs-keyword">return</span> children;
      },
      <span class="hljs-attr">contents</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">element</span>) </span>{
        <span class="hljs-keyword">return</span> element.contentDocument || element.childNodes || [];
      },
      <span class="hljs-attr">append</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">element, node</span>) </span>{
        <span class="hljs-keyword">var</span> nodeType = element.nodeType;
        <span class="hljs-keyword">if</span> (nodeType !== NODE_TYPE_ELEMENT &amp;&amp; nodeType !== NODE_TYPE_DOCUMENT_FRAGMENT) <span class="hljs-keyword">return</span>;
        node = <span class="hljs-keyword">new</span> JQLite(node);
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, ii = node.length; i &lt; ii; i++) {
          <span class="hljs-keyword">var</span> child = node[i];
          element.appendChild(child);
        }
      },
      <span class="hljs-attr">prepend</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">element, node</span>) </span>{
        <span class="hljs-keyword">if</span> (element.nodeType === NODE_TYPE_ELEMENT) {
          <span class="hljs-keyword">var</span> index = element.firstChild;
          forEach(<span class="hljs-keyword">new</span> JQLite(node), <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">child</span>) </span>{
            element.insertBefore(child, index);
          });
        }
      },
      <span class="hljs-attr">wrap</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">element, wrapNode</span>) </span>{
        jqLiteWrapNode(element, jqLite(wrapNode).eq(<span class="hljs-number">0</span>).clone()[<span class="hljs-number">0</span>]);
      },
      <span class="hljs-attr">remove</span>: jqLiteRemove,
      <span class="hljs-attr">detach</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">element</span>) </span>{
        jqLiteRemove(element, <span class="hljs-literal">true</span>);
      },
      <span class="hljs-attr">after</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">element, newElement</span>) </span>{
        <span class="hljs-keyword">var</span> index = element,
          parent = element.parentNode;
        newElement = <span class="hljs-keyword">new</span> JQLite(newElement);
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, ii = newElement.length; i &lt; ii; i++) {
          <span class="hljs-keyword">var</span> node = newElement[i];
          parent.insertBefore(node, index.nextSibling);
          index = node;
        }
      },
      <span class="hljs-attr">addClass</span>: jqLiteAddClass,
      <span class="hljs-attr">removeClass</span>: jqLiteRemoveClass,
      <span class="hljs-attr">toggleClass</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">element, selector, condition</span>) </span>{
        <span class="hljs-keyword">if</span> (selector) {
          forEach(selector.split(<span class="hljs-string">' '</span>), <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">className</span>) </span>{
            <span class="hljs-keyword">var</span> classCondition = condition;
            <span class="hljs-keyword">if</span> (isUndefined(classCondition)) {
              classCondition = !jqLiteHasClass(element, className);
            }
            (classCondition ? jqLiteAddClass : jqLiteRemoveClass)(element, className);
          });
        }
      },
      <span class="hljs-attr">parent</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">element</span>) </span>{
        <span class="hljs-keyword">var</span> parent = element.parentNode;
        <span class="hljs-keyword">return</span> parent &amp;&amp; parent.nodeType !== NODE_TYPE_DOCUMENT_FRAGMENT ? parent : <span class="hljs-literal">null</span>;
      },
      <span class="hljs-attr">next</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">element</span>) </span>{
        <span class="hljs-keyword">return</span> element.nextElementSibling;
      },
      <span class="hljs-attr">find</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">element, selector</span>) </span>{
        <span class="hljs-keyword">if</span> (element.getElementsByTagName) {
          <span class="hljs-keyword">return</span> element.getElementsByTagName(selector);
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">return</span> [];
        }
      },
      <span class="hljs-attr">clone</span>: jqLiteClone,
      <span class="hljs-attr">triggerHandler</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">element, event, extraParameters</span>) </span>{
        <span class="hljs-keyword">var</span> dummyEvent, eventFnsCopy, handlerArgs;
        <span class="hljs-keyword">var</span> eventName = event.type || event;
        <span class="hljs-keyword">var</span> expandoStore = jqLiteExpandoStore(element);
        <span class="hljs-keyword">var</span> events = expandoStore &amp;&amp; expandoStore.events;
        <span class="hljs-keyword">var</span> eventFns = events &amp;&amp; events[eventName];
        <span class="hljs-keyword">if</span> (eventFns) {
          dummyEvent = {
            <span class="hljs-attr">preventDefault</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
              <span class="hljs-keyword">this</span>.defaultPrevented = <span class="hljs-literal">true</span>;
            },
            <span class="hljs-attr">isDefaultPrevented</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
              <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.defaultPrevented === <span class="hljs-literal">true</span>;
            },
            <span class="hljs-attr">stopImmediatePropagation</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
              <span class="hljs-keyword">this</span>.immediatePropagationStopped = <span class="hljs-literal">true</span>;
            },
            <span class="hljs-attr">isImmediatePropagationStopped</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
              <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.immediatePropagationStopped === <span class="hljs-literal">true</span>;
            },
            <span class="hljs-attr">stopPropagation</span>: noop,
            <span class="hljs-attr">type</span>: eventName,
            <span class="hljs-attr">target</span>: element
          };
          <span class="hljs-keyword">if</span> (event.type) {
            dummyEvent = extend(dummyEvent, event);
          }
          eventFnsCopy = shallowCopy(eventFns);
          handlerArgs = extraParameters ? [dummyEvent].concat(extraParameters) : [dummyEvent];
          forEach(eventFnsCopy, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fn</span>) </span>{
            <span class="hljs-keyword">if</span> (!dummyEvent.isImmediatePropagationStopped()) {
              fn.apply(element, handlerArgs);
            }
          });
        }
      }
    }, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fn, name</span>) </span>{
      JQLite.prototype[name] = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">arg1, arg2, arg3</span>) </span>{
        <span class="hljs-keyword">var</span> value;
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, ii = <span class="hljs-keyword">this</span>.length; i &lt; ii; i++) {
          <span class="hljs-keyword">if</span> (isUndefined(value)) {
            value = fn(<span class="hljs-keyword">this</span>[i], arg1, arg2, arg3);
            <span class="hljs-keyword">if</span> (isDefined(value)) {
              value = jqLite(value);
            }
          } <span class="hljs-keyword">else</span> {
            jqLiteAddNodes(value, fn(<span class="hljs-keyword">this</span>[i], arg1, arg2, arg3));
          }
        }
        <span class="hljs-keyword">return</span> isDefined(value) ? value : <span class="hljs-keyword">this</span>;
      };
      JQLite.prototype.bind = JQLite.prototype.on;
      JQLite.prototype.unbind = JQLite.prototype.off;
    });

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$$jqLiteProvider</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">this</span>.$get = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$$jqLite</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> extend(JQLite, {
          <span class="hljs-attr">hasClass</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">node, classes</span>) </span>{
            <span class="hljs-keyword">if</span> (node.attr) node = node[<span class="hljs-number">0</span>];
            <span class="hljs-keyword">return</span> jqLiteHasClass(node, classes);
          },
          <span class="hljs-attr">addClass</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">node, classes</span>) </span>{
            <span class="hljs-keyword">if</span> (node.attr) node = node[<span class="hljs-number">0</span>];
            <span class="hljs-keyword">return</span> jqLiteAddClass(node, classes);
          },
          <span class="hljs-attr">removeClass</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">node, classes</span>) </span>{
            <span class="hljs-keyword">if</span> (node.attr) node = node[<span class="hljs-number">0</span>];
            <span class="hljs-keyword">return</span> jqLiteRemoveClass(node, classes);
          }
        });
      };
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hashKey</span>(<span class="hljs-params">obj, nextUidFn</span>) </span>{
      <span class="hljs-keyword">var</span> key = obj &amp;&amp; obj.$$hashKey;
      <span class="hljs-keyword">if</span> (key) {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> key === <span class="hljs-string">'function'</span>) {
          key = obj.$$hashKey();
        }
        <span class="hljs-keyword">return</span> key;
      }
      <span class="hljs-keyword">var</span> objType = <span class="hljs-keyword">typeof</span> obj;
      <span class="hljs-keyword">if</span> (objType == <span class="hljs-string">'function'</span> || (objType == <span class="hljs-string">'object'</span> &amp;&amp; obj !== <span class="hljs-literal">null</span>)) {
        key = obj.$$hashKey = objType + <span class="hljs-string">':'</span> + (nextUidFn || nextUid)();
      } <span class="hljs-keyword">else</span> {
        key = objType + <span class="hljs-string">':'</span> + obj;
      }
      <span class="hljs-keyword">return</span> key;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">HashMap</span>(<span class="hljs-params">array, isolatedUid</span>) </span>{
      <span class="hljs-keyword">if</span> (isolatedUid) {
        <span class="hljs-keyword">var</span> uid = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.nextUid = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
          <span class="hljs-keyword">return</span> ++uid;
        };
      }
      forEach(array, <span class="hljs-keyword">this</span>.put, <span class="hljs-keyword">this</span>);
    }
    HashMap.prototype = {
      <span class="hljs-attr">put</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">key, value</span>) </span>{
        <span class="hljs-keyword">this</span>[hashKey(key, <span class="hljs-keyword">this</span>.nextUid)] = value;
      },
      <span class="hljs-attr">get</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">key</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>[hashKey(key, <span class="hljs-keyword">this</span>.nextUid)];
      },
      <span class="hljs-attr">remove</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">key</span>) </span>{
        <span class="hljs-keyword">var</span> value = <span class="hljs-keyword">this</span>[key = hashKey(key, <span class="hljs-keyword">this</span>.nextUid)];
        <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>[key];
        <span class="hljs-keyword">return</span> value;
      }
    };
    <span class="hljs-keyword">var</span> $$HashMapProvider = [<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">this</span>.$get = [<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> HashMap;
      }];
    }];
    <span class="hljs-keyword">var</span> ARROW_ARG = <span class="hljs-regexp">/^([^\(]+?)=&gt;/</span>;
    <span class="hljs-keyword">var</span> FN_ARGS = <span class="hljs-regexp">/^[^\(]*\(\s*([^\)]*)\)/m</span>;
    <span class="hljs-keyword">var</span> FN_ARG_SPLIT = <span class="hljs-regexp">/,/</span>;
    <span class="hljs-keyword">var</span> FN_ARG = <span class="hljs-regexp">/^\s*(_?)(\S+?)\1\s*$/</span>;
    <span class="hljs-keyword">var</span> STRIP_COMMENTS = <span class="hljs-regexp">/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/mg</span>;
    <span class="hljs-keyword">var</span> $injectorMinErr = minErr(<span class="hljs-string">'$injector'</span>);

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">extractArgs</span>(<span class="hljs-params">fn</span>) </span>{
      <span class="hljs-keyword">var</span> fnText = fn.toString().replace(STRIP_COMMENTS, <span class="hljs-string">''</span>),
        args = fnText.match(ARROW_ARG) || fnText.match(FN_ARGS);
      <span class="hljs-keyword">return</span> args;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">anonFn</span>(<span class="hljs-params">fn</span>) </span>{
      <span class="hljs-keyword">var</span> args = extractArgs(fn);
      <span class="hljs-keyword">if</span> (args) {
        <span class="hljs-keyword">return</span> <span class="hljs-string">'function('</span> + (args[<span class="hljs-number">1</span>] || <span class="hljs-string">''</span>).replace(<span class="hljs-regexp">/[\s\r\n]+/</span>, <span class="hljs-string">' '</span>) + <span class="hljs-string">')'</span>;
      }
      <span class="hljs-keyword">return</span> <span class="hljs-string">'fn'</span>;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">annotate</span>(<span class="hljs-params">fn, strictDi, name</span>) </span>{
      <span class="hljs-keyword">var</span> $inject,
        argDecl,
        last;
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> fn === <span class="hljs-string">'function'</span>) {
        <span class="hljs-keyword">if</span> (!($inject = fn.$inject)) {
          $inject = [];
          <span class="hljs-keyword">if</span> (fn.length) {
            <span class="hljs-keyword">if</span> (strictDi) {
              <span class="hljs-keyword">if</span> (!isString(name) || !name) {
                name = fn.name || anonFn(fn);
              }
              <span class="hljs-keyword">throw</span> $injectorMinErr(<span class="hljs-string">'strictdi'</span>,
                <span class="hljs-string">'{0} is not using explicit annotation and cannot be invoked in strict mode'</span>, name);
            }
            argDecl = extractArgs(fn);
            forEach(argDecl[<span class="hljs-number">1</span>].split(FN_ARG_SPLIT), <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">arg</span>) </span>{
              arg.replace(FN_ARG, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">all, underscore, name</span>) </span>{
                $inject.push(name);
              });
            });
          }
          fn.$inject = $inject;
        }
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (isArray(fn)) {
        last = fn.length - <span class="hljs-number">1</span>;
        assertArgFn(fn[last], <span class="hljs-string">'fn'</span>);
        $inject = fn.slice(<span class="hljs-number">0</span>, last);
      } <span class="hljs-keyword">else</span> {
        assertArgFn(fn, <span class="hljs-string">'fn'</span>, <span class="hljs-literal">true</span>);
      }
      <span class="hljs-keyword">return</span> $inject;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createInjector</span>(<span class="hljs-params">modulesToLoad, strictDi</span>) </span>{
      strictDi = (strictDi === <span class="hljs-literal">true</span>);
      <span class="hljs-keyword">var</span> INSTANTIATING = {},
        providerSuffix = <span class="hljs-string">'Provider'</span>,
        path = [],
        loadedModules = <span class="hljs-keyword">new</span> HashMap([], <span class="hljs-literal">true</span>),
        providerCache = {
          <span class="hljs-attr">$provide</span>: {
            <span class="hljs-attr">provider</span>: supportObject(provider),
            <span class="hljs-attr">factory</span>: supportObject(factory),
            <span class="hljs-attr">service</span>: supportObject(service),
            <span class="hljs-attr">value</span>: supportObject(value),
            <span class="hljs-attr">constant</span>: supportObject(constant),
            <span class="hljs-attr">decorator</span>: decorator
          }
        },
        providerInjector = (providerCache.$injector =
          createInternalInjector(providerCache, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">serviceName, caller</span>) </span>{
            <span class="hljs-keyword">if</span> (angular.isString(caller)) {
              path.push(caller);
            }
            <span class="hljs-keyword">throw</span> $injectorMinErr(<span class="hljs-string">'unpr'</span>, <span class="hljs-string">"Unknown provider: {0}"</span>, path.join(<span class="hljs-string">' &lt;- '</span>));
          })),
        instanceCache = {},
        protoInstanceInjector =
        createInternalInjector(instanceCache, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">serviceName, caller</span>) </span>{
          <span class="hljs-keyword">var</span> provider = providerInjector.get(serviceName + providerSuffix, caller);
          <span class="hljs-keyword">return</span> instanceInjector.invoke(
            provider.$get, provider, <span class="hljs-literal">undefined</span>, serviceName);
        }),
        instanceInjector = protoInstanceInjector;
      providerCache[<span class="hljs-string">'$injector'</span> + providerSuffix] = {
        <span class="hljs-attr">$get</span>: valueFn(protoInstanceInjector)
      };
      <span class="hljs-keyword">var</span> runBlocks = loadModules(modulesToLoad);
      instanceInjector = protoInstanceInjector.get(<span class="hljs-string">'$injector'</span>);
      instanceInjector.strictDi = strictDi;
      forEach(runBlocks, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fn</span>) </span>{
        <span class="hljs-keyword">if</span> (fn) instanceInjector.invoke(fn);
      });
      <span class="hljs-keyword">return</span> instanceInjector;

      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">supportObject</span>(<span class="hljs-params">delegate</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">key, value</span>) </span>{
          <span class="hljs-keyword">if</span> (isObject(key)) {
            forEach(key, reverseParams(delegate));
          } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> delegate(key, value);
          }
        };
      }

      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">provider</span>(<span class="hljs-params">name, provider_</span>) </span>{
        assertNotHasOwnProperty(name, <span class="hljs-string">'service'</span>);
        <span class="hljs-keyword">if</span> (isFunction(provider_) || isArray(provider_)) {
          provider_ = providerInjector.instantiate(provider_);
        }
        <span class="hljs-keyword">if</span> (!provider_.$get) {
          <span class="hljs-keyword">throw</span> $injectorMinErr(<span class="hljs-string">'pget'</span>, <span class="hljs-string">"Provider '{0}' must define $get factory method."</span>, name);
        }
        <span class="hljs-keyword">return</span> providerCache[name + providerSuffix] = provider_;
      }

      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">enforceReturnValue</span>(<span class="hljs-params">name, factory</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">enforcedReturnValue</span>(<span class="hljs-params"></span>) </span>{
          <span class="hljs-keyword">var</span> result = instanceInjector.invoke(factory, <span class="hljs-keyword">this</span>);
          <span class="hljs-keyword">if</span> (isUndefined(result)) {
            <span class="hljs-keyword">throw</span> $injectorMinErr(<span class="hljs-string">'undef'</span>, <span class="hljs-string">"Provider '{0}' must return a value from $get factory method."</span>, name);
          }
          <span class="hljs-keyword">return</span> result;
        };
      }

      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">factory</span>(<span class="hljs-params">name, factoryFn, enforce</span>) </span>{
        <span class="hljs-keyword">return</span> provider(name, {
          <span class="hljs-attr">$get</span>: enforce !== <span class="hljs-literal">false</span> ? enforceReturnValue(name, factoryFn) : factoryFn
        });
      }

      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">service</span>(<span class="hljs-params">name, constructor</span>) </span>{
        <span class="hljs-keyword">return</span> factory(name, [<span class="hljs-string">'$injector'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$injector</span>) </span>{
          <span class="hljs-keyword">return</span> $injector.instantiate(<span class="hljs-keyword">constructor</span>);
        }]);
      }

      function value(name, val) {
        <span class="hljs-keyword">return</span> factory(name, valueFn(val), <span class="hljs-literal">false</span>);
      }

      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">constant</span>(<span class="hljs-params">name, value</span>) </span>{
        assertNotHasOwnProperty(name, <span class="hljs-string">'constant'</span>);
        providerCache[name] = value;
        instanceCache[name] = value;
      }

      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">decorator</span>(<span class="hljs-params">serviceName, decorFn</span>) </span>{
        <span class="hljs-keyword">var</span> origProvider = providerInjector.get(serviceName + providerSuffix),
          orig$get = origProvider.$get;
        origProvider.$get = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
          <span class="hljs-keyword">var</span> origInstance = instanceInjector.invoke(orig$get, origProvider);
          <span class="hljs-keyword">return</span> instanceInjector.invoke(decorFn, <span class="hljs-literal">null</span>, {
            <span class="hljs-attr">$delegate</span>: origInstance
          });
        };
      }

      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">loadModules</span>(<span class="hljs-params">modulesToLoad</span>) </span>{
        assertArg(isUndefined(modulesToLoad) || isArray(modulesToLoad), <span class="hljs-string">'modulesToLoad'</span>, <span class="hljs-string">'not an array'</span>);
        <span class="hljs-keyword">var</span> runBlocks = [],
          moduleFn;
        forEach(modulesToLoad, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">module</span>) </span>{
          <span class="hljs-keyword">if</span> (loadedModules.get(<span class="hljs-built_in">module</span>)) <span class="hljs-keyword">return</span>;
          loadedModules.put(<span class="hljs-built_in">module</span>, <span class="hljs-literal">true</span>);

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">runInvokeQueue</span>(<span class="hljs-params">queue</span>) </span>{
            <span class="hljs-keyword">var</span> i, ii;
            <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>, ii = queue.length; i &lt; ii; i++) {
              <span class="hljs-keyword">var</span> invokeArgs = queue[i],
                provider = providerInjector.get(invokeArgs[<span class="hljs-number">0</span>]);
              provider[invokeArgs[<span class="hljs-number">1</span>]].apply(provider, invokeArgs[<span class="hljs-number">2</span>]);
            }
          }
          <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">if</span> (isString(<span class="hljs-built_in">module</span>)) {
              moduleFn = angularModule(<span class="hljs-built_in">module</span>);
              runBlocks = runBlocks.concat(loadModules(moduleFn.requires)).concat(moduleFn._runBlocks);
              runInvokeQueue(moduleFn._invokeQueue);
              runInvokeQueue(moduleFn._configBlocks);
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (isFunction(<span class="hljs-built_in">module</span>)) {
              runBlocks.push(providerInjector.invoke(<span class="hljs-built_in">module</span>));
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (isArray(<span class="hljs-built_in">module</span>)) {
              runBlocks.push(providerInjector.invoke(<span class="hljs-built_in">module</span>));
            } <span class="hljs-keyword">else</span> {
              assertArgFn(<span class="hljs-built_in">module</span>, <span class="hljs-string">'module'</span>);
            }
          } <span class="hljs-keyword">catch</span> (e) {
            <span class="hljs-keyword">if</span> (isArray(<span class="hljs-built_in">module</span>)) {
              <span class="hljs-built_in">module</span> = <span class="hljs-built_in">module</span>[<span class="hljs-built_in">module</span>.length - <span class="hljs-number">1</span>];
            }
            <span class="hljs-keyword">if</span> (e.message &amp;&amp; e.stack &amp;&amp; e.stack.indexOf(e.message) == <span class="hljs-number">-1</span>) {
              e = e.message + <span class="hljs-string">'\n'</span> + e.stack;
            }
            <span class="hljs-keyword">throw</span> $injectorMinErr(<span class="hljs-string">'modulerr'</span>, <span class="hljs-string">"Failed to instantiate module {0} due to:\n{1}"</span>,
              <span class="hljs-built_in">module</span>, e.stack || e.message || e);
          }
        });
        <span class="hljs-keyword">return</span> runBlocks;
      }

      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createInternalInjector</span>(<span class="hljs-params">cache, factory</span>) </span>{
        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getService</span>(<span class="hljs-params">serviceName, caller</span>) </span>{
          <span class="hljs-keyword">if</span> (cache.hasOwnProperty(serviceName)) {
            <span class="hljs-keyword">if</span> (cache[serviceName] === INSTANTIATING) {
              <span class="hljs-keyword">throw</span> $injectorMinErr(<span class="hljs-string">'cdep'</span>, <span class="hljs-string">'Circular dependency found: {0}'</span>,
                serviceName + <span class="hljs-string">' &lt;- '</span> + path.join(<span class="hljs-string">' &lt;- '</span>));
            }
            <span class="hljs-keyword">return</span> cache[serviceName];
          } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">try</span> {
              path.unshift(serviceName);
              cache[serviceName] = INSTANTIATING;
              <span class="hljs-keyword">return</span> cache[serviceName] = factory(serviceName, caller);
            } <span class="hljs-keyword">catch</span> (err) {
              <span class="hljs-keyword">if</span> (cache[serviceName] === INSTANTIATING) {
                <span class="hljs-keyword">delete</span> cache[serviceName];
              }
              <span class="hljs-keyword">throw</span> err;
            } <span class="hljs-keyword">finally</span> {
              path.shift();
            }
          }
        }

        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">injectionArgs</span>(<span class="hljs-params">fn, locals, serviceName</span>) </span>{
          <span class="hljs-keyword">var</span> args = [],
            $inject = createInjector.$$annotate(fn, strictDi, serviceName);
          <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, length = $inject.length; i &lt; length; i++) {
            <span class="hljs-keyword">var</span> key = $inject[i];
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> key !== <span class="hljs-string">'string'</span>) {
              <span class="hljs-keyword">throw</span> $injectorMinErr(<span class="hljs-string">'itkn'</span>,
                <span class="hljs-string">'Incorrect injection token! Expected service name as string, got {0}'</span>, key);
            }
            args.push(locals &amp;&amp; locals.hasOwnProperty(key) ? locals[key] :
              getService(key, serviceName));
          }
          <span class="hljs-keyword">return</span> args;
        }

        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isClass</span>(<span class="hljs-params">func</span>) </span>{
          <span class="hljs-keyword">if</span> (msie &lt;= <span class="hljs-number">11</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
          }
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> func === <span class="hljs-string">'function'</span> &amp;&amp;
            <span class="hljs-regexp">/^(?:class\s|constructor\()/</span>.test(<span class="hljs-built_in">Function</span>.prototype.toString.call(func));
        }

        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">invoke</span>(<span class="hljs-params">fn, self, locals, serviceName</span>) </span>{
          <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> locals === <span class="hljs-string">'string'</span>) {
            serviceName = locals;
            locals = <span class="hljs-literal">null</span>;
          }
          <span class="hljs-keyword">var</span> args = injectionArgs(fn, locals, serviceName);
          <span class="hljs-keyword">if</span> (isArray(fn)) {
            fn = fn[fn.length - <span class="hljs-number">1</span>];
          }
          <span class="hljs-keyword">if</span> (!isClass(fn)) {
            <span class="hljs-keyword">return</span> fn.apply(self, args);
          } <span class="hljs-keyword">else</span> {
            args.unshift(<span class="hljs-literal">null</span>);
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span>(<span class="hljs-built_in">Function</span>.prototype.bind.apply(fn, args))();
          }
        }

        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">instantiate</span>(<span class="hljs-params">Type, locals, serviceName</span>) </span>{
          <span class="hljs-keyword">var</span> ctor = (isArray(Type) ? Type[Type.length - <span class="hljs-number">1</span>] : Type);
          <span class="hljs-keyword">var</span> args = injectionArgs(Type, locals, serviceName);
          args.unshift(<span class="hljs-literal">null</span>);
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span>(<span class="hljs-built_in">Function</span>.prototype.bind.apply(ctor, args))();
        }
        <span class="hljs-keyword">return</span> {
          <span class="hljs-attr">invoke</span>: invoke,
          <span class="hljs-attr">instantiate</span>: instantiate,
          <span class="hljs-attr">get</span>: getService,
          <span class="hljs-attr">annotate</span>: createInjector.$$annotate,
          <span class="hljs-attr">has</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name</span>) </span>{
            <span class="hljs-keyword">return</span> providerCache.hasOwnProperty(name + providerSuffix) || cache.hasOwnProperty(name);
          }
        };
      }
    }
    createInjector.$$annotate = annotate;

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$AnchorScrollProvider</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> autoScrollingEnabled = <span class="hljs-literal">true</span>;
      <span class="hljs-keyword">this</span>.disableAutoScrolling = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        autoScrollingEnabled = <span class="hljs-literal">false</span>;
      };
      <span class="hljs-keyword">this</span>.$get = [<span class="hljs-string">'$window'</span>, <span class="hljs-string">'$location'</span>, <span class="hljs-string">'$rootScope'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$window, $location, $rootScope</span>) </span>{
        <span class="hljs-keyword">var</span> <span class="hljs-built_in">document</span> = $<span class="hljs-built_in">window</span>.document;

        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getFirstAnchor</span>(<span class="hljs-params">list</span>) </span>{
          <span class="hljs-keyword">var</span> result = <span class="hljs-literal">null</span>;
          <span class="hljs-built_in">Array</span>.prototype.some.call(list, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">element</span>) </span>{
            <span class="hljs-keyword">if</span> (nodeName_(element) === <span class="hljs-string">'a'</span>) {
              result = element;
              <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
            }
          });
          <span class="hljs-keyword">return</span> result;
        }

        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getYOffset</span>(<span class="hljs-params"></span>) </span>{
          <span class="hljs-keyword">var</span> offset = scroll.yOffset;
          <span class="hljs-keyword">if</span> (isFunction(offset)) {
            offset = offset();
          } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (isElement(offset)) {
            <span class="hljs-keyword">var</span> elem = offset[<span class="hljs-number">0</span>];
            <span class="hljs-keyword">var</span> style = $<span class="hljs-built_in">window</span>.getComputedStyle(elem);
            <span class="hljs-keyword">if</span> (style.position !== <span class="hljs-string">'fixed'</span>) {
              offset = <span class="hljs-number">0</span>;
            } <span class="hljs-keyword">else</span> {
              offset = elem.getBoundingClientRect().bottom;
            }
          } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!isNumber(offset)) {
            offset = <span class="hljs-number">0</span>;
          }
          <span class="hljs-keyword">return</span> offset;
        }

        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">scrollTo</span>(<span class="hljs-params">elem</span>) </span>{
          <span class="hljs-keyword">if</span> (elem) {
            elem.scrollIntoView();
            <span class="hljs-keyword">var</span> offset = getYOffset();
            <span class="hljs-keyword">if</span> (offset) {
              <span class="hljs-keyword">var</span> elemTop = elem.getBoundingClientRect().top;
              $<span class="hljs-built_in">window</span>.scrollBy(<span class="hljs-number">0</span>, elemTop - offset);
            }
          } <span class="hljs-keyword">else</span> {
            $<span class="hljs-built_in">window</span>.scrollTo(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
          }
        }

        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">scroll</span>(<span class="hljs-params">hash</span>) </span>{
          hash = isString(hash) ? hash : $location.hash();
          <span class="hljs-keyword">var</span> elm;
          <span class="hljs-keyword">if</span> (!hash) scrollTo(<span class="hljs-literal">null</span>);
          <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ((elm = <span class="hljs-built_in">document</span>.getElementById(hash))) scrollTo(elm);
          <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ((elm = getFirstAnchor(<span class="hljs-built_in">document</span>.getElementsByName(hash)))) scrollTo(elm);
          <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (hash === <span class="hljs-string">'top'</span>) scrollTo(<span class="hljs-literal">null</span>);
        }
        <span class="hljs-keyword">if</span> (autoScrollingEnabled) {
          $rootScope.$watch(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">autoScrollWatch</span>(<span class="hljs-params"></span>) </span>{
              <span class="hljs-keyword">return</span> $location.hash();
            },
            <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">autoScrollWatchAction</span>(<span class="hljs-params">newVal, oldVal</span>) </span>{
              <span class="hljs-keyword">if</span> (newVal === oldVal &amp;&amp; newVal === <span class="hljs-string">''</span>) <span class="hljs-keyword">return</span>;
              jqLiteDocumentLoaded(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                $rootScope.$evalAsync(scroll);
              });
            });
        }
        <span class="hljs-keyword">return</span> scroll;
      }];
    }
    <span class="hljs-keyword">var</span> $animateMinErr = minErr(<span class="hljs-string">'$animate'</span>);
    <span class="hljs-keyword">var</span> ELEMENT_NODE = <span class="hljs-number">1</span>;
    <span class="hljs-keyword">var</span> NG_ANIMATE_CLASSNAME = <span class="hljs-string">'ng-animate'</span>;

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">mergeClasses</span>(<span class="hljs-params">a, b</span>) </span>{
      <span class="hljs-keyword">if</span> (!a &amp;&amp; !b) <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>;
      <span class="hljs-keyword">if</span> (!a) <span class="hljs-keyword">return</span> b;
      <span class="hljs-keyword">if</span> (!b) <span class="hljs-keyword">return</span> a;
      <span class="hljs-keyword">if</span> (isArray(a)) a = a.join(<span class="hljs-string">' '</span>);
      <span class="hljs-keyword">if</span> (isArray(b)) b = b.join(<span class="hljs-string">' '</span>);
      <span class="hljs-keyword">return</span> a + <span class="hljs-string">' '</span> + b;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">extractElementNode</span>(<span class="hljs-params">element</span>) </span>{
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; element.length; i++) {
        <span class="hljs-keyword">var</span> elm = element[i];
        <span class="hljs-keyword">if</span> (elm.nodeType === ELEMENT_NODE) {
          <span class="hljs-keyword">return</span> elm;
        }
      }
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">splitClasses</span>(<span class="hljs-params">classes</span>) </span>{
      <span class="hljs-keyword">if</span> (isString(classes)) {
        classes = classes.split(<span class="hljs-string">' '</span>);
      }
      <span class="hljs-keyword">var</span> obj = createMap();
      forEach(classes, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">klass</span>) </span>{
        <span class="hljs-keyword">if</span> (klass.length) {
          obj[klass] = <span class="hljs-literal">true</span>;
        }
      });
      <span class="hljs-keyword">return</span> obj;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">prepareAnimateOptions</span>(<span class="hljs-params">options</span>) </span>{
      <span class="hljs-keyword">return</span> isObject(options) ?
        options :
        {};
    }
    <span class="hljs-keyword">var</span> $$CoreAnimateJsProvider = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">this</span>.$get = noop;
    };
    <span class="hljs-keyword">var</span> $$CoreAnimateQueueProvider = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> postDigestQueue = <span class="hljs-keyword">new</span> HashMap();
      <span class="hljs-keyword">var</span> postDigestElements = [];
      <span class="hljs-keyword">this</span>.$get = [<span class="hljs-string">'$$AnimateRunner'</span>, <span class="hljs-string">'$rootScope'</span>,
        <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$$AnimateRunner, $rootScope</span>) </span>{
          <span class="hljs-keyword">return</span> {
            <span class="hljs-attr">enabled</span>: noop,
            <span class="hljs-attr">on</span>: noop,
            <span class="hljs-attr">off</span>: noop,
            <span class="hljs-attr">pin</span>: noop,
            <span class="hljs-attr">push</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">element, event, options, domOperation</span>) </span>{
              domOperation &amp;&amp; domOperation();
              options = options || {};
              options.from &amp;&amp; element.css(options.from);
              options.to &amp;&amp; element.css(options.to);
              <span class="hljs-keyword">if</span> (options.addClass || options.removeClass) {
                addRemoveClassesPostDigest(element, options.addClass, options.removeClass);
              }
              <span class="hljs-keyword">var</span> runner = <span class="hljs-keyword">new</span> $$AnimateRunner();
              runner.complete();
              <span class="hljs-keyword">return</span> runner;
            }
          };

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">updateData</span>(<span class="hljs-params">data, classes, value</span>) </span>{
            <span class="hljs-keyword">var</span> changed = <span class="hljs-literal">false</span>;
            <span class="hljs-keyword">if</span> (classes) {
              classes = isString(classes) ? classes.split(<span class="hljs-string">' '</span>) :
                isArray(classes) ? classes : [];
              forEach(classes, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">className</span>) </span>{
                <span class="hljs-keyword">if</span> (className) {
                  changed = <span class="hljs-literal">true</span>;
                  data[className] = value;
                }
              });
            }
            <span class="hljs-keyword">return</span> changed;
          }

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleCSSClassChanges</span>(<span class="hljs-params"></span>) </span>{
            forEach(postDigestElements, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">element</span>) </span>{
              <span class="hljs-keyword">var</span> data = postDigestQueue.get(element);
              <span class="hljs-keyword">if</span> (data) {
                <span class="hljs-keyword">var</span> existing = splitClasses(element.attr(<span class="hljs-string">'class'</span>));
                <span class="hljs-keyword">var</span> toAdd = <span class="hljs-string">''</span>;
                <span class="hljs-keyword">var</span> toRemove = <span class="hljs-string">''</span>;
                forEach(data, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">status, className</span>) </span>{
                  <span class="hljs-keyword">var</span> hasClass = !!existing[className];
                  <span class="hljs-keyword">if</span> (status !== hasClass) {
                    <span class="hljs-keyword">if</span> (status) {
                      toAdd += (toAdd.length ? <span class="hljs-string">' '</span> : <span class="hljs-string">''</span>) + className;
                    } <span class="hljs-keyword">else</span> {
                      toRemove += (toRemove.length ? <span class="hljs-string">' '</span> : <span class="hljs-string">''</span>) + className;
                    }
                  }
                });
                forEach(element, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">elm</span>) </span>{
                  toAdd &amp;&amp; jqLiteAddClass(elm, toAdd);
                  toRemove &amp;&amp; jqLiteRemoveClass(elm, toRemove);
                });
                postDigestQueue.remove(element);
              }
            });
            postDigestElements.length = <span class="hljs-number">0</span>;
          }

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addRemoveClassesPostDigest</span>(<span class="hljs-params">element, add, remove</span>) </span>{
            <span class="hljs-keyword">var</span> data = postDigestQueue.get(element) || {};
            <span class="hljs-keyword">var</span> classesAdded = updateData(data, add, <span class="hljs-literal">true</span>);
            <span class="hljs-keyword">var</span> classesRemoved = updateData(data, remove, <span class="hljs-literal">false</span>);
            <span class="hljs-keyword">if</span> (classesAdded || classesRemoved) {
              postDigestQueue.put(element, data);
              postDigestElements.push(element);
              <span class="hljs-keyword">if</span> (postDigestElements.length === <span class="hljs-number">1</span>) {
                $rootScope.$$postDigest(handleCSSClassChanges);
              }
            }
          }
        }
      ];
    };
    <span class="hljs-keyword">var</span> $AnimateProvider = [<span class="hljs-string">'$provide'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$provide</span>) </span>{
      <span class="hljs-keyword">var</span> provider = <span class="hljs-keyword">this</span>;
      <span class="hljs-keyword">this</span>.$$registeredAnimations = <span class="hljs-built_in">Object</span>.create(<span class="hljs-literal">null</span>);
      <span class="hljs-keyword">this</span>.register = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name, factory</span>) </span>{
        <span class="hljs-keyword">if</span> (name &amp;&amp; name.charAt(<span class="hljs-number">0</span>) !== <span class="hljs-string">'.'</span>) {
          <span class="hljs-keyword">throw</span> $animateMinErr(<span class="hljs-string">'notcsel'</span>, <span class="hljs-string">"Expecting class selector starting with '.' got '{0}'."</span>, name);
        }
        <span class="hljs-keyword">var</span> key = name + <span class="hljs-string">'-animation'</span>;
        provider.$$registeredAnimations[name.substr(<span class="hljs-number">1</span>)] = key;
        $provide.factory(key, factory);
      };
      <span class="hljs-keyword">this</span>.classNameFilter = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">expression</span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">arguments</span>.length === <span class="hljs-number">1</span>) {
          <span class="hljs-keyword">this</span>.$$classNameFilter = (expression <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">RegExp</span>) ? expression : <span class="hljs-literal">null</span>;
          <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.$$classNameFilter) {
            <span class="hljs-keyword">var</span> reservedRegex = <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(<span class="hljs-string">"(\\s+|\\/)"</span> + NG_ANIMATE_CLASSNAME + <span class="hljs-string">"(\\s+|\\/)"</span>);
            <span class="hljs-keyword">if</span> (reservedRegex.test(<span class="hljs-keyword">this</span>.$$classNameFilter.toString())) {
              <span class="hljs-keyword">throw</span> $animateMinErr(<span class="hljs-string">'nongcls'</span>, <span class="hljs-string">'$animateProvider.classNameFilter(regex) prohibits accepting a regex value which matches/contains the "{0}" CSS class.'</span>, NG_ANIMATE_CLASSNAME);
            }
          }
        }
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.$$classNameFilter;
      };
      <span class="hljs-keyword">this</span>.$get = [<span class="hljs-string">'$$animateQueue'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$$animateQueue</span>) </span>{
        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">domInsert</span>(<span class="hljs-params">element, parentElement, afterElement</span>) </span>{
          <span class="hljs-keyword">if</span> (afterElement) {
            <span class="hljs-keyword">var</span> afterNode = extractElementNode(afterElement);
            <span class="hljs-keyword">if</span> (afterNode &amp;&amp; !afterNode.parentNode &amp;&amp; !afterNode.previousElementSibling) {
              afterElement = <span class="hljs-literal">null</span>;
            }
          }
          afterElement ? afterElement.after(element) : parentElement.prepend(element);
        }
        <span class="hljs-keyword">return</span> {
          <span class="hljs-attr">on</span>: $$animateQueue.on,
          <span class="hljs-attr">off</span>: $$animateQueue.off,
          <span class="hljs-attr">pin</span>: $$animateQueue.pin,
          <span class="hljs-attr">enabled</span>: $$animateQueue.enabled,
          <span class="hljs-attr">cancel</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">runner</span>) </span>{
            runner.end &amp;&amp; runner.end();
          },
          <span class="hljs-attr">enter</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">element, parent, after, options</span>) </span>{
            parent = parent &amp;&amp; jqLite(parent);
            after = after &amp;&amp; jqLite(after);
            parent = parent || after.parent();
            domInsert(element, parent, after);
            <span class="hljs-keyword">return</span> $$animateQueue.push(element, <span class="hljs-string">'enter'</span>, prepareAnimateOptions(options));
          },
          <span class="hljs-attr">move</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">element, parent, after, options</span>) </span>{
            parent = parent &amp;&amp; jqLite(parent);
            after = after &amp;&amp; jqLite(after);
            parent = parent || after.parent();
            domInsert(element, parent, after);
            <span class="hljs-keyword">return</span> $$animateQueue.push(element, <span class="hljs-string">'move'</span>, prepareAnimateOptions(options));
          },
          <span class="hljs-attr">leave</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">element, options</span>) </span>{
            <span class="hljs-keyword">return</span> $$animateQueue.push(element, <span class="hljs-string">'leave'</span>, prepareAnimateOptions(options), <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
              element.remove();
            });
          },
          <span class="hljs-attr">addClass</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">element, className, options</span>) </span>{
            options = prepareAnimateOptions(options);
            options.addClass = mergeClasses(options.addclass, className);
            <span class="hljs-keyword">return</span> $$animateQueue.push(element, <span class="hljs-string">'addClass'</span>, options);
          },
          <span class="hljs-attr">removeClass</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">element, className, options</span>) </span>{
            options = prepareAnimateOptions(options);
            options.removeClass = mergeClasses(options.removeClass, className);
            <span class="hljs-keyword">return</span> $$animateQueue.push(element, <span class="hljs-string">'removeClass'</span>, options);
          },
          <span class="hljs-attr">setClass</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">element, add, remove, options</span>) </span>{
            options = prepareAnimateOptions(options);
            options.addClass = mergeClasses(options.addClass, add);
            options.removeClass = mergeClasses(options.removeClass, remove);
            <span class="hljs-keyword">return</span> $$animateQueue.push(element, <span class="hljs-string">'setClass'</span>, options);
          },
          <span class="hljs-attr">animate</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">element, from, to, className, options</span>) </span>{
            options = prepareAnimateOptions(options);
            options.from = options.from ? extend(options.from, <span class="hljs-keyword">from</span>) : <span class="hljs-keyword">from</span>;
            options.to = options.to ? extend(options.to, to) : to;
            className = className || <span class="hljs-string">'ng-inline-animate'</span>;
            options.tempClasses = mergeClasses(options.tempClasses, className);
            <span class="hljs-keyword">return</span> $$animateQueue.push(element, <span class="hljs-string">'animate'</span>, options);
          }
        };
      }];
    }];
    <span class="hljs-keyword">var</span> $$AnimateAsyncRunFactoryProvider = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">this</span>.$get = [<span class="hljs-string">'$$rAF'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$$rAF</span>) </span>{
        <span class="hljs-keyword">var</span> waitQueue = [];

        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">waitForTick</span>(<span class="hljs-params">fn</span>) </span>{
          waitQueue.push(fn);
          <span class="hljs-keyword">if</span> (waitQueue.length &gt; <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span>;
          $$rAF(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; waitQueue.length; i++) {
              waitQueue[i]();
            }
            waitQueue = [];
          });
        }
        <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
          <span class="hljs-keyword">var</span> passed = <span class="hljs-literal">false</span>;
          waitForTick(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            passed = <span class="hljs-literal">true</span>;
          });
          <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">callback</span>) </span>{
            passed ? callback() : waitForTick(callback);
          };
        };
      }];
    };
    <span class="hljs-keyword">var</span> $$AnimateRunnerFactoryProvider = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">this</span>.$get = [<span class="hljs-string">'$q'</span>, <span class="hljs-string">'$sniffer'</span>, <span class="hljs-string">'$$animateAsyncRun'</span>, <span class="hljs-string">'$document'</span>, <span class="hljs-string">'$timeout'</span>,
        <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$q, $sniffer, $$animateAsyncRun, $document, $timeout</span>) </span>{
          <span class="hljs-keyword">var</span> INITIAL_STATE = <span class="hljs-number">0</span>;
          <span class="hljs-keyword">var</span> DONE_PENDING_STATE = <span class="hljs-number">1</span>;
          <span class="hljs-keyword">var</span> DONE_COMPLETE_STATE = <span class="hljs-number">2</span>;
          AnimateRunner.chain = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">chain, callback</span>) </span>{
            <span class="hljs-keyword">var</span> index = <span class="hljs-number">0</span>;
            next();

            <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">next</span>(<span class="hljs-params"></span>) </span>{
              <span class="hljs-keyword">if</span> (index === chain.length) {
                callback(<span class="hljs-literal">true</span>);
                <span class="hljs-keyword">return</span>;
              }
              chain[index](<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">response</span>) </span>{
                <span class="hljs-keyword">if</span> (response === <span class="hljs-literal">false</span>) {
                  callback(<span class="hljs-literal">false</span>);
                  <span class="hljs-keyword">return</span>;
                }
                index++;
                next();
              });
            }
          };
          AnimateRunner.all = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">runners, callback</span>) </span>{
            <span class="hljs-keyword">var</span> count = <span class="hljs-number">0</span>;
            <span class="hljs-keyword">var</span> status = <span class="hljs-literal">true</span>;
            forEach(runners, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">runner</span>) </span>{
              runner.done(onProgress);
            });

            <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onProgress</span>(<span class="hljs-params">response</span>) </span>{
              status = status &amp;&amp; response;
              <span class="hljs-keyword">if</span> (++count === runners.length) {
                callback(status);
              }
            }
          };

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">AnimateRunner</span>(<span class="hljs-params">host</span>) </span>{
            <span class="hljs-keyword">this</span>.setHost(host);
            <span class="hljs-keyword">var</span> rafTick = $$animateAsyncRun();
            <span class="hljs-keyword">var</span> timeoutTick = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fn</span>) </span>{
              $timeout(fn, <span class="hljs-number">0</span>, <span class="hljs-literal">false</span>);
            };
            <span class="hljs-keyword">this</span>._doneCallbacks = [];
            <span class="hljs-keyword">this</span>._tick = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fn</span>) </span>{
              <span class="hljs-keyword">var</span> doc = $<span class="hljs-built_in">document</span>[<span class="hljs-number">0</span>];
              <span class="hljs-keyword">if</span> (doc &amp;&amp; doc.hidden) {
                timeoutTick(fn);
              } <span class="hljs-keyword">else</span> {
                rafTick(fn);
              }
            };
            <span class="hljs-keyword">this</span>._state = <span class="hljs-number">0</span>;
          }
          AnimateRunner.prototype = {
            <span class="hljs-attr">setHost</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">host</span>) </span>{
              <span class="hljs-keyword">this</span>.host = host || {};
            },
            <span class="hljs-attr">done</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fn</span>) </span>{
              <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._state === DONE_COMPLETE_STATE) {
                fn();
              } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">this</span>._doneCallbacks.push(fn);
              }
            },
            <span class="hljs-attr">progress</span>: noop,
            <span class="hljs-attr">getPromise</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
              <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.promise) {
                <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;
                <span class="hljs-keyword">this</span>.promise = $q(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">resolve, reject</span>) </span>{
                  self.done(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">status</span>) </span>{
                    status === <span class="hljs-literal">false</span> ? reject() : resolve();
                  });
                });
              }
              <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.promise;
            },
            <span class="hljs-attr">then</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">resolveHandler, rejectHandler</span>) </span>{
              <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.getPromise().then(resolveHandler, rejectHandler);
            },
            <span class="hljs-string">'catch'</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">handler</span>) </span>{
              <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.getPromise()[<span class="hljs-string">'catch'</span>](handler);
            },
            <span class="hljs-string">'finally'</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">handler</span>) </span>{
              <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.getPromise()[<span class="hljs-string">'finally'</span>](handler);
            },
            <span class="hljs-attr">pause</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
              <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.host.pause) {
                <span class="hljs-keyword">this</span>.host.pause();
              }
            },
            <span class="hljs-attr">resume</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
              <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.host.resume) {
                <span class="hljs-keyword">this</span>.host.resume();
              }
            },
            <span class="hljs-attr">end</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
              <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.host.end) {
                <span class="hljs-keyword">this</span>.host.end();
              }
              <span class="hljs-keyword">this</span>._resolve(<span class="hljs-literal">true</span>);
            },
            <span class="hljs-attr">cancel</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
              <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.host.cancel) {
                <span class="hljs-keyword">this</span>.host.cancel();
              }
              <span class="hljs-keyword">this</span>._resolve(<span class="hljs-literal">false</span>);
            },
            <span class="hljs-attr">complete</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">response</span>) </span>{
              <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;
              <span class="hljs-keyword">if</span> (self._state === INITIAL_STATE) {
                self._state = DONE_PENDING_STATE;
                self._tick(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                  self._resolve(response);
                });
              }
            },
            <span class="hljs-attr">_resolve</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">response</span>) </span>{
              <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._state !== DONE_COMPLETE_STATE) {
                forEach(<span class="hljs-keyword">this</span>._doneCallbacks, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fn</span>) </span>{
                  fn(response);
                });
                <span class="hljs-keyword">this</span>._doneCallbacks.length = <span class="hljs-number">0</span>;
                <span class="hljs-keyword">this</span>._state = DONE_COMPLETE_STATE;
              }
            }
          };
          <span class="hljs-keyword">return</span> AnimateRunner;
        }
      ];
    };
    <span class="hljs-keyword">var</span> $CoreAnimateCssProvider = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">this</span>.$get = [<span class="hljs-string">'$$rAF'</span>, <span class="hljs-string">'$q'</span>, <span class="hljs-string">'$$AnimateRunner'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$$rAF, $q, $$AnimateRunner</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">element, initialOptions</span>) </span>{
          <span class="hljs-keyword">var</span> options = initialOptions || {};
          <span class="hljs-keyword">if</span> (!options.$$prepared) {
            options = copy(options);
          }
          <span class="hljs-keyword">if</span> (options.cleanupStyles) {
            options.from = options.to = <span class="hljs-literal">null</span>;
          }
          <span class="hljs-keyword">if</span> (options.from) {
            element.css(options.from);
            options.from = <span class="hljs-literal">null</span>;
          }
          <span class="hljs-keyword">var</span> closed, runner = <span class="hljs-keyword">new</span> $$AnimateRunner();
          <span class="hljs-keyword">return</span> {
            <span class="hljs-attr">start</span>: run,
            <span class="hljs-attr">end</span>: run
          };

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">run</span>(<span class="hljs-params"></span>) </span>{
            $$rAF(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
              applyAnimationContents();
              <span class="hljs-keyword">if</span> (!closed) {
                runner.complete();
              }
              closed = <span class="hljs-literal">true</span>;
            });
            <span class="hljs-keyword">return</span> runner;
          }

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">applyAnimationContents</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">if</span> (options.addClass) {
              element.addClass(options.addClass);
              options.addClass = <span class="hljs-literal">null</span>;
            }
            <span class="hljs-keyword">if</span> (options.removeClass) {
              element.removeClass(options.removeClass);
              options.removeClass = <span class="hljs-literal">null</span>;
            }
            <span class="hljs-keyword">if</span> (options.to) {
              element.css(options.to);
              options.to = <span class="hljs-literal">null</span>;
            }
          }
        };
      }];
    };

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Browser</span>(<span class="hljs-params">window, document, $log, $sniffer</span>) </span>{
      <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>,
        location = <span class="hljs-built_in">window</span>.location,
        history = <span class="hljs-built_in">window</span>.history,
        setTimeout = <span class="hljs-built_in">window</span>.setTimeout,
        clearTimeout = <span class="hljs-built_in">window</span>.clearTimeout,
        pendingDeferIds = {};
      self.isMock = <span class="hljs-literal">false</span>;
      <span class="hljs-keyword">var</span> outstandingRequestCount = <span class="hljs-number">0</span>;
      <span class="hljs-keyword">var</span> outstandingRequestCallbacks = [];
      self.$$completeOutstandingRequest = completeOutstandingRequest;
      self.$$incOutstandingRequestCount = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        outstandingRequestCount++;
      };

      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">completeOutstandingRequest</span>(<span class="hljs-params">fn</span>) </span>{
        <span class="hljs-keyword">try</span> {
          fn.apply(<span class="hljs-literal">null</span>, sliceArgs(<span class="hljs-built_in">arguments</span>, <span class="hljs-number">1</span>));
        } <span class="hljs-keyword">finally</span> {
          outstandingRequestCount--;
          <span class="hljs-keyword">if</span> (outstandingRequestCount === <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">while</span> (outstandingRequestCallbacks.length) {
              <span class="hljs-keyword">try</span> {
                outstandingRequestCallbacks.pop()();
              } <span class="hljs-keyword">catch</span> (e) {
                $log.error(e);
              }
            }
          }
        }
      }

      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getHash</span>(<span class="hljs-params">url</span>) </span>{
        <span class="hljs-keyword">var</span> index = url.indexOf(<span class="hljs-string">'#'</span>);
        <span class="hljs-keyword">return</span> index === <span class="hljs-number">-1</span> ? <span class="hljs-string">''</span> : url.substr(index);
      }
      self.notifyWhenNoOutstandingRequests = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">callback</span>) </span>{
        <span class="hljs-keyword">if</span> (outstandingRequestCount === <span class="hljs-number">0</span>) {
          callback();
        } <span class="hljs-keyword">else</span> {
          outstandingRequestCallbacks.push(callback);
        }
      };
      <span class="hljs-keyword">var</span> cachedState, lastHistoryState,
        lastBrowserUrl = location.href,
        baseElement = <span class="hljs-built_in">document</span>.find(<span class="hljs-string">'base'</span>),
        pendingLocation = <span class="hljs-literal">null</span>,
        getCurrentState = !$sniffer.history ? noop : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getCurrentState</span>(<span class="hljs-params"></span>) </span>{
          <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">return</span> history.state;
          } <span class="hljs-keyword">catch</span> (e) {}
        };
      cacheState();
      lastHistoryState = cachedState;
      self.url = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">url, replace, state</span>) </span>{
        <span class="hljs-keyword">if</span> (isUndefined(state)) {
          state = <span class="hljs-literal">null</span>;
        }
        <span class="hljs-keyword">if</span> (location !== <span class="hljs-built_in">window</span>.location) location = <span class="hljs-built_in">window</span>.location;
        <span class="hljs-keyword">if</span> (history !== <span class="hljs-built_in">window</span>.history) history = <span class="hljs-built_in">window</span>.history;
        <span class="hljs-keyword">if</span> (url) {
          <span class="hljs-keyword">var</span> sameState = lastHistoryState === state;
          <span class="hljs-keyword">if</span> (lastBrowserUrl === url &amp;&amp; (!$sniffer.history || sameState)) {
            <span class="hljs-keyword">return</span> self;
          }
          <span class="hljs-keyword">var</span> sameBase = lastBrowserUrl &amp;&amp; stripHash(lastBrowserUrl) === stripHash(url);
          lastBrowserUrl = url;
          lastHistoryState = state;
          <span class="hljs-keyword">if</span> ($sniffer.history &amp;&amp; (!sameBase || !sameState)) {
            history[replace ? <span class="hljs-string">'replaceState'</span> : <span class="hljs-string">'pushState'</span>](state, <span class="hljs-string">''</span>, url);
            cacheState();
            lastHistoryState = cachedState;
          } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">if</span> (!sameBase || pendingLocation) {
              pendingLocation = url;
            }
            <span class="hljs-keyword">if</span> (replace) {
              location.replace(url);
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!sameBase) {
              location.href = url;
            } <span class="hljs-keyword">else</span> {
              location.hash = getHash(url);
            }
            <span class="hljs-keyword">if</span> (location.href !== url) {
              pendingLocation = url;
            }
          }
          <span class="hljs-keyword">return</span> self;
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">return</span> pendingLocation || location.href.replace(<span class="hljs-regexp">/%27/g</span>, <span class="hljs-string">"'"</span>);
        }
      };
      self.state = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> cachedState;
      };
      <span class="hljs-keyword">var</span> urlChangeListeners = [],
        urlChangeInit = <span class="hljs-literal">false</span>;

      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">cacheStateAndFireUrlChange</span>(<span class="hljs-params"></span>) </span>{
        pendingLocation = <span class="hljs-literal">null</span>;
        cacheState();
        fireUrlChange();
      }
      <span class="hljs-keyword">var</span> lastCachedState = <span class="hljs-literal">null</span>;

      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">cacheState</span>(<span class="hljs-params"></span>) </span>{
        cachedState = getCurrentState();
        cachedState = isUndefined(cachedState) ? <span class="hljs-literal">null</span> : cachedState;
        <span class="hljs-keyword">if</span> (equals(cachedState, lastCachedState)) {
          cachedState = lastCachedState;
        }
        lastCachedState = cachedState;
      }

      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fireUrlChange</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">if</span> (lastBrowserUrl === self.url() &amp;&amp; lastHistoryState === cachedState) {
          <span class="hljs-keyword">return</span>;
        }
        lastBrowserUrl = self.url();
        lastHistoryState = cachedState;
        forEach(urlChangeListeners, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">listener</span>) </span>{
          listener(self.url(), cachedState);
        });
      }
      self.onUrlChange = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">callback</span>) </span>{
        <span class="hljs-keyword">if</span> (!urlChangeInit) {
          <span class="hljs-keyword">if</span> ($sniffer.history) jqLite(<span class="hljs-built_in">window</span>).on(<span class="hljs-string">'popstate'</span>, cacheStateAndFireUrlChange);
          jqLite(<span class="hljs-built_in">window</span>).on(<span class="hljs-string">'hashchange'</span>, cacheStateAndFireUrlChange);
          urlChangeInit = <span class="hljs-literal">true</span>;
        }
        urlChangeListeners.push(callback);
        <span class="hljs-keyword">return</span> callback;
      };
      self.$$applicationDestroyed = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        jqLite(<span class="hljs-built_in">window</span>).off(<span class="hljs-string">'hashchange popstate'</span>, cacheStateAndFireUrlChange);
      };
      self.$$checkUrlChange = fireUrlChange;
      self.baseHref = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> href = baseElement.attr(<span class="hljs-string">'href'</span>);
        <span class="hljs-keyword">return</span> href ? href.replace(<span class="hljs-regexp">/^(https?\:)?\/\/[^\/]*/</span>, <span class="hljs-string">''</span>) : <span class="hljs-string">''</span>;
      };
      self.defer = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fn, delay</span>) </span>{
        <span class="hljs-keyword">var</span> timeoutId;
        outstandingRequestCount++;
        timeoutId = setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
          <span class="hljs-keyword">delete</span> pendingDeferIds[timeoutId];
          completeOutstandingRequest(fn);
        }, delay || <span class="hljs-number">0</span>);
        pendingDeferIds[timeoutId] = <span class="hljs-literal">true</span>;
        <span class="hljs-keyword">return</span> timeoutId;
      };
      self.defer.cancel = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">deferId</span>) </span>{
        <span class="hljs-keyword">if</span> (pendingDeferIds[deferId]) {
          <span class="hljs-keyword">delete</span> pendingDeferIds[deferId];
          clearTimeout(deferId);
          completeOutstandingRequest(noop);
          <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        }
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
      };
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$BrowserProvider</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">this</span>.$get = [<span class="hljs-string">'$window'</span>, <span class="hljs-string">'$log'</span>, <span class="hljs-string">'$sniffer'</span>, <span class="hljs-string">'$document'</span>,
        <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$window, $log, $sniffer, $document</span>) </span>{
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Browser($<span class="hljs-built_in">window</span>, $<span class="hljs-built_in">document</span>, $log, $sniffer);
        }
      ];
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$CacheFactoryProvider</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">this</span>.$get = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> caches = {};

        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">cacheFactory</span>(<span class="hljs-params">cacheId, options</span>) </span>{
          <span class="hljs-keyword">if</span> (cacheId <span class="hljs-keyword">in</span> caches) {
            <span class="hljs-keyword">throw</span> minErr(<span class="hljs-string">'$cacheFactory'</span>)(<span class="hljs-string">'iid'</span>, <span class="hljs-string">"CacheId '{0}' is already taken!"</span>, cacheId);
          }
          <span class="hljs-keyword">var</span> size = <span class="hljs-number">0</span>,
            stats = extend({}, options, {
              <span class="hljs-attr">id</span>: cacheId
            }),
            data = createMap(),
            capacity = (options &amp;&amp; options.capacity) || <span class="hljs-built_in">Number</span>.MAX_VALUE,
            lruHash = createMap(),
            freshEnd = <span class="hljs-literal">null</span>,
            staleEnd = <span class="hljs-literal">null</span>;
          <span class="hljs-keyword">return</span> caches[cacheId] = {
            <span class="hljs-attr">put</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">key, value</span>) </span>{
              <span class="hljs-keyword">if</span> (isUndefined(value)) <span class="hljs-keyword">return</span>;
              <span class="hljs-keyword">if</span> (capacity &lt; <span class="hljs-built_in">Number</span>.MAX_VALUE) {
                <span class="hljs-keyword">var</span> lruEntry = lruHash[key] || (lruHash[key] = {
                  <span class="hljs-attr">key</span>: key
                });
                refresh(lruEntry);
              }
              <span class="hljs-keyword">if</span> (!(key <span class="hljs-keyword">in</span> data)) size++;
              data[key] = value;
              <span class="hljs-keyword">if</span> (size &gt; capacity) {
                <span class="hljs-keyword">this</span>.remove(staleEnd.key);
              }
              <span class="hljs-keyword">return</span> value;
            },
            <span class="hljs-attr">get</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">key</span>) </span>{
              <span class="hljs-keyword">if</span> (capacity &lt; <span class="hljs-built_in">Number</span>.MAX_VALUE) {
                <span class="hljs-keyword">var</span> lruEntry = lruHash[key];
                <span class="hljs-keyword">if</span> (!lruEntry) <span class="hljs-keyword">return</span>;
                refresh(lruEntry);
              }
              <span class="hljs-keyword">return</span> data[key];
            },
            <span class="hljs-attr">remove</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">key</span>) </span>{
              <span class="hljs-keyword">if</span> (capacity &lt; <span class="hljs-built_in">Number</span>.MAX_VALUE) {
                <span class="hljs-keyword">var</span> lruEntry = lruHash[key];
                <span class="hljs-keyword">if</span> (!lruEntry) <span class="hljs-keyword">return</span>;
                <span class="hljs-keyword">if</span> (lruEntry == freshEnd) freshEnd = lruEntry.p;
                <span class="hljs-keyword">if</span> (lruEntry == staleEnd) staleEnd = lruEntry.n;
                link(lruEntry.n, lruEntry.p);
                <span class="hljs-keyword">delete</span> lruHash[key];
              }
              <span class="hljs-keyword">if</span> (!(key <span class="hljs-keyword">in</span> data)) <span class="hljs-keyword">return</span>;
              <span class="hljs-keyword">delete</span> data[key];
              size--;
            },
            <span class="hljs-attr">removeAll</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
              data = createMap();
              size = <span class="hljs-number">0</span>;
              lruHash = createMap();
              freshEnd = staleEnd = <span class="hljs-literal">null</span>;
            },
            <span class="hljs-attr">destroy</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
              data = <span class="hljs-literal">null</span>;
              stats = <span class="hljs-literal">null</span>;
              lruHash = <span class="hljs-literal">null</span>;
              <span class="hljs-keyword">delete</span> caches[cacheId];
            },
            <span class="hljs-attr">info</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
              <span class="hljs-keyword">return</span> extend({}, stats, {
                <span class="hljs-attr">size</span>: size
              });
            }
          };

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">refresh</span>(<span class="hljs-params">entry</span>) </span>{
            <span class="hljs-keyword">if</span> (entry != freshEnd) {
              <span class="hljs-keyword">if</span> (!staleEnd) {
                staleEnd = entry;
              } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (staleEnd == entry) {
                staleEnd = entry.n;
              }
              link(entry.n, entry.p);
              link(entry, freshEnd);
              freshEnd = entry;
              freshEnd.n = <span class="hljs-literal">null</span>;
            }
          }

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">link</span>(<span class="hljs-params">nextEntry, prevEntry</span>) </span>{
            <span class="hljs-keyword">if</span> (nextEntry != prevEntry) {
              <span class="hljs-keyword">if</span> (nextEntry) nextEntry.p = prevEntry;
              <span class="hljs-keyword">if</span> (prevEntry) prevEntry.n = nextEntry;
            }
          }
        }
        cacheFactory.info = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
          <span class="hljs-keyword">var</span> info = {};
          forEach(caches, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">cache, cacheId</span>) </span>{
            info[cacheId] = cache.info();
          });
          <span class="hljs-keyword">return</span> info;
        };
        cacheFactory.get = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">cacheId</span>) </span>{
          <span class="hljs-keyword">return</span> caches[cacheId];
        };
        <span class="hljs-keyword">return</span> cacheFactory;
      };
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$TemplateCacheProvider</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">this</span>.$get = [<span class="hljs-string">'$cacheFactory'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$cacheFactory</span>) </span>{
        <span class="hljs-keyword">return</span> $cacheFactory(<span class="hljs-string">'templates'</span>);
      }];
    }
    <span class="hljs-keyword">var</span> $compileMinErr = minErr(<span class="hljs-string">'$compile'</span>);
    $CompileProvider.$inject = [<span class="hljs-string">'$provide'</span>, <span class="hljs-string">'$$sanitizeUriProvider'</span>];

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$CompileProvider</span>(<span class="hljs-params">$provide, $$sanitizeUriProvider</span>) </span>{
      <span class="hljs-keyword">var</span> hasDirectives = {},
        Suffix = <span class="hljs-string">'Directive'</span>,
        COMMENT_DIRECTIVE_REGEXP = <span class="hljs-regexp">/^\s*directive\:\s*([\w\-]+)\s+(.*)$/</span>,
        CLASS_DIRECTIVE_REGEXP = <span class="hljs-regexp">/(([\w\-]+)(?:\:([^;]+))?;?)/</span>,
        ALL_OR_NOTHING_ATTRS = makeMap(<span class="hljs-string">'ngSrc,ngSrcset,src,srcset'</span>),
        REQUIRE_PREFIX_REGEXP = <span class="hljs-regexp">/^(?:(\^\^?)?(\?)?(\^\^?)?)?/</span>;
      <span class="hljs-keyword">var</span> EVENT_HANDLER_ATTR_REGEXP = <span class="hljs-regexp">/^(on[a-z]+|formaction)$/</span>;
      <span class="hljs-keyword">var</span> bindingCache = createMap();

      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">parseIsolateBindings</span>(<span class="hljs-params">scope, directiveName, isController</span>) </span>{
        <span class="hljs-keyword">var</span> LOCAL_REGEXP = <span class="hljs-regexp">/^\s*([@&amp;&lt;]|=(\*?))(\??)\s*(\w*)\s*$/</span>;
        <span class="hljs-keyword">var</span> bindings = {};
        forEach(scope, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">definition, scopeName</span>) </span>{
          <span class="hljs-keyword">if</span> (definition <span class="hljs-keyword">in</span> bindingCache) {
            bindings[scopeName] = bindingCache[definition];
            <span class="hljs-keyword">return</span>;
          }
          <span class="hljs-keyword">var</span> match = definition.match(LOCAL_REGEXP);
          <span class="hljs-keyword">if</span> (!match) {
            <span class="hljs-keyword">throw</span> $compileMinErr(<span class="hljs-string">'iscp'</span>,
              <span class="hljs-string">"Invalid {3} for directive '{0}'."</span> +
              <span class="hljs-string">" Definition: {... {1}: '{2}' ...}"</span>,
              directiveName, scopeName, definition,
              (isController ? <span class="hljs-string">"controller bindings definition"</span> :
                <span class="hljs-string">"isolate scope definition"</span>));
          }
          bindings[scopeName] = {
            <span class="hljs-attr">mode</span>: match[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>],
            <span class="hljs-attr">collection</span>: match[<span class="hljs-number">2</span>] === <span class="hljs-string">'*'</span>,
            <span class="hljs-attr">optional</span>: match[<span class="hljs-number">3</span>] === <span class="hljs-string">'?'</span>,
            <span class="hljs-attr">attrName</span>: match[<span class="hljs-number">4</span>] || scopeName
          };
          <span class="hljs-keyword">if</span> (match[<span class="hljs-number">4</span>]) {
            bindingCache[definition] = bindings[scopeName];
          }
        });
        <span class="hljs-keyword">return</span> bindings;
      }

      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">parseDirectiveBindings</span>(<span class="hljs-params">directive, directiveName</span>) </span>{
        <span class="hljs-keyword">var</span> bindings = {
          <span class="hljs-attr">isolateScope</span>: <span class="hljs-literal">null</span>,
          <span class="hljs-attr">bindToController</span>: <span class="hljs-literal">null</span>
        };
        <span class="hljs-keyword">if</span> (isObject(directive.scope)) {
          <span class="hljs-keyword">if</span> (directive.bindToController === <span class="hljs-literal">true</span>) {
            bindings.bindToController = parseIsolateBindings(directive.scope,
              directiveName, <span class="hljs-literal">true</span>);
            bindings.isolateScope = {};
          } <span class="hljs-keyword">else</span> {
            bindings.isolateScope = parseIsolateBindings(directive.scope,
              directiveName, <span class="hljs-literal">false</span>);
          }
        }
        <span class="hljs-keyword">if</span> (isObject(directive.bindToController)) {
          bindings.bindToController =
            parseIsolateBindings(directive.bindToController, directiveName, <span class="hljs-literal">true</span>);
        }
        <span class="hljs-keyword">if</span> (isObject(bindings.bindToController)) {
          <span class="hljs-keyword">var</span> controller = directive.controller;
          <span class="hljs-keyword">var</span> controllerAs = directive.controllerAs;
          <span class="hljs-keyword">if</span> (!controller) {
            <span class="hljs-keyword">throw</span> $compileMinErr(<span class="hljs-string">'noctrl'</span>,
              <span class="hljs-string">"Cannot bind to controller without directive '{0}'s controller."</span>,
              directiveName);
          } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!identifierForController(controller, controllerAs)) {
            <span class="hljs-keyword">throw</span> $compileMinErr(<span class="hljs-string">'noident'</span>,
              <span class="hljs-string">"Cannot bind to controller without identifier for directive '{0}'."</span>,
              directiveName);
          }
        }
        <span class="hljs-keyword">return</span> bindings;
      }

      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">assertValidDirectiveName</span>(<span class="hljs-params">name</span>) </span>{
        <span class="hljs-keyword">var</span> letter = name.charAt(<span class="hljs-number">0</span>);
        <span class="hljs-keyword">if</span> (!letter || letter !== lowercase(letter)) {
          <span class="hljs-keyword">throw</span> $compileMinErr(<span class="hljs-string">'baddir'</span>, <span class="hljs-string">"Directive/Component name '{0}' is invalid. The first character must be a lowercase letter"</span>, name);
        }
        <span class="hljs-keyword">if</span> (name !== name.trim()) {
          <span class="hljs-keyword">throw</span> $compileMinErr(<span class="hljs-string">'baddir'</span>,
            <span class="hljs-string">"Directive/Component name '{0}' is invalid. The name should not contain leading or trailing whitespaces"</span>,
            name);
        }
      }
      <span class="hljs-keyword">this</span>.directive = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">registerDirective</span>(<span class="hljs-params">name, directiveFactory</span>) </span>{
        assertNotHasOwnProperty(name, <span class="hljs-string">'directive'</span>);
        <span class="hljs-keyword">if</span> (isString(name)) {
          assertValidDirectiveName(name);
          assertArg(directiveFactory, <span class="hljs-string">'directiveFactory'</span>);
          <span class="hljs-keyword">if</span> (!hasDirectives.hasOwnProperty(name)) {
            hasDirectives[name] = [];
            $provide.factory(name + Suffix, [<span class="hljs-string">'$injector'</span>, <span class="hljs-string">'$exceptionHandler'</span>,
              <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$injector, $exceptionHandler</span>) </span>{
                <span class="hljs-keyword">var</span> directives = [];
                forEach(hasDirectives[name], <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">directiveFactory, index</span>) </span>{
                  <span class="hljs-keyword">try</span> {
                    <span class="hljs-keyword">var</span> directive = $injector.invoke(directiveFactory);
                    <span class="hljs-keyword">if</span> (isFunction(directive)) {
                      directive = {
                        <span class="hljs-attr">compile</span>: valueFn(directive)
                      };
                    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!directive.compile &amp;&amp; directive.link) {
                      directive.compile = valueFn(directive.link);
                    }
                    directive.priority = directive.priority || <span class="hljs-number">0</span>;
                    directive.index = index;
                    directive.name = directive.name || name;
                    directive.require = directive.require || (directive.controller &amp;&amp; directive.name);
                    directive.restrict = directive.restrict || <span class="hljs-string">'EA'</span>;
                    directive.$$moduleName = directiveFactory.$$moduleName;
                    directives.push(directive);
                  } <span class="hljs-keyword">catch</span> (e) {
                    $exceptionHandler(e);
                  }
                });
                <span class="hljs-keyword">return</span> directives;
              }
            ]);
          }
          hasDirectives[name].push(directiveFactory);
        } <span class="hljs-keyword">else</span> {
          forEach(name, reverseParams(registerDirective));
        }
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
      };
      <span class="hljs-keyword">this</span>.component = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">registerComponent</span>(<span class="hljs-params">name, options</span>) </span>{
        <span class="hljs-keyword">var</span> controller = options.controller || noop;

        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">factory</span>(<span class="hljs-params">$injector</span>) </span>{
          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">makeInjectable</span>(<span class="hljs-params">fn</span>) </span>{
            <span class="hljs-keyword">if</span> (isFunction(fn) || isArray(fn)) {
              <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">tElement, tAttrs</span>) </span>{
                <span class="hljs-keyword">return</span> $injector.invoke(fn, <span class="hljs-keyword">this</span>, {
                  <span class="hljs-attr">$element</span>: tElement,
                  <span class="hljs-attr">$attrs</span>: tAttrs
                });
              };
            } <span class="hljs-keyword">else</span> {
              <span class="hljs-keyword">return</span> fn;
            }
          }
          <span class="hljs-keyword">var</span> template = (!options.template &amp;&amp; !options.templateUrl ? <span class="hljs-string">''</span> : options.template);
          <span class="hljs-keyword">return</span> {
            <span class="hljs-attr">controller</span>: controller,
            <span class="hljs-attr">controllerAs</span>: identifierForController(options.controller) || options.controllerAs || <span class="hljs-string">'$ctrl'</span>,
            <span class="hljs-attr">template</span>: makeInjectable(template),
            <span class="hljs-attr">templateUrl</span>: makeInjectable(options.templateUrl),
            <span class="hljs-attr">transclude</span>: options.transclude,
            <span class="hljs-attr">scope</span>: {},
            <span class="hljs-attr">bindToController</span>: options.bindings || {},
            <span class="hljs-attr">restrict</span>: <span class="hljs-string">'E'</span>,
            <span class="hljs-attr">require</span>: options.require
          };
        }
        forEach(options, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">val, key</span>) </span>{
          <span class="hljs-keyword">if</span> (key.charAt(<span class="hljs-number">0</span>) === <span class="hljs-string">'$'</span>) {
            factory[key] = val;
            controller[key] = val;
          }
        });
        factory.$inject = [<span class="hljs-string">'$injector'</span>];
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.directive(name, factory);
      };
      <span class="hljs-keyword">this</span>.aHrefSanitizationWhitelist = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">regexp</span>) </span>{
        <span class="hljs-keyword">if</span> (isDefined(regexp)) {
          $$sanitizeUriProvider.aHrefSanitizationWhitelist(regexp);
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">return</span> $$sanitizeUriProvider.aHrefSanitizationWhitelist();
        }
      };
      <span class="hljs-keyword">this</span>.imgSrcSanitizationWhitelist = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">regexp</span>) </span>{
        <span class="hljs-keyword">if</span> (isDefined(regexp)) {
          $$sanitizeUriProvider.imgSrcSanitizationWhitelist(regexp);
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">return</span> $$sanitizeUriProvider.imgSrcSanitizationWhitelist();
        }
      };
      <span class="hljs-keyword">var</span> debugInfoEnabled = <span class="hljs-literal">true</span>;
      <span class="hljs-keyword">this</span>.debugInfoEnabled = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">enabled</span>) </span>{
        <span class="hljs-keyword">if</span> (isDefined(enabled)) {
          debugInfoEnabled = enabled;
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
        }
        <span class="hljs-keyword">return</span> debugInfoEnabled;
      };
      <span class="hljs-keyword">var</span> TTL = <span class="hljs-number">10</span>;
      <span class="hljs-keyword">this</span>.onChangesTtl = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">arguments</span>.length) {
          TTL = value;
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
        }
        <span class="hljs-keyword">return</span> TTL;
      };
      <span class="hljs-keyword">this</span>.$get = [
        <span class="hljs-string">'$injector'</span>, <span class="hljs-string">'$interpolate'</span>, <span class="hljs-string">'$exceptionHandler'</span>, <span class="hljs-string">'$templateRequest'</span>, <span class="hljs-string">'$parse'</span>,
        <span class="hljs-string">'$controller'</span>, <span class="hljs-string">'$rootScope'</span>, <span class="hljs-string">'$sce'</span>, <span class="hljs-string">'$animate'</span>, <span class="hljs-string">'$$sanitizeUri'</span>,
        <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$injector, $interpolate, $exceptionHandler, $templateRequest, $parse,
          $controller, $rootScope, $sce, $animate, $$sanitizeUri</span>) </span>{
          <span class="hljs-keyword">var</span> SIMPLE_ATTR_NAME = <span class="hljs-regexp">/^\w/</span>;
          <span class="hljs-keyword">var</span> specialAttrHolder = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'div'</span>);
          <span class="hljs-keyword">var</span> onChangesTtl = TTL;
          <span class="hljs-keyword">var</span> onChangesQueue;

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">flushOnChangesQueue</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">try</span> {
              <span class="hljs-keyword">if</span> (!(--onChangesTtl)) {
                onChangesQueue = <span class="hljs-literal">undefined</span>;
                <span class="hljs-keyword">throw</span> $compileMinErr(<span class="hljs-string">'infchng'</span>, <span class="hljs-string">'{0} $onChanges() iterations reached. Aborting!\n'</span>, TTL);
              }
              $rootScope.$apply(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, ii = onChangesQueue.length; i &lt; ii; ++i) {
                  onChangesQueue[i]();
                }
                onChangesQueue = <span class="hljs-literal">undefined</span>;
              });
            } <span class="hljs-keyword">finally</span> {
              onChangesTtl++;
            }
          }

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Attributes</span>(<span class="hljs-params">element, attributesToCopy</span>) </span>{
            <span class="hljs-keyword">if</span> (attributesToCopy) {
              <span class="hljs-keyword">var</span> keys = <span class="hljs-built_in">Object</span>.keys(attributesToCopy);
              <span class="hljs-keyword">var</span> i, l, key;
              <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>, l = keys.length; i &lt; l; i++) {
                key = keys[i];
                <span class="hljs-keyword">this</span>[key] = attributesToCopy[key];
              }
            } <span class="hljs-keyword">else</span> {
              <span class="hljs-keyword">this</span>.$attr = {};
            }
            <span class="hljs-keyword">this</span>.$$element = element;
          }
          Attributes.prototype = {
            <span class="hljs-attr">$normalize</span>: directiveNormalize,
            <span class="hljs-attr">$addClass</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">classVal</span>) </span>{
              <span class="hljs-keyword">if</span> (classVal &amp;&amp; classVal.length &gt; <span class="hljs-number">0</span>) {
                $animate.addClass(<span class="hljs-keyword">this</span>.$$element, classVal);
              }
            },
            <span class="hljs-attr">$removeClass</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">classVal</span>) </span>{
              <span class="hljs-keyword">if</span> (classVal &amp;&amp; classVal.length &gt; <span class="hljs-number">0</span>) {
                $animate.removeClass(<span class="hljs-keyword">this</span>.$$element, classVal);
              }
            },
            <span class="hljs-attr">$updateClass</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">newClasses, oldClasses</span>) </span>{
              <span class="hljs-keyword">var</span> toAdd = tokenDifference(newClasses, oldClasses);
              <span class="hljs-keyword">if</span> (toAdd &amp;&amp; toAdd.length) {
                $animate.addClass(<span class="hljs-keyword">this</span>.$$element, toAdd);
              }
              <span class="hljs-keyword">var</span> toRemove = tokenDifference(oldClasses, newClasses);
              <span class="hljs-keyword">if</span> (toRemove &amp;&amp; toRemove.length) {
                $animate.removeClass(<span class="hljs-keyword">this</span>.$$element, toRemove);
              }
            },
            <span class="hljs-attr">$set</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">key, value, writeAttr, attrName</span>) </span>{
              <span class="hljs-keyword">var</span> node = <span class="hljs-keyword">this</span>.$$element[<span class="hljs-number">0</span>],
                booleanKey = getBooleanAttrName(node, key),
                aliasedKey = getAliasedAttrName(key),
                observer = key,
                nodeName;
              <span class="hljs-keyword">if</span> (booleanKey) {
                <span class="hljs-keyword">this</span>.$$element.prop(key, value);
                attrName = booleanKey;
              } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (aliasedKey) {
                <span class="hljs-keyword">this</span>[aliasedKey] = value;
                observer = aliasedKey;
              }
              <span class="hljs-keyword">this</span>[key] = value;
              <span class="hljs-keyword">if</span> (attrName) {
                <span class="hljs-keyword">this</span>.$attr[key] = attrName;
              } <span class="hljs-keyword">else</span> {
                attrName = <span class="hljs-keyword">this</span>.$attr[key];
                <span class="hljs-keyword">if</span> (!attrName) {
                  <span class="hljs-keyword">this</span>.$attr[key] = attrName = snake_case(key, <span class="hljs-string">'-'</span>);
                }
              }
              nodeName = nodeName_(<span class="hljs-keyword">this</span>.$$element);
              <span class="hljs-keyword">if</span> ((nodeName === <span class="hljs-string">'a'</span> &amp;&amp; (key === <span class="hljs-string">'href'</span> || key === <span class="hljs-string">'xlinkHref'</span>)) ||
                (nodeName === <span class="hljs-string">'img'</span> &amp;&amp; key === <span class="hljs-string">'src'</span>)) {
                <span class="hljs-keyword">this</span>[key] = value = $$sanitizeUri(value, key === <span class="hljs-string">'src'</span>);
              } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (nodeName === <span class="hljs-string">'img'</span> &amp;&amp; key === <span class="hljs-string">'srcset'</span>) {
                <span class="hljs-keyword">var</span> result = <span class="hljs-string">""</span>;
                <span class="hljs-keyword">var</span> trimmedSrcset = trim(value);
                <span class="hljs-keyword">var</span> srcPattern = <span class="hljs-regexp">/(\s+\d+x\s*,|\s+\d+w\s*,|\s+,|,\s+)/</span>;
                <span class="hljs-keyword">var</span> pattern = <span class="hljs-regexp">/\s/</span>.test(trimmedSrcset) ? srcPattern : <span class="hljs-regexp">/(,)/</span>;
                <span class="hljs-keyword">var</span> rawUris = trimmedSrcset.split(pattern);
                <span class="hljs-keyword">var</span> nbrUrisWith2parts = <span class="hljs-built_in">Math</span>.floor(rawUris.length / <span class="hljs-number">2</span>);
                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; nbrUrisWith2parts; i++) {
                  <span class="hljs-keyword">var</span> innerIdx = i * <span class="hljs-number">2</span>;
                  result += $$sanitizeUri(trim(rawUris[innerIdx]), <span class="hljs-literal">true</span>);
                  result += (<span class="hljs-string">" "</span> + trim(rawUris[innerIdx + <span class="hljs-number">1</span>]));
                }
                <span class="hljs-keyword">var</span> lastTuple = trim(rawUris[i * <span class="hljs-number">2</span>]).split(<span class="hljs-regexp">/\s/</span>);
                result += $$sanitizeUri(trim(lastTuple[<span class="hljs-number">0</span>]), <span class="hljs-literal">true</span>);
                <span class="hljs-keyword">if</span> (lastTuple.length === <span class="hljs-number">2</span>) {
                  result += (<span class="hljs-string">" "</span> + trim(lastTuple[<span class="hljs-number">1</span>]));
                }
                <span class="hljs-keyword">this</span>[key] = value = result;
              }
              <span class="hljs-keyword">if</span> (writeAttr !== <span class="hljs-literal">false</span>) {
                <span class="hljs-keyword">if</span> (value === <span class="hljs-literal">null</span> || isUndefined(value)) {
                  <span class="hljs-keyword">this</span>.$$element.removeAttr(attrName);
                } <span class="hljs-keyword">else</span> {
                  <span class="hljs-keyword">if</span> (SIMPLE_ATTR_NAME.test(attrName)) {
                    <span class="hljs-keyword">this</span>.$$element.attr(attrName, value);
                  } <span class="hljs-keyword">else</span> {
                    setSpecialAttr(<span class="hljs-keyword">this</span>.$$element[<span class="hljs-number">0</span>], attrName, value);
                  }
                }
              }
              <span class="hljs-keyword">var</span> $$observers = <span class="hljs-keyword">this</span>.$$observers;
              $$observers &amp;&amp; forEach($$observers[observer], <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fn</span>) </span>{
                <span class="hljs-keyword">try</span> {
                  fn(value);
                } <span class="hljs-keyword">catch</span> (e) {
                  $exceptionHandler(e);
                }
              });
            },
            <span class="hljs-attr">$observe</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">key, fn</span>) </span>{
              <span class="hljs-keyword">var</span> attrs = <span class="hljs-keyword">this</span>,
                $$observers = (attrs.$$observers || (attrs.$$observers = createMap())),
                listeners = ($$observers[key] || ($$observers[key] = []));
              listeners.push(fn);
              $rootScope.$evalAsync(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                <span class="hljs-keyword">if</span> (!listeners.$$inter &amp;&amp; attrs.hasOwnProperty(key) &amp;&amp; !isUndefined(attrs[key])) {
                  fn(attrs[key]);
                }
              });
              <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                arrayRemove(listeners, fn);
              };
            }
          };

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setSpecialAttr</span>(<span class="hljs-params">element, attrName, value</span>) </span>{
            specialAttrHolder.innerHTML = <span class="hljs-string">"&lt;span "</span> + attrName + <span class="hljs-string">"&gt;"</span>;
            <span class="hljs-keyword">var</span> attributes = specialAttrHolder.firstChild.attributes;
            <span class="hljs-keyword">var</span> attribute = attributes[<span class="hljs-number">0</span>];
            attributes.removeNamedItem(attribute.name);
            attribute.value = value;
            element.attributes.setNamedItem(attribute);
          }

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">safeAddClass</span>(<span class="hljs-params">$element, className</span>) </span>{
            <span class="hljs-keyword">try</span> {
              $element.addClass(className);
            } <span class="hljs-keyword">catch</span> (e) {}
          }
          <span class="hljs-keyword">var</span> startSymbol = $interpolate.startSymbol(),
            endSymbol = $interpolate.endSymbol(),
            denormalizeTemplate = (startSymbol == <span class="hljs-string">'{{'</span> &amp;&amp; endSymbol == <span class="hljs-string">'}}'</span>) ?
            identity :
            <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">denormalizeTemplate</span>(<span class="hljs-params">template</span>) </span>{
              <span class="hljs-keyword">return</span> template.replace(<span class="hljs-regexp">/\{\{/g</span>, startSymbol).replace(<span class="hljs-regexp">/}}/g</span>, endSymbol);
            },
            NG_ATTR_BINDING = <span class="hljs-regexp">/^ngAttr[A-Z]/</span>;
          <span class="hljs-keyword">var</span> MULTI_ELEMENT_DIR_RE = <span class="hljs-regexp">/^(.+)Start$/</span>;
          compile.$$addBindingInfo = debugInfoEnabled ? <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$$addBindingInfo</span>(<span class="hljs-params">$element, binding</span>) </span>{
            <span class="hljs-keyword">var</span> bindings = $element.data(<span class="hljs-string">'$binding'</span>) || [];
            <span class="hljs-keyword">if</span> (isArray(binding)) {
              bindings = bindings.concat(binding);
            } <span class="hljs-keyword">else</span> {
              bindings.push(binding);
            }
            $element.data(<span class="hljs-string">'$binding'</span>, bindings);
          } : noop;
          compile.$$addBindingClass = debugInfoEnabled ? <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$$addBindingClass</span>(<span class="hljs-params">$element</span>) </span>{
            safeAddClass($element, <span class="hljs-string">'ng-binding'</span>);
          } : noop;
          compile.$$addScopeInfo = debugInfoEnabled ? <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$$addScopeInfo</span>(<span class="hljs-params">$element, scope, isolated, noTemplate</span>) </span>{
            <span class="hljs-keyword">var</span> dataName = isolated ? (noTemplate ? <span class="hljs-string">'$isolateScopeNoTemplate'</span> : <span class="hljs-string">'$isolateScope'</span>) : <span class="hljs-string">'$scope'</span>;
            $element.data(dataName, scope);
          } : noop;
          compile.$$addScopeClass = debugInfoEnabled ? <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$$addScopeClass</span>(<span class="hljs-params">$element, isolated</span>) </span>{
            safeAddClass($element, isolated ? <span class="hljs-string">'ng-isolate-scope'</span> : <span class="hljs-string">'ng-scope'</span>);
          } : noop;
          compile.$$createComment = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">directiveName, comment</span>) </span>{
            <span class="hljs-keyword">var</span> content = <span class="hljs-string">''</span>;
            <span class="hljs-keyword">if</span> (debugInfoEnabled) {
              content = <span class="hljs-string">' '</span> + (directiveName || <span class="hljs-string">''</span>) + <span class="hljs-string">': '</span> + (comment || <span class="hljs-string">''</span>) + <span class="hljs-string">' '</span>;
            }
            <span class="hljs-keyword">return</span> <span class="hljs-built_in">document</span>.createComment(content);
          };
          <span class="hljs-keyword">return</span> compile;

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">compile</span>(<span class="hljs-params">$compileNodes, transcludeFn, maxPriority, ignoreDirective,
            previousCompileContext</span>) </span>{
            <span class="hljs-keyword">if</span> (!($compileNodes <span class="hljs-keyword">instanceof</span> jqLite)) {
              $compileNodes = jqLite($compileNodes);
            }
            <span class="hljs-keyword">var</span> NOT_EMPTY = <span class="hljs-regexp">/\S+/</span>;
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, len = $compileNodes.length; i &lt; len; i++) {
              <span class="hljs-keyword">var</span> domNode = $compileNodes[i];
              <span class="hljs-keyword">if</span> (domNode.nodeType === NODE_TYPE_TEXT &amp;&amp; domNode.nodeValue.match(NOT_EMPTY)) {
                jqLiteWrapNode(domNode, $compileNodes[i] = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'span'</span>));
              }
            }
            <span class="hljs-keyword">var</span> compositeLinkFn =
              compileNodes($compileNodes, transcludeFn, $compileNodes,
                maxPriority, ignoreDirective, previousCompileContext);
            compile.$$addScopeClass($compileNodes);
            <span class="hljs-keyword">var</span> namespace = <span class="hljs-literal">null</span>;
            <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">publicLinkFn</span>(<span class="hljs-params">scope, cloneConnectFn, options</span>) </span>{
              assertArg(scope, <span class="hljs-string">'scope'</span>);
              <span class="hljs-keyword">if</span> (previousCompileContext &amp;&amp; previousCompileContext.needsNewScope) {
                scope = scope.$parent.$<span class="hljs-keyword">new</span>();
              }
              options = options || {};
              <span class="hljs-keyword">var</span> parentBoundTranscludeFn = options.parentBoundTranscludeFn,
                transcludeControllers = options.transcludeControllers,
                futureParentElement = options.futureParentElement;
              <span class="hljs-keyword">if</span> (parentBoundTranscludeFn &amp;&amp; parentBoundTranscludeFn.$$boundTransclude) {
                parentBoundTranscludeFn = parentBoundTranscludeFn.$$boundTransclude;
              }
              <span class="hljs-keyword">if</span> (!namespace) {
                namespace = detectNamespaceForChildElements(futureParentElement);
              }
              <span class="hljs-keyword">var</span> $linkNode;
              <span class="hljs-keyword">if</span> (namespace !== <span class="hljs-string">'html'</span>) {
                $linkNode = jqLite(
                  wrapTemplate(namespace, jqLite(<span class="hljs-string">'&lt;div&gt;'</span>).append($compileNodes).html())
                );
              } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (cloneConnectFn) {
                $linkNode = JQLitePrototype.clone.call($compileNodes);
              } <span class="hljs-keyword">else</span> {
                $linkNode = $compileNodes;
              }
              <span class="hljs-keyword">if</span> (transcludeControllers) {
                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> controllerName <span class="hljs-keyword">in</span> transcludeControllers) {
                  $linkNode.data(<span class="hljs-string">'$'</span> + controllerName + <span class="hljs-string">'Controller'</span>, transcludeControllers[controllerName].instance);
                }
              }
              compile.$$addScopeInfo($linkNode, scope);
              <span class="hljs-keyword">if</span> (cloneConnectFn) cloneConnectFn($linkNode, scope);
              <span class="hljs-keyword">if</span> (compositeLinkFn) compositeLinkFn(scope, $linkNode, $linkNode, parentBoundTranscludeFn);
              <span class="hljs-keyword">return</span> $linkNode;
            };
          }

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">detectNamespaceForChildElements</span>(<span class="hljs-params">parentElement</span>) </span>{
            <span class="hljs-keyword">var</span> node = parentElement &amp;&amp; parentElement[<span class="hljs-number">0</span>];
            <span class="hljs-keyword">if</span> (!node) {
              <span class="hljs-keyword">return</span> <span class="hljs-string">'html'</span>;
            } <span class="hljs-keyword">else</span> {
              <span class="hljs-keyword">return</span> nodeName_(node) !== <span class="hljs-string">'foreignobject'</span> &amp;&amp; toString.call(node).match(<span class="hljs-regexp">/SVG/</span>) ? <span class="hljs-string">'svg'</span> : <span class="hljs-string">'html'</span>;
            }
          }

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">compileNodes</span>(<span class="hljs-params">nodeList, transcludeFn, $rootElement, maxPriority, ignoreDirective,
            previousCompileContext</span>) </span>{
            <span class="hljs-keyword">var</span> linkFns = [],
              attrs, directives, nodeLinkFn, childNodes, childLinkFn, linkFnFound, nodeLinkFnFound;
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; nodeList.length; i++) {
              attrs = <span class="hljs-keyword">new</span> Attributes();
              directives = collectDirectives(nodeList[i], [], attrs, i === <span class="hljs-number">0</span> ? maxPriority : <span class="hljs-literal">undefined</span>,
                ignoreDirective);
              nodeLinkFn = (directives.length) ?
                applyDirectivesToNode(directives, nodeList[i], attrs, transcludeFn, $rootElement,
                  <span class="hljs-literal">null</span>, [], [], previousCompileContext) :
                <span class="hljs-literal">null</span>;
              <span class="hljs-keyword">if</span> (nodeLinkFn &amp;&amp; nodeLinkFn.scope) {
                compile.$$addScopeClass(attrs.$$element);
              }
              childLinkFn = (nodeLinkFn &amp;&amp; nodeLinkFn.terminal ||
                  !(childNodes = nodeList[i].childNodes) ||
                  !childNodes.length) ?
                <span class="hljs-literal">null</span> :
                compileNodes(childNodes,
                  nodeLinkFn ? (
                    (nodeLinkFn.transcludeOnThisElement || !nodeLinkFn.templateOnThisElement) &amp;&amp;
                    nodeLinkFn.transclude) : transcludeFn);
              <span class="hljs-keyword">if</span> (nodeLinkFn || childLinkFn) {
                linkFns.push(i, nodeLinkFn, childLinkFn);
                linkFnFound = <span class="hljs-literal">true</span>;
                nodeLinkFnFound = nodeLinkFnFound || nodeLinkFn;
              }
              previousCompileContext = <span class="hljs-literal">null</span>;
            }
            <span class="hljs-keyword">return</span> linkFnFound ? compositeLinkFn : <span class="hljs-literal">null</span>;

            <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">compositeLinkFn</span>(<span class="hljs-params">scope, nodeList, $rootElement, parentBoundTranscludeFn</span>) </span>{
              <span class="hljs-keyword">var</span> nodeLinkFn, childLinkFn, node, childScope, i, ii, idx, childBoundTranscludeFn;
              <span class="hljs-keyword">var</span> stableNodeList;
              <span class="hljs-keyword">if</span> (nodeLinkFnFound) {
                <span class="hljs-keyword">var</span> nodeListLength = nodeList.length;
                stableNodeList = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(nodeListLength);
                <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; linkFns.length; i += <span class="hljs-number">3</span>) {
                  idx = linkFns[i];
                  stableNodeList[idx] = nodeList[idx];
                }
              } <span class="hljs-keyword">else</span> {
                stableNodeList = nodeList;
              }
              <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>, ii = linkFns.length; i &lt; ii;) {
                node = stableNodeList[linkFns[i++]];
                nodeLinkFn = linkFns[i++];
                childLinkFn = linkFns[i++];
                <span class="hljs-keyword">if</span> (nodeLinkFn) {
                  <span class="hljs-keyword">if</span> (nodeLinkFn.scope) {
                    childScope = scope.$<span class="hljs-keyword">new</span>();
                    compile.$$addScopeInfo(jqLite(node), childScope);
                  } <span class="hljs-keyword">else</span> {
                    childScope = scope;
                  }
                  <span class="hljs-keyword">if</span> (nodeLinkFn.transcludeOnThisElement) {
                    childBoundTranscludeFn = createBoundTranscludeFn(
                      scope, nodeLinkFn.transclude, parentBoundTranscludeFn);
                  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!nodeLinkFn.templateOnThisElement &amp;&amp; parentBoundTranscludeFn) {
                    childBoundTranscludeFn = parentBoundTranscludeFn;
                  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!parentBoundTranscludeFn &amp;&amp; transcludeFn) {
                    childBoundTranscludeFn = createBoundTranscludeFn(scope, transcludeFn);
                  } <span class="hljs-keyword">else</span> {
                    childBoundTranscludeFn = <span class="hljs-literal">null</span>;
                  }
                  nodeLinkFn(childLinkFn, childScope, node, $rootElement, childBoundTranscludeFn);
                } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (childLinkFn) {
                  childLinkFn(scope, node.childNodes, <span class="hljs-literal">undefined</span>, parentBoundTranscludeFn);
                }
              }
            }
          }

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createBoundTranscludeFn</span>(<span class="hljs-params">scope, transcludeFn, previousBoundTranscludeFn</span>) </span>{
            <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">boundTranscludeFn</span>(<span class="hljs-params">transcludedScope, cloneFn, controllers, futureParentElement, containingScope</span>) </span>{
              <span class="hljs-keyword">if</span> (!transcludedScope) {
                transcludedScope = scope.$<span class="hljs-keyword">new</span>(<span class="hljs-literal">false</span>, containingScope);
                transcludedScope.$$transcluded = <span class="hljs-literal">true</span>;
              }
              <span class="hljs-keyword">return</span> transcludeFn(transcludedScope, cloneFn, {
                <span class="hljs-attr">parentBoundTranscludeFn</span>: previousBoundTranscludeFn,
                <span class="hljs-attr">transcludeControllers</span>: controllers,
                <span class="hljs-attr">futureParentElement</span>: futureParentElement
              });
            }
            <span class="hljs-keyword">var</span> boundSlots = boundTranscludeFn.$$slots = createMap();
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> slotName <span class="hljs-keyword">in</span> transcludeFn.$$slots) {
              <span class="hljs-keyword">if</span> (transcludeFn.$$slots[slotName]) {
                boundSlots[slotName] = createBoundTranscludeFn(scope, transcludeFn.$$slots[slotName], previousBoundTranscludeFn);
              } <span class="hljs-keyword">else</span> {
                boundSlots[slotName] = <span class="hljs-literal">null</span>;
              }
            }
            <span class="hljs-keyword">return</span> boundTranscludeFn;
          }

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">collectDirectives</span>(<span class="hljs-params">node, directives, attrs, maxPriority, ignoreDirective</span>) </span>{
            <span class="hljs-keyword">var</span> nodeType = node.nodeType,
              attrsMap = attrs.$attr,
              match,
              className;
            <span class="hljs-keyword">switch</span> (nodeType) {
              <span class="hljs-keyword">case</span> NODE_TYPE_ELEMENT:
                addDirective(directives,
                  directiveNormalize(nodeName_(node)), <span class="hljs-string">'E'</span>, maxPriority, ignoreDirective);
                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> attr, name, nName, ngAttrName, value, isNgAttr, nAttrs = node.attributes,
                    j = <span class="hljs-number">0</span>, jj = nAttrs &amp;&amp; nAttrs.length; j &lt; jj; j++) {
                  <span class="hljs-keyword">var</span> attrStartName = <span class="hljs-literal">false</span>;
                  <span class="hljs-keyword">var</span> attrEndName = <span class="hljs-literal">false</span>;
                  attr = nAttrs[j];
                  name = attr.name;
                  value = trim(attr.value);
                  ngAttrName = directiveNormalize(name);
                  <span class="hljs-keyword">if</span> (isNgAttr = NG_ATTR_BINDING.test(ngAttrName)) {
                    name = name.replace(PREFIX_REGEXP, <span class="hljs-string">''</span>)
                      .substr(<span class="hljs-number">8</span>).replace(<span class="hljs-regexp">/_(.)/g</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">match, letter</span>) </span>{
                        <span class="hljs-keyword">return</span> letter.toUpperCase();
                      });
                  }
                  <span class="hljs-keyword">var</span> multiElementMatch = ngAttrName.match(MULTI_ELEMENT_DIR_RE);
                  <span class="hljs-keyword">if</span> (multiElementMatch &amp;&amp; directiveIsMultiElement(multiElementMatch[<span class="hljs-number">1</span>])) {
                    attrStartName = name;
                    attrEndName = name.substr(<span class="hljs-number">0</span>, name.length - <span class="hljs-number">5</span>) + <span class="hljs-string">'end'</span>;
                    name = name.substr(<span class="hljs-number">0</span>, name.length - <span class="hljs-number">6</span>);
                  }
                  nName = directiveNormalize(name.toLowerCase());
                  attrsMap[nName] = name;
                  <span class="hljs-keyword">if</span> (isNgAttr || !attrs.hasOwnProperty(nName)) {
                    attrs[nName] = value;
                    <span class="hljs-keyword">if</span> (getBooleanAttrName(node, nName)) {
                      attrs[nName] = <span class="hljs-literal">true</span>;
                    }
                  }
                  addAttrInterpolateDirective(node, directives, value, nName, isNgAttr);
                  addDirective(directives, nName, <span class="hljs-string">'A'</span>, maxPriority, ignoreDirective, attrStartName,
                    attrEndName);
                }
                className = node.className;
                <span class="hljs-keyword">if</span> (isObject(className)) {
                  className = className.animVal;
                }
                <span class="hljs-keyword">if</span> (isString(className) &amp;&amp; className !== <span class="hljs-string">''</span>) {
                  <span class="hljs-keyword">while</span> (match = CLASS_DIRECTIVE_REGEXP.exec(className)) {
                    nName = directiveNormalize(match[<span class="hljs-number">2</span>]);
                    <span class="hljs-keyword">if</span> (addDirective(directives, nName, <span class="hljs-string">'C'</span>, maxPriority, ignoreDirective)) {
                      attrs[nName] = trim(match[<span class="hljs-number">3</span>]);
                    }
                    className = className.substr(match.index + match[<span class="hljs-number">0</span>].length);
                  }
                }
                <span class="hljs-keyword">break</span>;
              <span class="hljs-keyword">case</span> NODE_TYPE_TEXT:
                <span class="hljs-keyword">if</span> (msie === <span class="hljs-number">11</span>) {
                  <span class="hljs-keyword">while</span> (node.parentNode &amp;&amp; node.nextSibling &amp;&amp; node.nextSibling.nodeType === NODE_TYPE_TEXT) {
                    node.nodeValue = node.nodeValue + node.nextSibling.nodeValue;
                    node.parentNode.removeChild(node.nextSibling);
                  }
                }
                addTextInterpolateDirective(directives, node.nodeValue);
                <span class="hljs-keyword">break</span>;
              <span class="hljs-keyword">case</span> NODE_TYPE_COMMENT:
                <span class="hljs-keyword">try</span> {
                  match = COMMENT_DIRECTIVE_REGEXP.exec(node.nodeValue);
                  <span class="hljs-keyword">if</span> (match) {
                    nName = directiveNormalize(match[<span class="hljs-number">1</span>]);
                    <span class="hljs-keyword">if</span> (addDirective(directives, nName, <span class="hljs-string">'M'</span>, maxPriority, ignoreDirective)) {
                      attrs[nName] = trim(match[<span class="hljs-number">2</span>]);
                    }
                  }
                } <span class="hljs-keyword">catch</span> (e) {}
                <span class="hljs-keyword">break</span>;
            }
            directives.sort(byPriority);
            <span class="hljs-keyword">return</span> directives;
          }

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">groupScan</span>(<span class="hljs-params">node, attrStart, attrEnd</span>) </span>{
            <span class="hljs-keyword">var</span> nodes = [];
            <span class="hljs-keyword">var</span> depth = <span class="hljs-number">0</span>;
            <span class="hljs-keyword">if</span> (attrStart &amp;&amp; node.hasAttribute &amp;&amp; node.hasAttribute(attrStart)) {
              <span class="hljs-keyword">do</span> {
                <span class="hljs-keyword">if</span> (!node) {
                  <span class="hljs-keyword">throw</span> $compileMinErr(<span class="hljs-string">'uterdir'</span>,
                    <span class="hljs-string">"Unterminated attribute, found '{0}' but no matching '{1}' found."</span>,
                    attrStart, attrEnd);
                }
                <span class="hljs-keyword">if</span> (node.nodeType == NODE_TYPE_ELEMENT) {
                  <span class="hljs-keyword">if</span> (node.hasAttribute(attrStart)) depth++;
                  <span class="hljs-keyword">if</span> (node.hasAttribute(attrEnd)) depth--;
                }
                nodes.push(node);
                node = node.nextSibling;
              } <span class="hljs-keyword">while</span> (depth &gt; <span class="hljs-number">0</span>);
            } <span class="hljs-keyword">else</span> {
              nodes.push(node);
            }
            <span class="hljs-keyword">return</span> jqLite(nodes);
          }

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">groupElementsLinkFnWrapper</span>(<span class="hljs-params">linkFn, attrStart, attrEnd</span>) </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">groupedElementsLink</span>(<span class="hljs-params">scope, element, attrs, controllers, transcludeFn</span>) </span>{
              element = groupScan(element[<span class="hljs-number">0</span>], attrStart, attrEnd);
              <span class="hljs-keyword">return</span> linkFn(scope, element, attrs, controllers, transcludeFn);
            };
          }

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">compilationGenerator</span>(<span class="hljs-params">eager, $compileNodes, transcludeFn, maxPriority, ignoreDirective, previousCompileContext</span>) </span>{
            <span class="hljs-keyword">var</span> compiled;
            <span class="hljs-keyword">if</span> (eager) {
              <span class="hljs-keyword">return</span> compile($compileNodes, transcludeFn, maxPriority, ignoreDirective, previousCompileContext);
            }
            <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">lazyCompilation</span>(<span class="hljs-params"></span>) </span>{
              <span class="hljs-keyword">if</span> (!compiled) {
                compiled = compile($compileNodes, transcludeFn, maxPriority, ignoreDirective, previousCompileContext);
                $compileNodes = transcludeFn = previousCompileContext = <span class="hljs-literal">null</span>;
              }
              <span class="hljs-keyword">return</span> compiled.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
            };
          }

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">applyDirectivesToNode</span>(<span class="hljs-params">directives, compileNode, templateAttrs, transcludeFn,
            jqCollection, originalReplaceDirective, preLinkFns, postLinkFns,
            previousCompileContext</span>) </span>{
            previousCompileContext = previousCompileContext || {};
            <span class="hljs-keyword">var</span> terminalPriority = -<span class="hljs-built_in">Number</span>.MAX_VALUE,
              newScopeDirective = previousCompileContext.newScopeDirective,
              controllerDirectives = previousCompileContext.controllerDirectives,
              newIsolateScopeDirective = previousCompileContext.newIsolateScopeDirective,
              templateDirective = previousCompileContext.templateDirective,
              nonTlbTranscludeDirective = previousCompileContext.nonTlbTranscludeDirective,
              hasTranscludeDirective = <span class="hljs-literal">false</span>,
              hasTemplate = <span class="hljs-literal">false</span>,
              hasElementTranscludeDirective = previousCompileContext.hasElementTranscludeDirective,
              $compileNode = templateAttrs.$$element = jqLite(compileNode),
              directive,
              directiveName,
              $template,
              replaceDirective = originalReplaceDirective,
              childTranscludeFn = transcludeFn,
              linkFn,
              didScanForMultipleTransclusion = <span class="hljs-literal">false</span>,
              mightHaveMultipleTransclusionError = <span class="hljs-literal">false</span>,
              directiveValue;
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, ii = directives.length; i &lt; ii; i++) {
              directive = directives[i];
              <span class="hljs-keyword">var</span> attrStart = directive.$$start;
              <span class="hljs-keyword">var</span> attrEnd = directive.$$end;
              <span class="hljs-keyword">if</span> (attrStart) {
                $compileNode = groupScan(compileNode, attrStart, attrEnd);
              }
              $template = <span class="hljs-literal">undefined</span>;
              <span class="hljs-keyword">if</span> (terminalPriority &gt; directive.priority) {
                <span class="hljs-keyword">break</span>;
              }
              <span class="hljs-keyword">if</span> (directiveValue = directive.scope) {
                <span class="hljs-keyword">if</span> (!directive.templateUrl) {
                  <span class="hljs-keyword">if</span> (isObject(directiveValue)) {
                    assertNoDuplicate(<span class="hljs-string">'new/isolated scope'</span>, newIsolateScopeDirective || newScopeDirective,
                      directive, $compileNode);
                    newIsolateScopeDirective = directive;
                  } <span class="hljs-keyword">else</span> {
                    assertNoDuplicate(<span class="hljs-string">'new/isolated scope'</span>, newIsolateScopeDirective, directive,
                      $compileNode);
                  }
                }
                newScopeDirective = newScopeDirective || directive;
              }
              directiveName = directive.name;
              <span class="hljs-keyword">if</span> (!didScanForMultipleTransclusion &amp;&amp; ((directive.replace &amp;&amp; (directive.templateUrl || directive.template)) ||
                  (directive.transclude &amp;&amp; !directive.$$tlb))) {
                <span class="hljs-keyword">var</span> candidateDirective;
                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> scanningIndex = i + <span class="hljs-number">1</span>; candidateDirective = directives[scanningIndex++];) {
                  <span class="hljs-keyword">if</span> ((candidateDirective.transclude &amp;&amp; !candidateDirective.$$tlb) ||
                    (candidateDirective.replace &amp;&amp; (candidateDirective.templateUrl || candidateDirective.template))) {
                    mightHaveMultipleTransclusionError = <span class="hljs-literal">true</span>;
                    <span class="hljs-keyword">break</span>;
                  }
                }
                didScanForMultipleTransclusion = <span class="hljs-literal">true</span>;
              }
              <span class="hljs-keyword">if</span> (!directive.templateUrl &amp;&amp; directive.controller) {
                directiveValue = directive.controller;
                controllerDirectives = controllerDirectives || createMap();
                assertNoDuplicate(<span class="hljs-string">"'"</span> + directiveName + <span class="hljs-string">"' controller"</span>,
                  controllerDirectives[directiveName], directive, $compileNode);
                controllerDirectives[directiveName] = directive;
              }
              <span class="hljs-keyword">if</span> (directiveValue = directive.transclude) {
                hasTranscludeDirective = <span class="hljs-literal">true</span>;
                <span class="hljs-keyword">if</span> (!directive.$$tlb) {
                  assertNoDuplicate(<span class="hljs-string">'transclusion'</span>, nonTlbTranscludeDirective, directive, $compileNode);
                  nonTlbTranscludeDirective = directive;
                }
                <span class="hljs-keyword">if</span> (directiveValue == <span class="hljs-string">'element'</span>) {
                  hasElementTranscludeDirective = <span class="hljs-literal">true</span>;
                  terminalPriority = directive.priority;
                  $template = $compileNode;
                  $compileNode = templateAttrs.$$element =
                    jqLite(compile.$$createComment(directiveName, templateAttrs[directiveName]));
                  compileNode = $compileNode[<span class="hljs-number">0</span>];
                  replaceWith(jqCollection, sliceArgs($template), compileNode);
                  $template[<span class="hljs-number">0</span>].$$parentNode = $template[<span class="hljs-number">0</span>].parentNode;
                  childTranscludeFn = compilationGenerator(mightHaveMultipleTransclusionError, $template, transcludeFn, terminalPriority,
                    replaceDirective &amp;&amp; replaceDirective.name, {
                      <span class="hljs-attr">nonTlbTranscludeDirective</span>: nonTlbTranscludeDirective
                    });
                } <span class="hljs-keyword">else</span> {
                  <span class="hljs-keyword">var</span> slots = createMap();
                  $template = jqLite(jqLiteClone(compileNode)).contents();
                  <span class="hljs-keyword">if</span> (isObject(directiveValue)) {
                    $template = [];
                    <span class="hljs-keyword">var</span> slotMap = createMap();
                    <span class="hljs-keyword">var</span> filledSlots = createMap();
                    forEach(directiveValue, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">elementSelector, slotName</span>) </span>{
                      <span class="hljs-keyword">var</span> optional = (elementSelector.charAt(<span class="hljs-number">0</span>) === <span class="hljs-string">'?'</span>);
                      elementSelector = optional ? elementSelector.substring(<span class="hljs-number">1</span>) : elementSelector;
                      slotMap[elementSelector] = slotName;
                      slots[slotName] = <span class="hljs-literal">null</span>;
                      filledSlots[slotName] = optional;
                    });
                    forEach($compileNode.contents(), <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">node</span>) </span>{
                      <span class="hljs-keyword">var</span> slotName = slotMap[directiveNormalize(nodeName_(node))];
                      <span class="hljs-keyword">if</span> (slotName) {
                        filledSlots[slotName] = <span class="hljs-literal">true</span>;
                        slots[slotName] = slots[slotName] || [];
                        slots[slotName].push(node);
                      } <span class="hljs-keyword">else</span> {
                        $template.push(node);
                      }
                    });
                    forEach(filledSlots, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">filled, slotName</span>) </span>{
                      <span class="hljs-keyword">if</span> (!filled) {
                        <span class="hljs-keyword">throw</span> $compileMinErr(<span class="hljs-string">'reqslot'</span>, <span class="hljs-string">'Required transclusion slot `{0}` was not filled.'</span>, slotName);
                      }
                    });
                    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> slotName <span class="hljs-keyword">in</span> slots) {
                      <span class="hljs-keyword">if</span> (slots[slotName]) {
                        slots[slotName] = compilationGenerator(mightHaveMultipleTransclusionError, slots[slotName], transcludeFn);
                      }
                    }
                  }
                  $compileNode.empty();
                  childTranscludeFn = compilationGenerator(mightHaveMultipleTransclusionError, $template, transcludeFn, <span class="hljs-literal">undefined</span>,
                    <span class="hljs-literal">undefined</span>, {
                      <span class="hljs-attr">needsNewScope</span>: directive.$$isolateScope || directive.$$newScope
                    });
                  childTranscludeFn.$$slots = slots;
                }
              }
              <span class="hljs-keyword">if</span> (directive.template) {
                hasTemplate = <span class="hljs-literal">true</span>;
                assertNoDuplicate(<span class="hljs-string">'template'</span>, templateDirective, directive, $compileNode);
                templateDirective = directive;
                directiveValue = (isFunction(directive.template)) ?
                  directive.template($compileNode, templateAttrs) :
                  directive.template;
                directiveValue = denormalizeTemplate(directiveValue);
                <span class="hljs-keyword">if</span> (directive.replace) {
                  replaceDirective = directive;
                  <span class="hljs-keyword">if</span> (jqLiteIsTextNode(directiveValue)) {
                    $template = [];
                  } <span class="hljs-keyword">else</span> {
                    $template = removeComments(wrapTemplate(directive.templateNamespace, trim(directiveValue)));
                  }
                  compileNode = $template[<span class="hljs-number">0</span>];
                  <span class="hljs-keyword">if</span> ($template.length != <span class="hljs-number">1</span> || compileNode.nodeType !== NODE_TYPE_ELEMENT) {
                    <span class="hljs-keyword">throw</span> $compileMinErr(<span class="hljs-string">'tplrt'</span>,
                      <span class="hljs-string">"Template for directive '{0}' must have exactly one root element. {1}"</span>,
                      directiveName, <span class="hljs-string">''</span>);
                  }
                  replaceWith(jqCollection, $compileNode, compileNode);
                  <span class="hljs-keyword">var</span> newTemplateAttrs = {
                    <span class="hljs-attr">$attr</span>: {}
                  };
                  <span class="hljs-keyword">var</span> templateDirectives = collectDirectives(compileNode, [], newTemplateAttrs);
                  <span class="hljs-keyword">var</span> unprocessedDirectives = directives.splice(i + <span class="hljs-number">1</span>, directives.length - (i + <span class="hljs-number">1</span>));
                  <span class="hljs-keyword">if</span> (newIsolateScopeDirective || newScopeDirective) {
                    markDirectiveScope(templateDirectives, newIsolateScopeDirective, newScopeDirective);
                  }
                  directives = directives.concat(templateDirectives).concat(unprocessedDirectives);
                  mergeTemplateAttributes(templateAttrs, newTemplateAttrs);
                  ii = directives.length;
                } <span class="hljs-keyword">else</span> {
                  $compileNode.html(directiveValue);
                }
              }
              <span class="hljs-keyword">if</span> (directive.templateUrl) {
                hasTemplate = <span class="hljs-literal">true</span>;
                assertNoDuplicate(<span class="hljs-string">'template'</span>, templateDirective, directive, $compileNode);
                templateDirective = directive;
                <span class="hljs-keyword">if</span> (directive.replace) {
                  replaceDirective = directive;
                }
                nodeLinkFn = compileTemplateUrl(directives.splice(i, directives.length - i), $compileNode,
                  templateAttrs, jqCollection, hasTranscludeDirective &amp;&amp; childTranscludeFn, preLinkFns, postLinkFns, {
                    <span class="hljs-attr">controllerDirectives</span>: controllerDirectives,
                    <span class="hljs-attr">newScopeDirective</span>: (newScopeDirective !== directive) &amp;&amp; newScopeDirective,
                    <span class="hljs-attr">newIsolateScopeDirective</span>: newIsolateScopeDirective,
                    <span class="hljs-attr">templateDirective</span>: templateDirective,
                    <span class="hljs-attr">nonTlbTranscludeDirective</span>: nonTlbTranscludeDirective
                  });
                ii = directives.length;
              } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (directive.compile) {
                <span class="hljs-keyword">try</span> {
                  linkFn = directive.compile($compileNode, templateAttrs, childTranscludeFn);
                  <span class="hljs-keyword">if</span> (isFunction(linkFn)) {
                    addLinkFns(<span class="hljs-literal">null</span>, linkFn, attrStart, attrEnd);
                  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (linkFn) {
                    addLinkFns(linkFn.pre, linkFn.post, attrStart, attrEnd);
                  }
                } <span class="hljs-keyword">catch</span> (e) {
                  $exceptionHandler(e, startingTag($compileNode));
                }
              }
              <span class="hljs-keyword">if</span> (directive.terminal) {
                nodeLinkFn.terminal = <span class="hljs-literal">true</span>;
                terminalPriority = <span class="hljs-built_in">Math</span>.max(terminalPriority, directive.priority);
              }
            }
            nodeLinkFn.scope = newScopeDirective &amp;&amp; newScopeDirective.scope === <span class="hljs-literal">true</span>;
            nodeLinkFn.transcludeOnThisElement = hasTranscludeDirective;
            nodeLinkFn.templateOnThisElement = hasTemplate;
            nodeLinkFn.transclude = childTranscludeFn;
            previousCompileContext.hasElementTranscludeDirective = hasElementTranscludeDirective;
            <span class="hljs-keyword">return</span> nodeLinkFn;

            <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addLinkFns</span>(<span class="hljs-params">pre, post, attrStart, attrEnd</span>) </span>{
              <span class="hljs-keyword">if</span> (pre) {
                <span class="hljs-keyword">if</span> (attrStart) pre = groupElementsLinkFnWrapper(pre, attrStart, attrEnd);
                pre.require = directive.require;
                pre.directiveName = directiveName;
                <span class="hljs-keyword">if</span> (newIsolateScopeDirective === directive || directive.$$isolateScope) {
                  pre = cloneAndAnnotateFn(pre, {
                    <span class="hljs-attr">isolateScope</span>: <span class="hljs-literal">true</span>
                  });
                }
                preLinkFns.push(pre);
              }
              <span class="hljs-keyword">if</span> (post) {
                <span class="hljs-keyword">if</span> (attrStart) post = groupElementsLinkFnWrapper(post, attrStart, attrEnd);
                post.require = directive.require;
                post.directiveName = directiveName;
                <span class="hljs-keyword">if</span> (newIsolateScopeDirective === directive || directive.$$isolateScope) {
                  post = cloneAndAnnotateFn(post, {
                    <span class="hljs-attr">isolateScope</span>: <span class="hljs-literal">true</span>
                  });
                }
                postLinkFns.push(post);
              }
            }

            <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">nodeLinkFn</span>(<span class="hljs-params">childLinkFn, scope, linkNode, $rootElement, boundTranscludeFn</span>) </span>{
              <span class="hljs-keyword">var</span> i, ii, linkFn, isolateScope, controllerScope, elementControllers, transcludeFn, $element,
                attrs, removeScopeBindingWatches, removeControllerBindingWatches;
              <span class="hljs-keyword">if</span> (compileNode === linkNode) {
                attrs = templateAttrs;
                $element = templateAttrs.$$element;
              } <span class="hljs-keyword">else</span> {
                $element = jqLite(linkNode);
                attrs = <span class="hljs-keyword">new</span> Attributes($element, templateAttrs);
              }
              controllerScope = scope;
              <span class="hljs-keyword">if</span> (newIsolateScopeDirective) {
                isolateScope = scope.$<span class="hljs-keyword">new</span>(<span class="hljs-literal">true</span>);
              } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (newScopeDirective) {
                controllerScope = scope.$parent;
              }
              <span class="hljs-keyword">if</span> (boundTranscludeFn) {
                transcludeFn = controllersBoundTransclude;
                transcludeFn.$$boundTransclude = boundTranscludeFn;
                transcludeFn.isSlotFilled = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">slotName</span>) </span>{
                  <span class="hljs-keyword">return</span> !!boundTranscludeFn.$$slots[slotName];
                };
              }
              <span class="hljs-keyword">if</span> (controllerDirectives) {
                elementControllers = setupControllers($element, attrs, transcludeFn, controllerDirectives, isolateScope, scope, newIsolateScopeDirective);
              }
              <span class="hljs-keyword">if</span> (newIsolateScopeDirective) {
                compile.$$addScopeInfo($element, isolateScope, <span class="hljs-literal">true</span>, !(templateDirective &amp;&amp; (templateDirective === newIsolateScopeDirective ||
                  templateDirective === newIsolateScopeDirective.$$originalDirective)));
                compile.$$addScopeClass($element, <span class="hljs-literal">true</span>);
                isolateScope.$$isolateBindings =
                  newIsolateScopeDirective.$$isolateBindings;
                removeScopeBindingWatches = initializeDirectiveBindings(scope, attrs, isolateScope,
                  isolateScope.$$isolateBindings,
                  newIsolateScopeDirective);
                <span class="hljs-keyword">if</span> (removeScopeBindingWatches) {
                  isolateScope.$on(<span class="hljs-string">'$destroy'</span>, removeScopeBindingWatches);
                }
              }
              <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> name <span class="hljs-keyword">in</span> elementControllers) {
                <span class="hljs-keyword">var</span> controllerDirective = controllerDirectives[name];
                <span class="hljs-keyword">var</span> controller = elementControllers[name];
                <span class="hljs-keyword">var</span> bindings = controllerDirective.$$bindings.bindToController;
                <span class="hljs-keyword">if</span> (controller.identifier &amp;&amp; bindings) {
                  removeControllerBindingWatches =
                    initializeDirectiveBindings(controllerScope, attrs, controller.instance, bindings, controllerDirective);
                }
                <span class="hljs-keyword">var</span> controllerResult = controller();
                <span class="hljs-keyword">if</span> (controllerResult !== controller.instance) {
                  controller.instance = controllerResult;
                  $element.data(<span class="hljs-string">'$'</span> + controllerDirective.name + <span class="hljs-string">'Controller'</span>, controllerResult);
                  removeControllerBindingWatches &amp;&amp; removeControllerBindingWatches();
                  removeControllerBindingWatches =
                    initializeDirectiveBindings(controllerScope, attrs, controller.instance, bindings, controllerDirective);
                }
              }
              forEach(controllerDirectives, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">controllerDirective, name</span>) </span>{
                <span class="hljs-keyword">var</span> <span class="hljs-built_in">require</span> = controllerDirective.require;
                <span class="hljs-keyword">if</span> (controllerDirective.bindToController &amp;&amp; !isArray(<span class="hljs-built_in">require</span>) &amp;&amp; isObject(<span class="hljs-built_in">require</span>)) {
                  extend(elementControllers[name].instance, getControllers(name, <span class="hljs-built_in">require</span>, $element, elementControllers));
                }
              });
              forEach(elementControllers, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">controller</span>) </span>{
                <span class="hljs-keyword">var</span> controllerInstance = controller.instance;
                <span class="hljs-keyword">if</span> (isFunction(controllerInstance.$onInit)) {
                  controllerInstance.$onInit();
                }
                <span class="hljs-keyword">if</span> (isFunction(controllerInstance.$onDestroy)) {
                  controllerScope.$on(<span class="hljs-string">'$destroy'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">callOnDestroyHook</span>(<span class="hljs-params"></span>) </span>{
                    controllerInstance.$onDestroy();
                  });
                }
              });
              <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>, ii = preLinkFns.length; i &lt; ii; i++) {
                linkFn = preLinkFns[i];
                invokeLinkFn(linkFn,
                  linkFn.isolateScope ? isolateScope : scope,
                  $element,
                  attrs,
                  linkFn.require &amp;&amp; getControllers(linkFn.directiveName, linkFn.require, $element, elementControllers),
                  transcludeFn
                );
              }
              <span class="hljs-keyword">var</span> scopeToChild = scope;
              <span class="hljs-keyword">if</span> (newIsolateScopeDirective &amp;&amp; (newIsolateScopeDirective.template || newIsolateScopeDirective.templateUrl === <span class="hljs-literal">null</span>)) {
                scopeToChild = isolateScope;
              }
              childLinkFn &amp;&amp; childLinkFn(scopeToChild, linkNode.childNodes, <span class="hljs-literal">undefined</span>, boundTranscludeFn);
              <span class="hljs-keyword">for</span> (i = postLinkFns.length - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) {
                linkFn = postLinkFns[i];
                invokeLinkFn(linkFn,
                  linkFn.isolateScope ? isolateScope : scope,
                  $element,
                  attrs,
                  linkFn.require &amp;&amp; getControllers(linkFn.directiveName, linkFn.require, $element, elementControllers),
                  transcludeFn
                );
              }
              forEach(elementControllers, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">controller</span>) </span>{
                <span class="hljs-keyword">var</span> controllerInstance = controller.instance;
                <span class="hljs-keyword">if</span> (isFunction(controllerInstance.$postLink)) {
                  controllerInstance.$postLink();
                }
              });

              <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">controllersBoundTransclude</span>(<span class="hljs-params">scope, cloneAttachFn, futureParentElement, slotName</span>) </span>{
                <span class="hljs-keyword">var</span> transcludeControllers;
                <span class="hljs-keyword">if</span> (!isScope(scope)) {
                  slotName = futureParentElement;
                  futureParentElement = cloneAttachFn;
                  cloneAttachFn = scope;
                  scope = <span class="hljs-literal">undefined</span>;
                }
                <span class="hljs-keyword">if</span> (hasElementTranscludeDirective) {
                  transcludeControllers = elementControllers;
                }
                <span class="hljs-keyword">if</span> (!futureParentElement) {
                  futureParentElement = hasElementTranscludeDirective ? $element.parent() : $element;
                }
                <span class="hljs-keyword">if</span> (slotName) {
                  <span class="hljs-keyword">var</span> slotTranscludeFn = boundTranscludeFn.$$slots[slotName];
                  <span class="hljs-keyword">if</span> (slotTranscludeFn) {
                    <span class="hljs-keyword">return</span> slotTranscludeFn(scope, cloneAttachFn, transcludeControllers, futureParentElement, scopeToChild);
                  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (isUndefined(slotTranscludeFn)) {
                    <span class="hljs-keyword">throw</span> $compileMinErr(<span class="hljs-string">'noslot'</span>,
                      <span class="hljs-string">'No parent directive that requires a transclusion with slot name "{0}". '</span> +
                      <span class="hljs-string">'Element: {1}'</span>,
                      slotName, startingTag($element));
                  }
                } <span class="hljs-keyword">else</span> {
                  <span class="hljs-keyword">return</span> boundTranscludeFn(scope, cloneAttachFn, transcludeControllers, futureParentElement, scopeToChild);
                }
              }
            }
          }

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getControllers</span>(<span class="hljs-params">directiveName, require, $element, elementControllers</span>) </span>{
            <span class="hljs-keyword">var</span> value;
            <span class="hljs-keyword">if</span> (isString(<span class="hljs-built_in">require</span>)) {
              <span class="hljs-keyword">var</span> match = <span class="hljs-built_in">require</span>.match(REQUIRE_PREFIX_REGEXP);
              <span class="hljs-keyword">var</span> name = <span class="hljs-built_in">require</span>.substring(match[<span class="hljs-number">0</span>].length);
              <span class="hljs-keyword">var</span> inheritType = match[<span class="hljs-number">1</span>] || match[<span class="hljs-number">3</span>];
              <span class="hljs-keyword">var</span> optional = match[<span class="hljs-number">2</span>] === <span class="hljs-string">'?'</span>;
              <span class="hljs-keyword">if</span> (inheritType === <span class="hljs-string">'^^'</span>) {
                $element = $element.parent();
              } <span class="hljs-keyword">else</span> {
                value = elementControllers &amp;&amp; elementControllers[name];
                value = value &amp;&amp; value.instance;
              }
              <span class="hljs-keyword">if</span> (!value) {
                <span class="hljs-keyword">var</span> dataName = <span class="hljs-string">'$'</span> + name + <span class="hljs-string">'Controller'</span>;
                value = inheritType ? $element.inheritedData(dataName) : $element.data(dataName);
              }
              <span class="hljs-keyword">if</span> (!value &amp;&amp; !optional) {
                <span class="hljs-keyword">throw</span> $compileMinErr(<span class="hljs-string">'ctreq'</span>,
                  <span class="hljs-string">"Controller '{0}', required by directive '{1}', can't be found!"</span>,
                  name, directiveName);
              }
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (isArray(<span class="hljs-built_in">require</span>)) {
              value = [];
              <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, ii = <span class="hljs-built_in">require</span>.length; i &lt; ii; i++) {
                value[i] = getControllers(directiveName, <span class="hljs-built_in">require</span>[i], $element, elementControllers);
              }
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (isObject(<span class="hljs-built_in">require</span>)) {
              value = {};
              forEach(<span class="hljs-built_in">require</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">controller, property</span>) </span>{
                value[property] = getControllers(directiveName, controller, $element, elementControllers);
              });
            }
            <span class="hljs-keyword">return</span> value || <span class="hljs-literal">null</span>;
          }

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setupControllers</span>(<span class="hljs-params">$element, attrs, transcludeFn, controllerDirectives, isolateScope, scope, newIsolateScopeDirective</span>) </span>{
            <span class="hljs-keyword">var</span> elementControllers = createMap();
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> controllerKey <span class="hljs-keyword">in</span> controllerDirectives) {
              <span class="hljs-keyword">var</span> directive = controllerDirectives[controllerKey];
              <span class="hljs-keyword">var</span> locals = {
                <span class="hljs-attr">$scope</span>: directive === newIsolateScopeDirective || directive.$$isolateScope ? isolateScope : scope,
                <span class="hljs-attr">$element</span>: $element,
                <span class="hljs-attr">$attrs</span>: attrs,
                <span class="hljs-attr">$transclude</span>: transcludeFn
              };
              <span class="hljs-keyword">var</span> controller = directive.controller;
              <span class="hljs-keyword">if</span> (controller == <span class="hljs-string">'@'</span>) {
                controller = attrs[directive.name];
              }
              <span class="hljs-keyword">var</span> controllerInstance = $controller(controller, locals, <span class="hljs-literal">true</span>, directive.controllerAs);
              elementControllers[directive.name] = controllerInstance;
              $element.data(<span class="hljs-string">'$'</span> + directive.name + <span class="hljs-string">'Controller'</span>, controllerInstance.instance);
            }
            <span class="hljs-keyword">return</span> elementControllers;
          }

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">markDirectiveScope</span>(<span class="hljs-params">directives, isolateScope, newScope</span>) </span>{
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> j = <span class="hljs-number">0</span>, jj = directives.length; j &lt; jj; j++) {
              directives[j] = inherit(directives[j], {
                <span class="hljs-attr">$$isolateScope</span>: isolateScope,
                <span class="hljs-attr">$$newScope</span>: newScope
              });
            }
          }

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addDirective</span>(<span class="hljs-params">tDirectives, name, location, maxPriority, ignoreDirective, startAttrName,
            endAttrName</span>) </span>{
            <span class="hljs-keyword">if</span> (name === ignoreDirective) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
            <span class="hljs-keyword">var</span> match = <span class="hljs-literal">null</span>;
            <span class="hljs-keyword">if</span> (hasDirectives.hasOwnProperty(name)) {
              <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> directive, directives = $injector.get(name + Suffix),
                  i = <span class="hljs-number">0</span>, ii = directives.length; i &lt; ii; i++) {
                <span class="hljs-keyword">try</span> {
                  directive = directives[i];
                  <span class="hljs-keyword">if</span> ((isUndefined(maxPriority) || maxPriority &gt; directive.priority) &amp;&amp;
                    directive.restrict.indexOf(location) != <span class="hljs-number">-1</span>) {
                    <span class="hljs-keyword">if</span> (startAttrName) {
                      directive = inherit(directive, {
                        <span class="hljs-attr">$$start</span>: startAttrName,
                        <span class="hljs-attr">$$end</span>: endAttrName
                      });
                    }
                    <span class="hljs-keyword">if</span> (!directive.$$bindings) {
                      <span class="hljs-keyword">var</span> bindings = directive.$$bindings =
                        parseDirectiveBindings(directive, directive.name);
                      <span class="hljs-keyword">if</span> (isObject(bindings.isolateScope)) {
                        directive.$$isolateBindings = bindings.isolateScope;
                      }
                    }
                    tDirectives.push(directive);
                    match = directive;
                  }
                } <span class="hljs-keyword">catch</span> (e) {
                  $exceptionHandler(e);
                }
              }
            }
            <span class="hljs-keyword">return</span> match;
          }

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">directiveIsMultiElement</span>(<span class="hljs-params">name</span>) </span>{
            <span class="hljs-keyword">if</span> (hasDirectives.hasOwnProperty(name)) {
              <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> directive, directives = $injector.get(name + Suffix),
                  i = <span class="hljs-number">0</span>, ii = directives.length; i &lt; ii; i++) {
                directive = directives[i];
                <span class="hljs-keyword">if</span> (directive.multiElement) {
                  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
                }
              }
            }
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
          }

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">mergeTemplateAttributes</span>(<span class="hljs-params">dst, src</span>) </span>{
            <span class="hljs-keyword">var</span> srcAttr = src.$attr,
              dstAttr = dst.$attr,
              $element = dst.$$element;
            forEach(dst, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value, key</span>) </span>{
              <span class="hljs-keyword">if</span> (key.charAt(<span class="hljs-number">0</span>) != <span class="hljs-string">'$'</span>) {
                <span class="hljs-keyword">if</span> (src[key] &amp;&amp; src[key] !== value) {
                  value += (key === <span class="hljs-string">'style'</span> ? <span class="hljs-string">';'</span> : <span class="hljs-string">' '</span>) + src[key];
                }
                dst.$set(key, value, <span class="hljs-literal">true</span>, srcAttr[key]);
              }
            });
            forEach(src, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value, key</span>) </span>{
              <span class="hljs-keyword">if</span> (key == <span class="hljs-string">'class'</span>) {
                safeAddClass($element, value);
                dst[<span class="hljs-string">'class'</span>] = (dst[<span class="hljs-string">'class'</span>] ? dst[<span class="hljs-string">'class'</span>] + <span class="hljs-string">' '</span> : <span class="hljs-string">''</span>) + value;
              } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (key == <span class="hljs-string">'style'</span>) {
                $element.attr(<span class="hljs-string">'style'</span>, $element.attr(<span class="hljs-string">'style'</span>) + <span class="hljs-string">';'</span> + value);
                dst[<span class="hljs-string">'style'</span>] = (dst[<span class="hljs-string">'style'</span>] ? dst[<span class="hljs-string">'style'</span>] + <span class="hljs-string">';'</span> : <span class="hljs-string">''</span>) + value;
              } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (key.charAt(<span class="hljs-number">0</span>) != <span class="hljs-string">'$'</span> &amp;&amp; !dst.hasOwnProperty(key)) {
                dst[key] = value;
                dstAttr[key] = srcAttr[key];
              }
            });
          }

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">compileTemplateUrl</span>(<span class="hljs-params">directives, $compileNode, tAttrs,
            $rootElement, childTranscludeFn, preLinkFns, postLinkFns, previousCompileContext</span>) </span>{
            <span class="hljs-keyword">var</span> linkQueue = [],
              afterTemplateNodeLinkFn,
              afterTemplateChildLinkFn,
              beforeTemplateCompileNode = $compileNode[<span class="hljs-number">0</span>],
              origAsyncDirective = directives.shift(),
              derivedSyncDirective = inherit(origAsyncDirective, {
                <span class="hljs-attr">templateUrl</span>: <span class="hljs-literal">null</span>,
                <span class="hljs-attr">transclude</span>: <span class="hljs-literal">null</span>,
                <span class="hljs-attr">replace</span>: <span class="hljs-literal">null</span>,
                <span class="hljs-attr">$$originalDirective</span>: origAsyncDirective
              }),
              templateUrl = (isFunction(origAsyncDirective.templateUrl)) ?
              origAsyncDirective.templateUrl($compileNode, tAttrs) :
              origAsyncDirective.templateUrl,
              templateNamespace = origAsyncDirective.templateNamespace;
            $compileNode.empty();
            $templateRequest(templateUrl)
              .then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">content</span>) </span>{
                <span class="hljs-keyword">var</span> compileNode, tempTemplateAttrs, $template, childBoundTranscludeFn;
                content = denormalizeTemplate(content);
                <span class="hljs-keyword">if</span> (origAsyncDirective.replace) {
                  <span class="hljs-keyword">if</span> (jqLiteIsTextNode(content)) {
                    $template = [];
                  } <span class="hljs-keyword">else</span> {
                    $template = removeComments(wrapTemplate(templateNamespace, trim(content)));
                  }
                  compileNode = $template[<span class="hljs-number">0</span>];
                  <span class="hljs-keyword">if</span> ($template.length != <span class="hljs-number">1</span> || compileNode.nodeType !== NODE_TYPE_ELEMENT) {
                    <span class="hljs-keyword">throw</span> $compileMinErr(<span class="hljs-string">'tplrt'</span>,
                      <span class="hljs-string">"Template for directive '{0}' must have exactly one root element. {1}"</span>,
                      origAsyncDirective.name, templateUrl);
                  }
                  tempTemplateAttrs = {
                    <span class="hljs-attr">$attr</span>: {}
                  };
                  replaceWith($rootElement, $compileNode, compileNode);
                  <span class="hljs-keyword">var</span> templateDirectives = collectDirectives(compileNode, [], tempTemplateAttrs);
                  <span class="hljs-keyword">if</span> (isObject(origAsyncDirective.scope)) {
                    markDirectiveScope(templateDirectives, <span class="hljs-literal">true</span>);
                  }
                  directives = templateDirectives.concat(directives);
                  mergeTemplateAttributes(tAttrs, tempTemplateAttrs);
                } <span class="hljs-keyword">else</span> {
                  compileNode = beforeTemplateCompileNode;
                  $compileNode.html(content);
                }
                directives.unshift(derivedSyncDirective);
                afterTemplateNodeLinkFn = applyDirectivesToNode(directives, compileNode, tAttrs,
                  childTranscludeFn, $compileNode, origAsyncDirective, preLinkFns, postLinkFns,
                  previousCompileContext);
                forEach($rootElement, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">node, i</span>) </span>{
                  <span class="hljs-keyword">if</span> (node == compileNode) {
                    $rootElement[i] = $compileNode[<span class="hljs-number">0</span>];
                  }
                });
                afterTemplateChildLinkFn = compileNodes($compileNode[<span class="hljs-number">0</span>].childNodes, childTranscludeFn);
                <span class="hljs-keyword">while</span> (linkQueue.length) {
                  <span class="hljs-keyword">var</span> scope = linkQueue.shift(),
                    beforeTemplateLinkNode = linkQueue.shift(),
                    linkRootElement = linkQueue.shift(),
                    boundTranscludeFn = linkQueue.shift(),
                    linkNode = $compileNode[<span class="hljs-number">0</span>];
                  <span class="hljs-keyword">if</span> (scope.$$destroyed) <span class="hljs-keyword">continue</span>;
                  <span class="hljs-keyword">if</span> (beforeTemplateLinkNode !== beforeTemplateCompileNode) {
                    <span class="hljs-keyword">var</span> oldClasses = beforeTemplateLinkNode.className;
                    <span class="hljs-keyword">if</span> (!(previousCompileContext.hasElementTranscludeDirective &amp;&amp;
                        origAsyncDirective.replace)) {
                      linkNode = jqLiteClone(compileNode);
                    }
                    replaceWith(linkRootElement, jqLite(beforeTemplateLinkNode), linkNode);
                    safeAddClass(jqLite(linkNode), oldClasses);
                  }
                  <span class="hljs-keyword">if</span> (afterTemplateNodeLinkFn.transcludeOnThisElement) {
                    childBoundTranscludeFn = createBoundTranscludeFn(scope, afterTemplateNodeLinkFn.transclude, boundTranscludeFn);
                  } <span class="hljs-keyword">else</span> {
                    childBoundTranscludeFn = boundTranscludeFn;
                  }
                  afterTemplateNodeLinkFn(afterTemplateChildLinkFn, scope, linkNode, $rootElement,
                    childBoundTranscludeFn);
                }
                linkQueue = <span class="hljs-literal">null</span>;
              });
            <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">delayedNodeLinkFn</span>(<span class="hljs-params">ignoreChildLinkFn, scope, node, rootElement, boundTranscludeFn</span>) </span>{
              <span class="hljs-keyword">var</span> childBoundTranscludeFn = boundTranscludeFn;
              <span class="hljs-keyword">if</span> (scope.$$destroyed) <span class="hljs-keyword">return</span>;
              <span class="hljs-keyword">if</span> (linkQueue) {
                linkQueue.push(scope,
                  node,
                  rootElement,
                  childBoundTranscludeFn);
              } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">if</span> (afterTemplateNodeLinkFn.transcludeOnThisElement) {
                  childBoundTranscludeFn = createBoundTranscludeFn(scope, afterTemplateNodeLinkFn.transclude, boundTranscludeFn);
                }
                afterTemplateNodeLinkFn(afterTemplateChildLinkFn, scope, node, rootElement, childBoundTranscludeFn);
              }
            };
          }

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">byPriority</span>(<span class="hljs-params">a, b</span>) </span>{
            <span class="hljs-keyword">var</span> diff = b.priority - a.priority;
            <span class="hljs-keyword">if</span> (diff !== <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> diff;
            <span class="hljs-keyword">if</span> (a.name !== b.name) <span class="hljs-keyword">return</span> (a.name &lt; b.name) ? <span class="hljs-number">-1</span> : <span class="hljs-number">1</span>;
            <span class="hljs-keyword">return</span> a.index - b.index;
          }

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">assertNoDuplicate</span>(<span class="hljs-params">what, previousDirective, directive, element</span>) </span>{
            <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">wrapModuleNameIfDefined</span>(<span class="hljs-params">moduleName</span>) </span>{
              <span class="hljs-keyword">return</span> moduleName ?
                (<span class="hljs-string">' (module: '</span> + moduleName + <span class="hljs-string">')'</span>) :
                <span class="hljs-string">''</span>;
            }
            <span class="hljs-keyword">if</span> (previousDirective) {
              <span class="hljs-keyword">throw</span> $compileMinErr(<span class="hljs-string">'multidir'</span>, <span class="hljs-string">'Multiple directives [{0}{1}, {2}{3}] asking for {4} on: {5}'</span>,
                previousDirective.name, wrapModuleNameIfDefined(previousDirective.$$moduleName),
                directive.name, wrapModuleNameIfDefined(directive.$$moduleName), what, startingTag(element));
            }
          }

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addTextInterpolateDirective</span>(<span class="hljs-params">directives, text</span>) </span>{
            <span class="hljs-keyword">var</span> interpolateFn = $interpolate(text, <span class="hljs-literal">true</span>);
            <span class="hljs-keyword">if</span> (interpolateFn) {
              directives.push({
                <span class="hljs-attr">priority</span>: <span class="hljs-number">0</span>,
                <span class="hljs-attr">compile</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">textInterpolateCompileFn</span>(<span class="hljs-params">templateNode</span>) </span>{
                  <span class="hljs-keyword">var</span> templateNodeParent = templateNode.parent(),
                    hasCompileParent = !!templateNodeParent.length;
                  <span class="hljs-keyword">if</span> (hasCompileParent) compile.$$addBindingClass(templateNodeParent);
                  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">textInterpolateLinkFn</span>(<span class="hljs-params">scope, node</span>) </span>{
                    <span class="hljs-keyword">var</span> parent = node.parent();
                    <span class="hljs-keyword">if</span> (!hasCompileParent) compile.$$addBindingClass(parent);
                    compile.$$addBindingInfo(parent, interpolateFn.expressions);
                    scope.$watch(interpolateFn, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">interpolateFnWatchAction</span>(<span class="hljs-params">value</span>) </span>{
                      node[<span class="hljs-number">0</span>].nodeValue = value;
                    });
                  };
                }
              });
            }
          }

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">wrapTemplate</span>(<span class="hljs-params">type, template</span>) </span>{
            type = lowercase(type || <span class="hljs-string">'html'</span>);
            <span class="hljs-keyword">switch</span> (type) {
              <span class="hljs-keyword">case</span> <span class="hljs-string">'svg'</span>:
              <span class="hljs-keyword">case</span> <span class="hljs-string">'math'</span>:
                <span class="hljs-keyword">var</span> wrapper = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'div'</span>);
                wrapper.innerHTML = <span class="hljs-string">'&lt;'</span> + type + <span class="hljs-string">'&gt;'</span> + template + <span class="hljs-string">'&lt;/'</span> + type + <span class="hljs-string">'&gt;'</span>;
                <span class="hljs-keyword">return</span> wrapper.childNodes[<span class="hljs-number">0</span>].childNodes;
              <span class="hljs-keyword">default</span>:
                <span class="hljs-keyword">return</span> template;
            }
          }

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getTrustedContext</span>(<span class="hljs-params">node, attrNormalizedName</span>) </span>{
            <span class="hljs-keyword">if</span> (attrNormalizedName == <span class="hljs-string">"srcdoc"</span>) {
              <span class="hljs-keyword">return</span> $sce.HTML;
            }
            <span class="hljs-keyword">var</span> tag = nodeName_(node);
            <span class="hljs-keyword">if</span> (attrNormalizedName == <span class="hljs-string">"xlinkHref"</span> ||
              (tag == <span class="hljs-string">"form"</span> &amp;&amp; attrNormalizedName == <span class="hljs-string">"action"</span>) ||
              (tag != <span class="hljs-string">"img"</span> &amp;&amp; (attrNormalizedName == <span class="hljs-string">"src"</span> ||
                attrNormalizedName == <span class="hljs-string">"ngSrc"</span>))) {
              <span class="hljs-keyword">return</span> $sce.RESOURCE_URL;
            }
          }

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addAttrInterpolateDirective</span>(<span class="hljs-params">node, directives, value, name, allOrNothing</span>) </span>{
            <span class="hljs-keyword">var</span> trustedContext = getTrustedContext(node, name);
            allOrNothing = ALL_OR_NOTHING_ATTRS[name] || allOrNothing;
            <span class="hljs-keyword">var</span> interpolateFn = $interpolate(value, <span class="hljs-literal">true</span>, trustedContext, allOrNothing);
            <span class="hljs-keyword">if</span> (!interpolateFn) <span class="hljs-keyword">return</span>;
            <span class="hljs-keyword">if</span> (name === <span class="hljs-string">"multiple"</span> &amp;&amp; nodeName_(node) === <span class="hljs-string">"select"</span>) {
              <span class="hljs-keyword">throw</span> $compileMinErr(<span class="hljs-string">"selmulti"</span>,
                <span class="hljs-string">"Binding to the 'multiple' attribute is not supported. Element: {0}"</span>,
                startingTag(node));
            }
            directives.push({
              <span class="hljs-attr">priority</span>: <span class="hljs-number">100</span>,
              <span class="hljs-attr">compile</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                <span class="hljs-keyword">return</span> {
                  <span class="hljs-attr">pre</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">attrInterpolatePreLinkFn</span>(<span class="hljs-params">scope, element, attr</span>) </span>{
                    <span class="hljs-keyword">var</span> $$observers = (attr.$$observers || (attr.$$observers = createMap()));
                    <span class="hljs-keyword">if</span> (EVENT_HANDLER_ATTR_REGEXP.test(name)) {
                      <span class="hljs-keyword">throw</span> $compileMinErr(<span class="hljs-string">'nodomevents'</span>,
                        <span class="hljs-string">"Interpolations for HTML DOM event attributes are disallowed.  Please use the "</span> +
                        <span class="hljs-string">"ng- versions (such as ng-click instead of onclick) instead."</span>);
                    }
                    <span class="hljs-keyword">var</span> newValue = attr[name];
                    <span class="hljs-keyword">if</span> (newValue !== value) {
                      interpolateFn = newValue &amp;&amp; $interpolate(newValue, <span class="hljs-literal">true</span>, trustedContext, allOrNothing);
                      value = newValue;
                    }
                    <span class="hljs-keyword">if</span> (!interpolateFn) <span class="hljs-keyword">return</span>;
                    attr[name] = interpolateFn(scope);
                    ($$observers[name] || ($$observers[name] = [])).$$inter = <span class="hljs-literal">true</span>;
                    (attr.$$observers &amp;&amp; attr.$$observers[name].$$scope || scope).
                    $watch(interpolateFn, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">interpolateFnWatchAction</span>(<span class="hljs-params">newValue, oldValue</span>) </span>{
                      <span class="hljs-keyword">if</span> (name === <span class="hljs-string">'class'</span> &amp;&amp; newValue != oldValue) {
                        attr.$updateClass(newValue, oldValue);
                      } <span class="hljs-keyword">else</span> {
                        attr.$set(name, newValue);
                      }
                    });
                  }
                };
              }
            });
          }

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">replaceWith</span>(<span class="hljs-params">$rootElement, elementsToRemove, newNode</span>) </span>{
            <span class="hljs-keyword">var</span> firstElementToRemove = elementsToRemove[<span class="hljs-number">0</span>],
              removeCount = elementsToRemove.length,
              parent = firstElementToRemove.parentNode,
              i, ii;
            <span class="hljs-keyword">if</span> ($rootElement) {
              <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>, ii = $rootElement.length; i &lt; ii; i++) {
                <span class="hljs-keyword">if</span> ($rootElement[i] == firstElementToRemove) {
                  $rootElement[i++] = newNode;
                  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> j = i, j2 = j + removeCount - <span class="hljs-number">1</span>,
                      jj = $rootElement.length; j &lt; jj; j++, j2++) {
                    <span class="hljs-keyword">if</span> (j2 &lt; jj) {
                      $rootElement[j] = $rootElement[j2];
                    } <span class="hljs-keyword">else</span> {
                      <span class="hljs-keyword">delete</span> $rootElement[j];
                    }
                  }
                  $rootElement.length -= removeCount - <span class="hljs-number">1</span>;
                  <span class="hljs-keyword">if</span> ($rootElement.context === firstElementToRemove) {
                    $rootElement.context = newNode;
                  }
                  <span class="hljs-keyword">break</span>;
                }
              }
            }
            <span class="hljs-keyword">if</span> (parent) {
              parent.replaceChild(newNode, firstElementToRemove);
            }
            <span class="hljs-keyword">var</span> fragment = <span class="hljs-built_in">document</span>.createDocumentFragment();
            <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; removeCount; i++) {
              fragment.appendChild(elementsToRemove[i]);
            }
            <span class="hljs-keyword">if</span> (jqLite.hasData(firstElementToRemove)) {
              jqLite.data(newNode, jqLite.data(firstElementToRemove));
              jqLite(firstElementToRemove).off(<span class="hljs-string">'$destroy'</span>);
            }
            jqLite.cleanData(fragment.querySelectorAll(<span class="hljs-string">'*'</span>));
            <span class="hljs-keyword">for</span> (i = <span class="hljs-number">1</span>; i &lt; removeCount; i++) {
              <span class="hljs-keyword">delete</span> elementsToRemove[i];
            }
            elementsToRemove[<span class="hljs-number">0</span>] = newNode;
            elementsToRemove.length = <span class="hljs-number">1</span>;
          }

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">cloneAndAnnotateFn</span>(<span class="hljs-params">fn, annotation</span>) </span>{
            <span class="hljs-keyword">return</span> extend(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
              <span class="hljs-keyword">return</span> fn.apply(<span class="hljs-literal">null</span>, <span class="hljs-built_in">arguments</span>);
            }, fn, annotation);
          }

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">invokeLinkFn</span>(<span class="hljs-params">linkFn, scope, $element, attrs, controllers, transcludeFn</span>) </span>{
            <span class="hljs-keyword">try</span> {
              linkFn(scope, $element, attrs, controllers, transcludeFn);
            } <span class="hljs-keyword">catch</span> (e) {
              $exceptionHandler(e, startingTag($element));
            }
          }

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">initializeDirectiveBindings</span>(<span class="hljs-params">scope, attrs, destination, bindings, directive</span>) </span>{
            <span class="hljs-keyword">var</span> removeWatchCollection = [];
            <span class="hljs-keyword">var</span> changes;
            forEach(bindings, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">initializeBinding</span>(<span class="hljs-params">definition, scopeName</span>) </span>{
              <span class="hljs-keyword">var</span> attrName = definition.attrName,
                optional = definition.optional,
                mode = definition.mode,
                lastValue,
                parentGet, parentSet, compare, removeWatch;
              <span class="hljs-keyword">switch</span> (mode) {
                <span class="hljs-keyword">case</span> <span class="hljs-string">'@'</span>:
                  <span class="hljs-keyword">if</span> (!optional &amp;&amp; !hasOwnProperty.call(attrs, attrName)) {
                    destination[scopeName] = attrs[attrName] = <span class="hljs-keyword">void</span> <span class="hljs-number">0</span>;
                  }
                  attrs.$observe(attrName, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>) </span>{
                    <span class="hljs-keyword">if</span> (isString(value)) {
                      <span class="hljs-keyword">var</span> oldValue = destination[scopeName];
                      recordChanges(scopeName, value, oldValue);
                      destination[scopeName] = value;
                    }
                  });
                  attrs.$$observers[attrName].$$scope = scope;
                  lastValue = attrs[attrName];
                  <span class="hljs-keyword">if</span> (isString(lastValue)) {
                    destination[scopeName] = $interpolate(lastValue)(scope);
                  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (isBoolean(lastValue)) {
                    destination[scopeName] = lastValue;
                  }
                  <span class="hljs-keyword">break</span>;
                <span class="hljs-keyword">case</span> <span class="hljs-string">'='</span>:
                  <span class="hljs-keyword">if</span> (!hasOwnProperty.call(attrs, attrName)) {
                    <span class="hljs-keyword">if</span> (optional) <span class="hljs-keyword">break</span>;
                    attrs[attrName] = <span class="hljs-keyword">void</span> <span class="hljs-number">0</span>;
                  }
                  <span class="hljs-keyword">if</span> (optional &amp;&amp; !attrs[attrName]) <span class="hljs-keyword">break</span>;
                  parentGet = $parse(attrs[attrName]);
                  <span class="hljs-keyword">if</span> (parentGet.literal) {
                    compare = equals;
                  } <span class="hljs-keyword">else</span> {
                    compare = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">simpleCompare</span>(<span class="hljs-params">a, b</span>) </span>{
                      <span class="hljs-keyword">return</span> a === b || (a !== a &amp;&amp; b !== b);
                    };
                  }
                  parentSet = parentGet.assign || <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                    lastValue = destination[scopeName] = parentGet(scope);
                    <span class="hljs-keyword">throw</span> $compileMinErr(<span class="hljs-string">'nonassign'</span>,
                      <span class="hljs-string">"Expression '{0}' in attribute '{1}' used with directive '{2}' is non-assignable!"</span>,
                      attrs[attrName], attrName, directive.name);
                  };
                  lastValue = destination[scopeName] = parentGet(scope);
                  <span class="hljs-keyword">var</span> parentValueWatch = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">parentValueWatch</span>(<span class="hljs-params">parentValue</span>) </span>{
                    <span class="hljs-keyword">if</span> (!compare(parentValue, destination[scopeName])) {
                      <span class="hljs-keyword">if</span> (!compare(parentValue, lastValue)) {
                        destination[scopeName] = parentValue;
                      } <span class="hljs-keyword">else</span> {
                        parentSet(scope, parentValue = destination[scopeName]);
                      }
                    }
                    <span class="hljs-keyword">return</span> lastValue = parentValue;
                  };
                  parentValueWatch.$stateful = <span class="hljs-literal">true</span>;
                  <span class="hljs-keyword">if</span> (definition.collection) {
                    removeWatch = scope.$watchCollection(attrs[attrName], parentValueWatch);
                  } <span class="hljs-keyword">else</span> {
                    removeWatch = scope.$watch($parse(attrs[attrName], parentValueWatch), <span class="hljs-literal">null</span>, parentGet.literal);
                  }
                  removeWatchCollection.push(removeWatch);
                  <span class="hljs-keyword">break</span>;
                <span class="hljs-keyword">case</span> <span class="hljs-string">'&lt;'</span>:
                  <span class="hljs-keyword">if</span> (!hasOwnProperty.call(attrs, attrName)) {
                    <span class="hljs-keyword">if</span> (optional) <span class="hljs-keyword">break</span>;
                    attrs[attrName] = <span class="hljs-keyword">void</span> <span class="hljs-number">0</span>;
                  }
                  <span class="hljs-keyword">if</span> (optional &amp;&amp; !attrs[attrName]) <span class="hljs-keyword">break</span>;
                  parentGet = $parse(attrs[attrName]);
                  destination[scopeName] = parentGet(scope);
                  removeWatch = scope.$watch(parentGet, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">parentValueWatchAction</span>(<span class="hljs-params">newParentValue</span>) </span>{
                    <span class="hljs-keyword">var</span> oldValue = destination[scopeName];
                    recordChanges(scopeName, newParentValue, oldValue);
                    destination[scopeName] = newParentValue;
                  }, parentGet.literal);
                  removeWatchCollection.push(removeWatch);
                  <span class="hljs-keyword">break</span>;
                <span class="hljs-keyword">case</span> <span class="hljs-string">'&amp;'</span>:
                  parentGet = attrs.hasOwnProperty(attrName) ? $parse(attrs[attrName]) : noop;
                  <span class="hljs-keyword">if</span> (parentGet === noop &amp;&amp; optional) <span class="hljs-keyword">break</span>;
                  destination[scopeName] = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">locals</span>) </span>{
                    <span class="hljs-keyword">return</span> parentGet(scope, locals);
                  };
                  <span class="hljs-keyword">break</span>;
              }
            });

            <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">recordChanges</span>(<span class="hljs-params">key, currentValue, previousValue</span>) </span>{
              <span class="hljs-keyword">if</span> (isFunction(destination.$onChanges) &amp;&amp; currentValue !== previousValue) {
                <span class="hljs-keyword">if</span> (!onChangesQueue) {
                  scope.$$postDigest(flushOnChangesQueue);
                  onChangesQueue = [];
                }
                <span class="hljs-keyword">if</span> (!changes) {
                  changes = {};
                  onChangesQueue.push(triggerOnChangesHook);
                }
                <span class="hljs-keyword">if</span> (changes[key]) {
                  previousValue = changes[key].previousValue;
                }
                changes[key] = {
                  <span class="hljs-attr">previousValue</span>: previousValue,
                  <span class="hljs-attr">currentValue</span>: currentValue
                };
              }
            }

            <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">triggerOnChangesHook</span>(<span class="hljs-params"></span>) </span>{
              destination.$onChanges(changes);
              changes = <span class="hljs-literal">undefined</span>;
            }
            <span class="hljs-keyword">return</span> removeWatchCollection.length &amp;&amp; <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">removeWatches</span>(<span class="hljs-params"></span>) </span>{
              <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, ii = removeWatchCollection.length; i &lt; ii; ++i) {
                removeWatchCollection[i]();
              }
            };
          }
        }
      ];
    }
    <span class="hljs-keyword">var</span> PREFIX_REGEXP = <span class="hljs-regexp">/^((?:x|data)[\:\-_])/i</span>;

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">directiveNormalize</span>(<span class="hljs-params">name</span>) </span>{
      <span class="hljs-keyword">return</span> camelCase(name.replace(PREFIX_REGEXP, <span class="hljs-string">''</span>));
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">nodesetLinkingFn</span>(<span class="hljs-params">
      scope,
      nodeList,
      rootElement,
      boundTranscludeFn
    </span>) </span>{}

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">directiveLinkingFn</span>(<span class="hljs-params">
      nodesetLinkingFn,
      scope,
      node,
      rootElement,
      boundTranscludeFn
    </span>) </span>{}

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">tokenDifference</span>(<span class="hljs-params">str1, str2</span>) </span>{
      <span class="hljs-keyword">var</span> values = <span class="hljs-string">''</span>,
        tokens1 = str1.split(<span class="hljs-regexp">/\s+/</span>),
        tokens2 = str2.split(<span class="hljs-regexp">/\s+/</span>);
      outer:
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; tokens1.length; i++) {
          <span class="hljs-keyword">var</span> token = tokens1[i];
          <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> j = <span class="hljs-number">0</span>; j &lt; tokens2.length; j++) {
            <span class="hljs-keyword">if</span> (token == tokens2[j]) <span class="hljs-keyword">continue</span> outer;
          }
          values += (values.length &gt; <span class="hljs-number">0</span> ? <span class="hljs-string">' '</span> : <span class="hljs-string">''</span>) + token;
        }
      <span class="hljs-keyword">return</span> values;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">removeComments</span>(<span class="hljs-params">jqNodes</span>) </span>{
      jqNodes = jqLite(jqNodes);
      <span class="hljs-keyword">var</span> i = jqNodes.length;
      <span class="hljs-keyword">if</span> (i &lt;= <span class="hljs-number">1</span>) {
        <span class="hljs-keyword">return</span> jqNodes;
      }
      <span class="hljs-keyword">while</span> (i--) {
        <span class="hljs-keyword">var</span> node = jqNodes[i];
        <span class="hljs-keyword">if</span> (node.nodeType === NODE_TYPE_COMMENT) {
          splice.call(jqNodes, i, <span class="hljs-number">1</span>);
        }
      }
      <span class="hljs-keyword">return</span> jqNodes;
    }
    <span class="hljs-keyword">var</span> $controllerMinErr = minErr(<span class="hljs-string">'$controller'</span>);
    <span class="hljs-keyword">var</span> CNTRL_REG = <span class="hljs-regexp">/^(\S+)(\s+as\s+([\w$]+))?$/</span>;

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">identifierForController</span>(<span class="hljs-params">controller, ident</span>) </span>{
      <span class="hljs-keyword">if</span> (ident &amp;&amp; isString(ident)) <span class="hljs-keyword">return</span> ident;
      <span class="hljs-keyword">if</span> (isString(controller)) {
        <span class="hljs-keyword">var</span> match = CNTRL_REG.exec(controller);
        <span class="hljs-keyword">if</span> (match) <span class="hljs-keyword">return</span> match[<span class="hljs-number">3</span>];
      }
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$ControllerProvider</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> controllers = {},
        globals = <span class="hljs-literal">false</span>;
      <span class="hljs-keyword">this</span>.has = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name</span>) </span>{
        <span class="hljs-keyword">return</span> controllers.hasOwnProperty(name);
      };
      <span class="hljs-keyword">this</span>.register = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name, constructor</span>) </span>{
        assertNotHasOwnProperty(name, <span class="hljs-string">'controller'</span>);
        <span class="hljs-keyword">if</span> (isObject(name)) {
          extend(controllers, name);
        } <span class="hljs-keyword">else</span> {
          controllers[name] = <span class="hljs-keyword">constructor</span>;
        }
      };
      this.allowGlobals = function() {
        globals = <span class="hljs-literal">true</span>;
      };
      <span class="hljs-keyword">this</span>.$get = [<span class="hljs-string">'$injector'</span>, <span class="hljs-string">'$window'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$injector, $window</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$controller</span>(<span class="hljs-params">expression, locals, later, ident</span>) </span>{
          <span class="hljs-keyword">var</span> instance, match, <span class="hljs-keyword">constructor</span>, identifier;
          later = later === true;
          if (ident &amp;&amp; isString(ident)) {
            identifier = ident;
          }
          <span class="hljs-keyword">if</span> (isString(expression)) {
            match = expression.match(CNTRL_REG);
            <span class="hljs-keyword">if</span> (!match) {
              <span class="hljs-keyword">throw</span> $controllerMinErr(<span class="hljs-string">'ctrlfmt'</span>,
                <span class="hljs-string">"Badly formed controller string '{0}'. "</span> +
                <span class="hljs-string">"Must match `__name__ as __id__` or `__name__`."</span>, expression);
            }
            <span class="hljs-keyword">constructor</span> = match[1],
              identifier = identifier || match[3];
            expression = controllers.hasOwnProperty(<span class="hljs-keyword">constructor</span>) ?
              controllers[<span class="hljs-keyword">constructor</span>] :
              getter(locals.$scope, <span class="hljs-keyword">constructor</span>, true) ||
              (globals ? getter($window, <span class="hljs-keyword">constructor</span>, true) : undefined);
            assertArgFn(expression, <span class="hljs-keyword">constructor</span>, true);
          }
          if (later) {
            <span class="hljs-keyword">var</span> controllerPrototype = (isArray(expression) ?
              expression[expression.length - <span class="hljs-number">1</span>] : expression).prototype;
            instance = <span class="hljs-built_in">Object</span>.create(controllerPrototype || <span class="hljs-literal">null</span>);
            <span class="hljs-keyword">if</span> (identifier) {
              addIdentifier(locals, identifier, instance, <span class="hljs-keyword">constructor</span> || expression.name);
            }
            var instantiate;
            return instantiate = extend(function $controllerInit() {
              <span class="hljs-keyword">var</span> result = $injector.invoke(expression, instance, locals, <span class="hljs-keyword">constructor</span>);
              if (result !== instance &amp;&amp; (isObject(result) || isFunction(result))) {
                instance = result;
                <span class="hljs-keyword">if</span> (identifier) {
                  addIdentifier(locals, identifier, instance, <span class="hljs-keyword">constructor</span> || expression.name);
                }
              }
              return instance;
            }, {
              instance: instance,
              <span class="hljs-attr">identifier</span>: identifier
            });
          }
          instance = $injector.instantiate(expression, locals, <span class="hljs-keyword">constructor</span>);
          if (identifier) {
            addIdentifier(locals, identifier, instance, <span class="hljs-keyword">constructor</span> || expression.name);
          }
          return instance;
        };

        function addIdentifier(locals, identifier, instance, name) {
          <span class="hljs-keyword">if</span> (!(locals &amp;&amp; isObject(locals.$scope))) {
            <span class="hljs-keyword">throw</span> minErr(<span class="hljs-string">'$controller'</span>)(<span class="hljs-string">'noscp'</span>,
              <span class="hljs-string">"Cannot export controller '{0}' as '{1}'! No $scope object provided via `locals`."</span>,
              name, identifier);
          }
          locals.$scope[identifier] = instance;
        }
      }];
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$DocumentProvider</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">this</span>.$get = [<span class="hljs-string">'$window'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">window</span>) </span>{
        <span class="hljs-keyword">return</span> jqLite(<span class="hljs-built_in">window</span>.document);
      }];
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$ExceptionHandlerProvider</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">this</span>.$get = [<span class="hljs-string">'$log'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$log</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">exception, cause</span>) </span>{
          $log.error.apply($log, <span class="hljs-built_in">arguments</span>);
        };
      }];
    }
    <span class="hljs-keyword">var</span> $$ForceReflowProvider = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">this</span>.$get = [<span class="hljs-string">'$document'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$document</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">domNode</span>) </span>{
          <span class="hljs-keyword">if</span> (domNode) {
            <span class="hljs-keyword">if</span> (!domNode.nodeType &amp;&amp; domNode <span class="hljs-keyword">instanceof</span> jqLite) {
              domNode = domNode[<span class="hljs-number">0</span>];
            }
          } <span class="hljs-keyword">else</span> {
            domNode = $<span class="hljs-built_in">document</span>[<span class="hljs-number">0</span>].body;
          }
          <span class="hljs-keyword">return</span> domNode.offsetWidth + <span class="hljs-number">1</span>;
        };
      }];
    };
    <span class="hljs-keyword">var</span> APPLICATION_JSON = <span class="hljs-string">'application/json'</span>;
    <span class="hljs-keyword">var</span> CONTENT_TYPE_APPLICATION_JSON = {
      <span class="hljs-string">'Content-Type'</span>: APPLICATION_JSON + <span class="hljs-string">';charset=utf-8'</span>
    };
    <span class="hljs-keyword">var</span> JSON_START = <span class="hljs-regexp">/^\[|^\{(?!\{)/</span>;
    <span class="hljs-keyword">var</span> JSON_ENDS = {
      <span class="hljs-string">'['</span>: <span class="hljs-regexp">/]$/</span>,
      <span class="hljs-string">'{'</span>: <span class="hljs-regexp">/}$/</span>
    };
    <span class="hljs-keyword">var</span> JSON_PROTECTION_PREFIX = <span class="hljs-regexp">/^\)\]\}',?\n/</span>;
    <span class="hljs-keyword">var</span> $httpMinErr = minErr(<span class="hljs-string">'$http'</span>);
    <span class="hljs-keyword">var</span> $httpMinErrLegacyFn = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">method</span>) </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">throw</span> $httpMinErr(<span class="hljs-string">'legacy'</span>, <span class="hljs-string">'The method `{0}` on the promise returned from `$http` has been disabled.'</span>, method);
      };
    };

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">serializeValue</span>(<span class="hljs-params">v</span>) </span>{
      <span class="hljs-keyword">if</span> (isObject(v)) {
        <span class="hljs-keyword">return</span> isDate(v) ? v.toISOString() : toJson(v);
      }
      <span class="hljs-keyword">return</span> v;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$HttpParamSerializerProvider</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">this</span>.$get = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ngParamSerializer</span>(<span class="hljs-params">params</span>) </span>{
          <span class="hljs-keyword">if</span> (!params) <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>;
          <span class="hljs-keyword">var</span> parts = [];
          forEachSorted(params, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value, key</span>) </span>{
            <span class="hljs-keyword">if</span> (value === <span class="hljs-literal">null</span> || isUndefined(value)) <span class="hljs-keyword">return</span>;
            <span class="hljs-keyword">if</span> (isArray(value)) {
              forEach(value, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">v</span>) </span>{
                parts.push(encodeUriQuery(key) + <span class="hljs-string">'='</span> + encodeUriQuery(serializeValue(v)));
              });
            } <span class="hljs-keyword">else</span> {
              parts.push(encodeUriQuery(key) + <span class="hljs-string">'='</span> + encodeUriQuery(serializeValue(value)));
            }
          });
          <span class="hljs-keyword">return</span> parts.join(<span class="hljs-string">'&amp;'</span>);
        };
      };
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$HttpParamSerializerJQLikeProvider</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">this</span>.$get = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">jQueryLikeParamSerializer</span>(<span class="hljs-params">params</span>) </span>{
          <span class="hljs-keyword">if</span> (!params) <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>;
          <span class="hljs-keyword">var</span> parts = [];
          serialize(params, <span class="hljs-string">''</span>, <span class="hljs-literal">true</span>);
          <span class="hljs-keyword">return</span> parts.join(<span class="hljs-string">'&amp;'</span>);

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">serialize</span>(<span class="hljs-params">toSerialize, prefix, topLevel</span>) </span>{
            <span class="hljs-keyword">if</span> (toSerialize === <span class="hljs-literal">null</span> || isUndefined(toSerialize)) <span class="hljs-keyword">return</span>;
            <span class="hljs-keyword">if</span> (isArray(toSerialize)) {
              forEach(toSerialize, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value, index</span>) </span>{
                serialize(value, prefix + <span class="hljs-string">'['</span> + (isObject(value) ? index : <span class="hljs-string">''</span>) + <span class="hljs-string">']'</span>);
              });
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (isObject(toSerialize) &amp;&amp; !isDate(toSerialize)) {
              forEachSorted(toSerialize, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value, key</span>) </span>{
                serialize(value, prefix +
                  (topLevel ? <span class="hljs-string">''</span> : <span class="hljs-string">'['</span>) +
                  key +
                  (topLevel ? <span class="hljs-string">''</span> : <span class="hljs-string">']'</span>));
              });
            } <span class="hljs-keyword">else</span> {
              parts.push(encodeUriQuery(prefix) + <span class="hljs-string">'='</span> + encodeUriQuery(serializeValue(toSerialize)));
            }
          }
        };
      };
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">defaultHttpResponseTransform</span>(<span class="hljs-params">data, headers</span>) </span>{
      <span class="hljs-keyword">if</span> (isString(data)) {
        <span class="hljs-keyword">var</span> tempData = data.replace(JSON_PROTECTION_PREFIX, <span class="hljs-string">''</span>).trim();
        <span class="hljs-keyword">if</span> (tempData) {
          <span class="hljs-keyword">var</span> contentType = headers(<span class="hljs-string">'Content-Type'</span>);
          <span class="hljs-keyword">if</span> ((contentType &amp;&amp; (contentType.indexOf(APPLICATION_JSON) === <span class="hljs-number">0</span>)) || isJsonLike(tempData)) {
            data = fromJson(tempData);
          }
        }
      }
      <span class="hljs-keyword">return</span> data;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isJsonLike</span>(<span class="hljs-params">str</span>) </span>{
      <span class="hljs-keyword">var</span> jsonStart = str.match(JSON_START);
      <span class="hljs-keyword">return</span> jsonStart &amp;&amp; JSON_ENDS[jsonStart[<span class="hljs-number">0</span>]].test(str);
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">parseHeaders</span>(<span class="hljs-params">headers</span>) </span>{
      <span class="hljs-keyword">var</span> parsed = createMap(),
        i;

      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fillInParsed</span>(<span class="hljs-params">key, val</span>) </span>{
        <span class="hljs-keyword">if</span> (key) {
          parsed[key] = parsed[key] ? parsed[key] + <span class="hljs-string">', '</span> + val : val;
        }
      }
      <span class="hljs-keyword">if</span> (isString(headers)) {
        forEach(headers.split(<span class="hljs-string">'\n'</span>), <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">line</span>) </span>{
          i = line.indexOf(<span class="hljs-string">':'</span>);
          fillInParsed(lowercase(trim(line.substr(<span class="hljs-number">0</span>, i))), trim(line.substr(i + <span class="hljs-number">1</span>)));
        });
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (isObject(headers)) {
        forEach(headers, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">headerVal, headerKey</span>) </span>{
          fillInParsed(lowercase(headerKey), trim(headerVal));
        });
      }
      <span class="hljs-keyword">return</span> parsed;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">headersGetter</span>(<span class="hljs-params">headers</span>) </span>{
      <span class="hljs-keyword">var</span> headersObj;
      <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name</span>) </span>{
        <span class="hljs-keyword">if</span> (!headersObj) headersObj = parseHeaders(headers);
        <span class="hljs-keyword">if</span> (name) {
          <span class="hljs-keyword">var</span> value = headersObj[lowercase(name)];
          <span class="hljs-keyword">if</span> (value === <span class="hljs-keyword">void</span> <span class="hljs-number">0</span>) {
            value = <span class="hljs-literal">null</span>;
          }
          <span class="hljs-keyword">return</span> value;
        }
        <span class="hljs-keyword">return</span> headersObj;
      };
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">transformData</span>(<span class="hljs-params">data, headers, status, fns</span>) </span>{
      <span class="hljs-keyword">if</span> (isFunction(fns)) {
        <span class="hljs-keyword">return</span> fns(data, headers, status);
      }
      forEach(fns, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fn</span>) </span>{
        data = fn(data, headers, status);
      });
      <span class="hljs-keyword">return</span> data;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isSuccess</span>(<span class="hljs-params">status</span>) </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-number">200</span> &lt;= status &amp;&amp; status &lt; <span class="hljs-number">300</span>;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$HttpProvider</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> defaults = <span class="hljs-keyword">this</span>.defaults = {
        <span class="hljs-attr">transformResponse</span>: [defaultHttpResponseTransform],
        <span class="hljs-attr">transformRequest</span>: [<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">d</span>) </span>{
          <span class="hljs-keyword">return</span> isObject(d) &amp;&amp; !isFile(d) &amp;&amp; !isBlob(d) &amp;&amp; !isFormData(d) ? toJson(d) : d;
        }],
        <span class="hljs-attr">headers</span>: {
          <span class="hljs-attr">common</span>: {
            <span class="hljs-string">'Accept'</span>: <span class="hljs-string">'application/json, text/plain, */*'</span>
          },
          <span class="hljs-attr">post</span>: shallowCopy(CONTENT_TYPE_APPLICATION_JSON),
          <span class="hljs-attr">put</span>: shallowCopy(CONTENT_TYPE_APPLICATION_JSON),
          <span class="hljs-attr">patch</span>: shallowCopy(CONTENT_TYPE_APPLICATION_JSON)
        },
        <span class="hljs-attr">xsrfCookieName</span>: <span class="hljs-string">'XSRF-TOKEN'</span>,
        <span class="hljs-attr">xsrfHeaderName</span>: <span class="hljs-string">'X-XSRF-TOKEN'</span>,
        <span class="hljs-attr">paramSerializer</span>: <span class="hljs-string">'$httpParamSerializer'</span>
      };
      <span class="hljs-keyword">var</span> useApplyAsync = <span class="hljs-literal">false</span>;
      <span class="hljs-keyword">this</span>.useApplyAsync = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>) </span>{
        <span class="hljs-keyword">if</span> (isDefined(value)) {
          useApplyAsync = !!value;
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
        }
        <span class="hljs-keyword">return</span> useApplyAsync;
      };
      <span class="hljs-keyword">var</span> useLegacyPromise = <span class="hljs-literal">true</span>;
      <span class="hljs-keyword">this</span>.useLegacyPromiseExtensions = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>) </span>{
        <span class="hljs-keyword">if</span> (isDefined(value)) {
          useLegacyPromise = !!value;
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
        }
        <span class="hljs-keyword">return</span> useLegacyPromise;
      };
      <span class="hljs-keyword">var</span> interceptorFactories = <span class="hljs-keyword">this</span>.interceptors = [];
      <span class="hljs-keyword">this</span>.$get = [<span class="hljs-string">'$httpBackend'</span>, <span class="hljs-string">'$$cookieReader'</span>, <span class="hljs-string">'$cacheFactory'</span>, <span class="hljs-string">'$rootScope'</span>, <span class="hljs-string">'$q'</span>, <span class="hljs-string">'$injector'</span>,
        <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$httpBackend, $$cookieReader, $cacheFactory, $rootScope, $q, $injector</span>) </span>{
          <span class="hljs-keyword">var</span> defaultCache = $cacheFactory(<span class="hljs-string">'$http'</span>);
          defaults.paramSerializer = isString(defaults.paramSerializer) ?
            $injector.get(defaults.paramSerializer) : defaults.paramSerializer;
          <span class="hljs-keyword">var</span> reversedInterceptors = [];
          forEach(interceptorFactories, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">interceptorFactory</span>) </span>{
            reversedInterceptors.unshift(isString(interceptorFactory) ?
              $injector.get(interceptorFactory) : $injector.invoke(interceptorFactory));
          });

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$http</span>(<span class="hljs-params">requestConfig</span>) </span>{
            <span class="hljs-keyword">if</span> (!isObject(requestConfig)) {
              <span class="hljs-keyword">throw</span> minErr(<span class="hljs-string">'$http'</span>)(<span class="hljs-string">'badreq'</span>, <span class="hljs-string">'Http request configuration must be an object.  Received: {0}'</span>, requestConfig);
            }
            <span class="hljs-keyword">if</span> (!isString(requestConfig.url)) {
              <span class="hljs-keyword">throw</span> minErr(<span class="hljs-string">'$http'</span>)(<span class="hljs-string">'badreq'</span>, <span class="hljs-string">'Http request configuration url must be a string.  Received: {0}'</span>, requestConfig.url);
            }
            <span class="hljs-keyword">var</span> config = extend({
              <span class="hljs-attr">method</span>: <span class="hljs-string">'get'</span>,
              <span class="hljs-attr">transformRequest</span>: defaults.transformRequest,
              <span class="hljs-attr">transformResponse</span>: defaults.transformResponse,
              <span class="hljs-attr">paramSerializer</span>: defaults.paramSerializer
            }, requestConfig);
            config.headers = mergeHeaders(requestConfig);
            config.method = uppercase(config.method);
            config.paramSerializer = isString(config.paramSerializer) ?
              $injector.get(config.paramSerializer) : config.paramSerializer;
            <span class="hljs-keyword">var</span> serverRequest = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">config</span>) </span>{
              <span class="hljs-keyword">var</span> headers = config.headers;
              <span class="hljs-keyword">var</span> reqData = transformData(config.data, headersGetter(headers), <span class="hljs-literal">undefined</span>, config.transformRequest);
              <span class="hljs-keyword">if</span> (isUndefined(reqData)) {
                forEach(headers, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value, header</span>) </span>{
                  <span class="hljs-keyword">if</span> (lowercase(header) === <span class="hljs-string">'content-type'</span>) {
                    <span class="hljs-keyword">delete</span> headers[header];
                  }
                });
              }
              <span class="hljs-keyword">if</span> (isUndefined(config.withCredentials) &amp;&amp; !isUndefined(defaults.withCredentials)) {
                config.withCredentials = defaults.withCredentials;
              }
              <span class="hljs-keyword">return</span> sendReq(config, reqData).then(transformResponse, transformResponse);
            };
            <span class="hljs-keyword">var</span> chain = [serverRequest, <span class="hljs-literal">undefined</span>];
            <span class="hljs-keyword">var</span> promise = $q.when(config);
            forEach(reversedInterceptors, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">interceptor</span>) </span>{
              <span class="hljs-keyword">if</span> (interceptor.request || interceptor.requestError) {
                chain.unshift(interceptor.request, interceptor.requestError);
              }
              <span class="hljs-keyword">if</span> (interceptor.response || interceptor.responseError) {
                chain.push(interceptor.response, interceptor.responseError);
              }
            });
            <span class="hljs-keyword">while</span> (chain.length) {
              <span class="hljs-keyword">var</span> thenFn = chain.shift();
              <span class="hljs-keyword">var</span> rejectFn = chain.shift();
              promise = promise.then(thenFn, rejectFn);
            }
            <span class="hljs-keyword">if</span> (useLegacyPromise) {
              promise.success = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fn</span>) </span>{
                assertArgFn(fn, <span class="hljs-string">'fn'</span>);
                promise.then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">response</span>) </span>{
                  fn(response.data, response.status, response.headers, config);
                });
                <span class="hljs-keyword">return</span> promise;
              };
              promise.error = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fn</span>) </span>{
                assertArgFn(fn, <span class="hljs-string">'fn'</span>);
                promise.then(<span class="hljs-literal">null</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">response</span>) </span>{
                  fn(response.data, response.status, response.headers, config);
                });
                <span class="hljs-keyword">return</span> promise;
              };
            } <span class="hljs-keyword">else</span> {
              promise.success = $httpMinErrLegacyFn(<span class="hljs-string">'success'</span>);
              promise.error = $httpMinErrLegacyFn(<span class="hljs-string">'error'</span>);
            }
            <span class="hljs-keyword">return</span> promise;

            <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">transformResponse</span>(<span class="hljs-params">response</span>) </span>{
              <span class="hljs-keyword">var</span> resp = extend({}, response);
              resp.data = transformData(response.data, response.headers, response.status,
                config.transformResponse);
              <span class="hljs-keyword">return</span> (isSuccess(response.status)) ?
                resp :
                $q.reject(resp);
            }

            <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">executeHeaderFns</span>(<span class="hljs-params">headers, config</span>) </span>{
              <span class="hljs-keyword">var</span> headerContent, processedHeaders = {};
              forEach(headers, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">headerFn, header</span>) </span>{
                <span class="hljs-keyword">if</span> (isFunction(headerFn)) {
                  headerContent = headerFn(config);
                  <span class="hljs-keyword">if</span> (headerContent != <span class="hljs-literal">null</span>) {
                    processedHeaders[header] = headerContent;
                  }
                } <span class="hljs-keyword">else</span> {
                  processedHeaders[header] = headerFn;
                }
              });
              <span class="hljs-keyword">return</span> processedHeaders;
            }

            <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">mergeHeaders</span>(<span class="hljs-params">config</span>) </span>{
              <span class="hljs-keyword">var</span> defHeaders = defaults.headers,
                reqHeaders = extend({}, config.headers),
                defHeaderName, lowercaseDefHeaderName, reqHeaderName;
              defHeaders = extend({}, defHeaders.common, defHeaders[lowercase(config.method)]);
              defaultHeadersIteration:
                <span class="hljs-keyword">for</span> (defHeaderName <span class="hljs-keyword">in</span> defHeaders) {
                  lowercaseDefHeaderName = lowercase(defHeaderName);
                  <span class="hljs-keyword">for</span> (reqHeaderName <span class="hljs-keyword">in</span> reqHeaders) {
                    <span class="hljs-keyword">if</span> (lowercase(reqHeaderName) === lowercaseDefHeaderName) {
                      <span class="hljs-keyword">continue</span> defaultHeadersIteration;
                    }
                  }
                  reqHeaders[defHeaderName] = defHeaders[defHeaderName];
                }
              <span class="hljs-keyword">return</span> executeHeaderFns(reqHeaders, shallowCopy(config));
            }
          }
          $http.pendingRequests = [];
          createShortMethods(<span class="hljs-string">'get'</span>, <span class="hljs-string">'delete'</span>, <span class="hljs-string">'head'</span>, <span class="hljs-string">'jsonp'</span>);
          createShortMethodsWithData(<span class="hljs-string">'post'</span>, <span class="hljs-string">'put'</span>, <span class="hljs-string">'patch'</span>);
          $http.defaults = defaults;
          <span class="hljs-keyword">return</span> $http;

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createShortMethods</span>(<span class="hljs-params">names</span>) </span>{
            forEach(<span class="hljs-built_in">arguments</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name</span>) </span>{
              $http[name] = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">url, config</span>) </span>{
                <span class="hljs-keyword">return</span> $http(extend({}, config || {}, {
                  <span class="hljs-attr">method</span>: name,
                  <span class="hljs-attr">url</span>: url
                }));
              };
            });
          }

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createShortMethodsWithData</span>(<span class="hljs-params">name</span>) </span>{
            forEach(<span class="hljs-built_in">arguments</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name</span>) </span>{
              $http[name] = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">url, data, config</span>) </span>{
                <span class="hljs-keyword">return</span> $http(extend({}, config || {}, {
                  <span class="hljs-attr">method</span>: name,
                  <span class="hljs-attr">url</span>: url,
                  <span class="hljs-attr">data</span>: data
                }));
              };
            });
          }

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sendReq</span>(<span class="hljs-params">config, reqData</span>) </span>{
            <span class="hljs-keyword">var</span> deferred = $q.defer(),
              promise = deferred.promise,
              cache,
              cachedResp,
              reqHeaders = config.headers,
              url = buildUrl(config.url, config.paramSerializer(config.params));
            $http.pendingRequests.push(config);
            promise.then(removePendingReq, removePendingReq);
            <span class="hljs-keyword">if</span> ((config.cache || defaults.cache) &amp;&amp; config.cache !== <span class="hljs-literal">false</span> &amp;&amp;
              (config.method === <span class="hljs-string">'GET'</span> || config.method === <span class="hljs-string">'JSONP'</span>)) {
              cache = isObject(config.cache) ? config.cache :
                isObject(defaults.cache) ? defaults.cache :
                defaultCache;
            }
            <span class="hljs-keyword">if</span> (cache) {
              cachedResp = cache.get(url);
              <span class="hljs-keyword">if</span> (isDefined(cachedResp)) {
                <span class="hljs-keyword">if</span> (isPromiseLike(cachedResp)) {
                  cachedResp.then(resolvePromiseWithResult, resolvePromiseWithResult);
                } <span class="hljs-keyword">else</span> {
                  <span class="hljs-keyword">if</span> (isArray(cachedResp)) {
                    resolvePromise(cachedResp[<span class="hljs-number">1</span>], cachedResp[<span class="hljs-number">0</span>], shallowCopy(cachedResp[<span class="hljs-number">2</span>]), cachedResp[<span class="hljs-number">3</span>]);
                  } <span class="hljs-keyword">else</span> {
                    resolvePromise(cachedResp, <span class="hljs-number">200</span>, {}, <span class="hljs-string">'OK'</span>);
                  }
                }
              } <span class="hljs-keyword">else</span> {
                cache.put(url, promise);
              }
            }
            <span class="hljs-keyword">if</span> (isUndefined(cachedResp)) {
              <span class="hljs-keyword">var</span> xsrfValue = urlIsSameOrigin(config.url) ?
                $$cookieReader()[config.xsrfCookieName || defaults.xsrfCookieName] :
                <span class="hljs-literal">undefined</span>;
              <span class="hljs-keyword">if</span> (xsrfValue) {
                reqHeaders[(config.xsrfHeaderName || defaults.xsrfHeaderName)] = xsrfValue;
              }
              $httpBackend(config.method, url, reqData, done, reqHeaders, config.timeout,
                config.withCredentials, config.responseType);
            }
            <span class="hljs-keyword">return</span> promise;

            <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">done</span>(<span class="hljs-params">status, response, headersString, statusText</span>) </span>{
              <span class="hljs-keyword">if</span> (cache) {
                <span class="hljs-keyword">if</span> (isSuccess(status)) {
                  cache.put(url, [status, response, parseHeaders(headersString), statusText]);
                } <span class="hljs-keyword">else</span> {
                  cache.remove(url);
                }
              }

              <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">resolveHttpPromise</span>(<span class="hljs-params"></span>) </span>{
                resolvePromise(response, status, headersString, statusText);
              }
              <span class="hljs-keyword">if</span> (useApplyAsync) {
                $rootScope.$applyAsync(resolveHttpPromise);
              } <span class="hljs-keyword">else</span> {
                resolveHttpPromise();
                <span class="hljs-keyword">if</span> (!$rootScope.$$phase) $rootScope.$apply();
              }
            }

            <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">resolvePromise</span>(<span class="hljs-params">response, status, headers, statusText</span>) </span>{
              status = status &gt;= <span class="hljs-number">-1</span> ? status : <span class="hljs-number">0</span>;
              (isSuccess(status) ? deferred.resolve : deferred.reject)({
                <span class="hljs-attr">data</span>: response,
                <span class="hljs-attr">status</span>: status,
                <span class="hljs-attr">headers</span>: headersGetter(headers),
                <span class="hljs-attr">config</span>: config,
                <span class="hljs-attr">statusText</span>: statusText
              });
            }

            <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">resolvePromiseWithResult</span>(<span class="hljs-params">result</span>) </span>{
              resolvePromise(result.data, result.status, shallowCopy(result.headers()), result.statusText);
            }

            <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">removePendingReq</span>(<span class="hljs-params"></span>) </span>{
              <span class="hljs-keyword">var</span> idx = $http.pendingRequests.indexOf(config);
              <span class="hljs-keyword">if</span> (idx !== <span class="hljs-number">-1</span>) $http.pendingRequests.splice(idx, <span class="hljs-number">1</span>);
            }
          }

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">buildUrl</span>(<span class="hljs-params">url, serializedParams</span>) </span>{
            <span class="hljs-keyword">if</span> (serializedParams.length &gt; <span class="hljs-number">0</span>) {
              url += ((url.indexOf(<span class="hljs-string">'?'</span>) == <span class="hljs-number">-1</span>) ? <span class="hljs-string">'?'</span> : <span class="hljs-string">'&amp;'</span>) + serializedParams;
            }
            <span class="hljs-keyword">return</span> url;
          }
        }
      ];
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$xhrFactoryProvider</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">this</span>.$get = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createXhr</span>(<span class="hljs-params"></span>) </span>{
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">window</span>.XMLHttpRequest();
        };
      };
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$HttpBackendProvider</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">this</span>.$get = [<span class="hljs-string">'$browser'</span>, <span class="hljs-string">'$window'</span>, <span class="hljs-string">'$document'</span>, <span class="hljs-string">'$xhrFactory'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$browser, $window, $document, $xhrFactory</span>) </span>{
        <span class="hljs-keyword">return</span> createHttpBackend($browser, $xhrFactory, $browser.defer, $<span class="hljs-built_in">window</span>.angular.callbacks, $<span class="hljs-built_in">document</span>[<span class="hljs-number">0</span>]);
      }];
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createHttpBackend</span>(<span class="hljs-params">$browser, createXhr, $browserDefer, callbacks, rawDocument</span>) </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">method, url, post, callback, headers, timeout, withCredentials, responseType</span>) </span>{
        $browser.$$incOutstandingRequestCount();
        url = url || $browser.url();
        <span class="hljs-keyword">if</span> (lowercase(method) == <span class="hljs-string">'jsonp'</span>) {
          <span class="hljs-keyword">var</span> callbackId = <span class="hljs-string">'_'</span> + (callbacks.counter++).toString(<span class="hljs-number">36</span>);
          callbacks[callbackId] = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">data</span>) </span>{
            callbacks[callbackId].data = data;
            callbacks[callbackId].called = <span class="hljs-literal">true</span>;
          };
          <span class="hljs-keyword">var</span> jsonpDone = jsonpReq(url.replace(<span class="hljs-string">'JSON_CALLBACK'</span>, <span class="hljs-string">'angular.callbacks.'</span> + callbackId),
            callbackId,
            <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">status, text</span>) </span>{
              completeRequest(callback, status, callbacks[callbackId].data, <span class="hljs-string">""</span>, text);
              callbacks[callbackId] = noop;
            });
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">var</span> xhr = createXhr(method, url);
          xhr.open(method, url, <span class="hljs-literal">true</span>);
          forEach(headers, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value, key</span>) </span>{
            <span class="hljs-keyword">if</span> (isDefined(value)) {
              xhr.setRequestHeader(key, value);
            }
          });
          xhr.onload = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">requestLoaded</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">var</span> statusText = xhr.statusText || <span class="hljs-string">''</span>;
            <span class="hljs-keyword">var</span> response = (<span class="hljs-string">'response'</span> <span class="hljs-keyword">in</span> xhr) ? xhr.response : xhr.responseText;
            <span class="hljs-keyword">var</span> status = xhr.status === <span class="hljs-number">1223</span> ? <span class="hljs-number">204</span> : xhr.status;
            <span class="hljs-keyword">if</span> (status === <span class="hljs-number">0</span>) {
              status = response ? <span class="hljs-number">200</span> : urlResolve(url).protocol == <span class="hljs-string">'file'</span> ? <span class="hljs-number">404</span> : <span class="hljs-number">0</span>;
            }
            completeRequest(callback,
              status,
              response,
              xhr.getAllResponseHeaders(),
              statusText);
          };
          <span class="hljs-keyword">var</span> requestError = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            completeRequest(callback, <span class="hljs-number">-1</span>, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, <span class="hljs-string">''</span>);
          };
          xhr.onerror = requestError;
          xhr.onabort = requestError;
          <span class="hljs-keyword">if</span> (withCredentials) {
            xhr.withCredentials = <span class="hljs-literal">true</span>;
          }
          <span class="hljs-keyword">if</span> (responseType) {
            <span class="hljs-keyword">try</span> {
              xhr.responseType = responseType;
            } <span class="hljs-keyword">catch</span> (e) {
              <span class="hljs-keyword">if</span> (responseType !== <span class="hljs-string">'json'</span>) {
                <span class="hljs-keyword">throw</span> e;
              }
            }
          }
          xhr.send(isUndefined(post) ? <span class="hljs-literal">null</span> : post);
        }
        <span class="hljs-keyword">if</span> (timeout &gt; <span class="hljs-number">0</span>) {
          <span class="hljs-keyword">var</span> timeoutId = $browserDefer(timeoutRequest, timeout);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (isPromiseLike(timeout)) {
          timeout.then(timeoutRequest);
        }

        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">timeoutRequest</span>(<span class="hljs-params"></span>) </span>{
          jsonpDone &amp;&amp; jsonpDone();
          xhr &amp;&amp; xhr.abort();
        }

        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">completeRequest</span>(<span class="hljs-params">callback, status, response, headersString, statusText</span>) </span>{
          <span class="hljs-keyword">if</span> (isDefined(timeoutId)) {
            $browserDefer.cancel(timeoutId);
          }
          jsonpDone = xhr = <span class="hljs-literal">null</span>;
          callback(status, response, headersString, statusText);
          $browser.$$completeOutstandingRequest(noop);
        }
      };

      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">jsonpReq</span>(<span class="hljs-params">url, callbackId, done</span>) </span>{
        <span class="hljs-keyword">var</span> script = rawDocument.createElement(<span class="hljs-string">'script'</span>),
          callback = <span class="hljs-literal">null</span>;
        script.type = <span class="hljs-string">"text/javascript"</span>;
        script.src = url;
        script.async = <span class="hljs-literal">true</span>;
        callback = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>{
          removeEventListenerFn(script, <span class="hljs-string">"load"</span>, callback);
          removeEventListenerFn(script, <span class="hljs-string">"error"</span>, callback);
          rawDocument.body.removeChild(script);
          script = <span class="hljs-literal">null</span>;
          <span class="hljs-keyword">var</span> status = <span class="hljs-number">-1</span>;
          <span class="hljs-keyword">var</span> text = <span class="hljs-string">"unknown"</span>;
          <span class="hljs-keyword">if</span> (event) {
            <span class="hljs-keyword">if</span> (event.type === <span class="hljs-string">"load"</span> &amp;&amp; !callbacks[callbackId].called) {
              event = {
                <span class="hljs-attr">type</span>: <span class="hljs-string">"error"</span>
              };
            }
            text = event.type;
            status = event.type === <span class="hljs-string">"error"</span> ? <span class="hljs-number">404</span> : <span class="hljs-number">200</span>;
          }
          <span class="hljs-keyword">if</span> (done) {
            done(status, text);
          }
        };
        addEventListenerFn(script, <span class="hljs-string">"load"</span>, callback);
        addEventListenerFn(script, <span class="hljs-string">"error"</span>, callback);
        rawDocument.body.appendChild(script);
        <span class="hljs-keyword">return</span> callback;
      }
    }
    <span class="hljs-keyword">var</span> $interpolateMinErr = angular.$interpolateMinErr = minErr(<span class="hljs-string">'$interpolate'</span>);
    $interpolateMinErr.throwNoconcat = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">text</span>) </span>{
      <span class="hljs-keyword">throw</span> $interpolateMinErr(<span class="hljs-string">'noconcat'</span>,
        <span class="hljs-string">"Error while interpolating: {0}\nStrict Contextual Escaping disallows "</span> +
        <span class="hljs-string">"interpolations that concatenate multiple expressions when a trusted value is "</span> +
        <span class="hljs-string">"required.  See http://docs.angularjs.org/api/ng.$sce"</span>, text);
    };
    $interpolateMinErr.interr = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">text, err</span>) </span>{
      <span class="hljs-keyword">return</span> $interpolateMinErr(<span class="hljs-string">'interr'</span>, <span class="hljs-string">"Can't interpolate: {0}\n{1}"</span>, text, err.toString());
    };

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$InterpolateProvider</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> startSymbol = <span class="hljs-string">'{{'</span>;
      <span class="hljs-keyword">var</span> endSymbol = <span class="hljs-string">'}}'</span>;
      <span class="hljs-keyword">this</span>.startSymbol = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>) </span>{
        <span class="hljs-keyword">if</span> (value) {
          startSymbol = value;
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">return</span> startSymbol;
        }
      };
      <span class="hljs-keyword">this</span>.endSymbol = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>) </span>{
        <span class="hljs-keyword">if</span> (value) {
          endSymbol = value;
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">return</span> endSymbol;
        }
      };
      <span class="hljs-keyword">this</span>.$get = [<span class="hljs-string">'$parse'</span>, <span class="hljs-string">'$exceptionHandler'</span>, <span class="hljs-string">'$sce'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$parse, $exceptionHandler, $sce</span>) </span>{
        <span class="hljs-keyword">var</span> startSymbolLength = startSymbol.length,
          endSymbolLength = endSymbol.length,
          escapedStartRegexp = <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(startSymbol.replace(<span class="hljs-regexp">/./g</span>, <span class="hljs-built_in">escape</span>), <span class="hljs-string">'g'</span>),
          escapedEndRegexp = <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(endSymbol.replace(<span class="hljs-regexp">/./g</span>, <span class="hljs-built_in">escape</span>), <span class="hljs-string">'g'</span>);

        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">escape</span>(<span class="hljs-params">ch</span>) </span>{
          <span class="hljs-keyword">return</span> <span class="hljs-string">'\\\\\\'</span> + ch;
        }

        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">unescapeText</span>(<span class="hljs-params">text</span>) </span>{
          <span class="hljs-keyword">return</span> text.replace(escapedStartRegexp, startSymbol).
          replace(escapedEndRegexp, endSymbol);
        }

        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">stringify</span>(<span class="hljs-params">value</span>) </span>{
          <span class="hljs-keyword">if</span> (value == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>;
          }
          <span class="hljs-keyword">switch</span> (<span class="hljs-keyword">typeof</span> value) {
            <span class="hljs-keyword">case</span> <span class="hljs-string">'string'</span>:
              <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">'number'</span>:
              value = <span class="hljs-string">''</span> + value;
              <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">default</span>:
              value = toJson(value);
          }
          <span class="hljs-keyword">return</span> value;
        }

        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">constantWatchDelegate</span>(<span class="hljs-params">scope, listener, objectEquality, constantInterp</span>) </span>{
          <span class="hljs-keyword">var</span> unwatch;
          <span class="hljs-keyword">return</span> unwatch = scope.$watch(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">constantInterpolateWatch</span>(<span class="hljs-params">scope</span>) </span>{
            unwatch();
            <span class="hljs-keyword">return</span> constantInterp(scope);
          }, listener, objectEquality);
        }

        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$interpolate</span>(<span class="hljs-params">text, mustHaveExpression, trustedContext, allOrNothing</span>) </span>{
          <span class="hljs-keyword">if</span> (!text.length || text.indexOf(startSymbol) === <span class="hljs-number">-1</span>) {
            <span class="hljs-keyword">var</span> constantInterp;
            <span class="hljs-keyword">if</span> (!mustHaveExpression) {
              <span class="hljs-keyword">var</span> unescapedText = unescapeText(text);
              constantInterp = valueFn(unescapedText);
              constantInterp.exp = text;
              constantInterp.expressions = [];
              constantInterp.$$watchDelegate = constantWatchDelegate;
            }
            <span class="hljs-keyword">return</span> constantInterp;
          }
          allOrNothing = !!allOrNothing;
          <span class="hljs-keyword">var</span> startIndex,
            endIndex,
            index = <span class="hljs-number">0</span>,
            expressions = [],
            parseFns = [],
            textLength = text.length,
            exp,
            concat = [],
            expressionPositions = [];
          <span class="hljs-keyword">while</span> (index &lt; textLength) {
            <span class="hljs-keyword">if</span> (((startIndex = text.indexOf(startSymbol, index)) != <span class="hljs-number">-1</span>) &amp;&amp;
              ((endIndex = text.indexOf(endSymbol, startIndex + startSymbolLength)) != <span class="hljs-number">-1</span>)) {
              <span class="hljs-keyword">if</span> (index !== startIndex) {
                concat.push(unescapeText(text.substring(index, startIndex)));
              }
              exp = text.substring(startIndex + startSymbolLength, endIndex);
              expressions.push(exp);
              parseFns.push($parse(exp, parseStringifyInterceptor));
              index = endIndex + endSymbolLength;
              expressionPositions.push(concat.length);
              concat.push(<span class="hljs-string">''</span>);
            } <span class="hljs-keyword">else</span> {
              <span class="hljs-keyword">if</span> (index !== textLength) {
                concat.push(unescapeText(text.substring(index)));
              }
              <span class="hljs-keyword">break</span>;
            }
          }
          <span class="hljs-keyword">if</span> (trustedContext &amp;&amp; concat.length &gt; <span class="hljs-number">1</span>) {
            $interpolateMinErr.throwNoconcat(text);
          }
          <span class="hljs-keyword">if</span> (!mustHaveExpression || expressions.length) {
            <span class="hljs-keyword">var</span> compute = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">values</span>) </span>{
              <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, ii = expressions.length; i &lt; ii; i++) {
                <span class="hljs-keyword">if</span> (allOrNothing &amp;&amp; isUndefined(values[i])) <span class="hljs-keyword">return</span>;
                concat[expressionPositions[i]] = values[i];
              }
              <span class="hljs-keyword">return</span> concat.join(<span class="hljs-string">''</span>);
            };
            <span class="hljs-keyword">var</span> getValue = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>) </span>{
              <span class="hljs-keyword">return</span> trustedContext ?
                $sce.getTrusted(trustedContext, value) :
                $sce.valueOf(value);
            };
            <span class="hljs-keyword">return</span> extend(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">interpolationFn</span>(<span class="hljs-params">context</span>) </span>{
              <span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>;
              <span class="hljs-keyword">var</span> ii = expressions.length;
              <span class="hljs-keyword">var</span> values = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(ii);
              <span class="hljs-keyword">try</span> {
                <span class="hljs-keyword">for</span> (; i &lt; ii; i++) {
                  values[i] = parseFns[i](context);
                }
                <span class="hljs-keyword">return</span> compute(values);
              } <span class="hljs-keyword">catch</span> (err) {
                $exceptionHandler($interpolateMinErr.interr(text, err));
              }
            }, {
              <span class="hljs-attr">exp</span>: text,
              <span class="hljs-attr">expressions</span>: expressions,
              <span class="hljs-attr">$$watchDelegate</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">scope, listener</span>) </span>{
                <span class="hljs-keyword">var</span> lastValue;
                <span class="hljs-keyword">return</span> scope.$watchGroup(parseFns, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">interpolateFnWatcher</span>(<span class="hljs-params">values, oldValues</span>) </span>{
                  <span class="hljs-keyword">var</span> currValue = compute(values);
                  <span class="hljs-keyword">if</span> (isFunction(listener)) {
                    listener.call(<span class="hljs-keyword">this</span>, currValue, values !== oldValues ? lastValue : currValue, scope);
                  }
                  lastValue = currValue;
                });
              }
            });
          }

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">parseStringifyInterceptor</span>(<span class="hljs-params">value</span>) </span>{
            <span class="hljs-keyword">try</span> {
              value = getValue(value);
              <span class="hljs-keyword">return</span> allOrNothing &amp;&amp; !isDefined(value) ? value : stringify(value);
            } <span class="hljs-keyword">catch</span> (err) {
              $exceptionHandler($interpolateMinErr.interr(text, err));
            }
          }
        }
        $interpolate.startSymbol = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
          <span class="hljs-keyword">return</span> startSymbol;
        };
        $interpolate.endSymbol = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
          <span class="hljs-keyword">return</span> endSymbol;
        };
        <span class="hljs-keyword">return</span> $interpolate;
      }];
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$IntervalProvider</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">this</span>.$get = [<span class="hljs-string">'$rootScope'</span>, <span class="hljs-string">'$window'</span>, <span class="hljs-string">'$q'</span>, <span class="hljs-string">'$$q'</span>, <span class="hljs-string">'$browser'</span>,
        <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$rootScope, $window, $q, $$q, $browser</span>) </span>{
          <span class="hljs-keyword">var</span> intervals = {};

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">interval</span>(<span class="hljs-params">fn, delay, count, invokeApply</span>) </span>{
            <span class="hljs-keyword">var</span> hasParams = <span class="hljs-built_in">arguments</span>.length &gt; <span class="hljs-number">4</span>,
              args = hasParams ? sliceArgs(<span class="hljs-built_in">arguments</span>, <span class="hljs-number">4</span>) : [],
              setInterval = $<span class="hljs-built_in">window</span>.setInterval,
              clearInterval = $<span class="hljs-built_in">window</span>.clearInterval,
              iteration = <span class="hljs-number">0</span>,
              skipApply = (isDefined(invokeApply) &amp;&amp; !invokeApply),
              deferred = (skipApply ? $$q : $q).defer(),
              promise = deferred.promise;
            count = isDefined(count) ? count : <span class="hljs-number">0</span>;
            promise.$$intervalId = setInterval(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">tick</span>(<span class="hljs-params"></span>) </span>{
              <span class="hljs-keyword">if</span> (skipApply) {
                $browser.defer(callback);
              } <span class="hljs-keyword">else</span> {
                $rootScope.$evalAsync(callback);
              }
              deferred.notify(iteration++);
              <span class="hljs-keyword">if</span> (count &gt; <span class="hljs-number">0</span> &amp;&amp; iteration &gt;= count) {
                deferred.resolve(iteration);
                clearInterval(promise.$$intervalId);
                <span class="hljs-keyword">delete</span> intervals[promise.$$intervalId];
              }
              <span class="hljs-keyword">if</span> (!skipApply) $rootScope.$apply();
            }, delay);
            intervals[promise.$$intervalId] = deferred;
            <span class="hljs-keyword">return</span> promise;

            <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">callback</span>(<span class="hljs-params"></span>) </span>{
              <span class="hljs-keyword">if</span> (!hasParams) {
                fn(iteration);
              } <span class="hljs-keyword">else</span> {
                fn.apply(<span class="hljs-literal">null</span>, args);
              }
            }
          }
          interval.cancel = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">promise</span>) </span>{
            <span class="hljs-keyword">if</span> (promise &amp;&amp; promise.$$intervalId <span class="hljs-keyword">in</span> intervals) {
              intervals[promise.$$intervalId].reject(<span class="hljs-string">'canceled'</span>);
              $<span class="hljs-built_in">window</span>.clearInterval(promise.$$intervalId);
              <span class="hljs-keyword">delete</span> intervals[promise.$$intervalId];
              <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
            }
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
          };
          <span class="hljs-keyword">return</span> interval;
        }
      ];
    }
    <span class="hljs-keyword">var</span> PATH_MATCH = <span class="hljs-regexp">/^([^\?#]*)(\?([^#]*))?(#(.*))?$/</span>,
      DEFAULT_PORTS = {
        <span class="hljs-string">'http'</span>: <span class="hljs-number">80</span>,
        <span class="hljs-string">'https'</span>: <span class="hljs-number">443</span>,
        <span class="hljs-string">'ftp'</span>: <span class="hljs-number">21</span>
      };
    <span class="hljs-keyword">var</span> $locationMinErr = minErr(<span class="hljs-string">'$location'</span>);

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">encodePath</span>(<span class="hljs-params">path</span>) </span>{
      <span class="hljs-keyword">var</span> segments = path.split(<span class="hljs-string">'/'</span>),
        i = segments.length;
      <span class="hljs-keyword">while</span> (i--) {
        segments[i] = encodeUriSegment(segments[i]);
      }
      <span class="hljs-keyword">return</span> segments.join(<span class="hljs-string">'/'</span>);
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">parseAbsoluteUrl</span>(<span class="hljs-params">absoluteUrl, locationObj</span>) </span>{
      <span class="hljs-keyword">var</span> parsedUrl = urlResolve(absoluteUrl);
      locationObj.$$protocol = parsedUrl.protocol;
      locationObj.$$host = parsedUrl.hostname;
      locationObj.$$port = toInt(parsedUrl.port) || DEFAULT_PORTS[parsedUrl.protocol] || <span class="hljs-literal">null</span>;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">parseAppUrl</span>(<span class="hljs-params">relativeUrl, locationObj</span>) </span>{
      <span class="hljs-keyword">var</span> prefixed = (relativeUrl.charAt(<span class="hljs-number">0</span>) !== <span class="hljs-string">'/'</span>);
      <span class="hljs-keyword">if</span> (prefixed) {
        relativeUrl = <span class="hljs-string">'/'</span> + relativeUrl;
      }
      <span class="hljs-keyword">var</span> match = urlResolve(relativeUrl);
      locationObj.$$path = <span class="hljs-built_in">decodeURIComponent</span>(prefixed &amp;&amp; match.pathname.charAt(<span class="hljs-number">0</span>) === <span class="hljs-string">'/'</span> ?
        match.pathname.substring(<span class="hljs-number">1</span>) : match.pathname);
      locationObj.$$search = parseKeyValue(match.search);
      locationObj.$$hash = <span class="hljs-built_in">decodeURIComponent</span>(match.hash);
      <span class="hljs-keyword">if</span> (locationObj.$$path &amp;&amp; locationObj.$$path.charAt(<span class="hljs-number">0</span>) != <span class="hljs-string">'/'</span>) {
        locationObj.$$path = <span class="hljs-string">'/'</span> + locationObj.$$path;
      }
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">beginsWith</span>(<span class="hljs-params">begin, whole</span>) </span>{
      <span class="hljs-keyword">if</span> (whole.indexOf(begin) === <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">return</span> whole.substr(begin.length);
      }
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">stripHash</span>(<span class="hljs-params">url</span>) </span>{
      <span class="hljs-keyword">var</span> index = url.indexOf(<span class="hljs-string">'#'</span>);
      <span class="hljs-keyword">return</span> index == <span class="hljs-number">-1</span> ? url : url.substr(<span class="hljs-number">0</span>, index);
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">trimEmptyHash</span>(<span class="hljs-params">url</span>) </span>{
      <span class="hljs-keyword">return</span> url.replace(<span class="hljs-regexp">/(#.+)|#$/</span>, <span class="hljs-string">'$1'</span>);
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">stripFile</span>(<span class="hljs-params">url</span>) </span>{
      <span class="hljs-keyword">return</span> url.substr(<span class="hljs-number">0</span>, stripHash(url).lastIndexOf(<span class="hljs-string">'/'</span>) + <span class="hljs-number">1</span>);
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">serverBase</span>(<span class="hljs-params">url</span>) </span>{
      <span class="hljs-keyword">return</span> url.substring(<span class="hljs-number">0</span>, url.indexOf(<span class="hljs-string">'/'</span>, url.indexOf(<span class="hljs-string">'//'</span>) + <span class="hljs-number">2</span>));
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">LocationHtml5Url</span>(<span class="hljs-params">appBase, appBaseNoFile, basePrefix</span>) </span>{
      <span class="hljs-keyword">this</span>.$$html5 = <span class="hljs-literal">true</span>;
      basePrefix = basePrefix || <span class="hljs-string">''</span>;
      parseAbsoluteUrl(appBase, <span class="hljs-keyword">this</span>);
      <span class="hljs-keyword">this</span>.$$parse = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">url</span>) </span>{
        <span class="hljs-keyword">var</span> pathUrl = beginsWith(appBaseNoFile, url);
        <span class="hljs-keyword">if</span> (!isString(pathUrl)) {
          <span class="hljs-keyword">throw</span> $locationMinErr(<span class="hljs-string">'ipthprfx'</span>, <span class="hljs-string">'Invalid url "{0}", missing path prefix "{1}".'</span>, url,
            appBaseNoFile);
        }
        parseAppUrl(pathUrl, <span class="hljs-keyword">this</span>);
        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.$$path) {
          <span class="hljs-keyword">this</span>.$$path = <span class="hljs-string">'/'</span>;
        }
        <span class="hljs-keyword">this</span>.$$compose();
      };
      <span class="hljs-keyword">this</span>.$$compose = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> search = toKeyValue(<span class="hljs-keyword">this</span>.$$search),
          hash = <span class="hljs-keyword">this</span>.$$hash ? <span class="hljs-string">'#'</span> + encodeUriSegment(<span class="hljs-keyword">this</span>.$$hash) : <span class="hljs-string">''</span>;
        <span class="hljs-keyword">this</span>.$$url = encodePath(<span class="hljs-keyword">this</span>.$$path) + (search ? <span class="hljs-string">'?'</span> + search : <span class="hljs-string">''</span>) + hash;
        <span class="hljs-keyword">this</span>.$$absUrl = appBaseNoFile + <span class="hljs-keyword">this</span>.$$url.substr(<span class="hljs-number">1</span>);
      };
      <span class="hljs-keyword">this</span>.$$parseLinkUrl = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">url, relHref</span>) </span>{
        <span class="hljs-keyword">if</span> (relHref &amp;&amp; relHref[<span class="hljs-number">0</span>] === <span class="hljs-string">'#'</span>) {
          <span class="hljs-keyword">this</span>.hash(relHref.slice(<span class="hljs-number">1</span>));
          <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        }
        <span class="hljs-keyword">var</span> appUrl, prevAppUrl;
        <span class="hljs-keyword">var</span> rewrittenUrl;
        <span class="hljs-keyword">if</span> (isDefined(appUrl = beginsWith(appBase, url))) {
          prevAppUrl = appUrl;
          <span class="hljs-keyword">if</span> (isDefined(appUrl = beginsWith(basePrefix, appUrl))) {
            rewrittenUrl = appBaseNoFile + (beginsWith(<span class="hljs-string">'/'</span>, appUrl) || appUrl);
          } <span class="hljs-keyword">else</span> {
            rewrittenUrl = appBase + prevAppUrl;
          }
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (isDefined(appUrl = beginsWith(appBaseNoFile, url))) {
          rewrittenUrl = appBaseNoFile + appUrl;
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (appBaseNoFile == url + <span class="hljs-string">'/'</span>) {
          rewrittenUrl = appBaseNoFile;
        }
        <span class="hljs-keyword">if</span> (rewrittenUrl) {
          <span class="hljs-keyword">this</span>.$$parse(rewrittenUrl);
        }
        <span class="hljs-keyword">return</span> !!rewrittenUrl;
      };
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">LocationHashbangUrl</span>(<span class="hljs-params">appBase, appBaseNoFile, hashPrefix</span>) </span>{
      parseAbsoluteUrl(appBase, <span class="hljs-keyword">this</span>);
      <span class="hljs-keyword">this</span>.$$parse = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">url</span>) </span>{
        <span class="hljs-keyword">var</span> withoutBaseUrl = beginsWith(appBase, url) || beginsWith(appBaseNoFile, url);
        <span class="hljs-keyword">var</span> withoutHashUrl;
        <span class="hljs-keyword">if</span> (!isUndefined(withoutBaseUrl) &amp;&amp; withoutBaseUrl.charAt(<span class="hljs-number">0</span>) === <span class="hljs-string">'#'</span>) {
          withoutHashUrl = beginsWith(hashPrefix, withoutBaseUrl);
          <span class="hljs-keyword">if</span> (isUndefined(withoutHashUrl)) {
            withoutHashUrl = withoutBaseUrl;
          }
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.$$html5) {
            withoutHashUrl = withoutBaseUrl;
          } <span class="hljs-keyword">else</span> {
            withoutHashUrl = <span class="hljs-string">''</span>;
            <span class="hljs-keyword">if</span> (isUndefined(withoutBaseUrl)) {
              appBase = url;
              <span class="hljs-keyword">this</span>.replace();
            }
          }
        }
        parseAppUrl(withoutHashUrl, <span class="hljs-keyword">this</span>);
        <span class="hljs-keyword">this</span>.$$path = removeWindowsDriveName(<span class="hljs-keyword">this</span>.$$path, withoutHashUrl, appBase);
        <span class="hljs-keyword">this</span>.$$compose();

        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">removeWindowsDriveName</span>(<span class="hljs-params">path, url, base</span>) </span>{
          <span class="hljs-keyword">var</span> windowsFilePathExp = <span class="hljs-regexp">/^\/[A-Z]:(\/.*)/</span>;
          <span class="hljs-keyword">var</span> firstPathSegmentMatch;
          <span class="hljs-keyword">if</span> (url.indexOf(base) === <span class="hljs-number">0</span>) {
            url = url.replace(base, <span class="hljs-string">''</span>);
          }
          <span class="hljs-keyword">if</span> (windowsFilePathExp.exec(url)) {
            <span class="hljs-keyword">return</span> path;
          }
          firstPathSegmentMatch = windowsFilePathExp.exec(path);
          <span class="hljs-keyword">return</span> firstPathSegmentMatch ? firstPathSegmentMatch[<span class="hljs-number">1</span>] : path;
        }
      };
      <span class="hljs-keyword">this</span>.$$compose = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> search = toKeyValue(<span class="hljs-keyword">this</span>.$$search),
          hash = <span class="hljs-keyword">this</span>.$$hash ? <span class="hljs-string">'#'</span> + encodeUriSegment(<span class="hljs-keyword">this</span>.$$hash) : <span class="hljs-string">''</span>;
        <span class="hljs-keyword">this</span>.$$url = encodePath(<span class="hljs-keyword">this</span>.$$path) + (search ? <span class="hljs-string">'?'</span> + search : <span class="hljs-string">''</span>) + hash;
        <span class="hljs-keyword">this</span>.$$absUrl = appBase + (<span class="hljs-keyword">this</span>.$$url ? hashPrefix + <span class="hljs-keyword">this</span>.$$url : <span class="hljs-string">''</span>);
      };
      <span class="hljs-keyword">this</span>.$$parseLinkUrl = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">url, relHref</span>) </span>{
        <span class="hljs-keyword">if</span> (stripHash(appBase) == stripHash(url)) {
          <span class="hljs-keyword">this</span>.$$parse(url);
          <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        }
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
      };
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">LocationHashbangInHtml5Url</span>(<span class="hljs-params">appBase, appBaseNoFile, hashPrefix</span>) </span>{
      <span class="hljs-keyword">this</span>.$$html5 = <span class="hljs-literal">true</span>;
      LocationHashbangUrl.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
      <span class="hljs-keyword">this</span>.$$parseLinkUrl = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">url, relHref</span>) </span>{
        <span class="hljs-keyword">if</span> (relHref &amp;&amp; relHref[<span class="hljs-number">0</span>] === <span class="hljs-string">'#'</span>) {
          <span class="hljs-keyword">this</span>.hash(relHref.slice(<span class="hljs-number">1</span>));
          <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        }
        <span class="hljs-keyword">var</span> rewrittenUrl;
        <span class="hljs-keyword">var</span> appUrl;
        <span class="hljs-keyword">if</span> (appBase == stripHash(url)) {
          rewrittenUrl = url;
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ((appUrl = beginsWith(appBaseNoFile, url))) {
          rewrittenUrl = appBase + hashPrefix + appUrl;
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (appBaseNoFile === url + <span class="hljs-string">'/'</span>) {
          rewrittenUrl = appBaseNoFile;
        }
        <span class="hljs-keyword">if</span> (rewrittenUrl) {
          <span class="hljs-keyword">this</span>.$$parse(rewrittenUrl);
        }
        <span class="hljs-keyword">return</span> !!rewrittenUrl;
      };
      <span class="hljs-keyword">this</span>.$$compose = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> search = toKeyValue(<span class="hljs-keyword">this</span>.$$search),
          hash = <span class="hljs-keyword">this</span>.$$hash ? <span class="hljs-string">'#'</span> + encodeUriSegment(<span class="hljs-keyword">this</span>.$$hash) : <span class="hljs-string">''</span>;
        <span class="hljs-keyword">this</span>.$$url = encodePath(<span class="hljs-keyword">this</span>.$$path) + (search ? <span class="hljs-string">'?'</span> + search : <span class="hljs-string">''</span>) + hash;
        <span class="hljs-keyword">this</span>.$$absUrl = appBase + hashPrefix + <span class="hljs-keyword">this</span>.$$url;
      };
    }
    <span class="hljs-keyword">var</span> locationPrototype = {
      <span class="hljs-attr">$$html5</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">$$replace</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">absUrl</span>: locationGetter(<span class="hljs-string">'$$absUrl'</span>),
      <span class="hljs-attr">url</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">url</span>) </span>{
        <span class="hljs-keyword">if</span> (isUndefined(url)) {
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.$$url;
        }
        <span class="hljs-keyword">var</span> match = PATH_MATCH.exec(url);
        <span class="hljs-keyword">if</span> (match[<span class="hljs-number">1</span>] || url === <span class="hljs-string">''</span>) <span class="hljs-keyword">this</span>.path(<span class="hljs-built_in">decodeURIComponent</span>(match[<span class="hljs-number">1</span>]));
        <span class="hljs-keyword">if</span> (match[<span class="hljs-number">2</span>] || match[<span class="hljs-number">1</span>] || url === <span class="hljs-string">''</span>) <span class="hljs-keyword">this</span>.search(match[<span class="hljs-number">3</span>] || <span class="hljs-string">''</span>);
        <span class="hljs-keyword">this</span>.hash(match[<span class="hljs-number">5</span>] || <span class="hljs-string">''</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
      },
      <span class="hljs-attr">protocol</span>: locationGetter(<span class="hljs-string">'$$protocol'</span>),
      <span class="hljs-attr">host</span>: locationGetter(<span class="hljs-string">'$$host'</span>),
      <span class="hljs-attr">port</span>: locationGetter(<span class="hljs-string">'$$port'</span>),
      <span class="hljs-attr">path</span>: locationGetterSetter(<span class="hljs-string">'$$path'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">path</span>) </span>{
        path = path !== <span class="hljs-literal">null</span> ? path.toString() : <span class="hljs-string">''</span>;
        <span class="hljs-keyword">return</span> path.charAt(<span class="hljs-number">0</span>) == <span class="hljs-string">'/'</span> ? path : <span class="hljs-string">'/'</span> + path;
      }),
      <span class="hljs-attr">search</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">search, paramValue</span>) </span>{
        <span class="hljs-keyword">switch</span> (<span class="hljs-built_in">arguments</span>.length) {
          <span class="hljs-keyword">case</span> <span class="hljs-number">0</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.$$search;
          <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:
            <span class="hljs-keyword">if</span> (isString(search) || isNumber(search)) {
              search = search.toString();
              <span class="hljs-keyword">this</span>.$$search = parseKeyValue(search);
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (isObject(search)) {
              search = copy(search, {});
              forEach(search, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value, key</span>) </span>{
                <span class="hljs-keyword">if</span> (value == <span class="hljs-literal">null</span>) <span class="hljs-keyword">delete</span> search[key];
              });
              <span class="hljs-keyword">this</span>.$$search = search;
            } <span class="hljs-keyword">else</span> {
              <span class="hljs-keyword">throw</span> $locationMinErr(<span class="hljs-string">'isrcharg'</span>,
                <span class="hljs-string">'The first argument of the `$location#search()` call must be a string or an object.'</span>);
            }
            <span class="hljs-keyword">break</span>;
          <span class="hljs-keyword">default</span>:
            <span class="hljs-keyword">if</span> (isUndefined(paramValue) || paramValue === <span class="hljs-literal">null</span>) {
              <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.$$search[search];
            } <span class="hljs-keyword">else</span> {
              <span class="hljs-keyword">this</span>.$$search[search] = paramValue;
            }
        }
        <span class="hljs-keyword">this</span>.$$compose();
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
      },
      <span class="hljs-attr">hash</span>: locationGetterSetter(<span class="hljs-string">'$$hash'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">hash</span>) </span>{
        <span class="hljs-keyword">return</span> hash !== <span class="hljs-literal">null</span> ? hash.toString() : <span class="hljs-string">''</span>;
      }),
      <span class="hljs-attr">replace</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">this</span>.$$replace = <span class="hljs-literal">true</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
      }
    };
    forEach([LocationHashbangInHtml5Url, LocationHashbangUrl, LocationHtml5Url], <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">Location</span>) </span>{
      Location.prototype = <span class="hljs-built_in">Object</span>.create(locationPrototype);
      Location.prototype.state = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">state</span>) </span>{
        <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">arguments</span>.length) {
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.$$state;
        }
        <span class="hljs-keyword">if</span> (Location !== LocationHtml5Url || !<span class="hljs-keyword">this</span>.$$html5) {
          <span class="hljs-keyword">throw</span> $locationMinErr(<span class="hljs-string">'nostate'</span>, <span class="hljs-string">'History API state support is available only '</span> +
            <span class="hljs-string">'in HTML5 mode and only in browsers supporting HTML5 History API'</span>);
        }
        <span class="hljs-keyword">this</span>.$$state = isUndefined(state) ? <span class="hljs-literal">null</span> : state;
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
      };
    });

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">locationGetter</span>(<span class="hljs-params">property</span>) </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>[property];
      };
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">locationGetterSetter</span>(<span class="hljs-params">property, preprocess</span>) </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>) </span>{
        <span class="hljs-keyword">if</span> (isUndefined(value)) {
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>[property];
        }
        <span class="hljs-keyword">this</span>[property] = preprocess(value);
        <span class="hljs-keyword">this</span>.$$compose();
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
      };
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$LocationProvider</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> hashPrefix = <span class="hljs-string">''</span>,
        html5Mode = {
          <span class="hljs-attr">enabled</span>: <span class="hljs-literal">false</span>,
          <span class="hljs-attr">requireBase</span>: <span class="hljs-literal">true</span>,
          <span class="hljs-attr">rewriteLinks</span>: <span class="hljs-literal">true</span>
        };
      <span class="hljs-keyword">this</span>.hashPrefix = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">prefix</span>) </span>{
        <span class="hljs-keyword">if</span> (isDefined(prefix)) {
          hashPrefix = prefix;
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">return</span> hashPrefix;
        }
      };
      <span class="hljs-keyword">this</span>.html5Mode = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">mode</span>) </span>{
        <span class="hljs-keyword">if</span> (isBoolean(mode)) {
          html5Mode.enabled = mode;
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (isObject(mode)) {
          <span class="hljs-keyword">if</span> (isBoolean(mode.enabled)) {
            html5Mode.enabled = mode.enabled;
          }
          <span class="hljs-keyword">if</span> (isBoolean(mode.requireBase)) {
            html5Mode.requireBase = mode.requireBase;
          }
          <span class="hljs-keyword">if</span> (isBoolean(mode.rewriteLinks)) {
            html5Mode.rewriteLinks = mode.rewriteLinks;
          }
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">return</span> html5Mode;
        }
      };
      <span class="hljs-keyword">this</span>.$get = [<span class="hljs-string">'$rootScope'</span>, <span class="hljs-string">'$browser'</span>, <span class="hljs-string">'$sniffer'</span>, <span class="hljs-string">'$rootElement'</span>, <span class="hljs-string">'$window'</span>,
        <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$rootScope, $browser, $sniffer, $rootElement, $window</span>) </span>{
          <span class="hljs-keyword">var</span> $location,
            LocationMode,
            baseHref = $browser.baseHref(),
            initialUrl = $browser.url(),
            appBase;
          <span class="hljs-keyword">if</span> (html5Mode.enabled) {
            <span class="hljs-keyword">if</span> (!baseHref &amp;&amp; html5Mode.requireBase) {
              <span class="hljs-keyword">throw</span> $locationMinErr(<span class="hljs-string">'nobase'</span>,
                <span class="hljs-string">"$location in HTML5 mode requires a &lt;base&gt; tag to be present!"</span>);
            }
            appBase = serverBase(initialUrl) + (baseHref || <span class="hljs-string">'/'</span>);
            LocationMode = $sniffer.history ? LocationHtml5Url : LocationHashbangInHtml5Url;
          } <span class="hljs-keyword">else</span> {
            appBase = stripHash(initialUrl);
            LocationMode = LocationHashbangUrl;
          }
          <span class="hljs-keyword">var</span> appBaseNoFile = stripFile(appBase);
          $location = <span class="hljs-keyword">new</span> LocationMode(appBase, appBaseNoFile, <span class="hljs-string">'#'</span> + hashPrefix);
          $location.$$parseLinkUrl(initialUrl, initialUrl);
          $location.$$state = $browser.state();
          <span class="hljs-keyword">var</span> IGNORE_URI_REGEXP = <span class="hljs-regexp">/^\s*(javascript|mailto):/i</span>;

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setBrowserUrlWithFallback</span>(<span class="hljs-params">url, replace, state</span>) </span>{
            <span class="hljs-keyword">var</span> oldUrl = $location.url();
            <span class="hljs-keyword">var</span> oldState = $location.$$state;
            <span class="hljs-keyword">try</span> {
              $browser.url(url, replace, state);
              $location.$$state = $browser.state();
            } <span class="hljs-keyword">catch</span> (e) {
              $location.url(oldUrl);
              $location.$$state = oldState;
              <span class="hljs-keyword">throw</span> e;
            }
          }
          $rootElement.on(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>{
            <span class="hljs-keyword">if</span> (!html5Mode.rewriteLinks || event.ctrlKey || event.metaKey || event.shiftKey || event.which == <span class="hljs-number">2</span> || event.button == <span class="hljs-number">2</span>) <span class="hljs-keyword">return</span>;
            <span class="hljs-keyword">var</span> elm = jqLite(event.target);
            <span class="hljs-keyword">while</span> (nodeName_(elm[<span class="hljs-number">0</span>]) !== <span class="hljs-string">'a'</span>) {
              <span class="hljs-keyword">if</span> (elm[<span class="hljs-number">0</span>] === $rootElement[<span class="hljs-number">0</span>] || !(elm = elm.parent())[<span class="hljs-number">0</span>]) <span class="hljs-keyword">return</span>;
            }
            <span class="hljs-keyword">var</span> absHref = elm.prop(<span class="hljs-string">'href'</span>);
            <span class="hljs-keyword">var</span> relHref = elm.attr(<span class="hljs-string">'href'</span>) || elm.attr(<span class="hljs-string">'xlink:href'</span>);
            <span class="hljs-keyword">if</span> (isObject(absHref) &amp;&amp; absHref.toString() === <span class="hljs-string">'[object SVGAnimatedString]'</span>) {
              absHref = urlResolve(absHref.animVal).href;
            }
            <span class="hljs-keyword">if</span> (IGNORE_URI_REGEXP.test(absHref)) <span class="hljs-keyword">return</span>;
            <span class="hljs-keyword">if</span> (absHref &amp;&amp; !elm.attr(<span class="hljs-string">'target'</span>) &amp;&amp; !event.isDefaultPrevented()) {
              <span class="hljs-keyword">if</span> ($location.$$parseLinkUrl(absHref, relHref)) {
                event.preventDefault();
                <span class="hljs-keyword">if</span> ($location.absUrl() != $browser.url()) {
                  $rootScope.$apply();
                  $<span class="hljs-built_in">window</span>.angular[<span class="hljs-string">'ff-684208-preventDefault'</span>] = <span class="hljs-literal">true</span>;
                }
              }
            }
          });
          <span class="hljs-keyword">if</span> (trimEmptyHash($location.absUrl()) != trimEmptyHash(initialUrl)) {
            $browser.url($location.absUrl(), <span class="hljs-literal">true</span>);
          }
          <span class="hljs-keyword">var</span> initializing = <span class="hljs-literal">true</span>;
          $browser.onUrlChange(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">newUrl, newState</span>) </span>{
            <span class="hljs-keyword">if</span> (isUndefined(beginsWith(appBaseNoFile, newUrl))) {
              $<span class="hljs-built_in">window</span>.location.href = newUrl;
              <span class="hljs-keyword">return</span>;
            }
            $rootScope.$evalAsync(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
              <span class="hljs-keyword">var</span> oldUrl = $location.absUrl();
              <span class="hljs-keyword">var</span> oldState = $location.$$state;
              <span class="hljs-keyword">var</span> defaultPrevented;
              newUrl = trimEmptyHash(newUrl);
              $location.$$parse(newUrl);
              $location.$$state = newState;
              defaultPrevented = $rootScope.$broadcast(<span class="hljs-string">'$locationChangeStart'</span>, newUrl, oldUrl,
                newState, oldState).defaultPrevented;
              <span class="hljs-keyword">if</span> ($location.absUrl() !== newUrl) <span class="hljs-keyword">return</span>;
              <span class="hljs-keyword">if</span> (defaultPrevented) {
                $location.$$parse(oldUrl);
                $location.$$state = oldState;
                setBrowserUrlWithFallback(oldUrl, <span class="hljs-literal">false</span>, oldState);
              } <span class="hljs-keyword">else</span> {
                initializing = <span class="hljs-literal">false</span>;
                afterLocationChange(oldUrl, oldState);
              }
            });
            <span class="hljs-keyword">if</span> (!$rootScope.$$phase) $rootScope.$digest();
          });
          $rootScope.$watch(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$locationWatch</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">var</span> oldUrl = trimEmptyHash($browser.url());
            <span class="hljs-keyword">var</span> newUrl = trimEmptyHash($location.absUrl());
            <span class="hljs-keyword">var</span> oldState = $browser.state();
            <span class="hljs-keyword">var</span> currentReplace = $location.$$replace;
            <span class="hljs-keyword">var</span> urlOrStateChanged = oldUrl !== newUrl ||
              ($location.$$html5 &amp;&amp; $sniffer.history &amp;&amp; oldState !== $location.$$state);
            <span class="hljs-keyword">if</span> (initializing || urlOrStateChanged) {
              initializing = <span class="hljs-literal">false</span>;
              $rootScope.$evalAsync(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                <span class="hljs-keyword">var</span> newUrl = $location.absUrl();
                <span class="hljs-keyword">var</span> defaultPrevented = $rootScope.$broadcast(<span class="hljs-string">'$locationChangeStart'</span>, newUrl, oldUrl,
                  $location.$$state, oldState).defaultPrevented;
                <span class="hljs-keyword">if</span> ($location.absUrl() !== newUrl) <span class="hljs-keyword">return</span>;
                <span class="hljs-keyword">if</span> (defaultPrevented) {
                  $location.$$parse(oldUrl);
                  $location.$$state = oldState;
                } <span class="hljs-keyword">else</span> {
                  <span class="hljs-keyword">if</span> (urlOrStateChanged) {
                    setBrowserUrlWithFallback(newUrl, currentReplace,
                      oldState === $location.$$state ? <span class="hljs-literal">null</span> : $location.$$state);
                  }
                  afterLocationChange(oldUrl, oldState);
                }
              });
            }
            $location.$$replace = <span class="hljs-literal">false</span>;
          });
          <span class="hljs-keyword">return</span> $location;

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">afterLocationChange</span>(<span class="hljs-params">oldUrl, oldState</span>) </span>{
            $rootScope.$broadcast(<span class="hljs-string">'$locationChangeSuccess'</span>, $location.absUrl(), oldUrl,
              $location.$$state, oldState);
          }
        }
      ];
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$LogProvider</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> debug = <span class="hljs-literal">true</span>,
        self = <span class="hljs-keyword">this</span>;
      <span class="hljs-keyword">this</span>.debugEnabled = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">flag</span>) </span>{
        <span class="hljs-keyword">if</span> (isDefined(flag)) {
          debug = flag;
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">return</span> debug;
        }
      };
      <span class="hljs-keyword">this</span>.$get = [<span class="hljs-string">'$window'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$window</span>) </span>{
        <span class="hljs-keyword">return</span> {
          <span class="hljs-attr">log</span>: consoleLog(<span class="hljs-string">'log'</span>),
          <span class="hljs-attr">info</span>: consoleLog(<span class="hljs-string">'info'</span>),
          <span class="hljs-attr">warn</span>: consoleLog(<span class="hljs-string">'warn'</span>),
          <span class="hljs-attr">error</span>: consoleLog(<span class="hljs-string">'error'</span>),
          <span class="hljs-attr">debug</span>: (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">var</span> fn = consoleLog(<span class="hljs-string">'debug'</span>);
            <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
              <span class="hljs-keyword">if</span> (debug) {
                fn.apply(self, <span class="hljs-built_in">arguments</span>);
              }
            };
          }())
        };

        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">formatError</span>(<span class="hljs-params">arg</span>) </span>{
          <span class="hljs-keyword">if</span> (arg <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Error</span>) {
            <span class="hljs-keyword">if</span> (arg.stack) {
              arg = (arg.message &amp;&amp; arg.stack.indexOf(arg.message) === <span class="hljs-number">-1</span>) ?
                <span class="hljs-string">'Error: '</span> + arg.message + <span class="hljs-string">'\n'</span> + arg.stack :
                arg.stack;
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (arg.sourceURL) {
              arg = arg.message + <span class="hljs-string">'\n'</span> + arg.sourceURL + <span class="hljs-string">':'</span> + arg.line;
            }
          }
          <span class="hljs-keyword">return</span> arg;
        }

        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">consoleLog</span>(<span class="hljs-params">type</span>) </span>{
          <span class="hljs-keyword">var</span> <span class="hljs-built_in">console</span> = $<span class="hljs-built_in">window</span>.console || {},
            logFn = <span class="hljs-built_in">console</span>[type] || <span class="hljs-built_in">console</span>.log || noop,
            hasApply = <span class="hljs-literal">false</span>;
          <span class="hljs-keyword">try</span> {
            hasApply = !!logFn.apply;
          } <span class="hljs-keyword">catch</span> (e) {}
          <span class="hljs-keyword">if</span> (hasApply) {
            <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
              <span class="hljs-keyword">var</span> args = [];
              forEach(<span class="hljs-built_in">arguments</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">arg</span>) </span>{
                args.push(formatError(arg));
              });
              <span class="hljs-keyword">return</span> logFn.apply(<span class="hljs-built_in">console</span>, args);
            };
          }
          <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">arg1, arg2</span>) </span>{
            logFn(arg1, arg2 == <span class="hljs-literal">null</span> ? <span class="hljs-string">''</span> : arg2);
          };
        }
      }];
    }
    <span class="hljs-keyword">var</span> $parseMinErr = minErr(<span class="hljs-string">'$parse'</span>);

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ensureSafeMemberName</span>(<span class="hljs-params">name, fullExpression</span>) </span>{
      <span class="hljs-keyword">if</span> (name === <span class="hljs-string">"__defineGetter__"</span> || name === <span class="hljs-string">"__defineSetter__"</span> ||
        name === <span class="hljs-string">"__lookupGetter__"</span> || name === <span class="hljs-string">"__lookupSetter__"</span> ||
        name === <span class="hljs-string">"__proto__"</span>) {
        <span class="hljs-keyword">throw</span> $parseMinErr(<span class="hljs-string">'isecfld'</span>,
          <span class="hljs-string">'Attempting to access a disallowed field in Angular expressions! '</span> +
          <span class="hljs-string">'Expression: {0}'</span>, fullExpression);
      }
      <span class="hljs-keyword">return</span> name;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getStringValue</span>(<span class="hljs-params">name</span>) </span>{
      <span class="hljs-keyword">return</span> name + <span class="hljs-string">''</span>;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ensureSafeObject</span>(<span class="hljs-params">obj, fullExpression</span>) </span>{
      <span class="hljs-keyword">if</span> (obj) {
        <span class="hljs-keyword">if</span> (obj.constructor === obj) {
          <span class="hljs-keyword">throw</span> $parseMinErr(<span class="hljs-string">'isecfn'</span>,
            <span class="hljs-string">'Referencing Function in Angular expressions is disallowed! Expression: {0}'</span>,
            fullExpression);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (
          obj.window === obj) {
          <span class="hljs-keyword">throw</span> $parseMinErr(<span class="hljs-string">'isecwindow'</span>,
            <span class="hljs-string">'Referencing the Window in Angular expressions is disallowed! Expression: {0}'</span>,
            fullExpression);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (
          obj.children &amp;&amp; (obj.nodeName || (obj.prop &amp;&amp; obj.attr &amp;&amp; obj.find))) {
          <span class="hljs-keyword">throw</span> $parseMinErr(<span class="hljs-string">'isecdom'</span>,
            <span class="hljs-string">'Referencing DOM nodes in Angular expressions is disallowed! Expression: {0}'</span>,
            fullExpression);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (
          obj === <span class="hljs-built_in">Object</span>) {
          <span class="hljs-keyword">throw</span> $parseMinErr(<span class="hljs-string">'isecobj'</span>,
            <span class="hljs-string">'Referencing Object in Angular expressions is disallowed! Expression: {0}'</span>,
            fullExpression);
        }
      }
      <span class="hljs-keyword">return</span> obj;
    }
    <span class="hljs-keyword">var</span> CALL = <span class="hljs-built_in">Function</span>.prototype.call;
    <span class="hljs-keyword">var</span> APPLY = <span class="hljs-built_in">Function</span>.prototype.apply;
    <span class="hljs-keyword">var</span> BIND = <span class="hljs-built_in">Function</span>.prototype.bind;

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ensureSafeFunction</span>(<span class="hljs-params">obj, fullExpression</span>) </span>{
      <span class="hljs-keyword">if</span> (obj) {
        <span class="hljs-keyword">if</span> (obj.constructor === obj) {
          <span class="hljs-keyword">throw</span> $parseMinErr(<span class="hljs-string">'isecfn'</span>,
            <span class="hljs-string">'Referencing Function in Angular expressions is disallowed! Expression: {0}'</span>,
            fullExpression);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (obj === CALL || obj === APPLY || obj === BIND) {
          <span class="hljs-keyword">throw</span> $parseMinErr(<span class="hljs-string">'isecff'</span>,
            <span class="hljs-string">'Referencing call, apply or bind in Angular expressions is disallowed! Expression: {0}'</span>,
            fullExpression);
        }
      }
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ensureSafeAssignContext</span>(<span class="hljs-params">obj, fullExpression</span>) </span>{
      <span class="hljs-keyword">if</span> (obj) {
        <span class="hljs-keyword">if</span> (obj === (<span class="hljs-number">0</span>).constructor || obj === (<span class="hljs-literal">false</span>).constructor || obj === <span class="hljs-string">''</span>.constructor ||
          obj === {}.constructor || obj === [].constructor || obj === <span class="hljs-built_in">Function</span>.constructor) {
          <span class="hljs-keyword">throw</span> $parseMinErr(<span class="hljs-string">'isecaf'</span>,
            <span class="hljs-string">'Assigning to a constructor is disallowed! Expression: {0}'</span>, fullExpression);
        }
      }
    }
    <span class="hljs-keyword">var</span> OPERATORS = createMap();
    forEach(<span class="hljs-string">'+ - * / % === !== == != &lt; &gt; &lt;= &gt;= &amp;&amp; || ! = |'</span>.split(<span class="hljs-string">' '</span>), <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">operator</span>) </span>{
      OPERATORS[operator] = <span class="hljs-literal">true</span>;
    });
    <span class="hljs-keyword">var</span> ESCAPE = {
      <span class="hljs-string">"n"</span>: <span class="hljs-string">"\n"</span>,
      <span class="hljs-string">"f"</span>: <span class="hljs-string">"\f"</span>,
      <span class="hljs-string">"r"</span>: <span class="hljs-string">"\r"</span>,
      <span class="hljs-string">"t"</span>: <span class="hljs-string">"\t"</span>,
      <span class="hljs-string">"v"</span>: <span class="hljs-string">"\v"</span>,
      <span class="hljs-string">"'"</span>: <span class="hljs-string">"'"</span>,
      <span class="hljs-string">'"'</span>: <span class="hljs-string">'"'</span>
    };
    <span class="hljs-keyword">var</span> Lexer = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">options</span>) </span>{
      <span class="hljs-keyword">this</span>.options = options;
    };
    Lexer.prototype = {
      <span class="hljs-attr">constructor</span>: Lexer,
      <span class="hljs-attr">lex</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">text</span>) </span>{
        <span class="hljs-keyword">this</span>.text = text;
        <span class="hljs-keyword">this</span>.index = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.tokens = [];
        <span class="hljs-keyword">while</span> (<span class="hljs-keyword">this</span>.index &lt; <span class="hljs-keyword">this</span>.text.length) {
          <span class="hljs-keyword">var</span> ch = <span class="hljs-keyword">this</span>.text.charAt(<span class="hljs-keyword">this</span>.index);
          <span class="hljs-keyword">if</span> (ch === <span class="hljs-string">'"'</span> || ch === <span class="hljs-string">"'"</span>) {
            <span class="hljs-keyword">this</span>.readString(ch);
          } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.isNumber(ch) || ch === <span class="hljs-string">'.'</span> &amp;&amp; <span class="hljs-keyword">this</span>.isNumber(<span class="hljs-keyword">this</span>.peek())) {
            <span class="hljs-keyword">this</span>.readNumber();
          } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.isIdent(ch)) {
            <span class="hljs-keyword">this</span>.readIdent();
          } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.is(ch, <span class="hljs-string">'(){}[].,;:?'</span>)) {
            <span class="hljs-keyword">this</span>.tokens.push({
              <span class="hljs-attr">index</span>: <span class="hljs-keyword">this</span>.index,
              <span class="hljs-attr">text</span>: ch
            });
            <span class="hljs-keyword">this</span>.index++;
          } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.isWhitespace(ch)) {
            <span class="hljs-keyword">this</span>.index++;
          } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">var</span> ch2 = ch + <span class="hljs-keyword">this</span>.peek();
            <span class="hljs-keyword">var</span> ch3 = ch2 + <span class="hljs-keyword">this</span>.peek(<span class="hljs-number">2</span>);
            <span class="hljs-keyword">var</span> op1 = OPERATORS[ch];
            <span class="hljs-keyword">var</span> op2 = OPERATORS[ch2];
            <span class="hljs-keyword">var</span> op3 = OPERATORS[ch3];
            <span class="hljs-keyword">if</span> (op1 || op2 || op3) {
              <span class="hljs-keyword">var</span> token = op3 ? ch3 : (op2 ? ch2 : ch);
              <span class="hljs-keyword">this</span>.tokens.push({
                <span class="hljs-attr">index</span>: <span class="hljs-keyword">this</span>.index,
                <span class="hljs-attr">text</span>: token,
                <span class="hljs-attr">operator</span>: <span class="hljs-literal">true</span>
              });
              <span class="hljs-keyword">this</span>.index += token.length;
            } <span class="hljs-keyword">else</span> {
              <span class="hljs-keyword">this</span>.throwError(<span class="hljs-string">'Unexpected next character '</span>, <span class="hljs-keyword">this</span>.index, <span class="hljs-keyword">this</span>.index + <span class="hljs-number">1</span>);
            }
          }
        }
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.tokens;
      },
      <span class="hljs-attr">is</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">ch, chars</span>) </span>{
        <span class="hljs-keyword">return</span> chars.indexOf(ch) !== <span class="hljs-number">-1</span>;
      },
      <span class="hljs-attr">peek</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">i</span>) </span>{
        <span class="hljs-keyword">var</span> num = i || <span class="hljs-number">1</span>;
        <span class="hljs-keyword">return</span> (<span class="hljs-keyword">this</span>.index + num &lt; <span class="hljs-keyword">this</span>.text.length) ? <span class="hljs-keyword">this</span>.text.charAt(<span class="hljs-keyword">this</span>.index + num) : <span class="hljs-literal">false</span>;
      },
      <span class="hljs-attr">isNumber</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">ch</span>) </span>{
        <span class="hljs-keyword">return</span> (<span class="hljs-string">'0'</span> &lt;= ch &amp;&amp; ch &lt;= <span class="hljs-string">'9'</span>) &amp;&amp; <span class="hljs-keyword">typeof</span> ch === <span class="hljs-string">"string"</span>;
      },
      <span class="hljs-attr">isWhitespace</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">ch</span>) </span>{
        <span class="hljs-keyword">return</span> (ch === <span class="hljs-string">' '</span> || ch === <span class="hljs-string">'\r'</span> || ch === <span class="hljs-string">'\t'</span> ||
          ch === <span class="hljs-string">'\n'</span> || ch === <span class="hljs-string">'\v'</span> || ch === <span class="hljs-string">'\u00A0'</span>);
      },
      <span class="hljs-attr">isIdent</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">ch</span>) </span>{
        <span class="hljs-keyword">return</span> (<span class="hljs-string">'a'</span> &lt;= ch &amp;&amp; ch &lt;= <span class="hljs-string">'z'</span> ||
          <span class="hljs-string">'A'</span> &lt;= ch &amp;&amp; ch &lt;= <span class="hljs-string">'Z'</span> ||
          <span class="hljs-string">'_'</span> === ch || ch === <span class="hljs-string">'$'</span>);
      },
      <span class="hljs-attr">isExpOperator</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">ch</span>) </span>{
        <span class="hljs-keyword">return</span> (ch === <span class="hljs-string">'-'</span> || ch === <span class="hljs-string">'+'</span> || <span class="hljs-keyword">this</span>.isNumber(ch));
      },
      <span class="hljs-attr">throwError</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">error, start, end</span>) </span>{
        end = end || <span class="hljs-keyword">this</span>.index;
        <span class="hljs-keyword">var</span> colStr = (isDefined(start) ?
          <span class="hljs-string">'s '</span> + start + <span class="hljs-string">'-'</span> + <span class="hljs-keyword">this</span>.index + <span class="hljs-string">' ['</span> + <span class="hljs-keyword">this</span>.text.substring(start, end) + <span class="hljs-string">']'</span> :
          <span class="hljs-string">' '</span> + end);
        <span class="hljs-keyword">throw</span> $parseMinErr(<span class="hljs-string">'lexerr'</span>, <span class="hljs-string">'Lexer Error: {0} at column{1} in expression [{2}].'</span>,
          error, colStr, <span class="hljs-keyword">this</span>.text);
      },
      <span class="hljs-attr">readNumber</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> number = <span class="hljs-string">''</span>;
        <span class="hljs-keyword">var</span> start = <span class="hljs-keyword">this</span>.index;
        <span class="hljs-keyword">while</span> (<span class="hljs-keyword">this</span>.index &lt; <span class="hljs-keyword">this</span>.text.length) {
          <span class="hljs-keyword">var</span> ch = lowercase(<span class="hljs-keyword">this</span>.text.charAt(<span class="hljs-keyword">this</span>.index));
          <span class="hljs-keyword">if</span> (ch == <span class="hljs-string">'.'</span> || <span class="hljs-keyword">this</span>.isNumber(ch)) {
            number += ch;
          } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">var</span> peekCh = <span class="hljs-keyword">this</span>.peek();
            <span class="hljs-keyword">if</span> (ch == <span class="hljs-string">'e'</span> &amp;&amp; <span class="hljs-keyword">this</span>.isExpOperator(peekCh)) {
              number += ch;
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.isExpOperator(ch) &amp;&amp;
              peekCh &amp;&amp; <span class="hljs-keyword">this</span>.isNumber(peekCh) &amp;&amp;
              number.charAt(number.length - <span class="hljs-number">1</span>) == <span class="hljs-string">'e'</span>) {
              number += ch;
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.isExpOperator(ch) &amp;&amp;
              (!peekCh || !<span class="hljs-keyword">this</span>.isNumber(peekCh)) &amp;&amp;
              number.charAt(number.length - <span class="hljs-number">1</span>) == <span class="hljs-string">'e'</span>) {
              <span class="hljs-keyword">this</span>.throwError(<span class="hljs-string">'Invalid exponent'</span>);
            } <span class="hljs-keyword">else</span> {
              <span class="hljs-keyword">break</span>;
            }
          }
          <span class="hljs-keyword">this</span>.index++;
        }
        <span class="hljs-keyword">this</span>.tokens.push({
          <span class="hljs-attr">index</span>: start,
          <span class="hljs-attr">text</span>: number,
          <span class="hljs-attr">constant</span>: <span class="hljs-literal">true</span>,
          <span class="hljs-attr">value</span>: <span class="hljs-built_in">Number</span>(number)
        });
      },
      <span class="hljs-attr">readIdent</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> start = <span class="hljs-keyword">this</span>.index;
        <span class="hljs-keyword">while</span> (<span class="hljs-keyword">this</span>.index &lt; <span class="hljs-keyword">this</span>.text.length) {
          <span class="hljs-keyword">var</span> ch = <span class="hljs-keyword">this</span>.text.charAt(<span class="hljs-keyword">this</span>.index);
          <span class="hljs-keyword">if</span> (!(<span class="hljs-keyword">this</span>.isIdent(ch) || <span class="hljs-keyword">this</span>.isNumber(ch))) {
            <span class="hljs-keyword">break</span>;
          }
          <span class="hljs-keyword">this</span>.index++;
        }
        <span class="hljs-keyword">this</span>.tokens.push({
          <span class="hljs-attr">index</span>: start,
          <span class="hljs-attr">text</span>: <span class="hljs-keyword">this</span>.text.slice(start, <span class="hljs-keyword">this</span>.index),
          <span class="hljs-attr">identifier</span>: <span class="hljs-literal">true</span>
        });
      },
      <span class="hljs-attr">readString</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">quote</span>) </span>{
        <span class="hljs-keyword">var</span> start = <span class="hljs-keyword">this</span>.index;
        <span class="hljs-keyword">this</span>.index++;
        <span class="hljs-keyword">var</span> string = <span class="hljs-string">''</span>;
        <span class="hljs-keyword">var</span> rawString = quote;
        <span class="hljs-keyword">var</span> <span class="hljs-built_in">escape</span> = <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">while</span> (<span class="hljs-keyword">this</span>.index &lt; <span class="hljs-keyword">this</span>.text.length) {
          <span class="hljs-keyword">var</span> ch = <span class="hljs-keyword">this</span>.text.charAt(<span class="hljs-keyword">this</span>.index);
          rawString += ch;
          <span class="hljs-keyword">if</span> (<span class="hljs-built_in">escape</span>) {
            <span class="hljs-keyword">if</span> (ch === <span class="hljs-string">'u'</span>) {
              <span class="hljs-keyword">var</span> hex = <span class="hljs-keyword">this</span>.text.substring(<span class="hljs-keyword">this</span>.index + <span class="hljs-number">1</span>, <span class="hljs-keyword">this</span>.index + <span class="hljs-number">5</span>);
              <span class="hljs-keyword">if</span> (!hex.match(<span class="hljs-regexp">/[\da-f]{4}/i</span>)) {
                <span class="hljs-keyword">this</span>.throwError(<span class="hljs-string">'Invalid unicode escape [\\u'</span> + hex + <span class="hljs-string">']'</span>);
              }
              <span class="hljs-keyword">this</span>.index += <span class="hljs-number">4</span>;
              string += <span class="hljs-built_in">String</span>.fromCharCode(<span class="hljs-built_in">parseInt</span>(hex, <span class="hljs-number">16</span>));
            } <span class="hljs-keyword">else</span> {
              <span class="hljs-keyword">var</span> rep = ESCAPE[ch];
              string = string + (rep || ch);
            }
            <span class="hljs-built_in">escape</span> = <span class="hljs-literal">false</span>;
          } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (ch === <span class="hljs-string">'\\'</span>) {
            <span class="hljs-built_in">escape</span> = <span class="hljs-literal">true</span>;
          } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (ch === quote) {
            <span class="hljs-keyword">this</span>.index++;
            <span class="hljs-keyword">this</span>.tokens.push({
              <span class="hljs-attr">index</span>: start,
              <span class="hljs-attr">text</span>: rawString,
              <span class="hljs-attr">constant</span>: <span class="hljs-literal">true</span>,
              <span class="hljs-attr">value</span>: string
            });
            <span class="hljs-keyword">return</span>;
          } <span class="hljs-keyword">else</span> {
            string += ch;
          }
          <span class="hljs-keyword">this</span>.index++;
        }
        <span class="hljs-keyword">this</span>.throwError(<span class="hljs-string">'Unterminated quote'</span>, start);
      }
    };
    <span class="hljs-keyword">var</span> AST = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">lexer, options</span>) </span>{
      <span class="hljs-keyword">this</span>.lexer = lexer;
      <span class="hljs-keyword">this</span>.options = options;
    };
    AST.Program = <span class="hljs-string">'Program'</span>;
    AST.ExpressionStatement = <span class="hljs-string">'ExpressionStatement'</span>;
    AST.AssignmentExpression = <span class="hljs-string">'AssignmentExpression'</span>;
    AST.ConditionalExpression = <span class="hljs-string">'ConditionalExpression'</span>;
    AST.LogicalExpression = <span class="hljs-string">'LogicalExpression'</span>;
    AST.BinaryExpression = <span class="hljs-string">'BinaryExpression'</span>;
    AST.UnaryExpression = <span class="hljs-string">'UnaryExpression'</span>;
    AST.CallExpression = <span class="hljs-string">'CallExpression'</span>;
    AST.MemberExpression = <span class="hljs-string">'MemberExpression'</span>;
    AST.Identifier = <span class="hljs-string">'Identifier'</span>;
    AST.Literal = <span class="hljs-string">'Literal'</span>;
    AST.ArrayExpression = <span class="hljs-string">'ArrayExpression'</span>;
    AST.Property = <span class="hljs-string">'Property'</span>;
    AST.ObjectExpression = <span class="hljs-string">'ObjectExpression'</span>;
    AST.ThisExpression = <span class="hljs-string">'ThisExpression'</span>;
    AST.LocalsExpression = <span class="hljs-string">'LocalsExpression'</span>;
    AST.NGValueParameter = <span class="hljs-string">'NGValueParameter'</span>;
    AST.prototype = {
      <span class="hljs-attr">ast</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">text</span>) </span>{
        <span class="hljs-keyword">this</span>.text = text;
        <span class="hljs-keyword">this</span>.tokens = <span class="hljs-keyword">this</span>.lexer.lex(text);
        <span class="hljs-keyword">var</span> value = <span class="hljs-keyword">this</span>.program();
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.tokens.length !== <span class="hljs-number">0</span>) {
          <span class="hljs-keyword">this</span>.throwError(<span class="hljs-string">'is an unexpected token'</span>, <span class="hljs-keyword">this</span>.tokens[<span class="hljs-number">0</span>]);
        }
        <span class="hljs-keyword">return</span> value;
      },
      <span class="hljs-attr">program</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> body = [];
        <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
          <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.tokens.length &gt; <span class="hljs-number">0</span> &amp;&amp; !<span class="hljs-keyword">this</span>.peek(<span class="hljs-string">'}'</span>, <span class="hljs-string">')'</span>, <span class="hljs-string">';'</span>, <span class="hljs-string">']'</span>))
            body.push(<span class="hljs-keyword">this</span>.expressionStatement());
          <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.expect(<span class="hljs-string">';'</span>)) {
            <span class="hljs-keyword">return</span> {
              <span class="hljs-attr">type</span>: AST.Program,
              <span class="hljs-attr">body</span>: body
            };
          }
        }
      },
      <span class="hljs-attr">expressionStatement</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> {
          <span class="hljs-attr">type</span>: AST.ExpressionStatement,
          <span class="hljs-attr">expression</span>: <span class="hljs-keyword">this</span>.filterChain()
        };
      },
      <span class="hljs-attr">filterChain</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> left = <span class="hljs-keyword">this</span>.expression();
        <span class="hljs-keyword">var</span> token;
        <span class="hljs-keyword">while</span> ((token = <span class="hljs-keyword">this</span>.expect(<span class="hljs-string">'|'</span>))) {
          left = <span class="hljs-keyword">this</span>.filter(left);
        }
        <span class="hljs-keyword">return</span> left;
      },
      <span class="hljs-attr">expression</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.assignment();
      },
      <span class="hljs-attr">assignment</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> result = <span class="hljs-keyword">this</span>.ternary();
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.expect(<span class="hljs-string">'='</span>)) {
          result = {
            <span class="hljs-attr">type</span>: AST.AssignmentExpression,
            <span class="hljs-attr">left</span>: result,
            <span class="hljs-attr">right</span>: <span class="hljs-keyword">this</span>.assignment(),
            <span class="hljs-attr">operator</span>: <span class="hljs-string">'='</span>
          };
        }
        <span class="hljs-keyword">return</span> result;
      },
      <span class="hljs-attr">ternary</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> test = <span class="hljs-keyword">this</span>.logicalOR();
        <span class="hljs-keyword">var</span> alternate;
        <span class="hljs-keyword">var</span> consequent;
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.expect(<span class="hljs-string">'?'</span>)) {
          alternate = <span class="hljs-keyword">this</span>.expression();
          <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.consume(<span class="hljs-string">':'</span>)) {
            consequent = <span class="hljs-keyword">this</span>.expression();
            <span class="hljs-keyword">return</span> {
              <span class="hljs-attr">type</span>: AST.ConditionalExpression,
              <span class="hljs-attr">test</span>: test,
              <span class="hljs-attr">alternate</span>: alternate,
              <span class="hljs-attr">consequent</span>: consequent
            };
          }
        }
        <span class="hljs-keyword">return</span> test;
      },
      <span class="hljs-attr">logicalOR</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> left = <span class="hljs-keyword">this</span>.logicalAND();
        <span class="hljs-keyword">while</span> (<span class="hljs-keyword">this</span>.expect(<span class="hljs-string">'||'</span>)) {
          left = {
            <span class="hljs-attr">type</span>: AST.LogicalExpression,
            <span class="hljs-attr">operator</span>: <span class="hljs-string">'||'</span>,
            <span class="hljs-attr">left</span>: left,
            <span class="hljs-attr">right</span>: <span class="hljs-keyword">this</span>.logicalAND()
          };
        }
        <span class="hljs-keyword">return</span> left;
      },
      <span class="hljs-attr">logicalAND</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> left = <span class="hljs-keyword">this</span>.equality();
        <span class="hljs-keyword">while</span> (<span class="hljs-keyword">this</span>.expect(<span class="hljs-string">'&amp;&amp;'</span>)) {
          left = {
            <span class="hljs-attr">type</span>: AST.LogicalExpression,
            <span class="hljs-attr">operator</span>: <span class="hljs-string">'&amp;&amp;'</span>,
            <span class="hljs-attr">left</span>: left,
            <span class="hljs-attr">right</span>: <span class="hljs-keyword">this</span>.equality()
          };
        }
        <span class="hljs-keyword">return</span> left;
      },
      <span class="hljs-attr">equality</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> left = <span class="hljs-keyword">this</span>.relational();
        <span class="hljs-keyword">var</span> token;
        <span class="hljs-keyword">while</span> ((token = <span class="hljs-keyword">this</span>.expect(<span class="hljs-string">'=='</span>, <span class="hljs-string">'!='</span>, <span class="hljs-string">'==='</span>, <span class="hljs-string">'!=='</span>))) {
          left = {
            <span class="hljs-attr">type</span>: AST.BinaryExpression,
            <span class="hljs-attr">operator</span>: token.text,
            <span class="hljs-attr">left</span>: left,
            <span class="hljs-attr">right</span>: <span class="hljs-keyword">this</span>.relational()
          };
        }
        <span class="hljs-keyword">return</span> left;
      },
      <span class="hljs-attr">relational</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> left = <span class="hljs-keyword">this</span>.additive();
        <span class="hljs-keyword">var</span> token;
        <span class="hljs-keyword">while</span> ((token = <span class="hljs-keyword">this</span>.expect(<span class="hljs-string">'&lt;'</span>, <span class="hljs-string">'&gt;'</span>, <span class="hljs-string">'&lt;='</span>, <span class="hljs-string">'&gt;='</span>))) {
          left = {
            <span class="hljs-attr">type</span>: AST.BinaryExpression,
            <span class="hljs-attr">operator</span>: token.text,
            <span class="hljs-attr">left</span>: left,
            <span class="hljs-attr">right</span>: <span class="hljs-keyword">this</span>.additive()
          };
        }
        <span class="hljs-keyword">return</span> left;
      },
      <span class="hljs-attr">additive</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> left = <span class="hljs-keyword">this</span>.multiplicative();
        <span class="hljs-keyword">var</span> token;
        <span class="hljs-keyword">while</span> ((token = <span class="hljs-keyword">this</span>.expect(<span class="hljs-string">'+'</span>, <span class="hljs-string">'-'</span>))) {
          left = {
            <span class="hljs-attr">type</span>: AST.BinaryExpression,
            <span class="hljs-attr">operator</span>: token.text,
            <span class="hljs-attr">left</span>: left,
            <span class="hljs-attr">right</span>: <span class="hljs-keyword">this</span>.multiplicative()
          };
        }
        <span class="hljs-keyword">return</span> left;
      },
      <span class="hljs-attr">multiplicative</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> left = <span class="hljs-keyword">this</span>.unary();
        <span class="hljs-keyword">var</span> token;
        <span class="hljs-keyword">while</span> ((token = <span class="hljs-keyword">this</span>.expect(<span class="hljs-string">'*'</span>, <span class="hljs-string">'/'</span>, <span class="hljs-string">'%'</span>))) {
          left = {
            <span class="hljs-attr">type</span>: AST.BinaryExpression,
            <span class="hljs-attr">operator</span>: token.text,
            <span class="hljs-attr">left</span>: left,
            <span class="hljs-attr">right</span>: <span class="hljs-keyword">this</span>.unary()
          };
        }
        <span class="hljs-keyword">return</span> left;
      },
      <span class="hljs-attr">unary</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> token;
        <span class="hljs-keyword">if</span> ((token = <span class="hljs-keyword">this</span>.expect(<span class="hljs-string">'+'</span>, <span class="hljs-string">'-'</span>, <span class="hljs-string">'!'</span>))) {
          <span class="hljs-keyword">return</span> {
            <span class="hljs-attr">type</span>: AST.UnaryExpression,
            <span class="hljs-attr">operator</span>: token.text,
            <span class="hljs-attr">prefix</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">argument</span>: <span class="hljs-keyword">this</span>.unary()
          };
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.primary();
        }
      },
      <span class="hljs-attr">primary</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> primary;
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.expect(<span class="hljs-string">'('</span>)) {
          primary = <span class="hljs-keyword">this</span>.filterChain();
          <span class="hljs-keyword">this</span>.consume(<span class="hljs-string">')'</span>);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.expect(<span class="hljs-string">'['</span>)) {
          primary = <span class="hljs-keyword">this</span>.arrayDeclaration();
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.expect(<span class="hljs-string">'{'</span>)) {
          primary = <span class="hljs-keyword">this</span>.object();
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.selfReferential.hasOwnProperty(<span class="hljs-keyword">this</span>.peek().text)) {
          primary = copy(<span class="hljs-keyword">this</span>.selfReferential[<span class="hljs-keyword">this</span>.consume().text]);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.literals.hasOwnProperty(<span class="hljs-keyword">this</span>.peek().text)) {
          primary = {
            <span class="hljs-attr">type</span>: AST.Literal,
            <span class="hljs-attr">value</span>: <span class="hljs-keyword">this</span>.options.literals[<span class="hljs-keyword">this</span>.consume().text]
          };
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.peek().identifier) {
          primary = <span class="hljs-keyword">this</span>.identifier();
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.peek().constant) {
          primary = <span class="hljs-keyword">this</span>.constant();
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">this</span>.throwError(<span class="hljs-string">'not a primary expression'</span>, <span class="hljs-keyword">this</span>.peek());
        }
        <span class="hljs-keyword">var</span> next;
        <span class="hljs-keyword">while</span> ((next = <span class="hljs-keyword">this</span>.expect(<span class="hljs-string">'('</span>, <span class="hljs-string">'['</span>, <span class="hljs-string">'.'</span>))) {
          <span class="hljs-keyword">if</span> (next.text === <span class="hljs-string">'('</span>) {
            primary = {
              <span class="hljs-attr">type</span>: AST.CallExpression,
              <span class="hljs-attr">callee</span>: primary,
              <span class="hljs-attr">arguments</span>: <span class="hljs-keyword">this</span>.parseArguments()
            };
            <span class="hljs-keyword">this</span>.consume(<span class="hljs-string">')'</span>);
          } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (next.text === <span class="hljs-string">'['</span>) {
            primary = {
              <span class="hljs-attr">type</span>: AST.MemberExpression,
              <span class="hljs-attr">object</span>: primary,
              <span class="hljs-attr">property</span>: <span class="hljs-keyword">this</span>.expression(),
              <span class="hljs-attr">computed</span>: <span class="hljs-literal">true</span>
            };
            <span class="hljs-keyword">this</span>.consume(<span class="hljs-string">']'</span>);
          } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (next.text === <span class="hljs-string">'.'</span>) {
            primary = {
              <span class="hljs-attr">type</span>: AST.MemberExpression,
              <span class="hljs-attr">object</span>: primary,
              <span class="hljs-attr">property</span>: <span class="hljs-keyword">this</span>.identifier(),
              <span class="hljs-attr">computed</span>: <span class="hljs-literal">false</span>
            };
          } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">this</span>.throwError(<span class="hljs-string">'IMPOSSIBLE'</span>);
          }
        }
        <span class="hljs-keyword">return</span> primary;
      },
      <span class="hljs-attr">filter</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">baseExpression</span>) </span>{
        <span class="hljs-keyword">var</span> args = [baseExpression];
        <span class="hljs-keyword">var</span> result = {
          <span class="hljs-attr">type</span>: AST.CallExpression,
          <span class="hljs-attr">callee</span>: <span class="hljs-keyword">this</span>.identifier(),
          <span class="hljs-attr">arguments</span>: args,
          <span class="hljs-attr">filter</span>: <span class="hljs-literal">true</span>
        };
        <span class="hljs-keyword">while</span> (<span class="hljs-keyword">this</span>.expect(<span class="hljs-string">':'</span>)) {
          args.push(<span class="hljs-keyword">this</span>.expression());
        }
        <span class="hljs-keyword">return</span> result;
      },
      <span class="hljs-attr">parseArguments</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> args = [];
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.peekToken().text !== <span class="hljs-string">')'</span>) {
          <span class="hljs-keyword">do</span> {
            args.push(<span class="hljs-keyword">this</span>.expression());
          } <span class="hljs-keyword">while</span> (<span class="hljs-keyword">this</span>.expect(<span class="hljs-string">','</span>));
        }
        <span class="hljs-keyword">return</span> args;
      },
      <span class="hljs-attr">identifier</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> token = <span class="hljs-keyword">this</span>.consume();
        <span class="hljs-keyword">if</span> (!token.identifier) {
          <span class="hljs-keyword">this</span>.throwError(<span class="hljs-string">'is not a valid identifier'</span>, token);
        }
        <span class="hljs-keyword">return</span> {
          <span class="hljs-attr">type</span>: AST.Identifier,
          <span class="hljs-attr">name</span>: token.text
        };
      },
      <span class="hljs-attr">constant</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> {
          <span class="hljs-attr">type</span>: AST.Literal,
          <span class="hljs-attr">value</span>: <span class="hljs-keyword">this</span>.consume().value
        };
      },
      <span class="hljs-attr">arrayDeclaration</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> elements = [];
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.peekToken().text !== <span class="hljs-string">']'</span>) {
          <span class="hljs-keyword">do</span> {
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.peek(<span class="hljs-string">']'</span>)) {
              <span class="hljs-keyword">break</span>;
            }
            elements.push(<span class="hljs-keyword">this</span>.expression());
          } <span class="hljs-keyword">while</span> (<span class="hljs-keyword">this</span>.expect(<span class="hljs-string">','</span>));
        }
        <span class="hljs-keyword">this</span>.consume(<span class="hljs-string">']'</span>);
        <span class="hljs-keyword">return</span> {
          <span class="hljs-attr">type</span>: AST.ArrayExpression,
          <span class="hljs-attr">elements</span>: elements
        };
      },
      <span class="hljs-attr">object</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> properties = [],
          property;
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.peekToken().text !== <span class="hljs-string">'}'</span>) {
          <span class="hljs-keyword">do</span> {
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.peek(<span class="hljs-string">'}'</span>)) {
              <span class="hljs-keyword">break</span>;
            }
            property = {
              <span class="hljs-attr">type</span>: AST.Property,
              <span class="hljs-attr">kind</span>: <span class="hljs-string">'init'</span>
            };
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.peek().constant) {
              property.key = <span class="hljs-keyword">this</span>.constant();
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.peek().identifier) {
              property.key = <span class="hljs-keyword">this</span>.identifier();
            } <span class="hljs-keyword">else</span> {
              <span class="hljs-keyword">this</span>.throwError(<span class="hljs-string">"invalid key"</span>, <span class="hljs-keyword">this</span>.peek());
            }
            <span class="hljs-keyword">this</span>.consume(<span class="hljs-string">':'</span>);
            property.value = <span class="hljs-keyword">this</span>.expression();
            properties.push(property);
          } <span class="hljs-keyword">while</span> (<span class="hljs-keyword">this</span>.expect(<span class="hljs-string">','</span>));
        }
        <span class="hljs-keyword">this</span>.consume(<span class="hljs-string">'}'</span>);
        <span class="hljs-keyword">return</span> {
          <span class="hljs-attr">type</span>: AST.ObjectExpression,
          <span class="hljs-attr">properties</span>: properties
        };
      },
      <span class="hljs-attr">throwError</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">msg, token</span>) </span>{
        <span class="hljs-keyword">throw</span> $parseMinErr(<span class="hljs-string">'syntax'</span>,
          <span class="hljs-string">'Syntax Error: Token \'{0}\' {1} at column {2} of the expression [{3}] starting at [{4}].'</span>,
          token.text, msg, (token.index + <span class="hljs-number">1</span>), <span class="hljs-keyword">this</span>.text, <span class="hljs-keyword">this</span>.text.substring(token.index));
      },
      <span class="hljs-attr">consume</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e1</span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.tokens.length === <span class="hljs-number">0</span>) {
          <span class="hljs-keyword">throw</span> $parseMinErr(<span class="hljs-string">'ueoe'</span>, <span class="hljs-string">'Unexpected end of expression: {0}'</span>, <span class="hljs-keyword">this</span>.text);
        }
        <span class="hljs-keyword">var</span> token = <span class="hljs-keyword">this</span>.expect(e1);
        <span class="hljs-keyword">if</span> (!token) {
          <span class="hljs-keyword">this</span>.throwError(<span class="hljs-string">'is unexpected, expecting ['</span> + e1 + <span class="hljs-string">']'</span>, <span class="hljs-keyword">this</span>.peek());
        }
        <span class="hljs-keyword">return</span> token;
      },
      <span class="hljs-attr">peekToken</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.tokens.length === <span class="hljs-number">0</span>) {
          <span class="hljs-keyword">throw</span> $parseMinErr(<span class="hljs-string">'ueoe'</span>, <span class="hljs-string">'Unexpected end of expression: {0}'</span>, <span class="hljs-keyword">this</span>.text);
        }
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.tokens[<span class="hljs-number">0</span>];
      },
      <span class="hljs-attr">peek</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e1, e2, e3, e4</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.peekAhead(<span class="hljs-number">0</span>, e1, e2, e3, e4);
      },
      <span class="hljs-attr">peekAhead</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">i, e1, e2, e3, e4</span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.tokens.length &gt; i) {
          <span class="hljs-keyword">var</span> token = <span class="hljs-keyword">this</span>.tokens[i];
          <span class="hljs-keyword">var</span> t = token.text;
          <span class="hljs-keyword">if</span> (t === e1 || t === e2 || t === e3 || t === e4 ||
            (!e1 &amp;&amp; !e2 &amp;&amp; !e3 &amp;&amp; !e4)) {
            <span class="hljs-keyword">return</span> token;
          }
        }
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
      },
      <span class="hljs-attr">expect</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e1, e2, e3, e4</span>) </span>{
        <span class="hljs-keyword">var</span> token = <span class="hljs-keyword">this</span>.peek(e1, e2, e3, e4);
        <span class="hljs-keyword">if</span> (token) {
          <span class="hljs-keyword">this</span>.tokens.shift();
          <span class="hljs-keyword">return</span> token;
        }
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
      },
      <span class="hljs-attr">selfReferential</span>: {
        <span class="hljs-string">'this'</span>: {
          <span class="hljs-attr">type</span>: AST.ThisExpression
        },
        <span class="hljs-string">'$locals'</span>: {
          <span class="hljs-attr">type</span>: AST.LocalsExpression
        }
      }
    };

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ifDefined</span>(<span class="hljs-params">v, d</span>) </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> v !== <span class="hljs-string">'undefined'</span> ? v : d;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">plusFn</span>(<span class="hljs-params">l, r</span>) </span>{
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> l === <span class="hljs-string">'undefined'</span>) <span class="hljs-keyword">return</span> r;
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> r === <span class="hljs-string">'undefined'</span>) <span class="hljs-keyword">return</span> l;
      <span class="hljs-keyword">return</span> l + r;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isStateless</span>(<span class="hljs-params">$filter, filterName</span>) </span>{
      <span class="hljs-keyword">var</span> fn = $filter(filterName);
      <span class="hljs-keyword">return</span> !fn.$stateful;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">findConstantAndWatchExpressions</span>(<span class="hljs-params">ast, $filter</span>) </span>{
      <span class="hljs-keyword">var</span> allConstants;
      <span class="hljs-keyword">var</span> argsToWatch;
      <span class="hljs-keyword">switch</span> (ast.type) {
        <span class="hljs-keyword">case</span> AST.Program:
          allConstants = <span class="hljs-literal">true</span>;
          forEach(ast.body, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">expr</span>) </span>{
            findConstantAndWatchExpressions(expr.expression, $filter);
            allConstants = allConstants &amp;&amp; expr.expression.constant;
          });
          ast.constant = allConstants;
          <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> AST.Literal:
          ast.constant = <span class="hljs-literal">true</span>;
          ast.toWatch = [];
          <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> AST.UnaryExpression:
          findConstantAndWatchExpressions(ast.argument, $filter);
          ast.constant = ast.argument.constant;
          ast.toWatch = ast.argument.toWatch;
          <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> AST.BinaryExpression:
          findConstantAndWatchExpressions(ast.left, $filter);
          findConstantAndWatchExpressions(ast.right, $filter);
          ast.constant = ast.left.constant &amp;&amp; ast.right.constant;
          ast.toWatch = ast.left.toWatch.concat(ast.right.toWatch);
          <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> AST.LogicalExpression:
          findConstantAndWatchExpressions(ast.left, $filter);
          findConstantAndWatchExpressions(ast.right, $filter);
          ast.constant = ast.left.constant &amp;&amp; ast.right.constant;
          ast.toWatch = ast.constant ? [] : [ast];
          <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> AST.ConditionalExpression:
          findConstantAndWatchExpressions(ast.test, $filter);
          findConstantAndWatchExpressions(ast.alternate, $filter);
          findConstantAndWatchExpressions(ast.consequent, $filter);
          ast.constant = ast.test.constant &amp;&amp; ast.alternate.constant &amp;&amp; ast.consequent.constant;
          ast.toWatch = ast.constant ? [] : [ast];
          <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> AST.Identifier:
          ast.constant = <span class="hljs-literal">false</span>;
          ast.toWatch = [ast];
          <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> AST.MemberExpression:
          findConstantAndWatchExpressions(ast.object, $filter);
          <span class="hljs-keyword">if</span> (ast.computed) {
            findConstantAndWatchExpressions(ast.property, $filter);
          }
          ast.constant = ast.object.constant &amp;&amp; (!ast.computed || ast.property.constant);
          ast.toWatch = [ast];
          <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> AST.CallExpression:
          allConstants = ast.filter ? isStateless($filter, ast.callee.name) : <span class="hljs-literal">false</span>;
          argsToWatch = [];
          forEach(ast.arguments, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">expr</span>) </span>{
            findConstantAndWatchExpressions(expr, $filter);
            allConstants = allConstants &amp;&amp; expr.constant;
            <span class="hljs-keyword">if</span> (!expr.constant) {
              argsToWatch.push.apply(argsToWatch, expr.toWatch);
            }
          });
          ast.constant = allConstants;
          ast.toWatch = ast.filter &amp;&amp; isStateless($filter, ast.callee.name) ? argsToWatch : [ast];
          <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> AST.AssignmentExpression:
          findConstantAndWatchExpressions(ast.left, $filter);
          findConstantAndWatchExpressions(ast.right, $filter);
          ast.constant = ast.left.constant &amp;&amp; ast.right.constant;
          ast.toWatch = [ast];
          <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> AST.ArrayExpression:
          allConstants = <span class="hljs-literal">true</span>;
          argsToWatch = [];
          forEach(ast.elements, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">expr</span>) </span>{
            findConstantAndWatchExpressions(expr, $filter);
            allConstants = allConstants &amp;&amp; expr.constant;
            <span class="hljs-keyword">if</span> (!expr.constant) {
              argsToWatch.push.apply(argsToWatch, expr.toWatch);
            }
          });
          ast.constant = allConstants;
          ast.toWatch = argsToWatch;
          <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> AST.ObjectExpression:
          allConstants = <span class="hljs-literal">true</span>;
          argsToWatch = [];
          forEach(ast.properties, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">property</span>) </span>{
            findConstantAndWatchExpressions(property.value, $filter);
            allConstants = allConstants &amp;&amp; property.value.constant;
            <span class="hljs-keyword">if</span> (!property.value.constant) {
              argsToWatch.push.apply(argsToWatch, property.value.toWatch);
            }
          });
          ast.constant = allConstants;
          ast.toWatch = argsToWatch;
          <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> AST.ThisExpression:
          ast.constant = <span class="hljs-literal">false</span>;
          ast.toWatch = [];
          <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> AST.LocalsExpression:
          ast.constant = <span class="hljs-literal">false</span>;
          ast.toWatch = [];
          <span class="hljs-keyword">break</span>;
      }
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getInputs</span>(<span class="hljs-params">body</span>) </span>{
      <span class="hljs-keyword">if</span> (body.length != <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span>;
      <span class="hljs-keyword">var</span> lastExpression = body[<span class="hljs-number">0</span>].expression;
      <span class="hljs-keyword">var</span> candidate = lastExpression.toWatch;
      <span class="hljs-keyword">if</span> (candidate.length !== <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> candidate;
      <span class="hljs-keyword">return</span> candidate[<span class="hljs-number">0</span>] !== lastExpression ? candidate : <span class="hljs-literal">undefined</span>;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isAssignable</span>(<span class="hljs-params">ast</span>) </span>{
      <span class="hljs-keyword">return</span> ast.type === AST.Identifier || ast.type === AST.MemberExpression;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">assignableAST</span>(<span class="hljs-params">ast</span>) </span>{
      <span class="hljs-keyword">if</span> (ast.body.length === <span class="hljs-number">1</span> &amp;&amp; isAssignable(ast.body[<span class="hljs-number">0</span>].expression)) {
        <span class="hljs-keyword">return</span> {
          <span class="hljs-attr">type</span>: AST.AssignmentExpression,
          <span class="hljs-attr">left</span>: ast.body[<span class="hljs-number">0</span>].expression,
          <span class="hljs-attr">right</span>: {
            <span class="hljs-attr">type</span>: AST.NGValueParameter
          },
          <span class="hljs-attr">operator</span>: <span class="hljs-string">'='</span>
        };
      }
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isLiteral</span>(<span class="hljs-params">ast</span>) </span>{
      <span class="hljs-keyword">return</span> ast.body.length === <span class="hljs-number">0</span> ||
        ast.body.length === <span class="hljs-number">1</span> &amp;&amp; (
          ast.body[<span class="hljs-number">0</span>].expression.type === AST.Literal ||
          ast.body[<span class="hljs-number">0</span>].expression.type === AST.ArrayExpression ||
          ast.body[<span class="hljs-number">0</span>].expression.type === AST.ObjectExpression);
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isConstant</span>(<span class="hljs-params">ast</span>) </span>{
      <span class="hljs-keyword">return</span> ast.constant;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ASTCompiler</span>(<span class="hljs-params">astBuilder, $filter</span>) </span>{
      <span class="hljs-keyword">this</span>.astBuilder = astBuilder;
      <span class="hljs-keyword">this</span>.$filter = $filter;
    }
    ASTCompiler.prototype = {
      <span class="hljs-attr">compile</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">expression, expensiveChecks</span>) </span>{
        <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;
        <span class="hljs-keyword">var</span> ast = <span class="hljs-keyword">this</span>.astBuilder.ast(expression);
        <span class="hljs-keyword">this</span>.state = {
          <span class="hljs-attr">nextId</span>: <span class="hljs-number">0</span>,
          <span class="hljs-attr">filters</span>: {},
          <span class="hljs-attr">expensiveChecks</span>: expensiveChecks,
          <span class="hljs-attr">fn</span>: {
            <span class="hljs-attr">vars</span>: [],
            <span class="hljs-attr">body</span>: [],
            <span class="hljs-attr">own</span>: {}
          },
          <span class="hljs-attr">assign</span>: {
            <span class="hljs-attr">vars</span>: [],
            <span class="hljs-attr">body</span>: [],
            <span class="hljs-attr">own</span>: {}
          },
          <span class="hljs-attr">inputs</span>: []
        };
        findConstantAndWatchExpressions(ast, self.$filter);
        <span class="hljs-keyword">var</span> extra = <span class="hljs-string">''</span>;
        <span class="hljs-keyword">var</span> assignable;
        <span class="hljs-keyword">this</span>.stage = <span class="hljs-string">'assign'</span>;
        <span class="hljs-keyword">if</span> ((assignable = assignableAST(ast))) {
          <span class="hljs-keyword">this</span>.state.computing = <span class="hljs-string">'assign'</span>;
          <span class="hljs-keyword">var</span> result = <span class="hljs-keyword">this</span>.nextId();
          <span class="hljs-keyword">this</span>.recurse(assignable, result);
          <span class="hljs-keyword">this</span>.return_(result);
          extra = <span class="hljs-string">'fn.assign='</span> + <span class="hljs-keyword">this</span>.generateFunction(<span class="hljs-string">'assign'</span>, <span class="hljs-string">'s,v,l'</span>);
        }
        <span class="hljs-keyword">var</span> toWatch = getInputs(ast.body);
        self.stage = <span class="hljs-string">'inputs'</span>;
        forEach(toWatch, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">watch, key</span>) </span>{
          <span class="hljs-keyword">var</span> fnKey = <span class="hljs-string">'fn'</span> + key;
          self.state[fnKey] = {
            <span class="hljs-attr">vars</span>: [],
            <span class="hljs-attr">body</span>: [],
            <span class="hljs-attr">own</span>: {}
          };
          self.state.computing = fnKey;
          <span class="hljs-keyword">var</span> intoId = self.nextId();
          self.recurse(watch, intoId);
          self.return_(intoId);
          self.state.inputs.push(fnKey);
          watch.watchId = key;
        });
        <span class="hljs-keyword">this</span>.state.computing = <span class="hljs-string">'fn'</span>;
        <span class="hljs-keyword">this</span>.stage = <span class="hljs-string">'main'</span>;
        <span class="hljs-keyword">this</span>.recurse(ast);
        <span class="hljs-keyword">var</span> fnString =
          <span class="hljs-string">'"'</span> + <span class="hljs-keyword">this</span>.USE + <span class="hljs-string">' '</span> + <span class="hljs-keyword">this</span>.STRICT + <span class="hljs-string">'";\n'</span> +
          <span class="hljs-keyword">this</span>.filterPrefix() +
          <span class="hljs-string">'var fn='</span> + <span class="hljs-keyword">this</span>.generateFunction(<span class="hljs-string">'fn'</span>, <span class="hljs-string">'s,l,a,i'</span>) +
          extra +
          <span class="hljs-keyword">this</span>.watchFns() +
          <span class="hljs-string">'return fn;'</span>;
        <span class="hljs-keyword">var</span> fn = (<span class="hljs-keyword">new</span> <span class="hljs-built_in">Function</span>(<span class="hljs-string">'$filter'</span>,
          <span class="hljs-string">'ensureSafeMemberName'</span>,
          <span class="hljs-string">'ensureSafeObject'</span>,
          <span class="hljs-string">'ensureSafeFunction'</span>,
          <span class="hljs-string">'getStringValue'</span>,
          <span class="hljs-string">'ensureSafeAssignContext'</span>,
          <span class="hljs-string">'ifDefined'</span>,
          <span class="hljs-string">'plus'</span>,
          <span class="hljs-string">'text'</span>,
          fnString))(
          <span class="hljs-keyword">this</span>.$filter,
          ensureSafeMemberName,
          ensureSafeObject,
          ensureSafeFunction,
          getStringValue,
          ensureSafeAssignContext,
          ifDefined,
          plusFn,
          expression);
        <span class="hljs-keyword">this</span>.state = <span class="hljs-keyword">this</span>.stage = <span class="hljs-literal">undefined</span>;
        fn.literal = isLiteral(ast);
        fn.constant = isConstant(ast);
        <span class="hljs-keyword">return</span> fn;
      },
      <span class="hljs-attr">USE</span>: <span class="hljs-string">'use'</span>,
      <span class="hljs-attr">STRICT</span>: <span class="hljs-string">'strict'</span>,
      <span class="hljs-attr">watchFns</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> result = [];
        <span class="hljs-keyword">var</span> fns = <span class="hljs-keyword">this</span>.state.inputs;
        <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;
        forEach(fns, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name</span>) </span>{
          result.push(<span class="hljs-string">'var '</span> + name + <span class="hljs-string">'='</span> + self.generateFunction(name, <span class="hljs-string">'s'</span>));
        });
        <span class="hljs-keyword">if</span> (fns.length) {
          result.push(<span class="hljs-string">'fn.inputs=['</span> + fns.join(<span class="hljs-string">','</span>) + <span class="hljs-string">'];'</span>);
        }
        <span class="hljs-keyword">return</span> result.join(<span class="hljs-string">''</span>);
      },
      <span class="hljs-attr">generateFunction</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name, params</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-string">'function('</span> + params + <span class="hljs-string">'){'</span> +
          <span class="hljs-keyword">this</span>.varsPrefix(name) +
          <span class="hljs-keyword">this</span>.body(name) +
          <span class="hljs-string">'};'</span>;
      },
      <span class="hljs-attr">filterPrefix</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> parts = [];
        <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;
        forEach(<span class="hljs-keyword">this</span>.state.filters, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">id, filter</span>) </span>{
          parts.push(id + <span class="hljs-string">'=$filter('</span> + self.escape(filter) + <span class="hljs-string">')'</span>);
        });
        <span class="hljs-keyword">if</span> (parts.length) <span class="hljs-keyword">return</span> <span class="hljs-string">'var '</span> + parts.join(<span class="hljs-string">','</span>) + <span class="hljs-string">';'</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>;
      },
      <span class="hljs-attr">varsPrefix</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">section</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.state[section].vars.length ? <span class="hljs-string">'var '</span> + <span class="hljs-keyword">this</span>.state[section].vars.join(<span class="hljs-string">','</span>) + <span class="hljs-string">';'</span> : <span class="hljs-string">''</span>;
      },
      <span class="hljs-attr">body</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">section</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.state[section].body.join(<span class="hljs-string">''</span>);
      },
      <span class="hljs-attr">recurse</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">ast, intoId, nameId, recursionFn, create, skipWatchIdCheck</span>) </span>{
        <span class="hljs-keyword">var</span> left, right, self = <span class="hljs-keyword">this</span>,
          args, expression;
        recursionFn = recursionFn || noop;
        <span class="hljs-keyword">if</span> (!skipWatchIdCheck &amp;&amp; isDefined(ast.watchId)) {
          intoId = intoId || <span class="hljs-keyword">this</span>.nextId();
          <span class="hljs-keyword">this</span>.if_(<span class="hljs-string">'i'</span>,
            <span class="hljs-keyword">this</span>.lazyAssign(intoId, <span class="hljs-keyword">this</span>.computedMember(<span class="hljs-string">'i'</span>, ast.watchId)),
            <span class="hljs-keyword">this</span>.lazyRecurse(ast, intoId, nameId, recursionFn, create, <span class="hljs-literal">true</span>)
          );
          <span class="hljs-keyword">return</span>;
        }
        <span class="hljs-keyword">switch</span> (ast.type) {
          <span class="hljs-keyword">case</span> AST.Program:
            forEach(ast.body, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">expression, pos</span>) </span>{
              self.recurse(expression.expression, <span class="hljs-literal">undefined</span>, <span class="hljs-literal">undefined</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">expr</span>) </span>{
                right = expr;
              });
              <span class="hljs-keyword">if</span> (pos !== ast.body.length - <span class="hljs-number">1</span>) {
                self.current().body.push(right, <span class="hljs-string">';'</span>);
              } <span class="hljs-keyword">else</span> {
                self.return_(right);
              }
            });
            <span class="hljs-keyword">break</span>;
          <span class="hljs-keyword">case</span> AST.Literal:
            expression = <span class="hljs-keyword">this</span>.escape(ast.value);
            <span class="hljs-keyword">this</span>.assign(intoId, expression);
            recursionFn(expression);
            <span class="hljs-keyword">break</span>;
          <span class="hljs-keyword">case</span> AST.UnaryExpression:
            <span class="hljs-keyword">this</span>.recurse(ast.argument, <span class="hljs-literal">undefined</span>, <span class="hljs-literal">undefined</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">expr</span>) </span>{
              right = expr;
            });
            expression = ast.operator + <span class="hljs-string">'('</span> + <span class="hljs-keyword">this</span>.ifDefined(right, <span class="hljs-number">0</span>) + <span class="hljs-string">')'</span>;
            <span class="hljs-keyword">this</span>.assign(intoId, expression);
            recursionFn(expression);
            <span class="hljs-keyword">break</span>;
          <span class="hljs-keyword">case</span> AST.BinaryExpression:
            <span class="hljs-keyword">this</span>.recurse(ast.left, <span class="hljs-literal">undefined</span>, <span class="hljs-literal">undefined</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">expr</span>) </span>{
              left = expr;
            });
            <span class="hljs-keyword">this</span>.recurse(ast.right, <span class="hljs-literal">undefined</span>, <span class="hljs-literal">undefined</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">expr</span>) </span>{
              right = expr;
            });
            <span class="hljs-keyword">if</span> (ast.operator === <span class="hljs-string">'+'</span>) {
              expression = <span class="hljs-keyword">this</span>.plus(left, right);
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (ast.operator === <span class="hljs-string">'-'</span>) {
              expression = <span class="hljs-keyword">this</span>.ifDefined(left, <span class="hljs-number">0</span>) + ast.operator + <span class="hljs-keyword">this</span>.ifDefined(right, <span class="hljs-number">0</span>);
            } <span class="hljs-keyword">else</span> {
              expression = <span class="hljs-string">'('</span> + left + <span class="hljs-string">')'</span> + ast.operator + <span class="hljs-string">'('</span> + right + <span class="hljs-string">')'</span>;
            }
            <span class="hljs-keyword">this</span>.assign(intoId, expression);
            recursionFn(expression);
            <span class="hljs-keyword">break</span>;
          <span class="hljs-keyword">case</span> AST.LogicalExpression:
            intoId = intoId || <span class="hljs-keyword">this</span>.nextId();
            self.recurse(ast.left, intoId);
            self.if_(ast.operator === <span class="hljs-string">'&amp;&amp;'</span> ? intoId : self.not(intoId), self.lazyRecurse(ast.right, intoId));
            recursionFn(intoId);
            <span class="hljs-keyword">break</span>;
          <span class="hljs-keyword">case</span> AST.ConditionalExpression:
            intoId = intoId || <span class="hljs-keyword">this</span>.nextId();
            self.recurse(ast.test, intoId);
            self.if_(intoId, self.lazyRecurse(ast.alternate, intoId), self.lazyRecurse(ast.consequent, intoId));
            recursionFn(intoId);
            <span class="hljs-keyword">break</span>;
          <span class="hljs-keyword">case</span> AST.Identifier:
            intoId = intoId || <span class="hljs-keyword">this</span>.nextId();
            <span class="hljs-keyword">if</span> (nameId) {
              nameId.context = self.stage === <span class="hljs-string">'inputs'</span> ? <span class="hljs-string">'s'</span> : <span class="hljs-keyword">this</span>.assign(<span class="hljs-keyword">this</span>.nextId(), <span class="hljs-keyword">this</span>.getHasOwnProperty(<span class="hljs-string">'l'</span>, ast.name) + <span class="hljs-string">'?l:s'</span>);
              nameId.computed = <span class="hljs-literal">false</span>;
              nameId.name = ast.name;
            }
            ensureSafeMemberName(ast.name);
            self.if_(self.stage === <span class="hljs-string">'inputs'</span> || self.not(self.getHasOwnProperty(<span class="hljs-string">'l'</span>, ast.name)),
              <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                self.if_(self.stage === <span class="hljs-string">'inputs'</span> || <span class="hljs-string">'s'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                  <span class="hljs-keyword">if</span> (create &amp;&amp; create !== <span class="hljs-number">1</span>) {
                    self.if_(
                      self.not(self.nonComputedMember(<span class="hljs-string">'s'</span>, ast.name)),
                      self.lazyAssign(self.nonComputedMember(<span class="hljs-string">'s'</span>, ast.name), <span class="hljs-string">'{}'</span>));
                  }
                  self.assign(intoId, self.nonComputedMember(<span class="hljs-string">'s'</span>, ast.name));
                });
              }, intoId &amp;&amp; self.lazyAssign(intoId, self.nonComputedMember(<span class="hljs-string">'l'</span>, ast.name))
            );
            <span class="hljs-keyword">if</span> (self.state.expensiveChecks || isPossiblyDangerousMemberName(ast.name)) {
              self.addEnsureSafeObject(intoId);
            }
            recursionFn(intoId);
            <span class="hljs-keyword">break</span>;
          <span class="hljs-keyword">case</span> AST.MemberExpression:
            left = nameId &amp;&amp; (nameId.context = <span class="hljs-keyword">this</span>.nextId()) || <span class="hljs-keyword">this</span>.nextId();
            intoId = intoId || <span class="hljs-keyword">this</span>.nextId();
            self.recurse(ast.object, left, <span class="hljs-literal">undefined</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
              self.if_(self.notNull(left), <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                <span class="hljs-keyword">if</span> (create &amp;&amp; create !== <span class="hljs-number">1</span>) {
                  self.addEnsureSafeAssignContext(left);
                }
                <span class="hljs-keyword">if</span> (ast.computed) {
                  right = self.nextId();
                  self.recurse(ast.property, right);
                  self.getStringValue(right);
                  self.addEnsureSafeMemberName(right);
                  <span class="hljs-keyword">if</span> (create &amp;&amp; create !== <span class="hljs-number">1</span>) {
                    self.if_(self.not(self.computedMember(left, right)), self.lazyAssign(self.computedMember(left, right), <span class="hljs-string">'{}'</span>));
                  }
                  expression = self.ensureSafeObject(self.computedMember(left, right));
                  self.assign(intoId, expression);
                  <span class="hljs-keyword">if</span> (nameId) {
                    nameId.computed = <span class="hljs-literal">true</span>;
                    nameId.name = right;
                  }
                } <span class="hljs-keyword">else</span> {
                  ensureSafeMemberName(ast.property.name);
                  <span class="hljs-keyword">if</span> (create &amp;&amp; create !== <span class="hljs-number">1</span>) {
                    self.if_(self.not(self.nonComputedMember(left, ast.property.name)), self.lazyAssign(self.nonComputedMember(left, ast.property.name), <span class="hljs-string">'{}'</span>));
                  }
                  expression = self.nonComputedMember(left, ast.property.name);
                  <span class="hljs-keyword">if</span> (self.state.expensiveChecks || isPossiblyDangerousMemberName(ast.property.name)) {
                    expression = self.ensureSafeObject(expression);
                  }
                  self.assign(intoId, expression);
                  <span class="hljs-keyword">if</span> (nameId) {
                    nameId.computed = <span class="hljs-literal">false</span>;
                    nameId.name = ast.property.name;
                  }
                }
              }, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                self.assign(intoId, <span class="hljs-string">'undefined'</span>);
              });
              recursionFn(intoId);
            }, !!create);
            <span class="hljs-keyword">break</span>;
          <span class="hljs-keyword">case</span> AST.CallExpression:
            intoId = intoId || <span class="hljs-keyword">this</span>.nextId();
            <span class="hljs-keyword">if</span> (ast.filter) {
              right = self.filter(ast.callee.name);
              args = [];
              forEach(ast.arguments, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">expr</span>) </span>{
                <span class="hljs-keyword">var</span> argument = self.nextId();
                self.recurse(expr, argument);
                args.push(argument);
              });
              expression = right + <span class="hljs-string">'('</span> + args.join(<span class="hljs-string">','</span>) + <span class="hljs-string">')'</span>;
              self.assign(intoId, expression);
              recursionFn(intoId);
            } <span class="hljs-keyword">else</span> {
              right = self.nextId();
              left = {};
              args = [];
              self.recurse(ast.callee, right, left, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                self.if_(self.notNull(right), <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                  self.addEnsureSafeFunction(right);
                  forEach(ast.arguments, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">expr</span>) </span>{
                    self.recurse(expr, self.nextId(), <span class="hljs-literal">undefined</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">argument</span>) </span>{
                      args.push(self.ensureSafeObject(argument));
                    });
                  });
                  <span class="hljs-keyword">if</span> (left.name) {
                    <span class="hljs-keyword">if</span> (!self.state.expensiveChecks) {
                      self.addEnsureSafeObject(left.context);
                    }
                    expression = self.member(left.context, left.name, left.computed) + <span class="hljs-string">'('</span> + args.join(<span class="hljs-string">','</span>) + <span class="hljs-string">')'</span>;
                  } <span class="hljs-keyword">else</span> {
                    expression = right + <span class="hljs-string">'('</span> + args.join(<span class="hljs-string">','</span>) + <span class="hljs-string">')'</span>;
                  }
                  expression = self.ensureSafeObject(expression);
                  self.assign(intoId, expression);
                }, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                  self.assign(intoId, <span class="hljs-string">'undefined'</span>);
                });
                recursionFn(intoId);
              });
            }
            <span class="hljs-keyword">break</span>;
          <span class="hljs-keyword">case</span> AST.AssignmentExpression:
            right = <span class="hljs-keyword">this</span>.nextId();
            left = {};
            <span class="hljs-keyword">if</span> (!isAssignable(ast.left)) {
              <span class="hljs-keyword">throw</span> $parseMinErr(<span class="hljs-string">'lval'</span>, <span class="hljs-string">'Trying to assign a value to a non l-value'</span>);
            }
            <span class="hljs-keyword">this</span>.recurse(ast.left, <span class="hljs-literal">undefined</span>, left, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
              self.if_(self.notNull(left.context), <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                self.recurse(ast.right, right);
                self.addEnsureSafeObject(self.member(left.context, left.name, left.computed));
                self.addEnsureSafeAssignContext(left.context);
                expression = self.member(left.context, left.name, left.computed) + ast.operator + right;
                self.assign(intoId, expression);
                recursionFn(intoId || expression);
              });
            }, <span class="hljs-number">1</span>);
            <span class="hljs-keyword">break</span>;
          <span class="hljs-keyword">case</span> AST.ArrayExpression:
            args = [];
            forEach(ast.elements, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">expr</span>) </span>{
              self.recurse(expr, self.nextId(), <span class="hljs-literal">undefined</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">argument</span>) </span>{
                args.push(argument);
              });
            });
            expression = <span class="hljs-string">'['</span> + args.join(<span class="hljs-string">','</span>) + <span class="hljs-string">']'</span>;
            <span class="hljs-keyword">this</span>.assign(intoId, expression);
            recursionFn(expression);
            <span class="hljs-keyword">break</span>;
          <span class="hljs-keyword">case</span> AST.ObjectExpression:
            args = [];
            forEach(ast.properties, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">property</span>) </span>{
              self.recurse(property.value, self.nextId(), <span class="hljs-literal">undefined</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">expr</span>) </span>{
                args.push(self.escape(
                    property.key.type === AST.Identifier ? property.key.name :
                    (<span class="hljs-string">''</span> + property.key.value)) +
                  <span class="hljs-string">':'</span> + expr);
              });
            });
            expression = <span class="hljs-string">'{'</span> + args.join(<span class="hljs-string">','</span>) + <span class="hljs-string">'}'</span>;
            <span class="hljs-keyword">this</span>.assign(intoId, expression);
            recursionFn(expression);
            <span class="hljs-keyword">break</span>;
          <span class="hljs-keyword">case</span> AST.ThisExpression:
            <span class="hljs-keyword">this</span>.assign(intoId, <span class="hljs-string">'s'</span>);
            recursionFn(<span class="hljs-string">'s'</span>);
            <span class="hljs-keyword">break</span>;
          <span class="hljs-keyword">case</span> AST.LocalsExpression:
            <span class="hljs-keyword">this</span>.assign(intoId, <span class="hljs-string">'l'</span>);
            recursionFn(<span class="hljs-string">'l'</span>);
            <span class="hljs-keyword">break</span>;
          <span class="hljs-keyword">case</span> AST.NGValueParameter:
            <span class="hljs-keyword">this</span>.assign(intoId, <span class="hljs-string">'v'</span>);
            recursionFn(<span class="hljs-string">'v'</span>);
            <span class="hljs-keyword">break</span>;
        }
      },
      <span class="hljs-attr">getHasOwnProperty</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">element, property</span>) </span>{
        <span class="hljs-keyword">var</span> key = element + <span class="hljs-string">'.'</span> + property;
        <span class="hljs-keyword">var</span> own = <span class="hljs-keyword">this</span>.current().own;
        <span class="hljs-keyword">if</span> (!own.hasOwnProperty(key)) {
          own[key] = <span class="hljs-keyword">this</span>.nextId(<span class="hljs-literal">false</span>, element + <span class="hljs-string">'&amp;&amp;('</span> + <span class="hljs-keyword">this</span>.escape(property) + <span class="hljs-string">' in '</span> + element + <span class="hljs-string">')'</span>);
        }
        <span class="hljs-keyword">return</span> own[key];
      },
      <span class="hljs-attr">assign</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">id, value</span>) </span>{
        <span class="hljs-keyword">if</span> (!id) <span class="hljs-keyword">return</span>;
        <span class="hljs-keyword">this</span>.current().body.push(id, <span class="hljs-string">'='</span>, value, <span class="hljs-string">';'</span>);
        <span class="hljs-keyword">return</span> id;
      },
      <span class="hljs-attr">filter</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">filterName</span>) </span>{
        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.state.filters.hasOwnProperty(filterName)) {
          <span class="hljs-keyword">this</span>.state.filters[filterName] = <span class="hljs-keyword">this</span>.nextId(<span class="hljs-literal">true</span>);
        }
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.state.filters[filterName];
      },
      <span class="hljs-attr">ifDefined</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">id, defaultValue</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-string">'ifDefined('</span> + id + <span class="hljs-string">','</span> + <span class="hljs-keyword">this</span>.escape(defaultValue) + <span class="hljs-string">')'</span>;
      },
      <span class="hljs-attr">plus</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">left, right</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-string">'plus('</span> + left + <span class="hljs-string">','</span> + right + <span class="hljs-string">')'</span>;
      },
      <span class="hljs-attr">return_</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">id</span>) </span>{
        <span class="hljs-keyword">this</span>.current().body.push(<span class="hljs-string">'return '</span>, id, <span class="hljs-string">';'</span>);
      },
      <span class="hljs-attr">if_</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">test, alternate, consequent</span>) </span>{
        <span class="hljs-keyword">if</span> (test === <span class="hljs-literal">true</span>) {
          alternate();
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">var</span> body = <span class="hljs-keyword">this</span>.current().body;
          body.push(<span class="hljs-string">'if('</span>, test, <span class="hljs-string">'){'</span>);
          alternate();
          body.push(<span class="hljs-string">'}'</span>);
          <span class="hljs-keyword">if</span> (consequent) {
            body.push(<span class="hljs-string">'else{'</span>);
            consequent();
            body.push(<span class="hljs-string">'}'</span>);
          }
        }
      },
      <span class="hljs-attr">not</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">expression</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-string">'!('</span> + expression + <span class="hljs-string">')'</span>;
      },
      <span class="hljs-attr">notNull</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">expression</span>) </span>{
        <span class="hljs-keyword">return</span> expression + <span class="hljs-string">'!=null'</span>;
      },
      <span class="hljs-attr">nonComputedMember</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">left, right</span>) </span>{
        <span class="hljs-keyword">return</span> left + <span class="hljs-string">'.'</span> + right;
      },
      <span class="hljs-attr">computedMember</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">left, right</span>) </span>{
        <span class="hljs-keyword">return</span> left + <span class="hljs-string">'['</span> + right + <span class="hljs-string">']'</span>;
      },
      <span class="hljs-attr">member</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">left, right, computed</span>) </span>{
        <span class="hljs-keyword">if</span> (computed) <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.computedMember(left, right);
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.nonComputedMember(left, right);
      },
      <span class="hljs-attr">addEnsureSafeObject</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">item</span>) </span>{
        <span class="hljs-keyword">this</span>.current().body.push(<span class="hljs-keyword">this</span>.ensureSafeObject(item), <span class="hljs-string">';'</span>);
      },
      <span class="hljs-attr">addEnsureSafeMemberName</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">item</span>) </span>{
        <span class="hljs-keyword">this</span>.current().body.push(<span class="hljs-keyword">this</span>.ensureSafeMemberName(item), <span class="hljs-string">';'</span>);
      },
      <span class="hljs-attr">addEnsureSafeFunction</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">item</span>) </span>{
        <span class="hljs-keyword">this</span>.current().body.push(<span class="hljs-keyword">this</span>.ensureSafeFunction(item), <span class="hljs-string">';'</span>);
      },
      <span class="hljs-attr">addEnsureSafeAssignContext</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">item</span>) </span>{
        <span class="hljs-keyword">this</span>.current().body.push(<span class="hljs-keyword">this</span>.ensureSafeAssignContext(item), <span class="hljs-string">';'</span>);
      },
      <span class="hljs-attr">ensureSafeObject</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">item</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-string">'ensureSafeObject('</span> + item + <span class="hljs-string">',text)'</span>;
      },
      <span class="hljs-attr">ensureSafeMemberName</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">item</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-string">'ensureSafeMemberName('</span> + item + <span class="hljs-string">',text)'</span>;
      },
      <span class="hljs-attr">ensureSafeFunction</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">item</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-string">'ensureSafeFunction('</span> + item + <span class="hljs-string">',text)'</span>;
      },
      <span class="hljs-attr">getStringValue</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">item</span>) </span>{
        <span class="hljs-keyword">this</span>.assign(item, <span class="hljs-string">'getStringValue('</span> + item + <span class="hljs-string">')'</span>);
      },
      <span class="hljs-attr">ensureSafeAssignContext</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">item</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-string">'ensureSafeAssignContext('</span> + item + <span class="hljs-string">',text)'</span>;
      },
      <span class="hljs-attr">lazyRecurse</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">ast, intoId, nameId, recursionFn, create, skipWatchIdCheck</span>) </span>{
        <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
          self.recurse(ast, intoId, nameId, recursionFn, create, skipWatchIdCheck);
        };
      },
      <span class="hljs-attr">lazyAssign</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">id, value</span>) </span>{
        <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
          self.assign(id, value);
        };
      },
      <span class="hljs-attr">stringEscapeRegex</span>: <span class="hljs-regexp">/[^ a-zA-Z0-9]/g</span>,
      <span class="hljs-attr">stringEscapeFn</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">c</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-string">'\\u'</span> + (<span class="hljs-string">'0000'</span> + c.charCodeAt(<span class="hljs-number">0</span>).toString(<span class="hljs-number">16</span>)).slice(<span class="hljs-number">-4</span>);
      },
      <span class="hljs-attr">escape</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>) </span>{
        <span class="hljs-keyword">if</span> (isString(value)) <span class="hljs-keyword">return</span> <span class="hljs-string">"'"</span> + value.replace(<span class="hljs-keyword">this</span>.stringEscapeRegex, <span class="hljs-keyword">this</span>.stringEscapeFn) + <span class="hljs-string">"'"</span>;
        <span class="hljs-keyword">if</span> (isNumber(value)) <span class="hljs-keyword">return</span> value.toString();
        <span class="hljs-keyword">if</span> (value === <span class="hljs-literal">true</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">'true'</span>;
        <span class="hljs-keyword">if</span> (value === <span class="hljs-literal">false</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">'false'</span>;
        <span class="hljs-keyword">if</span> (value === <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">'null'</span>;
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> value === <span class="hljs-string">'undefined'</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">'undefined'</span>;
        <span class="hljs-keyword">throw</span> $parseMinErr(<span class="hljs-string">'esc'</span>, <span class="hljs-string">'IMPOSSIBLE'</span>);
      },
      <span class="hljs-attr">nextId</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">skip, init</span>) </span>{
        <span class="hljs-keyword">var</span> id = <span class="hljs-string">'v'</span> + (<span class="hljs-keyword">this</span>.state.nextId++);
        <span class="hljs-keyword">if</span> (!skip) {
          <span class="hljs-keyword">this</span>.current().vars.push(id + (init ? <span class="hljs-string">'='</span> + init : <span class="hljs-string">''</span>));
        }
        <span class="hljs-keyword">return</span> id;
      },
      <span class="hljs-attr">current</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.state[<span class="hljs-keyword">this</span>.state.computing];
      }
    };

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ASTInterpreter</span>(<span class="hljs-params">astBuilder, $filter</span>) </span>{
      <span class="hljs-keyword">this</span>.astBuilder = astBuilder;
      <span class="hljs-keyword">this</span>.$filter = $filter;
    }
    ASTInterpreter.prototype = {
      <span class="hljs-attr">compile</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">expression, expensiveChecks</span>) </span>{
        <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;
        <span class="hljs-keyword">var</span> ast = <span class="hljs-keyword">this</span>.astBuilder.ast(expression);
        <span class="hljs-keyword">this</span>.expression = expression;
        <span class="hljs-keyword">this</span>.expensiveChecks = expensiveChecks;
        findConstantAndWatchExpressions(ast, self.$filter);
        <span class="hljs-keyword">var</span> assignable;
        <span class="hljs-keyword">var</span> assign;
        <span class="hljs-keyword">if</span> ((assignable = assignableAST(ast))) {
          assign = <span class="hljs-keyword">this</span>.recurse(assignable);
        }
        <span class="hljs-keyword">var</span> toWatch = getInputs(ast.body);
        <span class="hljs-keyword">var</span> inputs;
        <span class="hljs-keyword">if</span> (toWatch) {
          inputs = [];
          forEach(toWatch, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">watch, key</span>) </span>{
            <span class="hljs-keyword">var</span> input = self.recurse(watch);
            watch.input = input;
            inputs.push(input);
            watch.watchId = key;
          });
        }
        <span class="hljs-keyword">var</span> expressions = [];
        forEach(ast.body, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">expression</span>) </span>{
          expressions.push(self.recurse(expression.expression));
        });
        <span class="hljs-keyword">var</span> fn = ast.body.length === <span class="hljs-number">0</span> ? noop :
          ast.body.length === <span class="hljs-number">1</span> ? expressions[<span class="hljs-number">0</span>] :
          <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">scope, locals</span>) </span>{
            <span class="hljs-keyword">var</span> lastValue;
            forEach(expressions, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">exp</span>) </span>{
              lastValue = exp(scope, locals);
            });
            <span class="hljs-keyword">return</span> lastValue;
          };
        <span class="hljs-keyword">if</span> (assign) {
          fn.assign = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">scope, value, locals</span>) </span>{
            <span class="hljs-keyword">return</span> assign(scope, locals, value);
          };
        }
        <span class="hljs-keyword">if</span> (inputs) {
          fn.inputs = inputs;
        }
        fn.literal = isLiteral(ast);
        fn.constant = isConstant(ast);
        <span class="hljs-keyword">return</span> fn;
      },
      <span class="hljs-attr">recurse</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">ast, context, create</span>) </span>{
        <span class="hljs-keyword">var</span> left, right, self = <span class="hljs-keyword">this</span>,
          args, expression;
        <span class="hljs-keyword">if</span> (ast.input) {
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.inputs(ast.input, ast.watchId);
        }
        <span class="hljs-keyword">switch</span> (ast.type) {
          <span class="hljs-keyword">case</span> AST.Literal:
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.value(ast.value, context);
          <span class="hljs-keyword">case</span> AST.UnaryExpression:
            right = <span class="hljs-keyword">this</span>.recurse(ast.argument);
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>[<span class="hljs-string">'unary'</span> + ast.operator](right, context);
          <span class="hljs-keyword">case</span> AST.BinaryExpression:
            left = <span class="hljs-keyword">this</span>.recurse(ast.left);
            right = <span class="hljs-keyword">this</span>.recurse(ast.right);
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>[<span class="hljs-string">'binary'</span> + ast.operator](left, right, context);
          <span class="hljs-keyword">case</span> AST.LogicalExpression:
            left = <span class="hljs-keyword">this</span>.recurse(ast.left);
            right = <span class="hljs-keyword">this</span>.recurse(ast.right);
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>[<span class="hljs-string">'binary'</span> + ast.operator](left, right, context);
          <span class="hljs-keyword">case</span> AST.ConditionalExpression:
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>[<span class="hljs-string">'ternary?:'</span>](
              <span class="hljs-keyword">this</span>.recurse(ast.test),
              <span class="hljs-keyword">this</span>.recurse(ast.alternate),
              <span class="hljs-keyword">this</span>.recurse(ast.consequent),
              context
            );
          <span class="hljs-keyword">case</span> AST.Identifier:
            ensureSafeMemberName(ast.name, self.expression);
            <span class="hljs-keyword">return</span> self.identifier(ast.name,
              self.expensiveChecks || isPossiblyDangerousMemberName(ast.name),
              context, create, self.expression);
          <span class="hljs-keyword">case</span> AST.MemberExpression:
            left = <span class="hljs-keyword">this</span>.recurse(ast.object, <span class="hljs-literal">false</span>, !!create);
            <span class="hljs-keyword">if</span> (!ast.computed) {
              ensureSafeMemberName(ast.property.name, self.expression);
              right = ast.property.name;
            }
            <span class="hljs-keyword">if</span> (ast.computed) right = <span class="hljs-keyword">this</span>.recurse(ast.property);
            <span class="hljs-keyword">return</span> ast.computed ?
              <span class="hljs-keyword">this</span>.computedMember(left, right, context, create, self.expression) :
              <span class="hljs-keyword">this</span>.nonComputedMember(left, right, self.expensiveChecks, context, create, self.expression);
          <span class="hljs-keyword">case</span> AST.CallExpression:
            args = [];
            forEach(ast.arguments, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">expr</span>) </span>{
              args.push(self.recurse(expr));
            });
            <span class="hljs-keyword">if</span> (ast.filter) right = <span class="hljs-keyword">this</span>.$filter(ast.callee.name);
            <span class="hljs-keyword">if</span> (!ast.filter) right = <span class="hljs-keyword">this</span>.recurse(ast.callee, <span class="hljs-literal">true</span>);
            <span class="hljs-keyword">return</span> ast.filter ?
              <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">scope, locals, assign, inputs</span>) </span>{
                <span class="hljs-keyword">var</span> values = [];
                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; args.length; ++i) {
                  values.push(args[i](scope, locals, assign, inputs));
                }
                <span class="hljs-keyword">var</span> value = right.apply(<span class="hljs-literal">undefined</span>, values, inputs);
                <span class="hljs-keyword">return</span> context ? {
                  <span class="hljs-attr">context</span>: <span class="hljs-literal">undefined</span>,
                  <span class="hljs-attr">name</span>: <span class="hljs-literal">undefined</span>,
                  <span class="hljs-attr">value</span>: value
                } : value;
              } :
              <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">scope, locals, assign, inputs</span>) </span>{
                <span class="hljs-keyword">var</span> rhs = right(scope, locals, assign, inputs);
                <span class="hljs-keyword">var</span> value;
                <span class="hljs-keyword">if</span> (rhs.value != <span class="hljs-literal">null</span>) {
                  ensureSafeObject(rhs.context, self.expression);
                  ensureSafeFunction(rhs.value, self.expression);
                  <span class="hljs-keyword">var</span> values = [];
                  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; args.length; ++i) {
                    values.push(ensureSafeObject(args[i](scope, locals, assign, inputs), self.expression));
                  }
                  value = ensureSafeObject(rhs.value.apply(rhs.context, values), self.expression);
                }
                <span class="hljs-keyword">return</span> context ? {
                  <span class="hljs-attr">value</span>: value
                } : value;
              };
          <span class="hljs-keyword">case</span> AST.AssignmentExpression:
            left = <span class="hljs-keyword">this</span>.recurse(ast.left, <span class="hljs-literal">true</span>, <span class="hljs-number">1</span>);
            right = <span class="hljs-keyword">this</span>.recurse(ast.right);
            <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">scope, locals, assign, inputs</span>) </span>{
              <span class="hljs-keyword">var</span> lhs = left(scope, locals, assign, inputs);
              <span class="hljs-keyword">var</span> rhs = right(scope, locals, assign, inputs);
              ensureSafeObject(lhs.value, self.expression);
              ensureSafeAssignContext(lhs.context);
              lhs.context[lhs.name] = rhs;
              <span class="hljs-keyword">return</span> context ? {
                <span class="hljs-attr">value</span>: rhs
              } : rhs;
            };
          <span class="hljs-keyword">case</span> AST.ArrayExpression:
            args = [];
            forEach(ast.elements, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">expr</span>) </span>{
              args.push(self.recurse(expr));
            });
            <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">scope, locals, assign, inputs</span>) </span>{
              <span class="hljs-keyword">var</span> value = [];
              <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; args.length; ++i) {
                value.push(args[i](scope, locals, assign, inputs));
              }
              <span class="hljs-keyword">return</span> context ? {
                <span class="hljs-attr">value</span>: value
              } : value;
            };
          <span class="hljs-keyword">case</span> AST.ObjectExpression:
            args = [];
            forEach(ast.properties, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">property</span>) </span>{
              args.push({
                <span class="hljs-attr">key</span>: property.key.type === AST.Identifier ?
                  property.key.name :
                  (<span class="hljs-string">''</span> + property.key.value),
                <span class="hljs-attr">value</span>: self.recurse(property.value)
              });
            });
            <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">scope, locals, assign, inputs</span>) </span>{
              <span class="hljs-keyword">var</span> value = {};
              <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; args.length; ++i) {
                value[args[i].key] = args[i].value(scope, locals, assign, inputs);
              }
              <span class="hljs-keyword">return</span> context ? {
                <span class="hljs-attr">value</span>: value
              } : value;
            };
          <span class="hljs-keyword">case</span> AST.ThisExpression:
            <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">scope</span>) </span>{
              <span class="hljs-keyword">return</span> context ? {
                <span class="hljs-attr">value</span>: scope
              } : scope;
            };
          <span class="hljs-keyword">case</span> AST.LocalsExpression:
            <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">scope, locals</span>) </span>{
              <span class="hljs-keyword">return</span> context ? {
                <span class="hljs-attr">value</span>: locals
              } : locals;
            };
          <span class="hljs-keyword">case</span> AST.NGValueParameter:
            <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">scope, locals, assign</span>) </span>{
              <span class="hljs-keyword">return</span> context ? {
                <span class="hljs-attr">value</span>: assign
              } : assign;
            };
        }
      },
      <span class="hljs-string">'unary+'</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">argument, context</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">scope, locals, assign, inputs</span>) </span>{
          <span class="hljs-keyword">var</span> arg = argument(scope, locals, assign, inputs);
          <span class="hljs-keyword">if</span> (isDefined(arg)) {
            arg = +arg;
          } <span class="hljs-keyword">else</span> {
            arg = <span class="hljs-number">0</span>;
          }
          <span class="hljs-keyword">return</span> context ? {
            <span class="hljs-attr">value</span>: arg
          } : arg;
        };
      },
      <span class="hljs-string">'unary-'</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">argument, context</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">scope, locals, assign, inputs</span>) </span>{
          <span class="hljs-keyword">var</span> arg = argument(scope, locals, assign, inputs);
          <span class="hljs-keyword">if</span> (isDefined(arg)) {
            arg = -arg;
          } <span class="hljs-keyword">else</span> {
            arg = <span class="hljs-number">0</span>;
          }
          <span class="hljs-keyword">return</span> context ? {
            <span class="hljs-attr">value</span>: arg
          } : arg;
        };
      },
      <span class="hljs-string">'unary!'</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">argument, context</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">scope, locals, assign, inputs</span>) </span>{
          <span class="hljs-keyword">var</span> arg = !argument(scope, locals, assign, inputs);
          <span class="hljs-keyword">return</span> context ? {
            <span class="hljs-attr">value</span>: arg
          } : arg;
        };
      },
      <span class="hljs-string">'binary+'</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">left, right, context</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">scope, locals, assign, inputs</span>) </span>{
          <span class="hljs-keyword">var</span> lhs = left(scope, locals, assign, inputs);
          <span class="hljs-keyword">var</span> rhs = right(scope, locals, assign, inputs);
          <span class="hljs-keyword">var</span> arg = plusFn(lhs, rhs);
          <span class="hljs-keyword">return</span> context ? {
            <span class="hljs-attr">value</span>: arg
          } : arg;
        };
      },
      <span class="hljs-string">'binary-'</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">left, right, context</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">scope, locals, assign, inputs</span>) </span>{
          <span class="hljs-keyword">var</span> lhs = left(scope, locals, assign, inputs);
          <span class="hljs-keyword">var</span> rhs = right(scope, locals, assign, inputs);
          <span class="hljs-keyword">var</span> arg = (isDefined(lhs) ? lhs : <span class="hljs-number">0</span>) - (isDefined(rhs) ? rhs : <span class="hljs-number">0</span>);
          <span class="hljs-keyword">return</span> context ? {
            <span class="hljs-attr">value</span>: arg
          } : arg;
        };
      },
      <span class="hljs-string">'binary*'</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">left, right, context</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">scope, locals, assign, inputs</span>) </span>{
          <span class="hljs-keyword">var</span> arg = left(scope, locals, assign, inputs) * right(scope, locals, assign, inputs);
          <span class="hljs-keyword">return</span> context ? {
            <span class="hljs-attr">value</span>: arg
          } : arg;
        };
      },
      <span class="hljs-string">'binary/'</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">left, right, context</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">scope, locals, assign, inputs</span>) </span>{
          <span class="hljs-keyword">var</span> arg = left(scope, locals, assign, inputs) / right(scope, locals, assign, inputs);
          <span class="hljs-keyword">return</span> context ? {
            <span class="hljs-attr">value</span>: arg
          } : arg;
        };
      },
      <span class="hljs-string">'binary%'</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">left, right, context</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">scope, locals, assign, inputs</span>) </span>{
          <span class="hljs-keyword">var</span> arg = left(scope, locals, assign, inputs) % right(scope, locals, assign, inputs);
          <span class="hljs-keyword">return</span> context ? {
            <span class="hljs-attr">value</span>: arg
          } : arg;
        };
      },
      <span class="hljs-string">'binary==='</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">left, right, context</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">scope, locals, assign, inputs</span>) </span>{
          <span class="hljs-keyword">var</span> arg = left(scope, locals, assign, inputs) === right(scope, locals, assign, inputs);
          <span class="hljs-keyword">return</span> context ? {
            <span class="hljs-attr">value</span>: arg
          } : arg;
        };
      },
      <span class="hljs-string">'binary!=='</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">left, right, context</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">scope, locals, assign, inputs</span>) </span>{
          <span class="hljs-keyword">var</span> arg = left(scope, locals, assign, inputs) !== right(scope, locals, assign, inputs);
          <span class="hljs-keyword">return</span> context ? {
            <span class="hljs-attr">value</span>: arg
          } : arg;
        };
      },
      <span class="hljs-string">'binary=='</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">left, right, context</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">scope, locals, assign, inputs</span>) </span>{
          <span class="hljs-keyword">var</span> arg = left(scope, locals, assign, inputs) == right(scope, locals, assign, inputs);
          <span class="hljs-keyword">return</span> context ? {
            <span class="hljs-attr">value</span>: arg
          } : arg;
        };
      },
      <span class="hljs-string">'binary!='</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">left, right, context</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">scope, locals, assign, inputs</span>) </span>{
          <span class="hljs-keyword">var</span> arg = left(scope, locals, assign, inputs) != right(scope, locals, assign, inputs);
          <span class="hljs-keyword">return</span> context ? {
            <span class="hljs-attr">value</span>: arg
          } : arg;
        };
      },
      <span class="hljs-string">'binary&lt;'</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">left, right, context</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">scope, locals, assign, inputs</span>) </span>{
          <span class="hljs-keyword">var</span> arg = left(scope, locals, assign, inputs) &lt; right(scope, locals, assign, inputs);
          <span class="hljs-keyword">return</span> context ? {
            <span class="hljs-attr">value</span>: arg
          } : arg;
        };
      },
      <span class="hljs-string">'binary&gt;'</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">left, right, context</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">scope, locals, assign, inputs</span>) </span>{
          <span class="hljs-keyword">var</span> arg = left(scope, locals, assign, inputs) &gt; right(scope, locals, assign, inputs);
          <span class="hljs-keyword">return</span> context ? {
            <span class="hljs-attr">value</span>: arg
          } : arg;
        };
      },
      <span class="hljs-string">'binary&lt;='</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">left, right, context</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">scope, locals, assign, inputs</span>) </span>{
          <span class="hljs-keyword">var</span> arg = left(scope, locals, assign, inputs) &lt;= right(scope, locals, assign, inputs);
          <span class="hljs-keyword">return</span> context ? {
            <span class="hljs-attr">value</span>: arg
          } : arg;
        };
      },
      <span class="hljs-string">'binary&gt;='</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">left, right, context</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">scope, locals, assign, inputs</span>) </span>{
          <span class="hljs-keyword">var</span> arg = left(scope, locals, assign, inputs) &gt;= right(scope, locals, assign, inputs);
          <span class="hljs-keyword">return</span> context ? {
            <span class="hljs-attr">value</span>: arg
          } : arg;
        };
      },
      <span class="hljs-string">'binary&amp;&amp;'</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">left, right, context</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">scope, locals, assign, inputs</span>) </span>{
          <span class="hljs-keyword">var</span> arg = left(scope, locals, assign, inputs) &amp;&amp; right(scope, locals, assign, inputs);
          <span class="hljs-keyword">return</span> context ? {
            <span class="hljs-attr">value</span>: arg
          } : arg;
        };
      },
      <span class="hljs-string">'binary||'</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">left, right, context</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">scope, locals, assign, inputs</span>) </span>{
          <span class="hljs-keyword">var</span> arg = left(scope, locals, assign, inputs) || right(scope, locals, assign, inputs);
          <span class="hljs-keyword">return</span> context ? {
            <span class="hljs-attr">value</span>: arg
          } : arg;
        };
      },
      <span class="hljs-string">'ternary?:'</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">test, alternate, consequent, context</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">scope, locals, assign, inputs</span>) </span>{
          <span class="hljs-keyword">var</span> arg = test(scope, locals, assign, inputs) ? alternate(scope, locals, assign, inputs) : consequent(scope, locals, assign, inputs);
          <span class="hljs-keyword">return</span> context ? {
            <span class="hljs-attr">value</span>: arg
          } : arg;
        };
      },
      <span class="hljs-attr">value</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value, context</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
          <span class="hljs-keyword">return</span> context ? {
            <span class="hljs-attr">context</span>: <span class="hljs-literal">undefined</span>,
            <span class="hljs-attr">name</span>: <span class="hljs-literal">undefined</span>,
            <span class="hljs-attr">value</span>: value
          } : value;
        };
      },
      <span class="hljs-attr">identifier</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name, expensiveChecks, context, create, expression</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">scope, locals, assign, inputs</span>) </span>{
          <span class="hljs-keyword">var</span> base = locals &amp;&amp; (name <span class="hljs-keyword">in</span> locals) ? locals : scope;
          <span class="hljs-keyword">if</span> (create &amp;&amp; create !== <span class="hljs-number">1</span> &amp;&amp; base &amp;&amp; !(base[name])) {
            base[name] = {};
          }
          <span class="hljs-keyword">var</span> value = base ? base[name] : <span class="hljs-literal">undefined</span>;
          <span class="hljs-keyword">if</span> (expensiveChecks) {
            ensureSafeObject(value, expression);
          }
          <span class="hljs-keyword">if</span> (context) {
            <span class="hljs-keyword">return</span> {
              <span class="hljs-attr">context</span>: base,
              <span class="hljs-attr">name</span>: name,
              <span class="hljs-attr">value</span>: value
            };
          } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> value;
          }
        };
      },
      <span class="hljs-attr">computedMember</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">left, right, context, create, expression</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">scope, locals, assign, inputs</span>) </span>{
          <span class="hljs-keyword">var</span> lhs = left(scope, locals, assign, inputs);
          <span class="hljs-keyword">var</span> rhs;
          <span class="hljs-keyword">var</span> value;
          <span class="hljs-keyword">if</span> (lhs != <span class="hljs-literal">null</span>) {
            rhs = right(scope, locals, assign, inputs);
            rhs = getStringValue(rhs);
            ensureSafeMemberName(rhs, expression);
            <span class="hljs-keyword">if</span> (create &amp;&amp; create !== <span class="hljs-number">1</span>) {
              ensureSafeAssignContext(lhs);
              <span class="hljs-keyword">if</span> (lhs &amp;&amp; !(lhs[rhs])) {
                lhs[rhs] = {};
              }
            }
            value = lhs[rhs];
            ensureSafeObject(value, expression);
          }
          <span class="hljs-keyword">if</span> (context) {
            <span class="hljs-keyword">return</span> {
              <span class="hljs-attr">context</span>: lhs,
              <span class="hljs-attr">name</span>: rhs,
              <span class="hljs-attr">value</span>: value
            };
          } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> value;
          }
        };
      },
      <span class="hljs-attr">nonComputedMember</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">left, right, expensiveChecks, context, create, expression</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">scope, locals, assign, inputs</span>) </span>{
          <span class="hljs-keyword">var</span> lhs = left(scope, locals, assign, inputs);
          <span class="hljs-keyword">if</span> (create &amp;&amp; create !== <span class="hljs-number">1</span>) {
            ensureSafeAssignContext(lhs);
            <span class="hljs-keyword">if</span> (lhs &amp;&amp; !(lhs[right])) {
              lhs[right] = {};
            }
          }
          <span class="hljs-keyword">var</span> value = lhs != <span class="hljs-literal">null</span> ? lhs[right] : <span class="hljs-literal">undefined</span>;
          <span class="hljs-keyword">if</span> (expensiveChecks || isPossiblyDangerousMemberName(right)) {
            ensureSafeObject(value, expression);
          }
          <span class="hljs-keyword">if</span> (context) {
            <span class="hljs-keyword">return</span> {
              <span class="hljs-attr">context</span>: lhs,
              <span class="hljs-attr">name</span>: right,
              <span class="hljs-attr">value</span>: value
            };
          } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> value;
          }
        };
      },
      <span class="hljs-attr">inputs</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">input, watchId</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">scope, value, locals, inputs</span>) </span>{
          <span class="hljs-keyword">if</span> (inputs) <span class="hljs-keyword">return</span> inputs[watchId];
          <span class="hljs-keyword">return</span> input(scope, value, locals);
        };
      }
    };
    <span class="hljs-keyword">var</span> Parser = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">lexer, $filter, options</span>) </span>{
      <span class="hljs-keyword">this</span>.lexer = lexer;
      <span class="hljs-keyword">this</span>.$filter = $filter;
      <span class="hljs-keyword">this</span>.options = options;
      <span class="hljs-keyword">this</span>.ast = <span class="hljs-keyword">new</span> AST(lexer, options);
      <span class="hljs-keyword">this</span>.astCompiler = options.csp ? <span class="hljs-keyword">new</span> ASTInterpreter(<span class="hljs-keyword">this</span>.ast, $filter) :
        <span class="hljs-keyword">new</span> ASTCompiler(<span class="hljs-keyword">this</span>.ast, $filter);
    };
    Parser.prototype = {
      <span class="hljs-attr">constructor</span>: Parser,
      <span class="hljs-attr">parse</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">text</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.astCompiler.compile(text, <span class="hljs-keyword">this</span>.options.expensiveChecks);
      }
    };

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isPossiblyDangerousMemberName</span>(<span class="hljs-params">name</span>) </span>{
      <span class="hljs-keyword">return</span> name == <span class="hljs-string">'constructor'</span>;
    }
    <span class="hljs-keyword">var</span> objectValueOf = <span class="hljs-built_in">Object</span>.prototype.valueOf;

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getValueOf</span>(<span class="hljs-params">value</span>) </span>{
      <span class="hljs-keyword">return</span> isFunction(value.valueOf) ? value.valueOf() : objectValueOf.call(value);
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$ParseProvider</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> cacheDefault = createMap();
      <span class="hljs-keyword">var</span> cacheExpensive = createMap();
      <span class="hljs-keyword">var</span> literals = {
        <span class="hljs-string">'true'</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-string">'false'</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-string">'null'</span>: <span class="hljs-literal">null</span>,
        <span class="hljs-string">'undefined'</span>: <span class="hljs-literal">undefined</span>
      };
      <span class="hljs-keyword">this</span>.addLiteral = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">literalName, literalValue</span>) </span>{
        literals[literalName] = literalValue;
      };
      <span class="hljs-keyword">this</span>.$get = [<span class="hljs-string">'$filter'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$filter</span>) </span>{
        <span class="hljs-keyword">var</span> noUnsafeEval = csp().noUnsafeEval;
        <span class="hljs-keyword">var</span> $parseOptions = {
            <span class="hljs-attr">csp</span>: noUnsafeEval,
            <span class="hljs-attr">expensiveChecks</span>: <span class="hljs-literal">false</span>,
            <span class="hljs-attr">literals</span>: copy(literals)
          },
          $parseOptionsExpensive = {
            <span class="hljs-attr">csp</span>: noUnsafeEval,
            <span class="hljs-attr">expensiveChecks</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">literals</span>: copy(literals)
          };
        <span class="hljs-keyword">var</span> runningChecksEnabled = <span class="hljs-literal">false</span>;
        $parse.$$runningExpensiveChecks = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
          <span class="hljs-keyword">return</span> runningChecksEnabled;
        };
        <span class="hljs-keyword">return</span> $parse;

        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$parse</span>(<span class="hljs-params">exp, interceptorFn, expensiveChecks</span>) </span>{
          <span class="hljs-keyword">var</span> parsedExpression, oneTime, cacheKey;
          expensiveChecks = expensiveChecks || runningChecksEnabled;
          <span class="hljs-keyword">switch</span> (<span class="hljs-keyword">typeof</span> exp) {
            <span class="hljs-keyword">case</span> <span class="hljs-string">'string'</span>:
              exp = exp.trim();
              cacheKey = exp;
              <span class="hljs-keyword">var</span> cache = (expensiveChecks ? cacheExpensive : cacheDefault);
              parsedExpression = cache[cacheKey];
              <span class="hljs-keyword">if</span> (!parsedExpression) {
                <span class="hljs-keyword">if</span> (exp.charAt(<span class="hljs-number">0</span>) === <span class="hljs-string">':'</span> &amp;&amp; exp.charAt(<span class="hljs-number">1</span>) === <span class="hljs-string">':'</span>) {
                  oneTime = <span class="hljs-literal">true</span>;
                  exp = exp.substring(<span class="hljs-number">2</span>);
                }
                <span class="hljs-keyword">var</span> parseOptions = expensiveChecks ? $parseOptionsExpensive : $parseOptions;
                <span class="hljs-keyword">var</span> lexer = <span class="hljs-keyword">new</span> Lexer(parseOptions);
                <span class="hljs-keyword">var</span> parser = <span class="hljs-keyword">new</span> Parser(lexer, $filter, parseOptions);
                parsedExpression = parser.parse(exp);
                <span class="hljs-keyword">if</span> (parsedExpression.constant) {
                  parsedExpression.$$watchDelegate = constantWatchDelegate;
                } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (oneTime) {
                  parsedExpression.$$watchDelegate = parsedExpression.literal ?
                    oneTimeLiteralWatchDelegate : oneTimeWatchDelegate;
                } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (parsedExpression.inputs) {
                  parsedExpression.$$watchDelegate = inputsWatchDelegate;
                }
                <span class="hljs-keyword">if</span> (expensiveChecks) {
                  parsedExpression = expensiveChecksInterceptor(parsedExpression);
                }
                cache[cacheKey] = parsedExpression;
              }
              <span class="hljs-keyword">return</span> addInterceptor(parsedExpression, interceptorFn);
            <span class="hljs-keyword">case</span> <span class="hljs-string">'function'</span>:
              <span class="hljs-keyword">return</span> addInterceptor(exp, interceptorFn);
            <span class="hljs-keyword">default</span>:
              <span class="hljs-keyword">return</span> addInterceptor(noop, interceptorFn);
          }
        }

        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">expensiveChecksInterceptor</span>(<span class="hljs-params">fn</span>) </span>{
          <span class="hljs-keyword">if</span> (!fn) <span class="hljs-keyword">return</span> fn;
          expensiveCheckFn.$$watchDelegate = fn.$$watchDelegate;
          expensiveCheckFn.assign = expensiveChecksInterceptor(fn.assign);
          expensiveCheckFn.constant = fn.constant;
          expensiveCheckFn.literal = fn.literal;
          <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; fn.inputs &amp;&amp; i &lt; fn.inputs.length; ++i) {
            fn.inputs[i] = expensiveChecksInterceptor(fn.inputs[i]);
          }
          expensiveCheckFn.inputs = fn.inputs;
          <span class="hljs-keyword">return</span> expensiveCheckFn;

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">expensiveCheckFn</span>(<span class="hljs-params">scope, locals, assign, inputs</span>) </span>{
            <span class="hljs-keyword">var</span> expensiveCheckOldValue = runningChecksEnabled;
            runningChecksEnabled = <span class="hljs-literal">true</span>;
            <span class="hljs-keyword">try</span> {
              <span class="hljs-keyword">return</span> fn(scope, locals, assign, inputs);
            } <span class="hljs-keyword">finally</span> {
              runningChecksEnabled = expensiveCheckOldValue;
            }
          }
        }

        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">expressionInputDirtyCheck</span>(<span class="hljs-params">newValue, oldValueOfValue</span>) </span>{
          <span class="hljs-keyword">if</span> (newValue == <span class="hljs-literal">null</span> || oldValueOfValue == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">return</span> newValue === oldValueOfValue;
          }
          <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> newValue === <span class="hljs-string">'object'</span>) {
            newValue = getValueOf(newValue);
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> newValue === <span class="hljs-string">'object'</span>) {
              <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
            }
          }
          <span class="hljs-keyword">return</span> newValue === oldValueOfValue || (newValue !== newValue &amp;&amp; oldValueOfValue !== oldValueOfValue);
        }

        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">inputsWatchDelegate</span>(<span class="hljs-params">scope, listener, objectEquality, parsedExpression, prettyPrintExpression</span>) </span>{
          <span class="hljs-keyword">var</span> inputExpressions = parsedExpression.inputs;
          <span class="hljs-keyword">var</span> lastResult;
          <span class="hljs-keyword">if</span> (inputExpressions.length === <span class="hljs-number">1</span>) {
            <span class="hljs-keyword">var</span> oldInputValueOf = expressionInputDirtyCheck;
            inputExpressions = inputExpressions[<span class="hljs-number">0</span>];
            <span class="hljs-keyword">return</span> scope.$watch(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">expressionInputWatch</span>(<span class="hljs-params">scope</span>) </span>{
              <span class="hljs-keyword">var</span> newInputValue = inputExpressions(scope);
              <span class="hljs-keyword">if</span> (!expressionInputDirtyCheck(newInputValue, oldInputValueOf)) {
                lastResult = parsedExpression(scope, <span class="hljs-literal">undefined</span>, <span class="hljs-literal">undefined</span>, [newInputValue]);
                oldInputValueOf = newInputValue &amp;&amp; getValueOf(newInputValue);
              }
              <span class="hljs-keyword">return</span> lastResult;
            }, listener, objectEquality, prettyPrintExpression);
          }
          <span class="hljs-keyword">var</span> oldInputValueOfValues = [];
          <span class="hljs-keyword">var</span> oldInputValues = [];
          <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, ii = inputExpressions.length; i &lt; ii; i++) {
            oldInputValueOfValues[i] = expressionInputDirtyCheck;
            oldInputValues[i] = <span class="hljs-literal">null</span>;
          }
          <span class="hljs-keyword">return</span> scope.$watch(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">expressionInputsWatch</span>(<span class="hljs-params">scope</span>) </span>{
            <span class="hljs-keyword">var</span> changed = <span class="hljs-literal">false</span>;
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, ii = inputExpressions.length; i &lt; ii; i++) {
              <span class="hljs-keyword">var</span> newInputValue = inputExpressions[i](scope);
              <span class="hljs-keyword">if</span> (changed || (changed = !expressionInputDirtyCheck(newInputValue, oldInputValueOfValues[i]))) {
                oldInputValues[i] = newInputValue;
                oldInputValueOfValues[i] = newInputValue &amp;&amp; getValueOf(newInputValue);
              }
            }
            <span class="hljs-keyword">if</span> (changed) {
              lastResult = parsedExpression(scope, <span class="hljs-literal">undefined</span>, <span class="hljs-literal">undefined</span>, oldInputValues);
            }
            <span class="hljs-keyword">return</span> lastResult;
          }, listener, objectEquality, prettyPrintExpression);
        }

        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">oneTimeWatchDelegate</span>(<span class="hljs-params">scope, listener, objectEquality, parsedExpression</span>) </span>{
          <span class="hljs-keyword">var</span> unwatch, lastValue;
          <span class="hljs-keyword">return</span> unwatch = scope.$watch(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">oneTimeWatch</span>(<span class="hljs-params">scope</span>) </span>{
            <span class="hljs-keyword">return</span> parsedExpression(scope);
          }, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">oneTimeListener</span>(<span class="hljs-params">value, old, scope</span>) </span>{
            lastValue = value;
            <span class="hljs-keyword">if</span> (isFunction(listener)) {
              listener.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
            }
            <span class="hljs-keyword">if</span> (isDefined(value)) {
              scope.$$postDigest(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                <span class="hljs-keyword">if</span> (isDefined(lastValue)) {
                  unwatch();
                }
              });
            }
          }, objectEquality);
        }

        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">oneTimeLiteralWatchDelegate</span>(<span class="hljs-params">scope, listener, objectEquality, parsedExpression</span>) </span>{
          <span class="hljs-keyword">var</span> unwatch, lastValue;
          <span class="hljs-keyword">return</span> unwatch = scope.$watch(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">oneTimeWatch</span>(<span class="hljs-params">scope</span>) </span>{
            <span class="hljs-keyword">return</span> parsedExpression(scope);
          }, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">oneTimeListener</span>(<span class="hljs-params">value, old, scope</span>) </span>{
            lastValue = value;
            <span class="hljs-keyword">if</span> (isFunction(listener)) {
              listener.call(<span class="hljs-keyword">this</span>, value, old, scope);
            }
            <span class="hljs-keyword">if</span> (isAllDefined(value)) {
              scope.$$postDigest(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                <span class="hljs-keyword">if</span> (isAllDefined(lastValue)) unwatch();
              });
            }
          }, objectEquality);

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isAllDefined</span>(<span class="hljs-params">value</span>) </span>{
            <span class="hljs-keyword">var</span> allDefined = <span class="hljs-literal">true</span>;
            forEach(value, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">val</span>) </span>{
              <span class="hljs-keyword">if</span> (!isDefined(val)) allDefined = <span class="hljs-literal">false</span>;
            });
            <span class="hljs-keyword">return</span> allDefined;
          }
        }

        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">constantWatchDelegate</span>(<span class="hljs-params">scope, listener, objectEquality, parsedExpression</span>) </span>{
          <span class="hljs-keyword">var</span> unwatch;
          <span class="hljs-keyword">return</span> unwatch = scope.$watch(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">constantWatch</span>(<span class="hljs-params">scope</span>) </span>{
            unwatch();
            <span class="hljs-keyword">return</span> parsedExpression(scope);
          }, listener, objectEquality);
        }

        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addInterceptor</span>(<span class="hljs-params">parsedExpression, interceptorFn</span>) </span>{
          <span class="hljs-keyword">if</span> (!interceptorFn) <span class="hljs-keyword">return</span> parsedExpression;
          <span class="hljs-keyword">var</span> watchDelegate = parsedExpression.$$watchDelegate;
          <span class="hljs-keyword">var</span> useInputs = <span class="hljs-literal">false</span>;
          <span class="hljs-keyword">var</span> regularWatch =
            watchDelegate !== oneTimeLiteralWatchDelegate &amp;&amp;
            watchDelegate !== oneTimeWatchDelegate;
          <span class="hljs-keyword">var</span> fn = regularWatch ? <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">regularInterceptedExpression</span>(<span class="hljs-params">scope, locals, assign, inputs</span>) </span>{
            <span class="hljs-keyword">var</span> value = useInputs &amp;&amp; inputs ? inputs[<span class="hljs-number">0</span>] : parsedExpression(scope, locals, assign, inputs);
            <span class="hljs-keyword">return</span> interceptorFn(value, scope, locals);
          } : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">oneTimeInterceptedExpression</span>(<span class="hljs-params">scope, locals, assign, inputs</span>) </span>{
            <span class="hljs-keyword">var</span> value = parsedExpression(scope, locals, assign, inputs);
            <span class="hljs-keyword">var</span> result = interceptorFn(value, scope, locals);
            <span class="hljs-keyword">return</span> isDefined(value) ? result : value;
          };
          <span class="hljs-keyword">if</span> (parsedExpression.$$watchDelegate &amp;&amp;
            parsedExpression.$$watchDelegate !== inputsWatchDelegate) {
            fn.$$watchDelegate = parsedExpression.$$watchDelegate;
          } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!interceptorFn.$stateful) {
            fn.$$watchDelegate = inputsWatchDelegate;
            useInputs = !parsedExpression.inputs;
            fn.inputs = parsedExpression.inputs ? parsedExpression.inputs : [parsedExpression];
          }
          <span class="hljs-keyword">return</span> fn;
        }
      }];
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$QProvider</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">this</span>.$get = [<span class="hljs-string">'$rootScope'</span>, <span class="hljs-string">'$exceptionHandler'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$rootScope, $exceptionHandler</span>) </span>{
        <span class="hljs-keyword">return</span> qFactory(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">callback</span>) </span>{
          $rootScope.$evalAsync(callback);
        }, $exceptionHandler);
      }];
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$$QProvider</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">this</span>.$get = [<span class="hljs-string">'$browser'</span>, <span class="hljs-string">'$exceptionHandler'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$browser, $exceptionHandler</span>) </span>{
        <span class="hljs-keyword">return</span> qFactory(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">callback</span>) </span>{
          $browser.defer(callback);
        }, $exceptionHandler);
      }];
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">qFactory</span>(<span class="hljs-params">nextTick, exceptionHandler</span>) </span>{
      <span class="hljs-keyword">var</span> $qMinErr = minErr(<span class="hljs-string">'$q'</span>, <span class="hljs-built_in">TypeError</span>);
      <span class="hljs-keyword">var</span> defer = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> d = <span class="hljs-keyword">new</span> Deferred();
        d.resolve = simpleBind(d, d.resolve);
        d.reject = simpleBind(d, d.reject);
        d.notify = simpleBind(d, d.notify);
        <span class="hljs-keyword">return</span> d;
      };

      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Promise</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">this</span>.$$state = {
          <span class="hljs-attr">status</span>: <span class="hljs-number">0</span>
        };
      }
      extend(<span class="hljs-built_in">Promise</span>.prototype, {
        <span class="hljs-attr">then</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">onFulfilled, onRejected, progressBack</span>) </span>{
          <span class="hljs-keyword">if</span> (isUndefined(onFulfilled) &amp;&amp; isUndefined(onRejected) &amp;&amp; isUndefined(progressBack)) {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
          }
          <span class="hljs-keyword">var</span> result = <span class="hljs-keyword">new</span> Deferred();
          <span class="hljs-keyword">this</span>.$$state.pending = <span class="hljs-keyword">this</span>.$$state.pending || [];
          <span class="hljs-keyword">this</span>.$$state.pending.push([result, onFulfilled, onRejected, progressBack]);
          <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.$$state.status &gt; <span class="hljs-number">0</span>) scheduleProcessQueue(<span class="hljs-keyword">this</span>.$$state);
          <span class="hljs-keyword">return</span> result.promise;
        },
        <span class="hljs-string">"catch"</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">callback</span>) </span>{
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.then(<span class="hljs-literal">null</span>, callback);
        },
        <span class="hljs-string">"finally"</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">callback, progressBack</span>) </span>{
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>) </span>{
            <span class="hljs-keyword">return</span> handleCallback(value, <span class="hljs-literal">true</span>, callback);
          }, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">error</span>) </span>{
            <span class="hljs-keyword">return</span> handleCallback(error, <span class="hljs-literal">false</span>, callback);
          }, progressBack);
        }
      });

      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">simpleBind</span>(<span class="hljs-params">context, fn</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>) </span>{
          fn.call(context, value);
        };
      }

      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">processQueue</span>(<span class="hljs-params">state</span>) </span>{
        <span class="hljs-keyword">var</span> fn, deferred, pending;
        pending = state.pending;
        state.processScheduled = <span class="hljs-literal">false</span>;
        state.pending = <span class="hljs-literal">undefined</span>;
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, ii = pending.length; i &lt; ii; ++i) {
          deferred = pending[i][<span class="hljs-number">0</span>];
          fn = pending[i][state.status];
          <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">if</span> (isFunction(fn)) {
              deferred.resolve(fn(state.value));
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (state.status === <span class="hljs-number">1</span>) {
              deferred.resolve(state.value);
            } <span class="hljs-keyword">else</span> {
              deferred.reject(state.value);
            }
          } <span class="hljs-keyword">catch</span> (e) {
            deferred.reject(e);
            exceptionHandler(e);
          }
        }
      }

      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">scheduleProcessQueue</span>(<span class="hljs-params">state</span>) </span>{
        <span class="hljs-keyword">if</span> (state.processScheduled || !state.pending) <span class="hljs-keyword">return</span>;
        state.processScheduled = <span class="hljs-literal">true</span>;
        nextTick(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
          processQueue(state);
        });
      }

      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Deferred</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">this</span>.promise = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>();
      }
      extend(Deferred.prototype, {
        <span class="hljs-attr">resolve</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">val</span>) </span>{
          <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.promise.$$state.status) <span class="hljs-keyword">return</span>;
          <span class="hljs-keyword">if</span> (val === <span class="hljs-keyword">this</span>.promise) {
            <span class="hljs-keyword">this</span>.$$reject($qMinErr(
              <span class="hljs-string">'qcycle'</span>,
              <span class="hljs-string">"Expected promise to be resolved with value other than itself '{0}'"</span>,
              val));
          } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">this</span>.$$resolve(val);
          }
        },
        <span class="hljs-attr">$$resolve</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">val</span>) </span>{
          <span class="hljs-keyword">var</span> then;
          <span class="hljs-keyword">var</span> that = <span class="hljs-keyword">this</span>;
          <span class="hljs-keyword">var</span> done = <span class="hljs-literal">false</span>;
          <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">if</span> ((isObject(val) || isFunction(val))) then = val &amp;&amp; val.then;
            <span class="hljs-keyword">if</span> (isFunction(then)) {
              <span class="hljs-keyword">this</span>.promise.$$state.status = <span class="hljs-number">-1</span>;
              then.call(val, resolvePromise, rejectPromise, simpleBind(<span class="hljs-keyword">this</span>, <span class="hljs-keyword">this</span>.notify));
            } <span class="hljs-keyword">else</span> {
              <span class="hljs-keyword">this</span>.promise.$$state.value = val;
              <span class="hljs-keyword">this</span>.promise.$$state.status = <span class="hljs-number">1</span>;
              scheduleProcessQueue(<span class="hljs-keyword">this</span>.promise.$$state);
            }
          } <span class="hljs-keyword">catch</span> (e) {
            rejectPromise(e);
            exceptionHandler(e);
          }

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">resolvePromise</span>(<span class="hljs-params">val</span>) </span>{
            <span class="hljs-keyword">if</span> (done) <span class="hljs-keyword">return</span>;
            done = <span class="hljs-literal">true</span>;
            that.$$resolve(val);
          }

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">rejectPromise</span>(<span class="hljs-params">val</span>) </span>{
            <span class="hljs-keyword">if</span> (done) <span class="hljs-keyword">return</span>;
            done = <span class="hljs-literal">true</span>;
            that.$$reject(val);
          }
        },
        <span class="hljs-attr">reject</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">reason</span>) </span>{
          <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.promise.$$state.status) <span class="hljs-keyword">return</span>;
          <span class="hljs-keyword">this</span>.$$reject(reason);
        },
        <span class="hljs-attr">$$reject</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">reason</span>) </span>{
          <span class="hljs-keyword">this</span>.promise.$$state.value = reason;
          <span class="hljs-keyword">this</span>.promise.$$state.status = <span class="hljs-number">2</span>;
          scheduleProcessQueue(<span class="hljs-keyword">this</span>.promise.$$state);
        },
        <span class="hljs-attr">notify</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">progress</span>) </span>{
          <span class="hljs-keyword">var</span> callbacks = <span class="hljs-keyword">this</span>.promise.$$state.pending;
          <span class="hljs-keyword">if</span> ((<span class="hljs-keyword">this</span>.promise.$$state.status &lt;= <span class="hljs-number">0</span>) &amp;&amp; callbacks &amp;&amp; callbacks.length) {
            nextTick(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
              <span class="hljs-keyword">var</span> callback, result;
              <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, ii = callbacks.length; i &lt; ii; i++) {
                result = callbacks[i][<span class="hljs-number">0</span>];
                callback = callbacks[i][<span class="hljs-number">3</span>];
                <span class="hljs-keyword">try</span> {
                  result.notify(isFunction(callback) ? callback(progress) : progress);
                } <span class="hljs-keyword">catch</span> (e) {
                  exceptionHandler(e);
                }
              }
            });
          }
        }
      });
      <span class="hljs-keyword">var</span> reject = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">reason</span>) </span>{
        <span class="hljs-keyword">var</span> result = <span class="hljs-keyword">new</span> Deferred();
        result.reject(reason);
        <span class="hljs-keyword">return</span> result.promise;
      };
      <span class="hljs-keyword">var</span> makePromise = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">makePromise</span>(<span class="hljs-params">value, resolved</span>) </span>{
        <span class="hljs-keyword">var</span> result = <span class="hljs-keyword">new</span> Deferred();
        <span class="hljs-keyword">if</span> (resolved) {
          result.resolve(value);
        } <span class="hljs-keyword">else</span> {
          result.reject(value);
        }
        <span class="hljs-keyword">return</span> result.promise;
      };
      <span class="hljs-keyword">var</span> handleCallback = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleCallback</span>(<span class="hljs-params">value, isResolved, callback</span>) </span>{
        <span class="hljs-keyword">var</span> callbackOutput = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">try</span> {
          <span class="hljs-keyword">if</span> (isFunction(callback)) callbackOutput = callback();
        } <span class="hljs-keyword">catch</span> (e) {
          <span class="hljs-keyword">return</span> makePromise(e, <span class="hljs-literal">false</span>);
        }
        <span class="hljs-keyword">if</span> (isPromiseLike(callbackOutput)) {
          <span class="hljs-keyword">return</span> callbackOutput.then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">return</span> makePromise(value, isResolved);
          }, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">error</span>) </span>{
            <span class="hljs-keyword">return</span> makePromise(error, <span class="hljs-literal">false</span>);
          });
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">return</span> makePromise(value, isResolved);
        }
      };
      <span class="hljs-keyword">var</span> when = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value, callback, errback, progressBack</span>) </span>{
        <span class="hljs-keyword">var</span> result = <span class="hljs-keyword">new</span> Deferred();
        result.resolve(value);
        <span class="hljs-keyword">return</span> result.promise.then(callback, errback, progressBack);
      };
      <span class="hljs-keyword">var</span> resolve = when;

      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">all</span>(<span class="hljs-params">promises</span>) </span>{
        <span class="hljs-keyword">var</span> deferred = <span class="hljs-keyword">new</span> Deferred(),
          counter = <span class="hljs-number">0</span>,
          results = isArray(promises) ? [] : {};
        forEach(promises, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">promise, key</span>) </span>{
          counter++;
          when(promise).then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>) </span>{
            <span class="hljs-keyword">if</span> (results.hasOwnProperty(key)) <span class="hljs-keyword">return</span>;
            results[key] = value;
            <span class="hljs-keyword">if</span> (!(--counter)) deferred.resolve(results);
          }, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">reason</span>) </span>{
            <span class="hljs-keyword">if</span> (results.hasOwnProperty(key)) <span class="hljs-keyword">return</span>;
            deferred.reject(reason);
          });
        });
        <span class="hljs-keyword">if</span> (counter === <span class="hljs-number">0</span>) {
          deferred.resolve(results);
        }
        <span class="hljs-keyword">return</span> deferred.promise;
      }
      <span class="hljs-keyword">var</span> $Q = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Q</span>(<span class="hljs-params">resolver</span>) </span>{
        <span class="hljs-keyword">if</span> (!isFunction(resolver)) {
          <span class="hljs-keyword">throw</span> $qMinErr(<span class="hljs-string">'norslvr'</span>, <span class="hljs-string">"Expected resolverFn, got '{0}'"</span>, resolver);
        }
        <span class="hljs-keyword">var</span> deferred = <span class="hljs-keyword">new</span> Deferred();

        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">resolveFn</span>(<span class="hljs-params">value</span>) </span>{
          deferred.resolve(value);
        }

        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">rejectFn</span>(<span class="hljs-params">reason</span>) </span>{
          deferred.reject(reason);
        }
        resolver(resolveFn, rejectFn);
        <span class="hljs-keyword">return</span> deferred.promise;
      };
      $Q.prototype = <span class="hljs-built_in">Promise</span>.prototype;
      $Q.defer = defer;
      $Q.reject = reject;
      $Q.when = when;
      $Q.resolve = resolve;
      $Q.all = all;
      <span class="hljs-keyword">return</span> $Q;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$$RAFProvider</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">this</span>.$get = [<span class="hljs-string">'$window'</span>, <span class="hljs-string">'$timeout'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$window, $timeout</span>) </span>{
        <span class="hljs-keyword">var</span> requestAnimationFrame = $<span class="hljs-built_in">window</span>.requestAnimationFrame ||
          $<span class="hljs-built_in">window</span>.webkitRequestAnimationFrame;
        <span class="hljs-keyword">var</span> cancelAnimationFrame = $<span class="hljs-built_in">window</span>.cancelAnimationFrame ||
          $<span class="hljs-built_in">window</span>.webkitCancelAnimationFrame ||
          $<span class="hljs-built_in">window</span>.webkitCancelRequestAnimationFrame;
        <span class="hljs-keyword">var</span> rafSupported = !!requestAnimationFrame;
        <span class="hljs-keyword">var</span> raf = rafSupported ?
          <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fn</span>) </span>{
            <span class="hljs-keyword">var</span> id = requestAnimationFrame(fn);
            <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
              cancelAnimationFrame(id);
            };
          } :
          <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fn</span>) </span>{
            <span class="hljs-keyword">var</span> timer = $timeout(fn, <span class="hljs-number">16.66</span>, <span class="hljs-literal">false</span>);
            <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
              $timeout.cancel(timer);
            };
          };
        raf.supported = rafSupported;
        <span class="hljs-keyword">return</span> raf;
      }];
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$RootScopeProvider</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> TTL = <span class="hljs-number">10</span>;
      <span class="hljs-keyword">var</span> $rootScopeMinErr = minErr(<span class="hljs-string">'$rootScope'</span>);
      <span class="hljs-keyword">var</span> lastDirtyWatch = <span class="hljs-literal">null</span>;
      <span class="hljs-keyword">var</span> applyAsyncId = <span class="hljs-literal">null</span>;
      <span class="hljs-keyword">this</span>.digestTtl = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">arguments</span>.length) {
          TTL = value;
        }
        <span class="hljs-keyword">return</span> TTL;
      };

      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createChildScopeClass</span>(<span class="hljs-params">parent</span>) </span>{
        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ChildScope</span>(<span class="hljs-params"></span>) </span>{
          <span class="hljs-keyword">this</span>.$$watchers = <span class="hljs-keyword">this</span>.$$nextSibling =
            <span class="hljs-keyword">this</span>.$$childHead = <span class="hljs-keyword">this</span>.$$childTail = <span class="hljs-literal">null</span>;
          <span class="hljs-keyword">this</span>.$$listeners = {};
          <span class="hljs-keyword">this</span>.$$listenerCount = {};
          <span class="hljs-keyword">this</span>.$$watchersCount = <span class="hljs-number">0</span>;
          <span class="hljs-keyword">this</span>.$id = nextUid();
          <span class="hljs-keyword">this</span>.$$ChildScope = <span class="hljs-literal">null</span>;
        }
        ChildScope.prototype = parent;
        <span class="hljs-keyword">return</span> ChildScope;
      }
      <span class="hljs-keyword">this</span>.$get = [<span class="hljs-string">'$exceptionHandler'</span>, <span class="hljs-string">'$parse'</span>, <span class="hljs-string">'$browser'</span>,
        <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$exceptionHandler, $parse, $browser</span>) </span>{
          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">destroyChildScope</span>(<span class="hljs-params">$event</span>) </span>{
            $event.currentScope.$$destroyed = <span class="hljs-literal">true</span>;
          }

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">cleanUpScope</span>(<span class="hljs-params">$scope</span>) </span>{
            <span class="hljs-keyword">if</span> (msie === <span class="hljs-number">9</span>) {
              $scope.$$childHead &amp;&amp; cleanUpScope($scope.$$childHead);
              $scope.$$nextSibling &amp;&amp; cleanUpScope($scope.$$nextSibling);
            }
            $scope.$parent = $scope.$$nextSibling = $scope.$$prevSibling = $scope.$$childHead =
              $scope.$$childTail = $scope.$root = $scope.$$watchers = <span class="hljs-literal">null</span>;
          }

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Scope</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">this</span>.$id = nextUid();
            <span class="hljs-keyword">this</span>.$$phase = <span class="hljs-keyword">this</span>.$parent = <span class="hljs-keyword">this</span>.$$watchers =
              <span class="hljs-keyword">this</span>.$$nextSibling = <span class="hljs-keyword">this</span>.$$prevSibling =
              <span class="hljs-keyword">this</span>.$$childHead = <span class="hljs-keyword">this</span>.$$childTail = <span class="hljs-literal">null</span>;
            <span class="hljs-keyword">this</span>.$root = <span class="hljs-keyword">this</span>;
            <span class="hljs-keyword">this</span>.$$destroyed = <span class="hljs-literal">false</span>;
            <span class="hljs-keyword">this</span>.$$listeners = {};
            <span class="hljs-keyword">this</span>.$$listenerCount = {};
            <span class="hljs-keyword">this</span>.$$watchersCount = <span class="hljs-number">0</span>;
            <span class="hljs-keyword">this</span>.$$isolateBindings = <span class="hljs-literal">null</span>;
          }
          Scope.prototype = {
            <span class="hljs-attr">constructor</span>: Scope,
            <span class="hljs-attr">$new</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">isolate, parent</span>) </span>{
              <span class="hljs-keyword">var</span> child;
              parent = parent || <span class="hljs-keyword">this</span>;
              <span class="hljs-keyword">if</span> (isolate) {
                child = <span class="hljs-keyword">new</span> Scope();
                child.$root = <span class="hljs-keyword">this</span>.$root;
              } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.$$ChildScope) {
                  <span class="hljs-keyword">this</span>.$$ChildScope = createChildScopeClass(<span class="hljs-keyword">this</span>);
                }
                child = <span class="hljs-keyword">new</span> <span class="hljs-keyword">this</span>.$$ChildScope();
              }
              child.$parent = parent;
              child.$$prevSibling = parent.$$childTail;
              <span class="hljs-keyword">if</span> (parent.$$childHead) {
                parent.$$childTail.$$nextSibling = child;
                parent.$$childTail = child;
              } <span class="hljs-keyword">else</span> {
                parent.$$childHead = parent.$$childTail = child;
              }
              <span class="hljs-keyword">if</span> (isolate || parent != <span class="hljs-keyword">this</span>) child.$on(<span class="hljs-string">'$destroy'</span>, destroyChildScope);
              <span class="hljs-keyword">return</span> child;
            },
            <span class="hljs-attr">$watch</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">watchExp, listener, objectEquality, prettyPrintExpression</span>) </span>{
              <span class="hljs-keyword">var</span> get = $parse(watchExp);
              <span class="hljs-keyword">if</span> (get.$$watchDelegate) {
                <span class="hljs-keyword">return</span> get.$$watchDelegate(<span class="hljs-keyword">this</span>, listener, objectEquality, get, watchExp);
              }
              <span class="hljs-keyword">var</span> scope = <span class="hljs-keyword">this</span>,
                array = scope.$$watchers,
                watcher = {
                  <span class="hljs-attr">fn</span>: listener,
                  <span class="hljs-attr">last</span>: initWatchVal,
                  <span class="hljs-attr">get</span>: get,
                  <span class="hljs-attr">exp</span>: prettyPrintExpression || watchExp,
                  <span class="hljs-attr">eq</span>: !!objectEquality
                };
              lastDirtyWatch = <span class="hljs-literal">null</span>;
              <span class="hljs-keyword">if</span> (!isFunction(listener)) {
                watcher.fn = noop;
              }
              <span class="hljs-keyword">if</span> (!array) {
                array = scope.$$watchers = [];
              }
              array.unshift(watcher);
              incrementWatchersCount(<span class="hljs-keyword">this</span>, <span class="hljs-number">1</span>);
              <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">deregisterWatch</span>(<span class="hljs-params"></span>) </span>{
                <span class="hljs-keyword">if</span> (arrayRemove(array, watcher) &gt;= <span class="hljs-number">0</span>) {
                  incrementWatchersCount(scope, <span class="hljs-number">-1</span>);
                }
                lastDirtyWatch = <span class="hljs-literal">null</span>;
              };
            },
            <span class="hljs-attr">$watchGroup</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">watchExpressions, listener</span>) </span>{
              <span class="hljs-keyword">var</span> oldValues = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(watchExpressions.length);
              <span class="hljs-keyword">var</span> newValues = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(watchExpressions.length);
              <span class="hljs-keyword">var</span> deregisterFns = [];
              <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;
              <span class="hljs-keyword">var</span> changeReactionScheduled = <span class="hljs-literal">false</span>;
              <span class="hljs-keyword">var</span> firstRun = <span class="hljs-literal">true</span>;
              <span class="hljs-keyword">if</span> (!watchExpressions.length) {
                <span class="hljs-keyword">var</span> shouldCall = <span class="hljs-literal">true</span>;
                self.$evalAsync(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                  <span class="hljs-keyword">if</span> (shouldCall) listener(newValues, newValues, self);
                });
                <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">deregisterWatchGroup</span>(<span class="hljs-params"></span>) </span>{
                  shouldCall = <span class="hljs-literal">false</span>;
                };
              }
              <span class="hljs-keyword">if</span> (watchExpressions.length === <span class="hljs-number">1</span>) {
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.$watch(watchExpressions[<span class="hljs-number">0</span>], <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">watchGroupAction</span>(<span class="hljs-params">value, oldValue, scope</span>) </span>{
                  newValues[<span class="hljs-number">0</span>] = value;
                  oldValues[<span class="hljs-number">0</span>] = oldValue;
                  listener(newValues, (value === oldValue) ? newValues : oldValues, scope);
                });
              }
              forEach(watchExpressions, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">expr, i</span>) </span>{
                <span class="hljs-keyword">var</span> unwatchFn = self.$watch(expr, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">watchGroupSubAction</span>(<span class="hljs-params">value, oldValue</span>) </span>{
                  newValues[i] = value;
                  oldValues[i] = oldValue;
                  <span class="hljs-keyword">if</span> (!changeReactionScheduled) {
                    changeReactionScheduled = <span class="hljs-literal">true</span>;
                    self.$evalAsync(watchGroupAction);
                  }
                });
                deregisterFns.push(unwatchFn);
              });

              <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">watchGroupAction</span>(<span class="hljs-params"></span>) </span>{
                changeReactionScheduled = <span class="hljs-literal">false</span>;
                <span class="hljs-keyword">if</span> (firstRun) {
                  firstRun = <span class="hljs-literal">false</span>;
                  listener(newValues, newValues, self);
                } <span class="hljs-keyword">else</span> {
                  listener(newValues, oldValues, self);
                }
              }
              <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">deregisterWatchGroup</span>(<span class="hljs-params"></span>) </span>{
                <span class="hljs-keyword">while</span> (deregisterFns.length) {
                  deregisterFns.shift()();
                }
              };
            },
            <span class="hljs-attr">$watchCollection</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">obj, listener</span>) </span>{
              $watchCollectionInterceptor.$stateful = <span class="hljs-literal">true</span>;
              <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;
              <span class="hljs-keyword">var</span> newValue;
              <span class="hljs-keyword">var</span> oldValue;
              <span class="hljs-keyword">var</span> veryOldValue;
              <span class="hljs-keyword">var</span> trackVeryOldValue = (listener.length &gt; <span class="hljs-number">1</span>);
              <span class="hljs-keyword">var</span> changeDetected = <span class="hljs-number">0</span>;
              <span class="hljs-keyword">var</span> changeDetector = $parse(obj, $watchCollectionInterceptor);
              <span class="hljs-keyword">var</span> internalArray = [];
              <span class="hljs-keyword">var</span> internalObject = {};
              <span class="hljs-keyword">var</span> initRun = <span class="hljs-literal">true</span>;
              <span class="hljs-keyword">var</span> oldLength = <span class="hljs-number">0</span>;

              <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$watchCollectionInterceptor</span>(<span class="hljs-params">_value</span>) </span>{
                newValue = _value;
                <span class="hljs-keyword">var</span> newLength, key, bothNaN, newItem, oldItem;
                <span class="hljs-keyword">if</span> (isUndefined(newValue)) <span class="hljs-keyword">return</span>;
                <span class="hljs-keyword">if</span> (!isObject(newValue)) {
                  <span class="hljs-keyword">if</span> (oldValue !== newValue) {
                    oldValue = newValue;
                    changeDetected++;
                  }
                } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (isArrayLike(newValue)) {
                  <span class="hljs-keyword">if</span> (oldValue !== internalArray) {
                    oldValue = internalArray;
                    oldLength = oldValue.length = <span class="hljs-number">0</span>;
                    changeDetected++;
                  }
                  newLength = newValue.length;
                  <span class="hljs-keyword">if</span> (oldLength !== newLength) {
                    changeDetected++;
                    oldValue.length = oldLength = newLength;
                  }
                  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; newLength; i++) {
                    oldItem = oldValue[i];
                    newItem = newValue[i];
                    bothNaN = (oldItem !== oldItem) &amp;&amp; (newItem !== newItem);
                    <span class="hljs-keyword">if</span> (!bothNaN &amp;&amp; (oldItem !== newItem)) {
                      changeDetected++;
                      oldValue[i] = newItem;
                    }
                  }
                } <span class="hljs-keyword">else</span> {
                  <span class="hljs-keyword">if</span> (oldValue !== internalObject) {
                    oldValue = internalObject = {};
                    oldLength = <span class="hljs-number">0</span>;
                    changeDetected++;
                  }
                  newLength = <span class="hljs-number">0</span>;
                  <span class="hljs-keyword">for</span> (key <span class="hljs-keyword">in</span> newValue) {
                    <span class="hljs-keyword">if</span> (hasOwnProperty.call(newValue, key)) {
                      newLength++;
                      newItem = newValue[key];
                      oldItem = oldValue[key];
                      <span class="hljs-keyword">if</span> (key <span class="hljs-keyword">in</span> oldValue) {
                        bothNaN = (oldItem !== oldItem) &amp;&amp; (newItem !== newItem);
                        <span class="hljs-keyword">if</span> (!bothNaN &amp;&amp; (oldItem !== newItem)) {
                          changeDetected++;
                          oldValue[key] = newItem;
                        }
                      } <span class="hljs-keyword">else</span> {
                        oldLength++;
                        oldValue[key] = newItem;
                        changeDetected++;
                      }
                    }
                  }
                  <span class="hljs-keyword">if</span> (oldLength &gt; newLength) {
                    changeDetected++;
                    <span class="hljs-keyword">for</span> (key <span class="hljs-keyword">in</span> oldValue) {
                      <span class="hljs-keyword">if</span> (!hasOwnProperty.call(newValue, key)) {
                        oldLength--;
                        <span class="hljs-keyword">delete</span> oldValue[key];
                      }
                    }
                  }
                }
                <span class="hljs-keyword">return</span> changeDetected;
              }

              <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$watchCollectionAction</span>(<span class="hljs-params"></span>) </span>{
                <span class="hljs-keyword">if</span> (initRun) {
                  initRun = <span class="hljs-literal">false</span>;
                  listener(newValue, newValue, self);
                } <span class="hljs-keyword">else</span> {
                  listener(newValue, veryOldValue, self);
                }
                <span class="hljs-keyword">if</span> (trackVeryOldValue) {
                  <span class="hljs-keyword">if</span> (!isObject(newValue)) {
                    veryOldValue = newValue;
                  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (isArrayLike(newValue)) {
                    veryOldValue = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(newValue.length);
                    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; newValue.length; i++) {
                      veryOldValue[i] = newValue[i];
                    }
                  } <span class="hljs-keyword">else</span> {
                    veryOldValue = {};
                    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> key <span class="hljs-keyword">in</span> newValue) {
                      <span class="hljs-keyword">if</span> (hasOwnProperty.call(newValue, key)) {
                        veryOldValue[key] = newValue[key];
                      }
                    }
                  }
                }
              }
              <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.$watch(changeDetector, $watchCollectionAction);
            },
            <span class="hljs-attr">$digest</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
              <span class="hljs-keyword">var</span> watch, value, last, fn, get,
                watchers,
                length,
                dirty, ttl = TTL,
                next, current, target = <span class="hljs-keyword">this</span>,
                watchLog = [],
                logIdx, asyncTask;
              beginPhase(<span class="hljs-string">'$digest'</span>);
              $browser.$$checkUrlChange();
              <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span> === $rootScope &amp;&amp; applyAsyncId !== <span class="hljs-literal">null</span>) {
                $browser.defer.cancel(applyAsyncId);
                flushApplyAsync();
              }
              lastDirtyWatch = <span class="hljs-literal">null</span>;
              <span class="hljs-keyword">do</span> {
                dirty = <span class="hljs-literal">false</span>;
                current = target;
                <span class="hljs-keyword">while</span> (asyncQueue.length) {
                  <span class="hljs-keyword">try</span> {
                    asyncTask = asyncQueue.shift();
                    asyncTask.scope.$<span class="hljs-built_in">eval</span>(asyncTask.expression, asyncTask.locals);
                  } <span class="hljs-keyword">catch</span> (e) {
                    $exceptionHandler(e);
                  }
                  lastDirtyWatch = <span class="hljs-literal">null</span>;
                }
                traverseScopesLoop:
                  <span class="hljs-keyword">do</span> {
                    <span class="hljs-keyword">if</span> ((watchers = current.$$watchers)) {
                      length = watchers.length;
                      <span class="hljs-keyword">while</span> (length--) {
                        <span class="hljs-keyword">try</span> {
                          watch = watchers[length];
                          <span class="hljs-keyword">if</span> (watch) {
                            get = watch.get;
                            <span class="hljs-keyword">if</span> ((value = get(current)) !== (last = watch.last) &amp;&amp;
                              !(watch.eq ?
                                equals(value, last) :
                                (<span class="hljs-keyword">typeof</span> value === <span class="hljs-string">'number'</span> &amp;&amp; <span class="hljs-keyword">typeof</span> last === <span class="hljs-string">'number'</span> &amp;&amp;
                                  <span class="hljs-built_in">isNaN</span>(value) &amp;&amp; <span class="hljs-built_in">isNaN</span>(last)))) {
                              dirty = <span class="hljs-literal">true</span>;
                              lastDirtyWatch = watch;
                              watch.last = watch.eq ? copy(value, <span class="hljs-literal">null</span>) : value;
                              fn = watch.fn;
                              fn(value, ((last === initWatchVal) ? value : last), current);
                              <span class="hljs-keyword">if</span> (ttl &lt; <span class="hljs-number">5</span>) {
                                logIdx = <span class="hljs-number">4</span> - ttl;
                                <span class="hljs-keyword">if</span> (!watchLog[logIdx]) watchLog[logIdx] = [];
                                watchLog[logIdx].push({
                                  <span class="hljs-attr">msg</span>: isFunction(watch.exp) ? <span class="hljs-string">'fn: '</span> + (watch.exp.name || watch.exp.toString()) : watch.exp,
                                  <span class="hljs-attr">newVal</span>: value,
                                  <span class="hljs-attr">oldVal</span>: last
                                });
                              }
                            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (watch === lastDirtyWatch) {
                              dirty = <span class="hljs-literal">false</span>;
                              <span class="hljs-keyword">break</span> traverseScopesLoop;
                            }
                          }
                        } <span class="hljs-keyword">catch</span> (e) {
                          $exceptionHandler(e);
                        }
                      }
                    }
                    <span class="hljs-keyword">if</span> (!(next = ((current.$$watchersCount &amp;&amp; current.$$childHead) ||
                        (current !== target &amp;&amp; current.$$nextSibling)))) {
                      <span class="hljs-keyword">while</span> (current !== target &amp;&amp; !(next = current.$$nextSibling)) {
                        current = current.$parent;
                      }
                    }
                  } <span class="hljs-keyword">while</span> ((current = next));
                <span class="hljs-keyword">if</span> ((dirty || asyncQueue.length) &amp;&amp; !(ttl--)) {
                  clearPhase();
                  <span class="hljs-keyword">throw</span> $rootScopeMinErr(<span class="hljs-string">'infdig'</span>,
                    <span class="hljs-string">'{0} $digest() iterations reached. Aborting!\n'</span> +
                    <span class="hljs-string">'Watchers fired in the last 5 iterations: {1}'</span>,
                    TTL, watchLog);
                }
              } <span class="hljs-keyword">while</span> (dirty || asyncQueue.length);
              clearPhase();
              <span class="hljs-keyword">while</span> (postDigestQueue.length) {
                <span class="hljs-keyword">try</span> {
                  postDigestQueue.shift()();
                } <span class="hljs-keyword">catch</span> (e) {
                  $exceptionHandler(e);
                }
              }
            },
            <span class="hljs-attr">$destroy</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
              <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.$$destroyed) <span class="hljs-keyword">return</span>;
              <span class="hljs-keyword">var</span> parent = <span class="hljs-keyword">this</span>.$parent;
              <span class="hljs-keyword">this</span>.$broadcast(<span class="hljs-string">'$destroy'</span>);
              <span class="hljs-keyword">this</span>.$$destroyed = <span class="hljs-literal">true</span>;
              <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span> === $rootScope) {
                $browser.$$applicationDestroyed();
              }
              incrementWatchersCount(<span class="hljs-keyword">this</span>, -<span class="hljs-keyword">this</span>.$$watchersCount);
              <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> eventName <span class="hljs-keyword">in</span> <span class="hljs-keyword">this</span>.$$listenerCount) {
                decrementListenerCount(<span class="hljs-keyword">this</span>, <span class="hljs-keyword">this</span>.$$listenerCount[eventName], eventName);
              }
              <span class="hljs-keyword">if</span> (parent &amp;&amp; parent.$$childHead == <span class="hljs-keyword">this</span>) parent.$$childHead = <span class="hljs-keyword">this</span>.$$nextSibling;
              <span class="hljs-keyword">if</span> (parent &amp;&amp; parent.$$childTail == <span class="hljs-keyword">this</span>) parent.$$childTail = <span class="hljs-keyword">this</span>.$$prevSibling;
              <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.$$prevSibling) <span class="hljs-keyword">this</span>.$$prevSibling.$$nextSibling = <span class="hljs-keyword">this</span>.$$nextSibling;
              <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.$$nextSibling) <span class="hljs-keyword">this</span>.$$nextSibling.$$prevSibling = <span class="hljs-keyword">this</span>.$$prevSibling;
              <span class="hljs-keyword">this</span>.$destroy = <span class="hljs-keyword">this</span>.$digest = <span class="hljs-keyword">this</span>.$apply = <span class="hljs-keyword">this</span>.$evalAsync = <span class="hljs-keyword">this</span>.$applyAsync = noop;
              <span class="hljs-keyword">this</span>.$on = <span class="hljs-keyword">this</span>.$watch = <span class="hljs-keyword">this</span>.$watchGroup = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                <span class="hljs-keyword">return</span> noop;
              };
              <span class="hljs-keyword">this</span>.$$listeners = {};
              <span class="hljs-keyword">this</span>.$$nextSibling = <span class="hljs-literal">null</span>;
              cleanUpScope(<span class="hljs-keyword">this</span>);
            },
            <span class="hljs-attr">$eval</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">expr, locals</span>) </span>{
              <span class="hljs-keyword">return</span> $parse(expr)(<span class="hljs-keyword">this</span>, locals);
            },
            <span class="hljs-attr">$evalAsync</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">expr, locals</span>) </span>{
              <span class="hljs-keyword">if</span> (!$rootScope.$$phase &amp;&amp; !asyncQueue.length) {
                $browser.defer(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                  <span class="hljs-keyword">if</span> (asyncQueue.length) {
                    $rootScope.$digest();
                  }
                });
              }
              asyncQueue.push({
                <span class="hljs-attr">scope</span>: <span class="hljs-keyword">this</span>,
                <span class="hljs-attr">expression</span>: $parse(expr),
                <span class="hljs-attr">locals</span>: locals
              });
            },
            <span class="hljs-attr">$$postDigest</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fn</span>) </span>{
              postDigestQueue.push(fn);
            },
            <span class="hljs-attr">$apply</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">expr</span>) </span>{
              <span class="hljs-keyword">try</span> {
                beginPhase(<span class="hljs-string">'$apply'</span>);
                <span class="hljs-keyword">try</span> {
                  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.$<span class="hljs-built_in">eval</span>(expr);
                } <span class="hljs-keyword">finally</span> {
                  clearPhase();
                }
              } <span class="hljs-keyword">catch</span> (e) {
                $exceptionHandler(e);
              } <span class="hljs-keyword">finally</span> {
                <span class="hljs-keyword">try</span> {
                  $rootScope.$digest();
                } <span class="hljs-keyword">catch</span> (e) {
                  $exceptionHandler(e);
                  <span class="hljs-keyword">throw</span> e;
                }
              }
            },
            <span class="hljs-attr">$applyAsync</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">expr</span>) </span>{
              <span class="hljs-keyword">var</span> scope = <span class="hljs-keyword">this</span>;
              expr &amp;&amp; applyAsyncQueue.push($applyAsyncExpression);
              expr = $parse(expr);
              scheduleApplyAsync();

              <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$applyAsyncExpression</span>(<span class="hljs-params"></span>) </span>{
                scope.$<span class="hljs-built_in">eval</span>(expr);
              }
            },
            <span class="hljs-attr">$on</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name, listener</span>) </span>{
              <span class="hljs-keyword">var</span> namedListeners = <span class="hljs-keyword">this</span>.$$listeners[name];
              <span class="hljs-keyword">if</span> (!namedListeners) {
                <span class="hljs-keyword">this</span>.$$listeners[name] = namedListeners = [];
              }
              namedListeners.push(listener);
              <span class="hljs-keyword">var</span> current = <span class="hljs-keyword">this</span>;
              <span class="hljs-keyword">do</span> {
                <span class="hljs-keyword">if</span> (!current.$$listenerCount[name]) {
                  current.$$listenerCount[name] = <span class="hljs-number">0</span>;
                }
                current.$$listenerCount[name]++;
              } <span class="hljs-keyword">while</span> ((current = current.$parent));
              <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;
              <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                <span class="hljs-keyword">var</span> indexOfListener = namedListeners.indexOf(listener);
                <span class="hljs-keyword">if</span> (indexOfListener !== <span class="hljs-number">-1</span>) {
                  namedListeners[indexOfListener] = <span class="hljs-literal">null</span>;
                  decrementListenerCount(self, <span class="hljs-number">1</span>, name);
                }
              };
            },
            <span class="hljs-attr">$emit</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name, args</span>) </span>{
              <span class="hljs-keyword">var</span> empty = [],
                namedListeners,
                scope = <span class="hljs-keyword">this</span>,
                stopPropagation = <span class="hljs-literal">false</span>,
                event = {
                  <span class="hljs-attr">name</span>: name,
                  <span class="hljs-attr">targetScope</span>: scope,
                  <span class="hljs-attr">stopPropagation</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                    stopPropagation = <span class="hljs-literal">true</span>;
                  },
                  <span class="hljs-attr">preventDefault</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                    event.defaultPrevented = <span class="hljs-literal">true</span>;
                  },
                  <span class="hljs-attr">defaultPrevented</span>: <span class="hljs-literal">false</span>
                },
                listenerArgs = concat([event], <span class="hljs-built_in">arguments</span>, <span class="hljs-number">1</span>),
                i, length;
              <span class="hljs-keyword">do</span> {
                namedListeners = scope.$$listeners[name] || empty;
                event.currentScope = scope;
                <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>, length = namedListeners.length; i &lt; length; i++) {
                  <span class="hljs-keyword">if</span> (!namedListeners[i]) {
                    namedListeners.splice(i, <span class="hljs-number">1</span>);
                    i--;
                    length--;
                    <span class="hljs-keyword">continue</span>;
                  }
                  <span class="hljs-keyword">try</span> {
                    namedListeners[i].apply(<span class="hljs-literal">null</span>, listenerArgs);
                  } <span class="hljs-keyword">catch</span> (e) {
                    $exceptionHandler(e);
                  }
                }
                <span class="hljs-keyword">if</span> (stopPropagation) {
                  event.currentScope = <span class="hljs-literal">null</span>;
                  <span class="hljs-keyword">return</span> event;
                }
                scope = scope.$parent;
              } <span class="hljs-keyword">while</span> (scope);
              event.currentScope = <span class="hljs-literal">null</span>;
              <span class="hljs-keyword">return</span> event;
            },
            <span class="hljs-attr">$broadcast</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name, args</span>) </span>{
              <span class="hljs-keyword">var</span> target = <span class="hljs-keyword">this</span>,
                current = target,
                next = target,
                event = {
                  <span class="hljs-attr">name</span>: name,
                  <span class="hljs-attr">targetScope</span>: target,
                  <span class="hljs-attr">preventDefault</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                    event.defaultPrevented = <span class="hljs-literal">true</span>;
                  },
                  <span class="hljs-attr">defaultPrevented</span>: <span class="hljs-literal">false</span>
                };
              <span class="hljs-keyword">if</span> (!target.$$listenerCount[name]) <span class="hljs-keyword">return</span> event;
              <span class="hljs-keyword">var</span> listenerArgs = concat([event], <span class="hljs-built_in">arguments</span>, <span class="hljs-number">1</span>),
                listeners, i, length;
              <span class="hljs-keyword">while</span> ((current = next)) {
                event.currentScope = current;
                listeners = current.$$listeners[name] || [];
                <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>, length = listeners.length; i &lt; length; i++) {
                  <span class="hljs-keyword">if</span> (!listeners[i]) {
                    listeners.splice(i, <span class="hljs-number">1</span>);
                    i--;
                    length--;
                    <span class="hljs-keyword">continue</span>;
                  }
                  <span class="hljs-keyword">try</span> {
                    listeners[i].apply(<span class="hljs-literal">null</span>, listenerArgs);
                  } <span class="hljs-keyword">catch</span> (e) {
                    $exceptionHandler(e);
                  }
                }
                <span class="hljs-keyword">if</span> (!(next = ((current.$$listenerCount[name] &amp;&amp; current.$$childHead) ||
                    (current !== target &amp;&amp; current.$$nextSibling)))) {
                  <span class="hljs-keyword">while</span> (current !== target &amp;&amp; !(next = current.$$nextSibling)) {
                    current = current.$parent;
                  }
                }
              }
              event.currentScope = <span class="hljs-literal">null</span>;
              <span class="hljs-keyword">return</span> event;
            }
          };
          <span class="hljs-keyword">var</span> $rootScope = <span class="hljs-keyword">new</span> Scope();
          <span class="hljs-keyword">var</span> asyncQueue = $rootScope.$$asyncQueue = [];
          <span class="hljs-keyword">var</span> postDigestQueue = $rootScope.$$postDigestQueue = [];
          <span class="hljs-keyword">var</span> applyAsyncQueue = $rootScope.$$applyAsyncQueue = [];
          <span class="hljs-keyword">return</span> $rootScope;

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">beginPhase</span>(<span class="hljs-params">phase</span>) </span>{
            <span class="hljs-keyword">if</span> ($rootScope.$$phase) {
              <span class="hljs-keyword">throw</span> $rootScopeMinErr(<span class="hljs-string">'inprog'</span>, <span class="hljs-string">'{0} already in progress'</span>, $rootScope.$$phase);
            }
            $rootScope.$$phase = phase;
          }

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">clearPhase</span>(<span class="hljs-params"></span>) </span>{
            $rootScope.$$phase = <span class="hljs-literal">null</span>;
          }

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">incrementWatchersCount</span>(<span class="hljs-params">current, count</span>) </span>{
            <span class="hljs-keyword">do</span> {
              current.$$watchersCount += count;
            } <span class="hljs-keyword">while</span> ((current = current.$parent));
          }

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">decrementListenerCount</span>(<span class="hljs-params">current, count, name</span>) </span>{
            <span class="hljs-keyword">do</span> {
              current.$$listenerCount[name] -= count;
              <span class="hljs-keyword">if</span> (current.$$listenerCount[name] === <span class="hljs-number">0</span>) {
                <span class="hljs-keyword">delete</span> current.$$listenerCount[name];
              }
            } <span class="hljs-keyword">while</span> ((current = current.$parent));
          }

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">initWatchVal</span>(<span class="hljs-params"></span>) </span>{}

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">flushApplyAsync</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">while</span> (applyAsyncQueue.length) {
              <span class="hljs-keyword">try</span> {
                applyAsyncQueue.shift()();
              } <span class="hljs-keyword">catch</span> (e) {
                $exceptionHandler(e);
              }
            }
            applyAsyncId = <span class="hljs-literal">null</span>;
          }

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">scheduleApplyAsync</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">if</span> (applyAsyncId === <span class="hljs-literal">null</span>) {
              applyAsyncId = $browser.defer(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                $rootScope.$apply(flushApplyAsync);
              });
            }
          }
        }
      ];
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$$SanitizeUriProvider</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> aHrefSanitizationWhitelist = <span class="hljs-regexp">/^\s*(https?|ftp|mailto|tel|file):/</span>,
        imgSrcSanitizationWhitelist = <span class="hljs-regexp">/^\s*((https?|ftp|file|blob):|data:image\/)/</span>;
      <span class="hljs-keyword">this</span>.aHrefSanitizationWhitelist = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">regexp</span>) </span>{
        <span class="hljs-keyword">if</span> (isDefined(regexp)) {
          aHrefSanitizationWhitelist = regexp;
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
        }
        <span class="hljs-keyword">return</span> aHrefSanitizationWhitelist;
      };
      <span class="hljs-keyword">this</span>.imgSrcSanitizationWhitelist = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">regexp</span>) </span>{
        <span class="hljs-keyword">if</span> (isDefined(regexp)) {
          imgSrcSanitizationWhitelist = regexp;
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
        }
        <span class="hljs-keyword">return</span> imgSrcSanitizationWhitelist;
      };
      <span class="hljs-keyword">this</span>.$get = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sanitizeUri</span>(<span class="hljs-params">uri, isImage</span>) </span>{
          <span class="hljs-keyword">var</span> regex = isImage ? imgSrcSanitizationWhitelist : aHrefSanitizationWhitelist;
          <span class="hljs-keyword">var</span> normalizedVal;
          normalizedVal = urlResolve(uri).href;
          <span class="hljs-keyword">if</span> (normalizedVal !== <span class="hljs-string">''</span> &amp;&amp; !normalizedVal.match(regex)) {
            <span class="hljs-keyword">return</span> <span class="hljs-string">'unsafe:'</span> + normalizedVal;
          }
          <span class="hljs-keyword">return</span> uri;
        };
      };
    }
    <span class="hljs-keyword">var</span> $sceMinErr = minErr(<span class="hljs-string">'$sce'</span>);
    <span class="hljs-keyword">var</span> SCE_CONTEXTS = {
      <span class="hljs-attr">HTML</span>: <span class="hljs-string">'html'</span>,
      <span class="hljs-attr">CSS</span>: <span class="hljs-string">'css'</span>,
      <span class="hljs-attr">URL</span>: <span class="hljs-string">'url'</span>,
      <span class="hljs-attr">RESOURCE_URL</span>: <span class="hljs-string">'resourceUrl'</span>,
      <span class="hljs-attr">JS</span>: <span class="hljs-string">'js'</span>
    };

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">adjustMatcher</span>(<span class="hljs-params">matcher</span>) </span>{
      <span class="hljs-keyword">if</span> (matcher === <span class="hljs-string">'self'</span>) {
        <span class="hljs-keyword">return</span> matcher;
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (isString(matcher)) {
        <span class="hljs-keyword">if</span> (matcher.indexOf(<span class="hljs-string">'***'</span>) &gt; <span class="hljs-number">-1</span>) {
          <span class="hljs-keyword">throw</span> $sceMinErr(<span class="hljs-string">'iwcard'</span>,
            <span class="hljs-string">'Illegal sequence *** in string matcher.  String: {0}'</span>, matcher);
        }
        matcher = escapeForRegexp(matcher).
        replace(<span class="hljs-string">'\\*\\*'</span>, <span class="hljs-string">'.*'</span>).
        replace(<span class="hljs-string">'\\*'</span>, <span class="hljs-string">'[^:/.?&amp;;]*'</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(<span class="hljs-string">'^'</span> + matcher + <span class="hljs-string">'$'</span>);
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (isRegExp(matcher)) {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(<span class="hljs-string">'^'</span> + matcher.source + <span class="hljs-string">'$'</span>);
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">throw</span> $sceMinErr(<span class="hljs-string">'imatcher'</span>,
          <span class="hljs-string">'Matchers may only be "self", string patterns or RegExp objects'</span>);
      }
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">adjustMatchers</span>(<span class="hljs-params">matchers</span>) </span>{
      <span class="hljs-keyword">var</span> adjustedMatchers = [];
      <span class="hljs-keyword">if</span> (isDefined(matchers)) {
        forEach(matchers, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">matcher</span>) </span>{
          adjustedMatchers.push(adjustMatcher(matcher));
        });
      }
      <span class="hljs-keyword">return</span> adjustedMatchers;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$SceDelegateProvider</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">this</span>.SCE_CONTEXTS = SCE_CONTEXTS;
      <span class="hljs-keyword">var</span> resourceUrlWhitelist = [<span class="hljs-string">'self'</span>],
        resourceUrlBlacklist = [];
      <span class="hljs-keyword">this</span>.resourceUrlWhitelist = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">arguments</span>.length) {
          resourceUrlWhitelist = adjustMatchers(value);
        }
        <span class="hljs-keyword">return</span> resourceUrlWhitelist;
      };
      <span class="hljs-keyword">this</span>.resourceUrlBlacklist = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">arguments</span>.length) {
          resourceUrlBlacklist = adjustMatchers(value);
        }
        <span class="hljs-keyword">return</span> resourceUrlBlacklist;
      };
      <span class="hljs-keyword">this</span>.$get = [<span class="hljs-string">'$injector'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$injector</span>) </span>{
        <span class="hljs-keyword">var</span> htmlSanitizer = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">htmlSanitizer</span>(<span class="hljs-params">html</span>) </span>{
          <span class="hljs-keyword">throw</span> $sceMinErr(<span class="hljs-string">'unsafe'</span>, <span class="hljs-string">'Attempting to use an unsafe value in a safe context.'</span>);
        };
        <span class="hljs-keyword">if</span> ($injector.has(<span class="hljs-string">'$sanitize'</span>)) {
          htmlSanitizer = $injector.get(<span class="hljs-string">'$sanitize'</span>);
        }

        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">matchUrl</span>(<span class="hljs-params">matcher, parsedUrl</span>) </span>{
          <span class="hljs-keyword">if</span> (matcher === <span class="hljs-string">'self'</span>) {
            <span class="hljs-keyword">return</span> urlIsSameOrigin(parsedUrl);
          } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> !!matcher.exec(parsedUrl.href);
          }
        }

        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isResourceUrlAllowedByPolicy</span>(<span class="hljs-params">url</span>) </span>{
          <span class="hljs-keyword">var</span> parsedUrl = urlResolve(url.toString());
          <span class="hljs-keyword">var</span> i, n, allowed = <span class="hljs-literal">false</span>;
          <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>, n = resourceUrlWhitelist.length; i &lt; n; i++) {
            <span class="hljs-keyword">if</span> (matchUrl(resourceUrlWhitelist[i], parsedUrl)) {
              allowed = <span class="hljs-literal">true</span>;
              <span class="hljs-keyword">break</span>;
            }
          }
          <span class="hljs-keyword">if</span> (allowed) {
            <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>, n = resourceUrlBlacklist.length; i &lt; n; i++) {
              <span class="hljs-keyword">if</span> (matchUrl(resourceUrlBlacklist[i], parsedUrl)) {
                allowed = <span class="hljs-literal">false</span>;
                <span class="hljs-keyword">break</span>;
              }
            }
          }
          <span class="hljs-keyword">return</span> allowed;
        }

        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">generateHolderType</span>(<span class="hljs-params">Base</span>) </span>{
          <span class="hljs-keyword">var</span> holderType = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">TrustedValueHolderType</span>(<span class="hljs-params">trustedValue</span>) </span>{
            <span class="hljs-keyword">this</span>.$$unwrapTrustedValue = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
              <span class="hljs-keyword">return</span> trustedValue;
            };
          };
          <span class="hljs-keyword">if</span> (Base) {
            holderType.prototype = <span class="hljs-keyword">new</span> Base();
          }
          holderType.prototype.valueOf = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sceValueOf</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.$$unwrapTrustedValue();
          };
          holderType.prototype.toString = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sceToString</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.$$unwrapTrustedValue().toString();
          };
          <span class="hljs-keyword">return</span> holderType;
        }
        <span class="hljs-keyword">var</span> trustedValueHolderBase = generateHolderType(),
          byType = {};
        byType[SCE_CONTEXTS.HTML] = generateHolderType(trustedValueHolderBase);
        byType[SCE_CONTEXTS.CSS] = generateHolderType(trustedValueHolderBase);
        byType[SCE_CONTEXTS.URL] = generateHolderType(trustedValueHolderBase);
        byType[SCE_CONTEXTS.JS] = generateHolderType(trustedValueHolderBase);
        byType[SCE_CONTEXTS.RESOURCE_URL] = generateHolderType(byType[SCE_CONTEXTS.URL]);

        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">trustAs</span>(<span class="hljs-params">type, trustedValue</span>) </span>{
          <span class="hljs-keyword">var</span> Constructor = (byType.hasOwnProperty(type) ? byType[type] : <span class="hljs-literal">null</span>);
          <span class="hljs-keyword">if</span> (!Constructor) {
            <span class="hljs-keyword">throw</span> $sceMinErr(<span class="hljs-string">'icontext'</span>,
              <span class="hljs-string">'Attempted to trust a value in invalid context. Context: {0}; Value: {1}'</span>,
              type, trustedValue);
          }
          <span class="hljs-keyword">if</span> (trustedValue === <span class="hljs-literal">null</span> || isUndefined(trustedValue) || trustedValue === <span class="hljs-string">''</span>) {
            <span class="hljs-keyword">return</span> trustedValue;
          }
          <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> trustedValue !== <span class="hljs-string">'string'</span>) {
            <span class="hljs-keyword">throw</span> $sceMinErr(<span class="hljs-string">'itype'</span>,
              <span class="hljs-string">'Attempted to trust a non-string value in a content requiring a string: Context: {0}'</span>,
              type);
          }
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Constructor(trustedValue);
        }

        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">valueOf</span>(<span class="hljs-params">maybeTrusted</span>) </span>{
          <span class="hljs-keyword">if</span> (maybeTrusted <span class="hljs-keyword">instanceof</span> trustedValueHolderBase) {
            <span class="hljs-keyword">return</span> maybeTrusted.$$unwrapTrustedValue();
          } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> maybeTrusted;
          }
        }

        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getTrusted</span>(<span class="hljs-params">type, maybeTrusted</span>) </span>{
          <span class="hljs-keyword">if</span> (maybeTrusted === <span class="hljs-literal">null</span> || isUndefined(maybeTrusted) || maybeTrusted === <span class="hljs-string">''</span>) {
            <span class="hljs-keyword">return</span> maybeTrusted;
          }
          <span class="hljs-keyword">var</span> <span class="hljs-keyword">constructor</span> = (byType.hasOwnProperty(type) ? byType[type] : null);
          if (<span class="hljs-keyword">constructor</span> &amp;&amp; maybeTrusted instanceof <span class="hljs-keyword">constructor</span>) {
            <span class="hljs-keyword">return</span> maybeTrusted.$$unwrapTrustedValue();
          }
          <span class="hljs-keyword">if</span> (type === SCE_CONTEXTS.RESOURCE_URL) {
            <span class="hljs-keyword">if</span> (isResourceUrlAllowedByPolicy(maybeTrusted)) {
              <span class="hljs-keyword">return</span> maybeTrusted;
            } <span class="hljs-keyword">else</span> {
              <span class="hljs-keyword">throw</span> $sceMinErr(<span class="hljs-string">'insecurl'</span>,
                <span class="hljs-string">'Blocked loading resource from url not allowed by $sceDelegate policy.  URL: {0}'</span>,
                maybeTrusted.toString());
            }
          } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (type === SCE_CONTEXTS.HTML) {
            <span class="hljs-keyword">return</span> htmlSanitizer(maybeTrusted);
          }
          <span class="hljs-keyword">throw</span> $sceMinErr(<span class="hljs-string">'unsafe'</span>, <span class="hljs-string">'Attempting to use an unsafe value in a safe context.'</span>);
        }
        <span class="hljs-keyword">return</span> {
          <span class="hljs-attr">trustAs</span>: trustAs,
          <span class="hljs-attr">getTrusted</span>: getTrusted,
          <span class="hljs-attr">valueOf</span>: valueOf
        };
      }];
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$SceProvider</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> enabled = <span class="hljs-literal">true</span>;
      <span class="hljs-keyword">this</span>.enabled = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">arguments</span>.length) {
          enabled = !!value;
        }
        <span class="hljs-keyword">return</span> enabled;
      };
      <span class="hljs-keyword">this</span>.$get = [<span class="hljs-string">'$parse'</span>, <span class="hljs-string">'$sceDelegate'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">
        $parse, $sceDelegate</span>) </span>{
        <span class="hljs-keyword">if</span> (enabled &amp;&amp; msie &lt; <span class="hljs-number">8</span>) {
          <span class="hljs-keyword">throw</span> $sceMinErr(<span class="hljs-string">'iequirks'</span>,
            <span class="hljs-string">'Strict Contextual Escaping does not support Internet Explorer version &lt; 11 in quirks '</span> +
            <span class="hljs-string">'mode.  You can fix this by adding the text &lt;!doctype html&gt; to the top of your HTML '</span> +
            <span class="hljs-string">'document.  See http://docs.angularjs.org/api/ng.$sce for more information.'</span>);
        }
        <span class="hljs-keyword">var</span> sce = shallowCopy(SCE_CONTEXTS);
        sce.isEnabled = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
          <span class="hljs-keyword">return</span> enabled;
        };
        sce.trustAs = $sceDelegate.trustAs;
        sce.getTrusted = $sceDelegate.getTrusted;
        sce.valueOf = $sceDelegate.valueOf;
        <span class="hljs-keyword">if</span> (!enabled) {
          sce.trustAs = sce.getTrusted = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">type, value</span>) </span>{
            <span class="hljs-keyword">return</span> value;
          };
          sce.valueOf = identity;
        }
        sce.parseAs = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sceParseAs</span>(<span class="hljs-params">type, expr</span>) </span>{
          <span class="hljs-keyword">var</span> parsed = $parse(expr);
          <span class="hljs-keyword">if</span> (parsed.literal &amp;&amp; parsed.constant) {
            <span class="hljs-keyword">return</span> parsed;
          } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> $parse(expr, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>) </span>{
              <span class="hljs-keyword">return</span> sce.getTrusted(type, value);
            });
          }
        };
        <span class="hljs-keyword">var</span> parse = sce.parseAs,
          getTrusted = sce.getTrusted,
          trustAs = sce.trustAs;
        forEach(SCE_CONTEXTS, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">enumValue, name</span>) </span>{
          <span class="hljs-keyword">var</span> lName = lowercase(name);
          sce[camelCase(<span class="hljs-string">"parse_as_"</span> + lName)] = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">expr</span>) </span>{
            <span class="hljs-keyword">return</span> parse(enumValue, expr);
          };
          sce[camelCase(<span class="hljs-string">"get_trusted_"</span> + lName)] = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>) </span>{
            <span class="hljs-keyword">return</span> getTrusted(enumValue, value);
          };
          sce[camelCase(<span class="hljs-string">"trust_as_"</span> + lName)] = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>) </span>{
            <span class="hljs-keyword">return</span> trustAs(enumValue, value);
          };
        });
        <span class="hljs-keyword">return</span> sce;
      }];
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$SnifferProvider</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">this</span>.$get = [<span class="hljs-string">'$window'</span>, <span class="hljs-string">'$document'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$window, $document</span>) </span>{
        <span class="hljs-keyword">var</span> eventSupport = {},
          isChromePackagedApp = $<span class="hljs-built_in">window</span>.chrome &amp;&amp; $<span class="hljs-built_in">window</span>.chrome.app &amp;&amp; $<span class="hljs-built_in">window</span>.chrome.app.runtime,
          hasHistoryPushState = !isChromePackagedApp &amp;&amp; $<span class="hljs-built_in">window</span>.history &amp;&amp; $<span class="hljs-built_in">window</span>.history.pushState,
          android =
          toInt((<span class="hljs-regexp">/android (\d+)/</span>.exec(lowercase(($<span class="hljs-built_in">window</span>.navigator || {}).userAgent)) || [])[<span class="hljs-number">1</span>]),
          boxee = <span class="hljs-regexp">/Boxee/i</span>.test(($<span class="hljs-built_in">window</span>.navigator || {}).userAgent),
          <span class="hljs-built_in">document</span> = $<span class="hljs-built_in">document</span>[<span class="hljs-number">0</span>] || {},
          vendorPrefix,
          vendorRegex = <span class="hljs-regexp">/^(Moz|webkit|ms)(?=[A-Z])/</span>,
          bodyStyle = <span class="hljs-built_in">document</span>.body &amp;&amp; <span class="hljs-built_in">document</span>.body.style,
          transitions = <span class="hljs-literal">false</span>,
          animations = <span class="hljs-literal">false</span>,
          match;
        <span class="hljs-keyword">if</span> (bodyStyle) {
          <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> prop <span class="hljs-keyword">in</span> bodyStyle) {
            <span class="hljs-keyword">if</span> (match = vendorRegex.exec(prop)) {
              vendorPrefix = match[<span class="hljs-number">0</span>];
              vendorPrefix = vendorPrefix.substr(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>).toUpperCase() + vendorPrefix.substr(<span class="hljs-number">1</span>);
              <span class="hljs-keyword">break</span>;
            }
          }
          <span class="hljs-keyword">if</span> (!vendorPrefix) {
            vendorPrefix = (<span class="hljs-string">'WebkitOpacity'</span> <span class="hljs-keyword">in</span> bodyStyle) &amp;&amp; <span class="hljs-string">'webkit'</span>;
          }
          transitions = !!((<span class="hljs-string">'transition'</span> <span class="hljs-keyword">in</span> bodyStyle) || (vendorPrefix + <span class="hljs-string">'Transition'</span> <span class="hljs-keyword">in</span> bodyStyle));
          animations = !!((<span class="hljs-string">'animation'</span> <span class="hljs-keyword">in</span> bodyStyle) || (vendorPrefix + <span class="hljs-string">'Animation'</span> <span class="hljs-keyword">in</span> bodyStyle));
          <span class="hljs-keyword">if</span> (android &amp;&amp; (!transitions || !animations)) {
            transitions = isString(bodyStyle.webkitTransition);
            animations = isString(bodyStyle.webkitAnimation);
          }
        }
        <span class="hljs-keyword">return</span> {
          <span class="hljs-attr">history</span>: !!(hasHistoryPushState &amp;&amp; !(android &lt; <span class="hljs-number">4</span>) &amp;&amp; !boxee),
          <span class="hljs-attr">hasEvent</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>{
            <span class="hljs-keyword">if</span> (event === <span class="hljs-string">'input'</span> &amp;&amp; msie &lt;= <span class="hljs-number">11</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
            <span class="hljs-keyword">if</span> (isUndefined(eventSupport[event])) {
              <span class="hljs-keyword">var</span> divElm = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'div'</span>);
              eventSupport[event] = <span class="hljs-string">'on'</span> + event <span class="hljs-keyword">in</span> divElm;
            }
            <span class="hljs-keyword">return</span> eventSupport[event];
          },
          <span class="hljs-attr">csp</span>: csp(),
          <span class="hljs-attr">vendorPrefix</span>: vendorPrefix,
          <span class="hljs-attr">transitions</span>: transitions,
          <span class="hljs-attr">animations</span>: animations,
          <span class="hljs-attr">android</span>: android
        };
      }];
    }
    <span class="hljs-keyword">var</span> $templateRequestMinErr = minErr(<span class="hljs-string">'$compile'</span>);

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$TemplateRequestProvider</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> httpOptions;
      <span class="hljs-keyword">this</span>.httpOptions = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">val</span>) </span>{
        <span class="hljs-keyword">if</span> (val) {
          httpOptions = val;
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
        }
        <span class="hljs-keyword">return</span> httpOptions;
      };
      <span class="hljs-keyword">this</span>.$get = [<span class="hljs-string">'$templateCache'</span>, <span class="hljs-string">'$http'</span>, <span class="hljs-string">'$q'</span>, <span class="hljs-string">'$sce'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$templateCache, $http, $q, $sce</span>) </span>{
        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleRequestFn</span>(<span class="hljs-params">tpl, ignoreRequestError</span>) </span>{
          handleRequestFn.totalPendingRequests++;
          <span class="hljs-keyword">if</span> (!isString(tpl) || !$templateCache.get(tpl)) {
            tpl = $sce.getTrustedResourceUrl(tpl);
          }
          <span class="hljs-keyword">var</span> transformResponse = $http.defaults &amp;&amp; $http.defaults.transformResponse;
          <span class="hljs-keyword">if</span> (isArray(transformResponse)) {
            transformResponse = transformResponse.filter(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">transformer</span>) </span>{
              <span class="hljs-keyword">return</span> transformer !== defaultHttpResponseTransform;
            });
          } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (transformResponse === defaultHttpResponseTransform) {
            transformResponse = <span class="hljs-literal">null</span>;
          }
          <span class="hljs-keyword">return</span> $http.get(tpl, extend({
              <span class="hljs-attr">cache</span>: $templateCache,
              <span class="hljs-attr">transformResponse</span>: transformResponse
            }, httpOptions))[<span class="hljs-string">'finally'</span>](<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
              handleRequestFn.totalPendingRequests--;
            })
            .then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">response</span>) </span>{
              $templateCache.put(tpl, response.data);
              <span class="hljs-keyword">return</span> response.data;
            }, handleError);

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleError</span>(<span class="hljs-params">resp</span>) </span>{
            <span class="hljs-keyword">if</span> (!ignoreRequestError) {
              <span class="hljs-keyword">throw</span> $templateRequestMinErr(<span class="hljs-string">'tpload'</span>, <span class="hljs-string">'Failed to load template: {0} (HTTP status: {1} {2})'</span>,
                tpl, resp.status, resp.statusText);
            }
            <span class="hljs-keyword">return</span> $q.reject(resp);
          }
        }
        handleRequestFn.totalPendingRequests = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">return</span> handleRequestFn;
      }];
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$$TestabilityProvider</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">this</span>.$get = [<span class="hljs-string">'$rootScope'</span>, <span class="hljs-string">'$browser'</span>, <span class="hljs-string">'$location'</span>,
        <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$rootScope, $browser, $location</span>) </span>{
          <span class="hljs-keyword">var</span> testability = {};
          testability.findBindings = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">element, expression, opt_exactMatch</span>) </span>{
            <span class="hljs-keyword">var</span> bindings = element.getElementsByClassName(<span class="hljs-string">'ng-binding'</span>);
            <span class="hljs-keyword">var</span> matches = [];
            forEach(bindings, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">binding</span>) </span>{
              <span class="hljs-keyword">var</span> dataBinding = angular.element(binding).data(<span class="hljs-string">'$binding'</span>);
              <span class="hljs-keyword">if</span> (dataBinding) {
                forEach(dataBinding, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bindingName</span>) </span>{
                  <span class="hljs-keyword">if</span> (opt_exactMatch) {
                    <span class="hljs-keyword">var</span> matcher = <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(<span class="hljs-string">'(^|\\s)'</span> + escapeForRegexp(expression) + <span class="hljs-string">'(\\s|\\||$)'</span>);
                    <span class="hljs-keyword">if</span> (matcher.test(bindingName)) {
                      matches.push(binding);
                    }
                  } <span class="hljs-keyword">else</span> {
                    <span class="hljs-keyword">if</span> (bindingName.indexOf(expression) != <span class="hljs-number">-1</span>) {
                      matches.push(binding);
                    }
                  }
                });
              }
            });
            <span class="hljs-keyword">return</span> matches;
          };
          testability.findModels = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">element, expression, opt_exactMatch</span>) </span>{
            <span class="hljs-keyword">var</span> prefixes = [<span class="hljs-string">'ng-'</span>, <span class="hljs-string">'data-ng-'</span>, <span class="hljs-string">'ng\\:'</span>];
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> p = <span class="hljs-number">0</span>; p &lt; prefixes.length; ++p) {
              <span class="hljs-keyword">var</span> attributeEquals = opt_exactMatch ? <span class="hljs-string">'='</span> : <span class="hljs-string">'*='</span>;
              <span class="hljs-keyword">var</span> selector = <span class="hljs-string">'['</span> + prefixes[p] + <span class="hljs-string">'model'</span> + attributeEquals + <span class="hljs-string">'"'</span> + expression + <span class="hljs-string">'"]'</span>;
              <span class="hljs-keyword">var</span> elements = element.querySelectorAll(selector);
              <span class="hljs-keyword">if</span> (elements.length) {
                <span class="hljs-keyword">return</span> elements;
              }
            }
          };
          testability.getLocation = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">return</span> $location.url();
          };
          testability.setLocation = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">url</span>) </span>{
            <span class="hljs-keyword">if</span> (url !== $location.url()) {
              $location.url(url);
              $rootScope.$digest();
            }
          };
          testability.whenStable = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">callback</span>) </span>{
            $browser.notifyWhenNoOutstandingRequests(callback);
          };
          <span class="hljs-keyword">return</span> testability;
        }
      ];
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$TimeoutProvider</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">this</span>.$get = [<span class="hljs-string">'$rootScope'</span>, <span class="hljs-string">'$browser'</span>, <span class="hljs-string">'$q'</span>, <span class="hljs-string">'$$q'</span>, <span class="hljs-string">'$exceptionHandler'</span>,
        <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$rootScope, $browser, $q, $$q, $exceptionHandler</span>) </span>{
          <span class="hljs-keyword">var</span> deferreds = {};

          <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">timeout</span>(<span class="hljs-params">fn, delay, invokeApply</span>) </span>{
            <span class="hljs-keyword">if</span> (!isFunction(fn)) {
              invokeApply = delay;
              delay = fn;
              fn = noop;
            }
            <span class="hljs-keyword">var</span> args = sliceArgs(<span class="hljs-built_in">arguments</span>, <span class="hljs-number">3</span>),
              skipApply = (isDefined(invokeApply) &amp;&amp; !invokeApply),
              deferred = (skipApply ? $$q : $q).defer(),
              promise = deferred.promise,
              timeoutId;
            timeoutId = $browser.defer(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
              <span class="hljs-keyword">try</span> {
                deferred.resolve(fn.apply(<span class="hljs-literal">null</span>, args));
              } <span class="hljs-keyword">catch</span> (e) {
                deferred.reject(e);
                $exceptionHandler(e);
              } <span class="hljs-keyword">finally</span> {
                <span class="hljs-keyword">delete</span> deferreds[promise.$$timeoutId];
              }
              <span class="hljs-keyword">if</span> (!skipApply) $rootScope.$apply();
            }, delay);
            promise.$$timeoutId = timeoutId;
            deferreds[timeoutId] = deferred;
            <span class="hljs-keyword">return</span> promise;
          }
          timeout.cancel = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">promise</span>) </span>{
            <span class="hljs-keyword">if</span> (promise &amp;&amp; promise.$$timeoutId <span class="hljs-keyword">in</span> deferreds) {
              deferreds[promise.$$timeoutId].reject(<span class="hljs-string">'canceled'</span>);
              <span class="hljs-keyword">delete</span> deferreds[promise.$$timeoutId];
              <span class="hljs-keyword">return</span> $browser.defer.cancel(promise.$$timeoutId);
            }
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
          };
          <span class="hljs-keyword">return</span> timeout;
        }
      ];
    }
    <span class="hljs-keyword">var</span> urlParsingNode = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"a"</span>);
    <span class="hljs-keyword">var</span> originUrl = urlResolve(<span class="hljs-built_in">window</span>.location.href);

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">urlResolve</span>(<span class="hljs-params">url</span>) </span>{
      <span class="hljs-keyword">var</span> href = url;
      <span class="hljs-keyword">if</span> (msie) {
        urlParsingNode.setAttribute(<span class="hljs-string">"href"</span>, href);
        href = urlParsingNode.href;
      }
      urlParsingNode.setAttribute(<span class="hljs-string">'href'</span>, href);
      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">href</span>: urlParsingNode.href,
        <span class="hljs-attr">protocol</span>: urlParsingNode.protocol ? urlParsingNode.protocol.replace(<span class="hljs-regexp">/:$/</span>, <span class="hljs-string">''</span>) : <span class="hljs-string">''</span>,
        <span class="hljs-attr">host</span>: urlParsingNode.host,
        <span class="hljs-attr">search</span>: urlParsingNode.search ? urlParsingNode.search.replace(<span class="hljs-regexp">/^\?/</span>, <span class="hljs-string">''</span>) : <span class="hljs-string">''</span>,
        <span class="hljs-attr">hash</span>: urlParsingNode.hash ? urlParsingNode.hash.replace(<span class="hljs-regexp">/^#/</span>, <span class="hljs-string">''</span>) : <span class="hljs-string">''</span>,
        <span class="hljs-attr">hostname</span>: urlParsingNode.hostname,
        <span class="hljs-attr">port</span>: urlParsingNode.port,
        <span class="hljs-attr">pathname</span>: (urlParsingNode.pathname.charAt(<span class="hljs-number">0</span>) === <span class="hljs-string">'/'</span>) ?
          urlParsingNode.pathname :
          <span class="hljs-string">'/'</span> + urlParsingNode.pathname
      };
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">urlIsSameOrigin</span>(<span class="hljs-params">requestUrl</span>) </span>{
      <span class="hljs-keyword">var</span> parsed = (isString(requestUrl)) ? urlResolve(requestUrl) : requestUrl;
      <span class="hljs-keyword">return</span> (parsed.protocol === originUrl.protocol &amp;&amp;
        parsed.host === originUrl.host);
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$WindowProvider</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">this</span>.$get = valueFn(<span class="hljs-built_in">window</span>);
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$$CookieReader</span>(<span class="hljs-params">$document</span>) </span>{
      <span class="hljs-keyword">var</span> rawDocument = $<span class="hljs-built_in">document</span>[<span class="hljs-number">0</span>] || {};
      <span class="hljs-keyword">var</span> lastCookies = {};
      <span class="hljs-keyword">var</span> lastCookieString = <span class="hljs-string">''</span>;

      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">safeDecodeURIComponent</span>(<span class="hljs-params">str</span>) </span>{
        <span class="hljs-keyword">try</span> {
          <span class="hljs-keyword">return</span> <span class="hljs-built_in">decodeURIComponent</span>(str);
        } <span class="hljs-keyword">catch</span> (e) {
          <span class="hljs-keyword">return</span> str;
        }
      }
      <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> cookieArray, cookie, i, index, name;
        <span class="hljs-keyword">var</span> currentCookieString = rawDocument.cookie || <span class="hljs-string">''</span>;
        <span class="hljs-keyword">if</span> (currentCookieString !== lastCookieString) {
          lastCookieString = currentCookieString;
          cookieArray = lastCookieString.split(<span class="hljs-string">'; '</span>);
          lastCookies = {};
          <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; cookieArray.length; i++) {
            cookie = cookieArray[i];
            index = cookie.indexOf(<span class="hljs-string">'='</span>);
            <span class="hljs-keyword">if</span> (index &gt; <span class="hljs-number">0</span>) {
              name = safeDecodeURIComponent(cookie.substring(<span class="hljs-number">0</span>, index));
              <span class="hljs-keyword">if</span> (isUndefined(lastCookies[name])) {
                lastCookies[name] = safeDecodeURIComponent(cookie.substring(index + <span class="hljs-number">1</span>));
              }
            }
          }
        }
        <span class="hljs-keyword">return</span> lastCookies;
      };
    }
    $$CookieReader.$inject = [<span class="hljs-string">'$document'</span>];

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$$CookieReaderProvider</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">this</span>.$get = $$CookieReader;
    }
    $FilterProvider.$inject = [<span class="hljs-string">'$provide'</span>];

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$FilterProvider</span>(<span class="hljs-params">$provide</span>) </span>{
      <span class="hljs-keyword">var</span> suffix = <span class="hljs-string">'Filter'</span>;

      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">register</span>(<span class="hljs-params">name, factory</span>) </span>{
        <span class="hljs-keyword">if</span> (isObject(name)) {
          <span class="hljs-keyword">var</span> filters = {};
          forEach(name, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">filter, key</span>) </span>{
            filters[key] = register(key, filter);
          });
          <span class="hljs-keyword">return</span> filters;
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">return</span> $provide.factory(name + suffix, factory);
        }
      }
      <span class="hljs-keyword">this</span>.register = register;
      <span class="hljs-keyword">this</span>.$get = [<span class="hljs-string">'$injector'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$injector</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name</span>) </span>{
          <span class="hljs-keyword">return</span> $injector.get(name + suffix);
        };
      }];
      register(<span class="hljs-string">'currency'</span>, currencyFilter);
      register(<span class="hljs-string">'date'</span>, dateFilter);
      register(<span class="hljs-string">'filter'</span>, filterFilter);
      register(<span class="hljs-string">'json'</span>, jsonFilter);
      register(<span class="hljs-string">'limitTo'</span>, limitToFilter);
      register(<span class="hljs-string">'lowercase'</span>, lowercaseFilter);
      register(<span class="hljs-string">'number'</span>, numberFilter);
      register(<span class="hljs-string">'orderBy'</span>, orderByFilter);
      register(<span class="hljs-string">'uppercase'</span>, uppercaseFilter);
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filterFilter</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">array, expression, comparator</span>) </span>{
        <span class="hljs-keyword">if</span> (!isArrayLike(array)) {
          <span class="hljs-keyword">if</span> (array == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">return</span> array;
          } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">throw</span> minErr(<span class="hljs-string">'filter'</span>)(<span class="hljs-string">'notarray'</span>, <span class="hljs-string">'Expected array but received: {0}'</span>, array);
          }
        }
        <span class="hljs-keyword">var</span> expressionType = getTypeForFilter(expression);
        <span class="hljs-keyword">var</span> predicateFn;
        <span class="hljs-keyword">var</span> matchAgainstAnyProp;
        <span class="hljs-keyword">switch</span> (expressionType) {
          <span class="hljs-keyword">case</span> <span class="hljs-string">'function'</span>:
            predicateFn = expression;
            <span class="hljs-keyword">break</span>;
          <span class="hljs-keyword">case</span> <span class="hljs-string">'boolean'</span>:
          <span class="hljs-keyword">case</span> <span class="hljs-string">'null'</span>:
          <span class="hljs-keyword">case</span> <span class="hljs-string">'number'</span>:
          <span class="hljs-keyword">case</span> <span class="hljs-string">'string'</span>:
            matchAgainstAnyProp = <span class="hljs-literal">true</span>;
          <span class="hljs-keyword">case</span> <span class="hljs-string">'object'</span>:
            predicateFn = createPredicateFn(expression, comparator, matchAgainstAnyProp);
            <span class="hljs-keyword">break</span>;
          <span class="hljs-keyword">default</span>:
            <span class="hljs-keyword">return</span> array;
        }
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">Array</span>.prototype.filter.call(array, predicateFn);
      };
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createPredicateFn</span>(<span class="hljs-params">expression, comparator, matchAgainstAnyProp</span>) </span>{
      <span class="hljs-keyword">var</span> shouldMatchPrimitives = isObject(expression) &amp;&amp; (<span class="hljs-string">'$'</span> <span class="hljs-keyword">in</span> expression);
      <span class="hljs-keyword">var</span> predicateFn;
      <span class="hljs-keyword">if</span> (comparator === <span class="hljs-literal">true</span>) {
        comparator = equals;
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!isFunction(comparator)) {
        comparator = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">actual, expected</span>) </span>{
          <span class="hljs-keyword">if</span> (isUndefined(actual)) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
          }
          <span class="hljs-keyword">if</span> ((actual === <span class="hljs-literal">null</span>) || (expected === <span class="hljs-literal">null</span>)) {
            <span class="hljs-keyword">return</span> actual === expected;
          }
          <span class="hljs-keyword">if</span> (isObject(expected) || (isObject(actual) &amp;&amp; !hasCustomToString(actual))) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
          }
          actual = lowercase(<span class="hljs-string">''</span> + actual);
          expected = lowercase(<span class="hljs-string">''</span> + expected);
          <span class="hljs-keyword">return</span> actual.indexOf(expected) !== <span class="hljs-number">-1</span>;
        };
      }
      predicateFn = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">item</span>) </span>{
        <span class="hljs-keyword">if</span> (shouldMatchPrimitives &amp;&amp; !isObject(item)) {
          <span class="hljs-keyword">return</span> deepCompare(item, expression.$, comparator, <span class="hljs-literal">false</span>);
        }
        <span class="hljs-keyword">return</span> deepCompare(item, expression, comparator, matchAgainstAnyProp);
      };
      <span class="hljs-keyword">return</span> predicateFn;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">deepCompare</span>(<span class="hljs-params">actual, expected, comparator, matchAgainstAnyProp, dontMatchWholeObject</span>) </span>{
      <span class="hljs-keyword">var</span> actualType = getTypeForFilter(actual);
      <span class="hljs-keyword">var</span> expectedType = getTypeForFilter(expected);
      <span class="hljs-keyword">if</span> ((expectedType === <span class="hljs-string">'string'</span>) &amp;&amp; (expected.charAt(<span class="hljs-number">0</span>) === <span class="hljs-string">'!'</span>)) {
        <span class="hljs-keyword">return</span> !deepCompare(actual, expected.substring(<span class="hljs-number">1</span>), comparator, matchAgainstAnyProp);
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (isArray(actual)) {
        <span class="hljs-keyword">return</span> actual.some(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">item</span>) </span>{
          <span class="hljs-keyword">return</span> deepCompare(item, expected, comparator, matchAgainstAnyProp);
        });
      }
      <span class="hljs-keyword">switch</span> (actualType) {
        <span class="hljs-keyword">case</span> <span class="hljs-string">'object'</span>:
          <span class="hljs-keyword">var</span> key;
          <span class="hljs-keyword">if</span> (matchAgainstAnyProp) {
            <span class="hljs-keyword">for</span> (key <span class="hljs-keyword">in</span> actual) {
              <span class="hljs-keyword">if</span> ((key.charAt(<span class="hljs-number">0</span>) !== <span class="hljs-string">'$'</span>) &amp;&amp; deepCompare(actual[key], expected, comparator, <span class="hljs-literal">true</span>)) {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
              }
            }
            <span class="hljs-keyword">return</span> dontMatchWholeObject ? <span class="hljs-literal">false</span> : deepCompare(actual, expected, comparator, <span class="hljs-literal">false</span>);
          } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (expectedType === <span class="hljs-string">'object'</span>) {
            <span class="hljs-keyword">for</span> (key <span class="hljs-keyword">in</span> expected) {
              <span class="hljs-keyword">var</span> expecte</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
