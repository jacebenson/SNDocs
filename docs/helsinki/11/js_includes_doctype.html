<!DOCTYPE html>

<html>
<head>
  <title>js_includes_doctype.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page_wrapper">
            <div id="jump_page">
              
                
                <a class="source" href="AJAXCompleter.html">
                  AJAXCompleter.js
                </a>
              
                
                <a class="source" href="AJAXEmailClientCompleter.html">
                  AJAXEmailClientCompleter.js
                </a>
              
                
                <a class="source" href="AJAXOtherCompleter.html">
                  AJAXOtherCompleter.js
                </a>
              
                
                <a class="source" href="AJAXReferenceChoice.html">
                  AJAXReferenceChoice.js
                </a>
              
                
                <a class="source" href="AJAXReferenceCompleter.html">
                  AJAXReferenceCompleter.js
                </a>
              
                
                <a class="source" href="AJAXReferenceCompleterMulti.html">
                  AJAXReferenceCompleterMulti.js
                </a>
              
                
                <a class="source" href="AJAXReferenceControls.html">
                  AJAXReferenceControls.js
                </a>
              
                
                <a class="source" href="AJAXTableCompleter.html">
                  AJAXTableCompleter.js
                </a>
              
                
                <a class="source" href="AttachmentUploader.html">
                  AttachmentUploader.js
                </a>
              
                
                <a class="source" href="AutoComplete.html">
                  AutoComplete.js
                </a>
              
                
                <a class="source" href="BoundsUtil2.html">
                  BoundsUtil2.js
                </a>
              
                
                <a class="source" href="CookieJar.html">
                  CookieJar.js
                </a>
              
                
                <a class="source" href="CustomEventManager.html">
                  CustomEventManager.js
                </a>
              
                
                <a class="source" href="DaysOfWeekElement.html">
                  DaysOfWeekElement.js
                </a>
              
                
                <a class="source" href="DerivedFields.html">
                  DerivedFields.js
                </a>
              
                
                <a class="source" href="Draggable2.html">
                  Draggable2.js
                </a>
              
                
                <a class="source" href="DropTarget2.html">
                  DropTarget2.js
                </a>
              
                
                <a class="source" href="FieldListElement.html">
                  FieldListElement.js
                </a>
              
                
                <a class="source" href="GlideAPI1.html">
                  GlideAPI1.js
                </a>
              
                
                <a class="source" href="GlideAjax.html">
                  GlideAjax.js
                </a>
              
                
                <a class="source" href="GlideAjaxForm.html">
                  GlideAjaxForm.js
                </a>
              
                
                <a class="source" href="GlideBox.html">
                  GlideBox.js
                </a>
              
                
                <a class="source" href="GlideClientCache.html">
                  GlideClientCache.js
                </a>
              
                
                <a class="source" href="GlideDecoration.html">
                  GlideDecoration.js
                </a>
              
                
                <a class="source" href="GlideDialogForm.html">
                  GlideDialogForm.js
                </a>
              
                
                <a class="source" href="GlideDialogWindow.html">
                  GlideDialogWindow.js
                </a>
              
                
                <a class="source" href="GlideDraggable.html">
                  GlideDraggable.js
                </a>
              
                
                <a class="source" href="GlideDuration.html">
                  GlideDuration.js
                </a>
              
                
                <a class="source" href="GlideEvent.html">
                  GlideEvent.js
                </a>
              
                
                <a class="source" href="GlideEventHandler.html">
                  GlideEventHandler.js
                </a>
              
                
                <a class="source" href="GlideFilter14.html">
                  GlideFilter14.js
                </a>
              
                
                <a class="source" href="GlideFilterDate.html">
                  GlideFilterDate.js
                </a>
              
                
                <a class="source" href="GlideFilterDescription.html">
                  GlideFilterDescription.js
                </a>
              
                
                <a class="source" href="GlideFilterHandlers.html">
                  GlideFilterHandlers.js
                </a>
              
                
                <a class="source" href="GlideFilterItemVariables.html">
                  GlideFilterItemVariables.js
                </a>
              
                
                <a class="source" href="GlideFilterLabels.html">
                  GlideFilterLabels.js
                </a>
              
                
                <a class="source" href="GlideFilterQuestions.html">
                  GlideFilterQuestions.js
                </a>
              
                
                <a class="source" href="GlideFilterReference.html">
                  GlideFilterReference.js
                </a>
              
                
                <a class="source" href="GlideFilterReferenceMulti.html">
                  GlideFilterReferenceMulti.js
                </a>
              
                
                <a class="source" href="GlideFilterVariables.html">
                  GlideFilterVariables.js
                </a>
              
                
                <a class="source" href="GlideForm14.html">
                  GlideForm14.js
                </a>
              
                
                <a class="source" href="GlideHeaderSearch.html">
                  GlideHeaderSearch.js
                </a>
              
                
                <a class="source" href="GlideList2.html">
                  GlideList2.js
                </a>
              
                
                <a class="source" href="GlideList2FilterUtil.html">
                  GlideList2FilterUtil.js
                </a>
              
                
                <a class="source" href="GlideList2Handlers.html">
                  GlideList2Handlers.js
                </a>
              
                
                <a class="source" href="GlideList2InitEvents.html">
                  GlideList2InitEvents.js
                </a>
              
                
                <a class="source" href="GlideListAggregates.html">
                  GlideListAggregates.js
                </a>
              
                
                <a class="source" href="GlideListEditor.html">
                  GlideListEditor.js
                </a>
              
                
                <a class="source" href="GlideListEditorMessaging.html">
                  GlideListEditorMessaging.js
                </a>
              
                
                <a class="source" href="GlideListElement.html">
                  GlideListElement.js
                </a>
              
                
                <a class="source" href="GlideModal.html">
                  GlideModal.js
                </a>
              
                
                <a class="source" href="GlideModalForm.html">
                  GlideModalForm.js
                </a>
              
                
                <a class="source" href="GlideNavigation.html">
                  GlideNavigation.js
                </a>
              
                
                <a class="source" href="GlideOverlay.html">
                  GlideOverlay.js
                </a>
              
                
                <a class="source" href="GlidePane.html">
                  GlidePane.js
                </a>
              
                
                <a class="source" href="GlidePaneForm.html">
                  GlidePaneForm.js
                </a>
              
                
                <a class="source" href="GlideRecord.html">
                  GlideRecord.js
                </a>
              
                
                <a class="source" href="GlideTabs2.html">
                  GlideTabs2.js
                </a>
              
                
                <a class="source" href="GlideTabs2State.html">
                  GlideTabs2State.js
                </a>
              
                
                <a class="source" href="GlideTabs2Tab.html">
                  GlideTabs2Tab.js
                </a>
              
                
                <a class="source" href="GlideTimeElement.html">
                  GlideTimeElement.js
                </a>
              
                
                <a class="source" href="GlideTimerElement.html">
                  GlideTimerElement.js
                </a>
              
                
                <a class="source" href="GlideTransactionScope.html">
                  GlideTransactionScope.js
                </a>
              
                
                <a class="source" href="GlideUI.html">
                  GlideUI.js
                </a>
              
                
                <a class="source" href="GlideUIDefault.html">
                  GlideUIDefault.js
                </a>
              
                
                <a class="source" href="GlideUIElement.html">
                  GlideUIElement.js
                </a>
              
                
                <a class="source" href="GlideUINotification.html">
                  GlideUINotification.js
                </a>
              
                
                <a class="source" href="GlideURL.html">
                  GlideURL.js
                </a>
              
                
                <a class="source" href="GlideURLElement.html">
                  GlideURLElement.js
                </a>
              
                
                <a class="source" href="GlideUser.html">
                  GlideUser.js
                </a>
              
                
                <a class="source" href="GlideUserImageElement.html">
                  GlideUserImageElement.js
                </a>
              
                
                <a class="source" href="GlideWidgetFilter.html">
                  GlideWidgetFilter.js
                </a>
              
                
                <a class="source" href="GlideWidgetHideOnEmpty.html">
                  GlideWidgetHideOnEmpty.js
                </a>
              
                
                <a class="source" href="GlideWidgetSearch.html">
                  GlideWidgetSearch.js
                </a>
              
                
                <a class="source" href="GlideWidgetVCR.html">
                  GlideWidgetVCR.js
                </a>
              
                
                <a class="source" href="GlideWindow.html">
                  GlideWindow.js
                </a>
              
                
                <a class="source" href="GuidedTourElementTranslator.html">
                  GuidedTourElementTranslator.js
                </a>
              
                
                <a class="source" href="GwtCellEditor.html">
                  GwtCellEditor.js
                </a>
              
                
                <a class="source" href="GwtCellSelector.html">
                  GwtCellSelector.js
                </a>
              
                
                <a class="source" href="GwtContextMenu.html">
                  GwtContextMenu.js
                </a>
              
                
                <a class="source" href="GwtDate.html">
                  GwtDate.js
                </a>
              
                
                <a class="source" href="GwtDraggable.html">
                  GwtDraggable.js
                </a>
              
                
                <a class="source" href="GwtDraggableSnap.html">
                  GwtDraggableSnap.js
                </a>
              
                
                <a class="source" href="GwtExportScheduleDialog.html">
                  GwtExportScheduleDialog.js
                </a>
              
                
                <a class="source" href="GwtGridEdit.html">
                  GwtGridEdit.js
                </a>
              
                
                <a class="source" href="GwtListEditAjaxChangeSaver.html">
                  GwtListEditAjaxChangeSaver.js
                </a>
              
                
                <a class="source" href="GwtListEditAjaxValueLoader.html">
                  GwtListEditAjaxValueLoader.js
                </a>
              
                
                <a class="source" href="GwtListEditBoolean.html">
                  GwtListEditBoolean.js
                </a>
              
                
                <a class="source" href="GwtListEditCalendar.html">
                  GwtListEditCalendar.js
                </a>
              
                
                <a class="source" href="GwtListEditDependent.html">
                  GwtListEditDependent.js
                </a>
              
                
                <a class="source" href="GwtListEditDuration.html">
                  GwtListEditDuration.js
                </a>
              
                
                <a class="source" href="GwtListEditEncryptedText.html">
                  GwtListEditEncryptedText.js
                </a>
              
                
                <a class="source" href="GwtListEditGList.html">
                  GwtListEditGList.js
                </a>
              
                
                <a class="source" href="GwtListEditGlideRecord.html">
                  GwtListEditGlideRecord.js
                </a>
              
                
                <a class="source" href="GwtListEditGridSelector.html">
                  GwtListEditGridSelector.js
                </a>
              
                
                <a class="source" href="GwtListEditInternalType.html">
                  GwtListEditInternalType.js
                </a>
              
                
                <a class="source" href="GwtListEditJournal.html">
                  GwtListEditJournal.js
                </a>
              
                
                <a class="source" href="GwtListEditPassword.html">
                  GwtListEditPassword.js
                </a>
              
                
                <a class="source" href="GwtListEditRecordDecorations.html">
                  GwtListEditRecordDecorations.js
                </a>
              
                
                <a class="source" href="GwtListEditReference.html">
                  GwtListEditReference.js
                </a>
              
                
                <a class="source" href="GwtListEditRelatedTags.html">
                  GwtListEditRelatedTags.js
                </a>
              
                
                <a class="source" href="GwtListEditSavePolicy.html">
                  GwtListEditSavePolicy.js
                </a>
              
                
                <a class="source" href="GwtListEditSelect.html">
                  GwtListEditSelect.js
                </a>
              
                
                <a class="source" href="GwtListEditTableController.html">
                  GwtListEditTableController.js
                </a>
              
                
                <a class="source" href="GwtListEditText.html">
                  GwtListEditText.js
                </a>
              
                
                <a class="source" href="GwtListEditTranslatedField.html">
                  GwtListEditTranslatedField.js
                </a>
              
                
                <a class="source" href="GwtListEditUpdateTablename.html">
                  GwtListEditUpdateTablename.js
                </a>
              
                
                <a class="source" href="GwtListEditValueRenderer.html">
                  GwtListEditValueRenderer.js
                </a>
              
                
                <a class="source" href="GwtListEditWindow.html">
                  GwtListEditWindow.js
                </a>
              
                
                <a class="source" href="GwtListEditor.html">
                  GwtListEditor.js
                </a>
              
                
                <a class="source" href="GwtListEditorPendingChanges.html">
                  GwtListEditorPendingChanges.js
                </a>
              
                
                <a class="source" href="GwtMessage14.html">
                  GwtMessage14.js
                </a>
              
                
                <a class="source" href="GwtObservable.html">
                  GwtObservable.js
                </a>
              
                
                <a class="source" href="GwtPollDialog.html">
                  GwtPollDialog.js
                </a>
              
                
                <a class="source" href="InPlaceEdit.html">
                  InPlaceEdit.js
                </a>
              
                
                <a class="source" href="ListDraggableRow2.html">
                  ListDraggableRow2.js
                </a>
              
                
                <a class="source" href="ListSelectManager2.html">
                  ListSelectManager2.js
                </a>
              
                
                <a class="source" href="ListSortDual2.html">
                  ListSortDual2.js
                </a>
              
                
                <a class="source" href="ListSortWindow2.html">
                  ListSortWindow2.js
                </a>
              
                
                <a class="source" href="NOW.messaging.html">
                  NOW.messaging.js
                </a>
              
                
                <a class="source" href="NOW.messaging.record.html">
                  NOW.messaging.record.js
                </a>
              
                
                <a class="source" href="NameMapEntry.html">
                  NameMapEntry.js
                </a>
              
                
                <a class="source" href="NotificationMessage.html">
                  NotificationMessage.js
                </a>
              
                
                <a class="source" href="PageTiming14.html">
                  PageTiming14.js
                </a>
              
                
                <a class="source" href="PersonalizeForm.html">
                  PersonalizeForm.js
                </a>
              
                
                <a class="source" href="Point.html">
                  Point.js
                </a>
              
                
                <a class="source" href="SLARepairClient.html">
                  SLARepairClient.js
                </a>
              
                
                <a class="source" href="ScriptLoader.html">
                  ScriptLoader.js
                </a>
              
                
                <a class="source" href="Select.html">
                  Select.js
                </a>
              
                
                <a class="source" href="SlushBucket.html">
                  SlushBucket.js
                </a>
              
                
                <a class="source" href="SortDraggable2.html">
                  SortDraggable2.js
                </a>
              
                
                <a class="source" href="SortListManager2.html">
                  SortListManager2.js
                </a>
              
                
                <a class="source" href="SortUtil2.html">
                  SortUtil2.js
                </a>
              
                
                <a class="source" href="StopWatch.html">
                  StopWatch.js
                </a>
              
                
                <a class="source" href="Table.html">
                  Table.js
                </a>
              
                
                <a class="source" href="TableElement.html">
                  TableElement.js
                </a>
              
                
                <a class="source" href="TableExtension.html">
                  TableExtension.js
                </a>
              
                
                <a class="source" href="TemplateRecord.html">
                  TemplateRecord.js
                </a>
              
                
                <a class="source" href="TextAreaElement.html">
                  TextAreaElement.js
                </a>
              
                
                <a class="source" href="UserRolesElement.html">
                  UserRolesElement.js
                </a>
              
                
                <a class="source" href="UtilityAndOverrides2.html">
                  UtilityAndOverrides2.js
                </a>
              
                
                <a class="source" href="_module.html">
                  _module.js
                </a>
              
                
                <a class="source" href="ac.html">
                  ac.js
                </a>
              
                
                <a class="source" href="ac_derived_field_support.html">
                  ac_derived_field_support.js
                </a>
              
                
                <a class="source" href="accessibility_tabindex.html">
                  accessibility_tabindex.js
                </a>
              
                
                <a class="source" href="affix.html">
                  affix.js
                </a>
              
                
                <a class="source" href="alert.html">
                  alert.js
                </a>
              
                
                <a class="source" href="amb.Channel.html">
                  amb.Channel.js
                </a>
              
                
                <a class="source" href="amb.ChannelRedirect.html">
                  amb.ChannelRedirect.js
                </a>
              
                
                <a class="source" href="amb.Logger.html">
                  amb.Logger.js
                </a>
              
                
                <a class="source" href="amb.MessageClient.html">
                  amb.MessageClient.js
                </a>
              
                
                <a class="source" href="amb.ServerConnection.html">
                  amb.ServerConnection.js
                </a>
              
                
                <a class="source" href="amb_initialize.html">
                  amb_initialize.js
                </a>
              
                
                <a class="source" href="amb_properties.html">
                  amb_properties.js
                </a>
              
                
                <a class="source" href="annotations_toggle.html">
                  annotations_toggle.js
                </a>
              
                
                <a class="source" href="app.form_presence.html">
                  app.form_presence.js
                </a>
              
                
                <a class="source" href="app_guided_tours.html">
                  app_guided_tours.js
                </a>
              
                
                <a class="source" href="button.html">
                  button.js
                </a>
              
                
                <a class="source" href="calendar.html">
                  calendar.js
                </a>
              
                
                <a class="source" href="carousel.html">
                  carousel.js
                </a>
              
                
                <a class="source" href="collapse.html">
                  collapse.js
                </a>
              
                
                <a class="source" href="cometd.html">
                  cometd.js
                </a>
              
                
                <a class="source" href="condition14_new.html">
                  condition14_new.js
                </a>
              
                
                <a class="source" href="condition14_reporting.html">
                  condition14_reporting.js
                </a>
              
                
                <a class="source" href="condition14_templates.html">
                  condition14_templates.js
                </a>
              
                
                <a class="source" href="condition_global_variables14.html">
                  condition_global_variables14.js
                </a>
              
                
                <a class="source" href="constants_embedded_help.html">
                  constants_embedded_help.js
                </a>
              
                
                <a class="source" href="context_actions.html">
                  context_actions.js
                </a>
              
                
                <a class="source" href="controller.guidedTours.html">
                  controller.guidedTours.js
                </a>
              
                
                <a class="source" href="deferred_related_lists.html">
                  deferred_related_lists.js
                </a>
              
                
                <a class="source" href="depends.html">
                  depends.js
                </a>
              
                
                <a class="source" href="directive.snBindPopoverSelection.html">
                  directive.snBindPopoverSelection.js
                </a>
              
                
                <a class="source" href="directive.snComplexPopover.html">
                  directive.snComplexPopover.js
                </a>
              
                
                <a class="source" href="dropdown.html">
                  dropdown.js
                </a>
              
                
                <a class="source" href="dropdowns.html">
                  dropdowns.js
                </a>
              
                
                <a class="source" href="email_activity.html">
                  email_activity.js
                </a>
              
                
                <a class="source" href="event_initialize.html">
                  event_initialize.js
                </a>
              
                
                <a class="source" href="fixedHeaders.html">
                  fixedHeaders.js
                </a>
              
                
                <a class="source" href="form_submitted_mask.html">
                  form_submitted_mask.js
                </a>
              
                
                <a class="source" href="form_tags.html">
                  form_tags.js
                </a>
              
                
                <a class="source" href="formatting.html">
                  formatting.js
                </a>
              
                
                <a class="source" href="functions.html">
                  functions.js
                </a>
              
                
                <a class="source" href="functions_attachments.html">
                  functions_attachments.js
                </a>
              
                
                <a class="source" href="functions_bootstrap14.html">
                  functions_bootstrap14.js
                </a>
              
                
                <a class="source" href="functions_calendar.html">
                  functions_calendar.js
                </a>
              
                
                <a class="source" href="functions_clipboard.html">
                  functions_clipboard.js
                </a>
              
                
                <a class="source" href="functions_email.html">
                  functions_email.js
                </a>
              
                
                <a class="source" href="functions_fontsizer.html">
                  functions_fontsizer.js
                </a>
              
                
                <a class="source" href="functions_onchange.html">
                  functions_onchange.js
                </a>
              
                
                <a class="source" href="functions_reference.html">
                  functions_reference.js
                </a>
              
                
                <a class="source" href="functions_showloading.html">
                  functions_showloading.js
                </a>
              
                
                <a class="source" href="functions_user_image.html">
                  functions_user_image.js
                </a>
              
                
                <a class="source" href="glide-highcharts-v5.html">
                  glide-highcharts-v5.js
                </a>
              
                
                <a class="source" href="guided_tours_template.html">
                  guided_tours_template.js
                </a>
              
                
                <a class="source" href="heisenberg_all.html">
                  heisenberg_all.js
                </a>
              
                
                <a class="source" href="jquery-1.11.0_no_conflict.html">
                  jquery-1.11.0_no_conflict.js
                </a>
              
                
                <a class="source" href="jquery.cometd.html">
                  jquery.cometd.js
                </a>
              
                
                <a class="source" href="jquery_clean.html">
                  jquery_clean.js
                </a>
              
                
                <a class="source" href="jquery_includes.html">
                  jquery_includes.js
                </a>
              
                
                <a class="source" href="js_guided_tours_includes.html">
                  js_guided_tours_includes.js
                </a>
              
                
                <a class="source" href="js_includes_amb.html">
                  js_includes_amb.js
                </a>
              
                
                <a class="source" href="js_includes_customer.html">
                  js_includes_customer.js
                </a>
              
                
                <a class="source" href="js_includes_doctype.html">
                  js_includes_doctype.js
                </a>
              
                
                <a class="source" href="js_includes_form_presence.html">
                  js_includes_form_presence.js
                </a>
              
                
                <a class="source" href="js_includes_last_doctype.html">
                  js_includes_last_doctype.js
                </a>
              
                
                <a class="source" href="js_includes_list_edit_doctype.html">
                  js_includes_list_edit_doctype.js
                </a>
              
                
                <a class="source" href="js_includes_listv2_doctype.html">
                  js_includes_listv2_doctype.js
                </a>
              
                
                <a class="source" href="js_includes_sorting_new.html">
                  js_includes_sorting_new.js
                </a>
              
                
                <a class="source" href="js_includes_ui_popover.html">
                  js_includes_ui_popover.js
                </a>
              
                
                <a class="source" href="list_filter.html">
                  list_filter.js
                </a>
              
                
                <a class="source" href="magellan.CreateFavoriteModal.html">
                  magellan.CreateFavoriteModal.js
                </a>
              
                
                <a class="source" href="modal.html">
                  modal.js
                </a>
              
                
                <a class="source" href="modals.html">
                  modals.js
                </a>
              
                
                <a class="source" href="newtag-it.html">
                  newtag-it.js
                </a>
              
                
                <a class="source" href="popover.html">
                  popover.js
                </a>
              
                
                <a class="source" href="popovers.html">
                  popovers.js
                </a>
              
                
                <a class="source" href="popupdivs14.html">
                  popupdivs14.js
                </a>
              
                
                <a class="source" href="popups.html">
                  popups.js
                </a>
              
                
                <a class="source" href="prototype.effects.html">
                  prototype.effects.js
                </a>
              
                
                <a class="source" href="prototype.hidefix.html">
                  prototype.hidefix.js
                </a>
              
                
                <a class="source" href="prototype.html">
                  prototype.js
                </a>
              
                
                <a class="source" href="prototype.plugin.html">
                  prototype.plugin.js
                </a>
              
                
                <a class="source" href="prototype.template.html">
                  prototype.template.js
                </a>
              
                
                <a class="source" href="scoped_object_generators.html">
                  scoped_object_generators.js
                </a>
              
                
                <a class="source" href="scrollable.html">
                  scrollable.js
                </a>
              
                
                <a class="source" href="scrollspy.html">
                  scrollspy.js
                </a>
              
                
                <a class="source" href="section.html">
                  section.js
                </a>
              
                
                <a class="source" href="selects.html">
                  selects.js
                </a>
              
                
                <a class="source" href="service.guidedToursService.html">
                  service.guidedToursService.js
                </a>
              
                
                <a class="source" href="service.snComplexPopoverService.html">
                  service.snComplexPopoverService.js
                </a>
              
                
                <a class="source" href="service.userData.html">
                  service.userData.js
                </a>
              
                
                <a class="source" href="simpleStorage.html">
                  simpleStorage.js
                </a>
              
                
                <a class="source" href="snPopover.html">
                  snPopover.js
                </a>
              
                
                <a class="source" href="tables.html">
                  tables.js
                </a>
              
                
                <a class="source" href="tabs.html">
                  tabs.js
                </a>
              
                
                <a class="source" href="tabs2_14.html">
                  tabs2_14.js
                </a>
              
                
                <a class="source" href="textutil.html">
                  textutil.js
                </a>
              
                
                <a class="source" href="timeAgo.html">
                  timeAgo.js
                </a>
              
                
                <a class="source" href="tooltip.html">
                  tooltip.js
                </a>
              
                
                <a class="source" href="tooltips.html">
                  tooltips.js
                </a>
              
                
                <a class="source" href="transaction_scope_includes.html">
                  transaction_scope_includes.js
                </a>
              
                
                <a class="source" href="transition.html">
                  transition.js
                </a>
              
                
                <a class="source" href="ui_policy.html">
                  ui_policy.js
                </a>
              
                
                <a class="source" href="utils14.html">
                  utils14.js
                </a>
              
                
                <a class="source" href="xmlhttp.html">
                  xmlhttp.js
                </a>
              
                
                <a class="source" href="z_last_include.html">
                  z_last_include.js
                </a>
              
            </div>
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>js_includes_doctype.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-comment">/*! RESOURCE: /scripts/doctype/js_includes_doctype.js */</span>
<span class="hljs-comment">/*! RESOURCE: /scripts/lib/prototype.min.js */</span>
<span class="hljs-comment">/*!
 *  Prototype JavaScript framework, version 1.7
 *  (c) 2005-2010 Sam Stephenson
 *
 *  Prototype is freely distributable under the terms of an MIT-style license.
 *  For details, see the Prototype web site: http://www.prototypejs.org/
 *
 */</span>
<span class="hljs-keyword">var</span> Prototype = {
  <span class="hljs-attr">Version</span>: <span class="hljs-string">"1.7"</span>,
  <span class="hljs-attr">Browser</span>: (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> b = navigator.userAgent;
    <span class="hljs-keyword">var</span> a = <span class="hljs-built_in">Object</span>.prototype.toString.call(<span class="hljs-built_in">window</span>.opera) == <span class="hljs-string">"[object Opera]"</span>;
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">IE</span>: !!<span class="hljs-built_in">window</span>.attachEvent &amp;&amp; !a,
      <span class="hljs-attr">Opera</span>: a,
      <span class="hljs-attr">WebKit</span>: b.indexOf(<span class="hljs-string">"AppleWebKit/"</span>) &gt; <span class="hljs-number">-1</span>,
      <span class="hljs-attr">Gecko</span>: b.indexOf(<span class="hljs-string">"Gecko"</span>) &gt; <span class="hljs-number">-1</span> &amp;&amp; b.indexOf(<span class="hljs-string">"KHTML"</span>) === <span class="hljs-number">-1</span>,
      <span class="hljs-attr">MobileSafari</span>: <span class="hljs-regexp">/Apple.*Mobile/</span>.test(b)
    }
  })(),
  <span class="hljs-attr">BrowserFeatures</span>: {
    <span class="hljs-attr">XPath</span>: !!<span class="hljs-built_in">document</span>.evaluate,
    <span class="hljs-attr">SelectorsAPI</span>: !!<span class="hljs-built_in">document</span>.querySelector,
    <span class="hljs-attr">ElementExtensions</span>: (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> a = <span class="hljs-built_in">window</span>.Element || <span class="hljs-built_in">window</span>.HTMLElement;
      <span class="hljs-keyword">return</span> !!(a &amp;&amp; a.prototype)
    })(),
    <span class="hljs-attr">SpecificElementExtensions</span>: (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">window</span>.HTMLDivElement !== <span class="hljs-string">"undefined"</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
      }
      <span class="hljs-keyword">var</span> c = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"div"</span>),
        b = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"form"</span>),
        a = <span class="hljs-literal">false</span>;
      <span class="hljs-keyword">if</span> (c.__proto__ &amp;&amp; (c.__proto__ !== b.__proto__)) {
        a = <span class="hljs-literal">true</span>
      }
      c = b = <span class="hljs-literal">null</span>;
      <span class="hljs-keyword">return</span> a
    })()
  },
  <span class="hljs-attr">ScriptFragment</span>: <span class="hljs-string">"&lt;script[^&gt;]*&gt;([\\S\\s]*?)&lt;\/script&gt;"</span>,
  <span class="hljs-attr">JSONFilter</span>: <span class="hljs-regexp">/^\/\*-secure-([\s\S]*)\*\/\s*$/</span>,
  <span class="hljs-attr">emptyFunction</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{},
  <span class="hljs-attr">K</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
    <span class="hljs-keyword">return</span> a
  }
};
<span class="hljs-keyword">if</span> (Prototype.Browser.MobileSafari) {
  Prototype.BrowserFeatures.SpecificElementExtensions = <span class="hljs-literal">false</span>
}
<span class="hljs-keyword">var</span> Abstract = {};
<span class="hljs-keyword">var</span> Try = {
  <span class="hljs-attr">these</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> c;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> b = <span class="hljs-number">0</span>, d = <span class="hljs-built_in">arguments</span>.length; b &lt; d; b++) {
      <span class="hljs-keyword">var</span> a = <span class="hljs-built_in">arguments</span>[b];
      <span class="hljs-keyword">try</span> {
        c = a();
        <span class="hljs-keyword">break</span>
      } <span class="hljs-keyword">catch</span> (f) {}
    }
    <span class="hljs-keyword">return</span> c
  }
};
<span class="hljs-keyword">var</span> Class = (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> d = (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> e <span class="hljs-keyword">in</span> {
        <span class="hljs-attr">toString</span>: <span class="hljs-number">1</span>
      }) {
      <span class="hljs-keyword">if</span> (e === <span class="hljs-string">"toString"</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
      }
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
  })();

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">a</span>(<span class="hljs-params"></span>) </span>{}

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">b</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> h = <span class="hljs-literal">null</span>,
      g = $A(<span class="hljs-built_in">arguments</span>);
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.isFunction(g[<span class="hljs-number">0</span>])) {
      h = g.shift()
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">e</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">this</span>.initialize.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>)
    }
    <span class="hljs-built_in">Object</span>.extend(e, Class.Methods);
    e.superclass = h;
    e.subclasses = [];
    <span class="hljs-keyword">if</span> (h) {
      a.prototype = h.prototype;
      e.prototype = <span class="hljs-keyword">new</span> a;
      h.subclasses.push(e)
    }
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> f = <span class="hljs-number">0</span>, j = g.length; f &lt; j; f++) {
      e.addMethods(g[f])
    }
    <span class="hljs-keyword">if</span> (!e.prototype.initialize) {
      e.prototype.initialize = Prototype.emptyFunction
    }
    e.prototype.constructor = e;
    <span class="hljs-keyword">return</span> e
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">c</span>(<span class="hljs-params">l</span>) </span>{
    <span class="hljs-keyword">var</span> g = <span class="hljs-keyword">this</span>.superclass &amp;&amp; <span class="hljs-keyword">this</span>.superclass.prototype,
      f = <span class="hljs-built_in">Object</span>.keys(l);
    <span class="hljs-keyword">if</span> (d) {
      <span class="hljs-keyword">if</span> (l.toString != <span class="hljs-built_in">Object</span>.prototype.toString) {
        f.push(<span class="hljs-string">"toString"</span>)
      }
      <span class="hljs-keyword">if</span> (l.valueOf != <span class="hljs-built_in">Object</span>.prototype.valueOf) {
        f.push(<span class="hljs-string">"valueOf"</span>)
      }
    }
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> e = <span class="hljs-number">0</span>, h = f.length; e &lt; h; e++) {
      <span class="hljs-keyword">var</span> k = f[e],
        j = l[k];
      <span class="hljs-keyword">if</span> (g &amp;&amp; <span class="hljs-built_in">Object</span>.isFunction(j) &amp;&amp; j.argumentNames()[<span class="hljs-number">0</span>] == <span class="hljs-string">"$super"</span>) {
        <span class="hljs-keyword">var</span> m = j;
        j = (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">i</span>) </span>{
          <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">return</span> g[i].apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>)
          }
        })(k).wrap(m);
        j.valueOf = m.valueOf.bind(m);
        j.toString = m.toString.bind(m)
      }
      <span class="hljs-keyword">this</span>.prototype[k] = j
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>
  }
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">create</span>: b,
    <span class="hljs-attr">Methods</span>: {
      <span class="hljs-attr">addMethods</span>: c
    }
  }
})();
(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> C = <span class="hljs-built_in">Object</span>.prototype.toString,
    B = <span class="hljs-string">"Null"</span>,
    o = <span class="hljs-string">"Undefined"</span>,
    v = <span class="hljs-string">"Boolean"</span>,
    f = <span class="hljs-string">"Number"</span>,
    s = <span class="hljs-string">"String"</span>,
    H = <span class="hljs-string">"Object"</span>,
    t = <span class="hljs-string">"[object Function]"</span>,
    y = <span class="hljs-string">"[object Boolean]"</span>,
    g = <span class="hljs-string">"[object Number]"</span>,
    l = <span class="hljs-string">"[object String]"</span>,
    h = <span class="hljs-string">"[object Array]"</span>,
    x = <span class="hljs-string">"[object Date]"</span>,
    i = <span class="hljs-built_in">window</span>.JSON &amp;&amp; <span class="hljs-keyword">typeof</span> <span class="hljs-built_in">JSON</span>.stringify === <span class="hljs-string">"function"</span> &amp;&amp; <span class="hljs-built_in">JSON</span>.stringify(<span class="hljs-number">0</span>) === <span class="hljs-string">"0"</span> &amp;&amp; <span class="hljs-keyword">typeof</span> <span class="hljs-built_in">JSON</span>.stringify(Prototype.K) === <span class="hljs-string">"undefined"</span>;

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">k</span>(<span class="hljs-params">J</span>) </span>{
    <span class="hljs-keyword">switch</span> (J) {
      <span class="hljs-keyword">case</span> <span class="hljs-literal">null</span>:
        <span class="hljs-keyword">return</span> B;
      <span class="hljs-keyword">case</span> (<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>):
        <span class="hljs-keyword">return</span> o
    }
    <span class="hljs-keyword">var</span> I = <span class="hljs-keyword">typeof</span> J;
    <span class="hljs-keyword">switch</span> (I) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">"boolean"</span>:
        <span class="hljs-keyword">return</span> v;
      <span class="hljs-keyword">case</span> <span class="hljs-string">"number"</span>:
        <span class="hljs-keyword">return</span> f;
      <span class="hljs-keyword">case</span> <span class="hljs-string">"string"</span>:
        <span class="hljs-keyword">return</span> s
    }
    <span class="hljs-keyword">return</span> H
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">z</span>(<span class="hljs-params">I, K</span>) </span>{
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> J <span class="hljs-keyword">in</span> K) {
      I[J] = K[J]
    }
    <span class="hljs-keyword">return</span> I
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">G</span>(<span class="hljs-params">I</span>) </span>{
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">if</span> (c(I)) {
        <span class="hljs-keyword">return</span> <span class="hljs-string">"undefined"</span>
      }
      <span class="hljs-keyword">if</span> (I === <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-string">"null"</span>
      }
      <span class="hljs-keyword">return</span> I.inspect ? I.inspect() : <span class="hljs-built_in">String</span>(I)
    } <span class="hljs-keyword">catch</span> (J) {
      <span class="hljs-keyword">if</span> (J <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">RangeError</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-string">"..."</span>
      }
      <span class="hljs-keyword">throw</span> J
    }
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">D</span>(<span class="hljs-params">I</span>) </span>{
    <span class="hljs-keyword">return</span> F(<span class="hljs-string">""</span>, {
      <span class="hljs-string">""</span>: I
    }, [])
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">F</span>(<span class="hljs-params">R, O, P</span>) </span>{
    <span class="hljs-keyword">var</span> Q = O[R],
      N = <span class="hljs-keyword">typeof</span> Q;
    <span class="hljs-keyword">if</span> (k(Q) === H &amp;&amp; <span class="hljs-keyword">typeof</span> Q.toJSON === <span class="hljs-string">"function"</span>) {
      Q = Q.toJSON(R)
    }
    <span class="hljs-keyword">var</span> K = C.call(Q);
    <span class="hljs-keyword">switch</span> (K) {
      <span class="hljs-keyword">case</span> g:
      <span class="hljs-keyword">case</span> y:
      <span class="hljs-keyword">case</span> l:
        Q = Q.valueOf()
    }
    <span class="hljs-keyword">switch</span> (Q) {
      <span class="hljs-keyword">case</span> <span class="hljs-literal">null</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-string">"null"</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-literal">true</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-string">"true"</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-literal">false</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-string">"false"</span>
    }
    N = <span class="hljs-keyword">typeof</span> Q;
    <span class="hljs-keyword">switch</span> (N) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">"string"</span>:
        <span class="hljs-keyword">return</span> Q.inspect(<span class="hljs-literal">true</span>);
      <span class="hljs-keyword">case</span> <span class="hljs-string">"number"</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">isFinite</span>(Q) ? <span class="hljs-built_in">String</span>(Q) : <span class="hljs-string">"null"</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">"object"</span>:
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> J = <span class="hljs-number">0</span>, I = P.length; J &lt; I; J++) {
          <span class="hljs-keyword">if</span> (P[J] === Q) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>()
          }
        }
        P.push(Q);
        <span class="hljs-keyword">var</span> M = [];
        <span class="hljs-keyword">if</span> (K === h) {
          <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> J = <span class="hljs-number">0</span>, I = Q.length; J &lt; I; J++) {
            <span class="hljs-keyword">var</span> L = F(J, Q, P);
            M.push(<span class="hljs-keyword">typeof</span> L === <span class="hljs-string">"undefined"</span> ? <span class="hljs-string">"null"</span> : L)
          }
          M = <span class="hljs-string">"["</span> + M.join(<span class="hljs-string">","</span>) + <span class="hljs-string">"]"</span>
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">var</span> S = <span class="hljs-built_in">Object</span>.keys(Q);
          <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> J = <span class="hljs-number">0</span>, I = S.length; J &lt; I; J++) {
            <span class="hljs-keyword">var</span> R = S[J],
              L = F(R, Q, P);
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> L !== <span class="hljs-string">"undefined"</span>) {
              M.push(R.inspect(<span class="hljs-literal">true</span>) + <span class="hljs-string">":"</span> + L)
            }
          }
          M = <span class="hljs-string">"{"</span> + M.join(<span class="hljs-string">","</span>) + <span class="hljs-string">"}"</span>
        }
        P.pop();
        <span class="hljs-keyword">return</span> M
    }
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">w</span>(<span class="hljs-params">I</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">JSON</span>.stringify(I)
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">j</span>(<span class="hljs-params">I</span>) </span>{
    <span class="hljs-keyword">return</span> $H(I).toQueryString()
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">p</span>(<span class="hljs-params">I</span>) </span>{
    <span class="hljs-keyword">return</span> I &amp;&amp; I.toHTML ? I.toHTML() : <span class="hljs-built_in">String</span>.interpret(I)
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">r</span>(<span class="hljs-params">I</span>) </span>{
    <span class="hljs-keyword">if</span> (k(I) !== H) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>()
    }
    <span class="hljs-keyword">var</span> J = [];
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> K <span class="hljs-keyword">in</span> I) {
      <span class="hljs-keyword">if</span> (I.hasOwnProperty(K)) {
        J.push(K)
      }
    }
    <span class="hljs-keyword">return</span> J
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">d</span>(<span class="hljs-params">I</span>) </span>{
    <span class="hljs-keyword">var</span> J = [];
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> K <span class="hljs-keyword">in</span> I) {
      J.push(I[K])
    }
    <span class="hljs-keyword">return</span> J
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">A</span>(<span class="hljs-params">I</span>) </span>{
    <span class="hljs-keyword">return</span> z({}, I)
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">u</span>(<span class="hljs-params">I</span>) </span>{
    <span class="hljs-keyword">return</span> !!(I &amp;&amp; I.nodeType == <span class="hljs-number">1</span>)
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">m</span>(<span class="hljs-params">I</span>) </span>{
    <span class="hljs-keyword">return</span> C.call(I) === h
  }
  <span class="hljs-keyword">var</span> b = (<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">Array</span>.isArray == <span class="hljs-string">"function"</span>) &amp;&amp; <span class="hljs-built_in">Array</span>.isArray([]) &amp;&amp; !<span class="hljs-built_in">Array</span>.isArray({});
  <span class="hljs-keyword">if</span> (b) {
    m = <span class="hljs-built_in">Array</span>.isArray
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">e</span>(<span class="hljs-params">I</span>) </span>{
    <span class="hljs-keyword">return</span> I <span class="hljs-keyword">instanceof</span> Hash
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">a</span>(<span class="hljs-params">I</span>) </span>{
    <span class="hljs-keyword">return</span> C.call(I) === t
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">n</span>(<span class="hljs-params">I</span>) </span>{
    <span class="hljs-keyword">return</span> C.call(I) === l
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">q</span>(<span class="hljs-params">I</span>) </span>{
    <span class="hljs-keyword">return</span> C.call(I) === g
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">E</span>(<span class="hljs-params">I</span>) </span>{
    <span class="hljs-keyword">return</span> C.call(I) === x
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">c</span>(<span class="hljs-params">I</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> I === <span class="hljs-string">"undefined"</span>
  }
  z(<span class="hljs-built_in">Object</span>, {
    <span class="hljs-attr">extend</span>: z,
    <span class="hljs-attr">inspect</span>: G,
    <span class="hljs-attr">toJSON</span>: i ? w : D,
    <span class="hljs-attr">toQueryString</span>: j,
    <span class="hljs-attr">toHTML</span>: p,
    <span class="hljs-attr">keys</span>: <span class="hljs-built_in">Object</span>.keys || r,
    <span class="hljs-attr">values</span>: d,
    <span class="hljs-attr">clone</span>: A,
    <span class="hljs-attr">isElement</span>: u,
    <span class="hljs-attr">isArray</span>: m,
    <span class="hljs-attr">isHash</span>: e,
    <span class="hljs-attr">isFunction</span>: a,
    <span class="hljs-attr">isString</span>: n,
    <span class="hljs-attr">isNumber</span>: q,
    <span class="hljs-attr">isDate</span>: E,
    <span class="hljs-attr">isUndefined</span>: c
  })
})();
<span class="hljs-built_in">Object</span>.extend(<span class="hljs-built_in">Function</span>.prototype, (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> k = <span class="hljs-built_in">Array</span>.prototype.slice;

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">d</span>(<span class="hljs-params">o, l</span>) </span>{
    <span class="hljs-keyword">var</span> n = o.length,
      m = l.length;
    <span class="hljs-keyword">while</span> (m--) {
      o[n + m] = l[m]
    }
    <span class="hljs-keyword">return</span> o
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">i</span>(<span class="hljs-params">m, l</span>) </span>{
    m = k.call(m, <span class="hljs-number">0</span>);
    <span class="hljs-keyword">return</span> d(m, l)
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">g</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> l = <span class="hljs-keyword">this</span>.toString().match(<span class="hljs-regexp">/^[\s\(]*function[^(]*\(([^)]*)\)/</span>)[<span class="hljs-number">1</span>].replace(<span class="hljs-regexp">/\/\/.*?[\r\n]|\/\*(?:.|[\r\n])*?\*\//g</span>, <span class="hljs-string">""</span>).replace(<span class="hljs-regexp">/\s+/g</span>, <span class="hljs-string">""</span>).split(<span class="hljs-string">","</span>);
    <span class="hljs-keyword">return</span> l.length == <span class="hljs-number">1</span> &amp;&amp; !l[<span class="hljs-number">0</span>] ? [] : l
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">h</span>(<span class="hljs-params">n</span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">arguments</span>.length &lt; <span class="hljs-number">2</span> &amp;&amp; <span class="hljs-built_in">Object</span>.isUndefined(<span class="hljs-built_in">arguments</span>[<span class="hljs-number">0</span>])) {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>
    }
    <span class="hljs-keyword">var</span> l = <span class="hljs-keyword">this</span>,
      m = k.call(<span class="hljs-built_in">arguments</span>, <span class="hljs-number">1</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> o = i(m, <span class="hljs-built_in">arguments</span>);
      <span class="hljs-keyword">return</span> l.apply(n, o)
    }
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">f</span>(<span class="hljs-params">n</span>) </span>{
    <span class="hljs-keyword">var</span> l = <span class="hljs-keyword">this</span>,
      m = k.call(<span class="hljs-built_in">arguments</span>, <span class="hljs-number">1</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">p</span>) </span>{
      <span class="hljs-keyword">var</span> o = d([p || <span class="hljs-built_in">window</span>.event], m);
      <span class="hljs-keyword">return</span> l.apply(n, o)
    }
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">j</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">arguments</span>.length) {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>
    }
    <span class="hljs-keyword">var</span> l = <span class="hljs-keyword">this</span>,
      m = k.call(<span class="hljs-built_in">arguments</span>, <span class="hljs-number">0</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> n = i(m, <span class="hljs-built_in">arguments</span>);
      <span class="hljs-keyword">return</span> l.apply(<span class="hljs-keyword">this</span>, n)
    }
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">e</span>(<span class="hljs-params">n</span>) </span>{
    <span class="hljs-keyword">var</span> l = <span class="hljs-keyword">this</span>,
      m = k.call(<span class="hljs-built_in">arguments</span>, <span class="hljs-number">1</span>);
    n = n * <span class="hljs-number">1000</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">window</span>.setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">return</span> l.apply(l, m)
    }, n)
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">a</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> l = d([<span class="hljs-number">0.01</span>], <span class="hljs-built_in">arguments</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.delay.apply(<span class="hljs-keyword">this</span>, l)
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">c</span>(<span class="hljs-params">m</span>) </span>{
    <span class="hljs-keyword">var</span> l = <span class="hljs-keyword">this</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> n = d([l.bind(<span class="hljs-keyword">this</span>)], <span class="hljs-built_in">arguments</span>);
      <span class="hljs-keyword">return</span> m.apply(<span class="hljs-keyword">this</span>, n)
    }
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">b</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._methodized) {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._methodized
    }
    <span class="hljs-keyword">var</span> l = <span class="hljs-keyword">this</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._methodized = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> m = d([<span class="hljs-keyword">this</span>], <span class="hljs-built_in">arguments</span>);
      <span class="hljs-keyword">return</span> l.apply(<span class="hljs-literal">null</span>, m)
    }
  }
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">argumentNames</span>: g,
    <span class="hljs-attr">bind</span>: h,
    <span class="hljs-attr">bindAsEventListener</span>: f,
    <span class="hljs-attr">curry</span>: j,
    <span class="hljs-attr">delay</span>: e,
    <span class="hljs-attr">defer</span>: a,
    <span class="hljs-attr">wrap</span>: c,
    <span class="hljs-attr">methodize</span>: b
  }
})());
(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">c</span>) </span>{
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">b</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.getUTCFullYear() + <span class="hljs-string">"-"</span> + (<span class="hljs-keyword">this</span>.getUTCMonth() + <span class="hljs-number">1</span>).toPaddedString(<span class="hljs-number">2</span>) + <span class="hljs-string">"-"</span> + <span class="hljs-keyword">this</span>.getUTCDate().toPaddedString(<span class="hljs-number">2</span>) + <span class="hljs-string">"T"</span> + <span class="hljs-keyword">this</span>.getUTCHours().toPaddedString(<span class="hljs-number">2</span>) + <span class="hljs-string">":"</span> + <span class="hljs-keyword">this</span>.getUTCMinutes().toPaddedString(<span class="hljs-number">2</span>) + <span class="hljs-string">":"</span> + <span class="hljs-keyword">this</span>.getUTCSeconds().toPaddedString(<span class="hljs-number">2</span>) + <span class="hljs-string">"Z"</span>
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">a</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.toISOString()
  }
  <span class="hljs-keyword">if</span> (!c.toISOString) {
    c.toISOString = b
  }
  <span class="hljs-keyword">if</span> (!c.toJSON) {
    c.toJSON = a
  }
})(<span class="hljs-built_in">Date</span>.prototype);
<span class="hljs-built_in">RegExp</span>.prototype.match = <span class="hljs-built_in">RegExp</span>.prototype.test;
<span class="hljs-built_in">RegExp</span>.escape = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-built_in">String</span>(a).replace(<span class="hljs-regexp">/([.*+?^=!:()|[\]\/\\])/g</span>, <span class="hljs-string">"\\$1"</span>)
};
<span class="hljs-keyword">var</span> PeriodicalExecuter = Class.create({
  <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">b, a</span>) </span>{
    <span class="hljs-keyword">this</span>.callback = b;
    <span class="hljs-keyword">this</span>.frequency = a;
    <span class="hljs-keyword">this</span>.currentlyExecuting = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">this</span>.registerCallback()
  },
  <span class="hljs-attr">registerCallback</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>.timer = setInterval(<span class="hljs-keyword">this</span>.onTimerEvent.bind(<span class="hljs-keyword">this</span>), <span class="hljs-keyword">this</span>.frequency * <span class="hljs-number">1000</span>)
  },
  <span class="hljs-attr">execute</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>.callback(<span class="hljs-keyword">this</span>)
  },
  <span class="hljs-attr">stop</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.timer) {
      <span class="hljs-keyword">return</span>
    }
    clearInterval(<span class="hljs-keyword">this</span>.timer);
    <span class="hljs-keyword">this</span>.timer = <span class="hljs-literal">null</span>
  },
  <span class="hljs-attr">onTimerEvent</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.currentlyExecuting) {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">this</span>.currentlyExecuting = <span class="hljs-literal">true</span>;
        <span class="hljs-keyword">this</span>.execute();
        <span class="hljs-keyword">this</span>.currentlyExecuting = <span class="hljs-literal">false</span>
      } <span class="hljs-keyword">catch</span> (a) {
        <span class="hljs-keyword">this</span>.currentlyExecuting = <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">throw</span> a
      }
    }
  }
});
<span class="hljs-built_in">Object</span>.extend(<span class="hljs-built_in">String</span>, {
  <span class="hljs-attr">interpret</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
    <span class="hljs-keyword">return</span> a == <span class="hljs-literal">null</span> ? <span class="hljs-string">""</span> : <span class="hljs-built_in">String</span>(a)
  },
  <span class="hljs-attr">specialChar</span>: {
    <span class="hljs-string">"\b"</span>: <span class="hljs-string">"\\b"</span>,
    <span class="hljs-string">"\t"</span>: <span class="hljs-string">"\\t"</span>,
    <span class="hljs-string">"\n"</span>: <span class="hljs-string">"\\n"</span>,
    <span class="hljs-string">"\f"</span>: <span class="hljs-string">"\\f"</span>,
    <span class="hljs-string">"\r"</span>: <span class="hljs-string">"\\r"</span>,
    <span class="hljs-string">"\\"</span>: <span class="hljs-string">"\\\\"</span>
  }
});
<span class="hljs-built_in">Object</span>.extend(<span class="hljs-built_in">String</span>.prototype, (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> NATIVE_JSON_PARSE_SUPPORT = <span class="hljs-built_in">window</span>.JSON &amp;&amp; <span class="hljs-keyword">typeof</span> <span class="hljs-built_in">JSON</span>.parse === <span class="hljs-string">"function"</span> &amp;&amp; <span class="hljs-built_in">JSON</span>.parse(<span class="hljs-string">'{"test": true}'</span>).test;

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">prepareReplacement</span>(<span class="hljs-params">replacement</span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.isFunction(replacement)) {
      <span class="hljs-keyword">return</span> replacement
    }
    <span class="hljs-keyword">var</span> template = <span class="hljs-keyword">new</span> Template(replacement);
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">match</span>) </span>{
      <span class="hljs-keyword">return</span> template.evaluate(match)
    }
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">gsub</span>(<span class="hljs-params">pattern, replacement</span>) </span>{
    <span class="hljs-keyword">var</span> result = <span class="hljs-string">""</span>,
      source = <span class="hljs-keyword">this</span>,
      match;
    replacement = prepareReplacement(replacement);
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.isString(pattern)) {
      pattern = <span class="hljs-built_in">RegExp</span>.escape(pattern)
    }
    <span class="hljs-keyword">if</span> (!(pattern.length || pattern.source)) {
      replacement = replacement(<span class="hljs-string">""</span>);
      <span class="hljs-keyword">return</span> replacement + source.split(<span class="hljs-string">""</span>).join(replacement) + replacement
    }
    <span class="hljs-keyword">while</span> (source.length &gt; <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">if</span> (match = source.match(pattern)) {
        result += source.slice(<span class="hljs-number">0</span>, match.index);
        result += <span class="hljs-built_in">String</span>.interpret(replacement(match));
        source = source.slice(match.index + match[<span class="hljs-number">0</span>].length)
      } <span class="hljs-keyword">else</span> {
        result += source, source = <span class="hljs-string">""</span>
      }
    }
    <span class="hljs-keyword">return</span> result
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sub</span>(<span class="hljs-params">pattern, replacement, count</span>) </span>{
    replacement = prepareReplacement(replacement);
    count = <span class="hljs-built_in">Object</span>.isUndefined(count) ? <span class="hljs-number">1</span> : count;
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.gsub(pattern, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">match</span>) </span>{
      <span class="hljs-keyword">if</span> (--count &lt; <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">return</span> match[<span class="hljs-number">0</span>]
      }
      <span class="hljs-keyword">return</span> replacement(match)
    })
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">scan</span>(<span class="hljs-params">pattern, iterator</span>) </span>{
    <span class="hljs-keyword">this</span>.gsub(pattern, iterator);
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">String</span>(<span class="hljs-keyword">this</span>)
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">truncate</span>(<span class="hljs-params">length, truncation</span>) </span>{
    length = length || <span class="hljs-number">30</span>;
    truncation = <span class="hljs-built_in">Object</span>.isUndefined(truncation) ? <span class="hljs-string">"..."</span> : truncation;
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.length &gt; length ? <span class="hljs-keyword">this</span>.slice(<span class="hljs-number">0</span>, length - truncation.length) + truncation : <span class="hljs-built_in">String</span>(<span class="hljs-keyword">this</span>)
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">strip</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.replace(<span class="hljs-regexp">/^\s+/</span>, <span class="hljs-string">""</span>).replace(<span class="hljs-regexp">/\s+$/</span>, <span class="hljs-string">""</span>)
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">stripTags</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.replace(<span class="hljs-regexp">/&lt;\w+(\s+("[^"]*"|'[^']*'|[^&gt;])+)?&gt;|&lt;\/\w+&gt;/gi</span>, <span class="hljs-string">""</span>)
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">stripScripts</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.replace(<span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(Prototype.ScriptFragment, <span class="hljs-string">"img"</span>), <span class="hljs-string">""</span>)
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">extractScripts</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> matchAll = <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(Prototype.ScriptFragment, <span class="hljs-string">"img"</span>),
      matchOne = <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(Prototype.ScriptFragment, <span class="hljs-string">"im"</span>);
    <span class="hljs-keyword">return</span> (<span class="hljs-keyword">this</span>.match(matchAll) || []).map(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">scriptTag</span>) </span>{
      <span class="hljs-keyword">return</span> (scriptTag.match(matchOne) || [<span class="hljs-string">""</span>, <span class="hljs-string">""</span>])[<span class="hljs-number">1</span>]
    })
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">evalScripts</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.extractScripts().map(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">script</span>) </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-built_in">eval</span>(script)
    })
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">escapeHTML</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.replace(<span class="hljs-regexp">/&amp;/g</span>, <span class="hljs-string">"&amp;amp;"</span>).replace(<span class="hljs-regexp">/&lt;/g</span>, <span class="hljs-string">"&amp;lt;"</span>).replace(<span class="hljs-regexp">/&gt;/g</span>, <span class="hljs-string">"&amp;gt;"</span>)
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">unescapeHTML</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.stripTags().replace(<span class="hljs-regexp">/&amp;lt;/g</span>, <span class="hljs-string">"&lt;"</span>).replace(<span class="hljs-regexp">/&amp;gt;/g</span>, <span class="hljs-string">"&gt;"</span>).replace(<span class="hljs-regexp">/&amp;amp;/g</span>, <span class="hljs-string">"&amp;"</span>)
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toQueryParams</span>(<span class="hljs-params">separator</span>) </span>{
    <span class="hljs-keyword">var</span> match = <span class="hljs-keyword">this</span>.strip().match(<span class="hljs-regexp">/([^?#]*)(#.*)?$/</span>);
    <span class="hljs-keyword">if</span> (!match) {
      <span class="hljs-keyword">return</span> {}
    }
    <span class="hljs-keyword">return</span> match[<span class="hljs-number">1</span>].split(separator || <span class="hljs-string">"&amp;"</span>).inject({}, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">hash, pair</span>) </span>{
      <span class="hljs-keyword">if</span> ((pair = pair.split(<span class="hljs-string">"="</span>))[<span class="hljs-number">0</span>]) {
        <span class="hljs-keyword">var</span> key = <span class="hljs-built_in">decodeURIComponent</span>(pair.shift()),
          value = pair.length &gt; <span class="hljs-number">1</span> ? pair.join(<span class="hljs-string">"="</span>) : pair[<span class="hljs-number">0</span>];
        <span class="hljs-keyword">if</span> (value != <span class="hljs-literal">undefined</span>) {
          value = <span class="hljs-built_in">decodeURIComponent</span>(value)
        }
        <span class="hljs-keyword">if</span> (key <span class="hljs-keyword">in</span> hash) {
          <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">Object</span>.isArray(hash[key])) {
            hash[key] = [hash[key]]
          }
          hash[key].push(value)
        } <span class="hljs-keyword">else</span> {
          hash[key] = value
        }
      }
      <span class="hljs-keyword">return</span> hash
    })
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toArray</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.split(<span class="hljs-string">""</span>)
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">succ</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.slice(<span class="hljs-number">0</span>, <span class="hljs-keyword">this</span>.length - <span class="hljs-number">1</span>) + <span class="hljs-built_in">String</span>.fromCharCode(<span class="hljs-keyword">this</span>.charCodeAt(<span class="hljs-keyword">this</span>.length - <span class="hljs-number">1</span>) + <span class="hljs-number">1</span>)
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">times</span>(<span class="hljs-params">count</span>) </span>{
    <span class="hljs-keyword">return</span> count &lt; <span class="hljs-number">1</span> ? <span class="hljs-string">""</span> : <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(count + <span class="hljs-number">1</span>).join(<span class="hljs-keyword">this</span>)
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">camelize</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.replace(<span class="hljs-regexp">/-+(.)?/g</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">match, chr</span>) </span>{
      <span class="hljs-keyword">return</span> chr ? chr.toUpperCase() : <span class="hljs-string">""</span>
    })
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">capitalize</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.charAt(<span class="hljs-number">0</span>).toUpperCase() + <span class="hljs-keyword">this</span>.substring(<span class="hljs-number">1</span>).toLowerCase()
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">underscore</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.replace(<span class="hljs-regexp">/::/g</span>, <span class="hljs-string">"/"</span>).replace(<span class="hljs-regexp">/([A-Z]+)([A-Z][a-z])/g</span>, <span class="hljs-string">"$1_$2"</span>).replace(<span class="hljs-regexp">/([a-z\d])([A-Z])/g</span>, <span class="hljs-string">"$1_$2"</span>).replace(<span class="hljs-regexp">/-/g</span>, <span class="hljs-string">"_"</span>).toLowerCase()
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">dasherize</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.replace(<span class="hljs-regexp">/_/g</span>, <span class="hljs-string">"-"</span>)
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">inspect</span>(<span class="hljs-params">useDoubleQuotes</span>) </span>{
    <span class="hljs-keyword">var</span> escapedString = <span class="hljs-keyword">this</span>.replace(<span class="hljs-regexp">/[\x00-\x1f\\]/g</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">character</span>) </span>{
      <span class="hljs-keyword">if</span> (character <span class="hljs-keyword">in</span> <span class="hljs-built_in">String</span>.specialChar) {
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">String</span>.specialChar[character]
      }
      <span class="hljs-keyword">return</span> <span class="hljs-string">"\\u00"</span> + character.charCodeAt().toPaddedString(<span class="hljs-number">2</span>, <span class="hljs-number">16</span>)
    });
    <span class="hljs-keyword">if</span> (useDoubleQuotes) {
      <span class="hljs-keyword">return</span> <span class="hljs-string">'"'</span> + escapedString.replace(<span class="hljs-regexp">/"/g</span>, <span class="hljs-string">'\\"'</span>) + <span class="hljs-string">'"'</span>
    }
    <span class="hljs-keyword">return</span> <span class="hljs-string">"'"</span> + escapedString.replace(<span class="hljs-regexp">/'/g</span>, <span class="hljs-string">"\\'"</span>) + <span class="hljs-string">"'"</span>
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">unfilterJSON</span>(<span class="hljs-params">filter</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.replace(filter || Prototype.JSONFilter, <span class="hljs-string">"$1"</span>)
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isJSON</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> str = <span class="hljs-keyword">this</span>;
    <span class="hljs-keyword">if</span> (str.blank()) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
    }
    str = str.replace(<span class="hljs-regexp">/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g</span>, <span class="hljs-string">"@"</span>);
    str = str.replace(<span class="hljs-regexp">/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g</span>, <span class="hljs-string">"]"</span>);
    str = str.replace(<span class="hljs-regexp">/(?:^|:|,)(?:\s*\[)+/g</span>, <span class="hljs-string">""</span>);
    <span class="hljs-keyword">return</span> (<span class="hljs-regexp">/^[\],:{}\s]*$/</span>).test(str)
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">evalJSON</span>(<span class="hljs-params">sanitize</span>) </span>{
    <span class="hljs-keyword">var</span> json = <span class="hljs-keyword">this</span>.unfilterJSON(),
      cx = <span class="hljs-regexp">/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g</span>;
    <span class="hljs-keyword">if</span> (cx.test(json)) {
      json = json.replace(cx, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-string">"\\u"</span> + (<span class="hljs-string">"0000"</span> + a.charCodeAt(<span class="hljs-number">0</span>).toString(<span class="hljs-number">16</span>)).slice(<span class="hljs-number">-4</span>)
      })
    }
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">if</span> (!sanitize || json.isJSON()) {
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">eval</span>(<span class="hljs-string">"("</span> + json + <span class="hljs-string">")"</span>)
      }
    } <span class="hljs-keyword">catch</span> (e) {}
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">SyntaxError</span>(<span class="hljs-string">"Badly formed JSON string: "</span> + <span class="hljs-keyword">this</span>.inspect())
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">parseJSON</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> json = <span class="hljs-keyword">this</span>.unfilterJSON();
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">JSON</span>.parse(json)
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">include</span>(<span class="hljs-params">pattern</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.indexOf(pattern) &gt; <span class="hljs-number">-1</span>
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">startsWith</span>(<span class="hljs-params">pattern</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.lastIndexOf(pattern, <span class="hljs-number">0</span>) === <span class="hljs-number">0</span>
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">endsWith</span>(<span class="hljs-params">pattern</span>) </span>{
    <span class="hljs-keyword">var</span> d = <span class="hljs-keyword">this</span>.length - pattern.length;
    <span class="hljs-keyword">return</span> d &gt;= <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-keyword">this</span>.indexOf(pattern, d) === d
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">empty</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span> == <span class="hljs-string">""</span>
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">blank</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-regexp">/^\s*$/</span>.test(<span class="hljs-keyword">this</span>)
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">interpolate</span>(<span class="hljs-params">object, pattern</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Template(<span class="hljs-keyword">this</span>, pattern).evaluate(object)
  }
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">gsub</span>: gsub,
    <span class="hljs-attr">sub</span>: sub,
    <span class="hljs-attr">scan</span>: scan,
    <span class="hljs-attr">truncate</span>: truncate,
    <span class="hljs-attr">strip</span>: <span class="hljs-built_in">String</span>.prototype.trim || strip,
    <span class="hljs-attr">stripTags</span>: stripTags,
    <span class="hljs-attr">stripScripts</span>: stripScripts,
    <span class="hljs-attr">extractScripts</span>: extractScripts,
    <span class="hljs-attr">evalScripts</span>: evalScripts,
    <span class="hljs-attr">escapeHTML</span>: escapeHTML,
    <span class="hljs-attr">unescapeHTML</span>: unescapeHTML,
    <span class="hljs-attr">toQueryParams</span>: toQueryParams,
    <span class="hljs-attr">parseQuery</span>: toQueryParams,
    <span class="hljs-attr">toArray</span>: toArray,
    <span class="hljs-attr">succ</span>: succ,
    <span class="hljs-attr">times</span>: times,
    <span class="hljs-attr">camelize</span>: camelize,
    <span class="hljs-attr">capitalize</span>: capitalize,
    <span class="hljs-attr">underscore</span>: underscore,
    <span class="hljs-attr">dasherize</span>: dasherize,
    <span class="hljs-attr">inspect</span>: inspect,
    <span class="hljs-attr">unfilterJSON</span>: unfilterJSON,
    <span class="hljs-attr">isJSON</span>: isJSON,
    <span class="hljs-attr">evalJSON</span>: NATIVE_JSON_PARSE_SUPPORT ? parseJSON : evalJSON,
    <span class="hljs-attr">include</span>: include,
    <span class="hljs-attr">startsWith</span>: startsWith,
    <span class="hljs-attr">endsWith</span>: endsWith,
    <span class="hljs-attr">empty</span>: empty,
    <span class="hljs-attr">blank</span>: blank,
    <span class="hljs-attr">interpolate</span>: interpolate
  }
})());
<span class="hljs-keyword">var</span> Template = Class.create({
  <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a, b</span>) </span>{
    <span class="hljs-keyword">this</span>.template = a.toString();
    <span class="hljs-keyword">this</span>.pattern = b || Template.Pattern
  },
  <span class="hljs-attr">evaluate</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
    <span class="hljs-keyword">if</span> (a &amp;&amp; <span class="hljs-built_in">Object</span>.isFunction(a.toTemplateReplacements)) {
      a = a.toTemplateReplacements()
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.template.gsub(<span class="hljs-keyword">this</span>.pattern, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">d</span>) </span>{
      <span class="hljs-keyword">if</span> (a == <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">return</span> (d[<span class="hljs-number">1</span>] + <span class="hljs-string">""</span>)
      }
      <span class="hljs-keyword">var</span> f = d[<span class="hljs-number">1</span>] || <span class="hljs-string">""</span>;
      <span class="hljs-keyword">if</span> (f == <span class="hljs-string">"\\"</span>) {
        <span class="hljs-keyword">return</span> d[<span class="hljs-number">2</span>]
      }
      <span class="hljs-keyword">var</span> b = a,
        g = d[<span class="hljs-number">3</span>],
        e = <span class="hljs-regexp">/^([^.[]+|\[((?:.*?[^\\])?)\])(\.|\[|$)/</span>;
      d = e.exec(g);
      <span class="hljs-keyword">if</span> (d == <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">return</span> f
      }
      <span class="hljs-keyword">while</span> (d != <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">var</span> c = d[<span class="hljs-number">1</span>].startsWith(<span class="hljs-string">"["</span>) ? d[<span class="hljs-number">2</span>].replace(<span class="hljs-regexp">/\\\\]/g</span>, <span class="hljs-string">"]"</span>) : d[<span class="hljs-number">1</span>];
        b = b[c];
        <span class="hljs-keyword">if</span> (<span class="hljs-literal">null</span> == b || <span class="hljs-string">""</span> == d[<span class="hljs-number">3</span>]) {
          <span class="hljs-keyword">break</span>
        }
        g = g.substring(<span class="hljs-string">"["</span> == d[<span class="hljs-number">3</span>] ? d[<span class="hljs-number">1</span>].length : d[<span class="hljs-number">0</span>].length);
        d = e.exec(g)
      }
      <span class="hljs-keyword">return</span> f + <span class="hljs-built_in">String</span>.interpret(b)
    })
  }
});
Template.Pattern = <span class="hljs-regexp">/(^|.|\r|\n)(#\{(.*?)\})/</span>;
<span class="hljs-keyword">var</span> $<span class="hljs-keyword">break</span> = {};
<span class="hljs-keyword">var</span> Enumerable = (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">c</span>(<span class="hljs-params">y, x</span>) </span>{
    <span class="hljs-keyword">var</span> w = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">this</span>._each(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">A</span>) </span>{
        y.call(x, A, w++)
      })
    } <span class="hljs-keyword">catch</span> (z) {
      <span class="hljs-keyword">if</span> (z != $<span class="hljs-keyword">break</span>) {
        <span class="hljs-keyword">throw</span> z
      }
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">r</span>(<span class="hljs-params">z, y, x</span>) </span>{
    <span class="hljs-keyword">var</span> w = -z,
      A = [],
      B = <span class="hljs-keyword">this</span>.toArray();
    <span class="hljs-keyword">if</span> (z &lt; <span class="hljs-number">1</span>) {
      <span class="hljs-keyword">return</span> B
    }
    <span class="hljs-keyword">while</span> ((w += z) &lt; B.length) {
      A.push(B.slice(w, w + z))
    }
    <span class="hljs-keyword">return</span> A.collect(y, x)
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">b</span>(<span class="hljs-params">y, x</span>) </span>{
    y = y || Prototype.K;
    <span class="hljs-keyword">var</span> w = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">this</span>.each(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">A, z</span>) </span>{
      w = w &amp;&amp; !!y.call(x, A, z);
      <span class="hljs-keyword">if</span> (!w) {
        <span class="hljs-keyword">throw</span> $<span class="hljs-keyword">break</span>
      }
    });
    <span class="hljs-keyword">return</span> w
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">i</span>(<span class="hljs-params">y, x</span>) </span>{
    y = y || Prototype.K;
    <span class="hljs-keyword">var</span> w = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">this</span>.each(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">A, z</span>) </span>{
      <span class="hljs-keyword">if</span> (w = !!y.call(x, A, z)) {
        <span class="hljs-keyword">throw</span> $<span class="hljs-keyword">break</span>
      }
    });
    <span class="hljs-keyword">return</span> w
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">j</span>(<span class="hljs-params">y, x</span>) </span>{
    y = y || Prototype.K;
    <span class="hljs-keyword">var</span> w = [];
    <span class="hljs-keyword">this</span>.each(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">A, z</span>) </span>{
      w.push(y.call(x, A, z))
    });
    <span class="hljs-keyword">return</span> w
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">t</span>(<span class="hljs-params">y, x</span>) </span>{
    <span class="hljs-keyword">var</span> w;
    <span class="hljs-keyword">this</span>.each(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">A, z</span>) </span>{
      <span class="hljs-keyword">if</span> (y.call(x, A, z)) {
        w = A;
        <span class="hljs-keyword">throw</span> $<span class="hljs-keyword">break</span>
      }
    });
    <span class="hljs-keyword">return</span> w
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">h</span>(<span class="hljs-params">y, x</span>) </span>{
    <span class="hljs-keyword">var</span> w = [];
    <span class="hljs-keyword">this</span>.each(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">A, z</span>) </span>{
      <span class="hljs-keyword">if</span> (y.call(x, A, z)) {
        w.push(A)
      }
    });
    <span class="hljs-keyword">return</span> w
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">g</span>(<span class="hljs-params">z, y, x</span>) </span>{
    y = y || Prototype.K;
    <span class="hljs-keyword">var</span> w = [];
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.isString(z)) {
      z = <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(<span class="hljs-built_in">RegExp</span>.escape(z))
    }
    <span class="hljs-keyword">this</span>.each(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">B, A</span>) </span>{
      <span class="hljs-keyword">if</span> (z.match(B)) {
        w.push(y.call(x, B, A))
      }
    });
    <span class="hljs-keyword">return</span> w
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">a</span>(<span class="hljs-params">w</span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.isFunction(<span class="hljs-keyword">this</span>.indexOf)) {
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.indexOf(w) != <span class="hljs-number">-1</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
      }
    }
    <span class="hljs-keyword">var</span> x = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">this</span>.each(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">y</span>) </span>{
      <span class="hljs-keyword">if</span> (y == w) {
        x = <span class="hljs-literal">true</span>;
        <span class="hljs-keyword">throw</span> $<span class="hljs-keyword">break</span>
      }
    });
    <span class="hljs-keyword">return</span> x
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">q</span>(<span class="hljs-params">x, w</span>) </span>{
    w = <span class="hljs-built_in">Object</span>.isUndefined(w) ? <span class="hljs-literal">null</span> : w;
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.eachSlice(x, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">y</span>) </span>{
      <span class="hljs-keyword">while</span> (y.length &lt; x) {
        y.push(w)
      }
      <span class="hljs-keyword">return</span> y
    })
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">l</span>(<span class="hljs-params">w, y, x</span>) </span>{
    <span class="hljs-keyword">this</span>.each(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">A, z</span>) </span>{
      w = y.call(x, w, A, z)
    });
    <span class="hljs-keyword">return</span> w
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">v</span>(<span class="hljs-params">x</span>) </span>{
    <span class="hljs-keyword">var</span> w = $A(<span class="hljs-built_in">arguments</span>).slice(<span class="hljs-number">1</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.map(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">y</span>) </span>{
      <span class="hljs-keyword">return</span> y[x].apply(y, w)
    })
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">p</span>(<span class="hljs-params">y, x</span>) </span>{
    y = y || Prototype.K;
    <span class="hljs-keyword">var</span> w;
    <span class="hljs-keyword">this</span>.each(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">A, z</span>) </span>{
      A = y.call(x, A, z);
      <span class="hljs-keyword">if</span> (w == <span class="hljs-literal">null</span> || A &gt;= w) {
        w = A
      }
    });
    <span class="hljs-keyword">return</span> w
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">n</span>(<span class="hljs-params">y, x</span>) </span>{
    y = y || Prototype.K;
    <span class="hljs-keyword">var</span> w;
    <span class="hljs-keyword">this</span>.each(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">A, z</span>) </span>{
      A = y.call(x, A, z);
      <span class="hljs-keyword">if</span> (w == <span class="hljs-literal">null</span> || A &lt; w) {
        w = A
      }
    });
    <span class="hljs-keyword">return</span> w
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">e</span>(<span class="hljs-params">z, x</span>) </span>{
    z = z || Prototype.K;
    <span class="hljs-keyword">var</span> y = [],
      w = [];
    <span class="hljs-keyword">this</span>.each(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">B, A</span>) </span>{
      (z.call(x, B, A) ? y : w).push(B)
    });
    <span class="hljs-keyword">return</span> [y, w]
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">f</span>(<span class="hljs-params">x</span>) </span>{
    <span class="hljs-keyword">var</span> w = [];
    <span class="hljs-keyword">this</span>.each(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">y</span>) </span>{
      w.push(y[x])
    });
    <span class="hljs-keyword">return</span> w
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">d</span>(<span class="hljs-params">y, x</span>) </span>{
    <span class="hljs-keyword">var</span> w = [];
    <span class="hljs-keyword">this</span>.each(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">A, z</span>) </span>{
      <span class="hljs-keyword">if</span> (!y.call(x, A, z)) {
        w.push(A)
      }
    });
    <span class="hljs-keyword">return</span> w
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">m</span>(<span class="hljs-params">x, w</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.map(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">z, y</span>) </span>{
      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">value</span>: z,
        <span class="hljs-attr">criteria</span>: x.call(w, z, y)
      }
    }).sort(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">B, A</span>) </span>{
      <span class="hljs-keyword">var</span> z = B.criteria,
        y = A.criteria;
      <span class="hljs-keyword">return</span> z &lt; y ? <span class="hljs-number">-1</span> : z &gt; y ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span>
    }).pluck(<span class="hljs-string">"value"</span>)
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">o</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.map()
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">s</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> x = Prototype.K,
      w = $A(<span class="hljs-built_in">arguments</span>);
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.isFunction(w.last())) {
      x = w.pop()
    }
    <span class="hljs-keyword">var</span> y = [<span class="hljs-keyword">this</span>].concat(w).map($A);
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.map(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">A, z</span>) </span>{
      <span class="hljs-keyword">return</span> x(y.pluck(z))
    })
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">k</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.toArray().length
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">u</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-string">"#&lt;Enumerable:"</span> + <span class="hljs-keyword">this</span>.toArray().inspect() + <span class="hljs-string">"&gt;"</span>
  }
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">each</span>: c,
    <span class="hljs-attr">eachSlice</span>: r,
    <span class="hljs-attr">all</span>: b,
    <span class="hljs-attr">every</span>: b,
    <span class="hljs-attr">any</span>: i,
    <span class="hljs-attr">some</span>: i,
    <span class="hljs-attr">collect</span>: j,
    <span class="hljs-attr">map</span>: j,
    <span class="hljs-attr">detect</span>: t,
    <span class="hljs-attr">findAll</span>: h,
    <span class="hljs-attr">select</span>: h,
    <span class="hljs-attr">filter</span>: h,
    <span class="hljs-attr">grep</span>: g,
    <span class="hljs-attr">include</span>: a,
    <span class="hljs-attr">member</span>: a,
    <span class="hljs-attr">inGroupsOf</span>: q,
    <span class="hljs-attr">inject</span>: l,
    <span class="hljs-attr">invoke</span>: v,
    <span class="hljs-attr">max</span>: p,
    <span class="hljs-attr">min</span>: n,
    <span class="hljs-attr">partition</span>: e,
    <span class="hljs-attr">pluck</span>: f,
    <span class="hljs-attr">reject</span>: d,
    <span class="hljs-attr">sortBy</span>: m,
    <span class="hljs-attr">toArray</span>: o,
    <span class="hljs-attr">entries</span>: o,
    <span class="hljs-attr">zip</span>: s,
    <span class="hljs-attr">size</span>: k,
    <span class="hljs-attr">inspect</span>: u,
    <span class="hljs-attr">find</span>: t
  }
})();

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$A</span>(<span class="hljs-params">c</span>) </span>{
  <span class="hljs-keyword">if</span> (!c) {
    <span class="hljs-keyword">return</span> []
  }
  <span class="hljs-keyword">if</span> (<span class="hljs-string">"toArray"</span> <span class="hljs-keyword">in</span> <span class="hljs-built_in">Object</span>(c)) {
    <span class="hljs-keyword">return</span> c.toArray()
  }
  <span class="hljs-keyword">var</span> b = c.length || <span class="hljs-number">0</span>,
    a = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(b);
  <span class="hljs-keyword">while</span> (b--) {
    a[b] = c[b]
  }
  <span class="hljs-keyword">return</span> a
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$w</span>(<span class="hljs-params">a</span>) </span>{
  <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">Object</span>.isString(a)) {
    <span class="hljs-keyword">return</span> []
  }
  a = a.strip();
  <span class="hljs-keyword">return</span> a ? a.split(<span class="hljs-regexp">/\s+/</span>) : []
}
<span class="hljs-built_in">Array</span>.from = $A;
(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> r = <span class="hljs-built_in">Array</span>.prototype,
    m = r.slice,
    o = r.forEach;

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">b</span>(<span class="hljs-params">w, v</span>) </span>{
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> u = <span class="hljs-number">0</span>, x = <span class="hljs-keyword">this</span>.length &gt;&gt;&gt; <span class="hljs-number">0</span>; u &lt; x; u++) {
      <span class="hljs-keyword">if</span> (u <span class="hljs-keyword">in</span> <span class="hljs-keyword">this</span>) {
        w.call(v, <span class="hljs-keyword">this</span>[u], u, <span class="hljs-keyword">this</span>)
      }
    }
  }
  <span class="hljs-keyword">if</span> (!o) {
    o = b
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">l</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>.length = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">d</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>[<span class="hljs-number">0</span>]
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">g</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>[<span class="hljs-keyword">this</span>.length - <span class="hljs-number">1</span>]
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">i</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.select(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">u</span>) </span>{
      <span class="hljs-keyword">return</span> u != <span class="hljs-literal">null</span>
    })
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">t</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.inject([], <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">v, u</span>) </span>{
      <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.isArray(u)) {
        <span class="hljs-keyword">return</span> v.concat(u.flatten())
      }
      v.push(u);
      <span class="hljs-keyword">return</span> v
    })
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">h</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> u = m.call(<span class="hljs-built_in">arguments</span>, <span class="hljs-number">0</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.select(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">v</span>) </span>{
      <span class="hljs-keyword">return</span> !u.include(v)
    })
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">f</span>(<span class="hljs-params">u</span>) </span>{
    <span class="hljs-keyword">return</span> (u === <span class="hljs-literal">false</span> ? <span class="hljs-keyword">this</span>.toArray() : <span class="hljs-keyword">this</span>)._reverse()
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">k</span>(<span class="hljs-params">u</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.inject([], <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">x, w, v</span>) </span>{
      <span class="hljs-keyword">if</span> (<span class="hljs-number">0</span> == v || (u ? x.last() != w : !x.include(w))) {
        x.push(w)
      }
      <span class="hljs-keyword">return</span> x
    })
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">p</span>(<span class="hljs-params">u</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.uniq().findAll(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">v</span>) </span>{
      <span class="hljs-keyword">return</span> u.detect(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">w</span>) </span>{
        <span class="hljs-keyword">return</span> v === w
      })
    })
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">q</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> m.call(<span class="hljs-keyword">this</span>, <span class="hljs-number">0</span>)
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">j</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.length
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">s</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-string">"["</span> + <span class="hljs-keyword">this</span>.map(<span class="hljs-built_in">Object</span>.inspect).join(<span class="hljs-string">", "</span>) + <span class="hljs-string">"]"</span>
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">a</span>(<span class="hljs-params">w, u</span>) </span>{
    u || (u = <span class="hljs-number">0</span>);
    <span class="hljs-keyword">var</span> v = <span class="hljs-keyword">this</span>.length;
    <span class="hljs-keyword">if</span> (u &lt; <span class="hljs-number">0</span>) {
      u = v + u
    }
    <span class="hljs-keyword">for</span> (; u &lt; v; u++) {
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>[u] === w) {
        <span class="hljs-keyword">return</span> u
      }
    }
    <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">n</span>(<span class="hljs-params">v, u</span>) </span>{
    u = <span class="hljs-built_in">isNaN</span>(u) ? <span class="hljs-keyword">this</span>.length : (u &lt; <span class="hljs-number">0</span> ? <span class="hljs-keyword">this</span>.length + u : u) + <span class="hljs-number">1</span>;
    <span class="hljs-keyword">var</span> w = <span class="hljs-keyword">this</span>.slice(<span class="hljs-number">0</span>, u).reverse().indexOf(v);
    <span class="hljs-keyword">return</span> (w &lt; <span class="hljs-number">0</span>) ? w : u - w - <span class="hljs-number">1</span>
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">c</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> z = m.call(<span class="hljs-keyword">this</span>, <span class="hljs-number">0</span>),
      x;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> v = <span class="hljs-number">0</span>, w = <span class="hljs-built_in">arguments</span>.length; v &lt; w; v++) {
      x = <span class="hljs-built_in">arguments</span>[v];
      <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.isArray(x) &amp;&amp; !(<span class="hljs-string">"callee"</span> <span class="hljs-keyword">in</span> x)) {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> u = <span class="hljs-number">0</span>, y = x.length; u &lt; y; u++) {
          z.push(x[u])
        }
      } <span class="hljs-keyword">else</span> {
        z.push(x)
      }
    }
    <span class="hljs-keyword">return</span> z
  }
  <span class="hljs-built_in">Object</span>.extend(r, Enumerable);
  <span class="hljs-keyword">if</span> (!r._reverse) {
    r._reverse = r.reverse
  }
  <span class="hljs-built_in">Object</span>.extend(r, {
    <span class="hljs-attr">_each</span>: o,
    <span class="hljs-attr">clear</span>: l,
    <span class="hljs-attr">first</span>: d,
    <span class="hljs-attr">last</span>: g,
    <span class="hljs-attr">compact</span>: i,
    <span class="hljs-attr">flatten</span>: t,
    <span class="hljs-attr">without</span>: h,
    <span class="hljs-attr">reverse</span>: f,
    <span class="hljs-attr">uniq</span>: k,
    <span class="hljs-attr">intersect</span>: p,
    <span class="hljs-attr">clone</span>: q,
    <span class="hljs-attr">toArray</span>: q,
    <span class="hljs-attr">size</span>: j,
    <span class="hljs-attr">inspect</span>: s
  });
  <span class="hljs-keyword">var</span> e = (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> [].concat(<span class="hljs-built_in">arguments</span>)[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>] !== <span class="hljs-number">1</span>
  })(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>);
  <span class="hljs-keyword">if</span> (e) {
    r.concat = c
  }
  <span class="hljs-keyword">if</span> (!r.indexOf) {
    r.indexOf = a
  }
  <span class="hljs-keyword">if</span> (!r.lastIndexOf) {
    r.lastIndexOf = n
  }
})();

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$H</span>(<span class="hljs-params">a</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Hash(a)
}
<span class="hljs-keyword">var</span> Hash = Class.create(Enumerable, (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">e</span>(<span class="hljs-params">p</span>) </span>{
    <span class="hljs-keyword">this</span>._object = <span class="hljs-built_in">Object</span>.isHash(p) ? p.toObject() : <span class="hljs-built_in">Object</span>.clone(p)
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">f</span>(<span class="hljs-params">q</span>) </span>{
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> p <span class="hljs-keyword">in</span> <span class="hljs-keyword">this</span>._object) {
      <span class="hljs-keyword">var</span> r = <span class="hljs-keyword">this</span>._object[p],
        s = [p, r];
      s.key = p;
      s.value = r;
      q(s)
    }
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">j</span>(<span class="hljs-params">p, q</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._object[p] = q
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">c</span>(<span class="hljs-params">p</span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._object[p] !== <span class="hljs-built_in">Object</span>.prototype[p]) {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._object[p]
    }
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">m</span>(<span class="hljs-params">p</span>) </span>{
    <span class="hljs-keyword">var</span> q = <span class="hljs-keyword">this</span>._object[p];
    <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>._object[p];
    <span class="hljs-keyword">return</span> q
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">o</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">Object</span>.clone(<span class="hljs-keyword">this</span>._object)
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">n</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.pluck(<span class="hljs-string">"key"</span>)
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">l</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.pluck(<span class="hljs-string">"value"</span>)
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">g</span>(<span class="hljs-params">q</span>) </span>{
    <span class="hljs-keyword">var</span> p = <span class="hljs-keyword">this</span>.detect(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">r</span>) </span>{
      <span class="hljs-keyword">return</span> r.value === q
    });
    <span class="hljs-keyword">return</span> p &amp;&amp; p.key
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">i</span>(<span class="hljs-params">p</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.clone().update(p)
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">d</span>(<span class="hljs-params">p</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Hash(p).inject(<span class="hljs-keyword">this</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">q, r</span>) </span>{
      q.set(r.key, r.value);
      <span class="hljs-keyword">return</span> q
    })
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">b</span>(<span class="hljs-params">p, q</span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.isUndefined(q)) {
      <span class="hljs-keyword">return</span> p
    }
    <span class="hljs-keyword">return</span> p + <span class="hljs-string">"="</span> + <span class="hljs-built_in">encodeURIComponent</span>(<span class="hljs-built_in">String</span>.interpret(q))
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">a</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.inject([], <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">t, w</span>) </span>{
      <span class="hljs-keyword">var</span> s = <span class="hljs-built_in">encodeURIComponent</span>(w.key),
        q = w.value;
      <span class="hljs-keyword">if</span> (q &amp;&amp; <span class="hljs-keyword">typeof</span> q == <span class="hljs-string">"object"</span>) {
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.isArray(q)) {
          <span class="hljs-keyword">var</span> v = [];
          <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> r = <span class="hljs-number">0</span>, p = q.length, u; r &lt; p; r++) {
            u = q[r];
            v.push(b(s, u))
          }
          <span class="hljs-keyword">return</span> t.concat(v)
        }
      } <span class="hljs-keyword">else</span> {
        t.push(b(s, q))
      }
      <span class="hljs-keyword">return</span> t
    }).join(<span class="hljs-string">"&amp;"</span>)
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">k</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-string">"#&lt;Hash:{"</span> + <span class="hljs-keyword">this</span>.map(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">p</span>) </span>{
      <span class="hljs-keyword">return</span> p.map(<span class="hljs-built_in">Object</span>.inspect).join(<span class="hljs-string">": "</span>)
    }).join(<span class="hljs-string">", "</span>) + <span class="hljs-string">"}&gt;"</span>
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">h</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Hash(<span class="hljs-keyword">this</span>)
  }
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">initialize</span>: e,
    <span class="hljs-attr">_each</span>: f,
    <span class="hljs-attr">set</span>: j,
    <span class="hljs-attr">get</span>: c,
    <span class="hljs-attr">unset</span>: m,
    <span class="hljs-attr">toObject</span>: o,
    <span class="hljs-attr">toTemplateReplacements</span>: o,
    <span class="hljs-attr">keys</span>: n,
    <span class="hljs-attr">values</span>: l,
    <span class="hljs-attr">index</span>: g,
    <span class="hljs-attr">merge</span>: i,
    <span class="hljs-attr">update</span>: d,
    <span class="hljs-attr">toQueryString</span>: a,
    <span class="hljs-attr">inspect</span>: k,
    <span class="hljs-attr">toJSON</span>: o,
    <span class="hljs-attr">clone</span>: h
  }
})());
Hash.from = $H;
<span class="hljs-built_in">Object</span>.extend(<span class="hljs-built_in">Number</span>.prototype, (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">d</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.toPaddedString(<span class="hljs-number">2</span>, <span class="hljs-number">16</span>)
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">b</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span> + <span class="hljs-number">1</span>
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">h</span>(<span class="hljs-params">j, i</span>) </span>{
    $R(<span class="hljs-number">0</span>, <span class="hljs-keyword">this</span>, <span class="hljs-literal">true</span>).each(j, i);
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">g</span>(<span class="hljs-params">k, j</span>) </span>{
    <span class="hljs-keyword">var</span> i = <span class="hljs-keyword">this</span>.toString(j || <span class="hljs-number">10</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-string">"0"</span>.times(k - i.length) + i
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">a</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">Math</span>.abs(<span class="hljs-keyword">this</span>)
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">c</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">Math</span>.round(<span class="hljs-keyword">this</span>)
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">e</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">Math</span>.ceil(<span class="hljs-keyword">this</span>)
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">f</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">Math</span>.floor(<span class="hljs-keyword">this</span>)
  }
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">toColorPart</span>: d,
    <span class="hljs-attr">succ</span>: b,
    <span class="hljs-attr">times</span>: h,
    <span class="hljs-attr">toPaddedString</span>: g,
    <span class="hljs-attr">abs</span>: a,
    <span class="hljs-attr">round</span>: c,
    <span class="hljs-attr">ceil</span>: e,
    <span class="hljs-attr">floor</span>: f
  }
})());

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$R</span>(<span class="hljs-params">c, a, b</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ObjectRange(c, a, b)
}
<span class="hljs-keyword">var</span> ObjectRange = Class.create(Enumerable, (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">b</span>(<span class="hljs-params">f, d, e</span>) </span>{
    <span class="hljs-keyword">this</span>.start = f;
    <span class="hljs-keyword">this</span>.end = d;
    <span class="hljs-keyword">this</span>.exclusive = e
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">c</span>(<span class="hljs-params">d</span>) </span>{
    <span class="hljs-keyword">var</span> e = <span class="hljs-keyword">this</span>.start;
    <span class="hljs-keyword">while</span> (<span class="hljs-keyword">this</span>.include(e)) {
      d(e);
      e = e.succ()
    }
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">a</span>(<span class="hljs-params">d</span>) </span>{
    <span class="hljs-keyword">if</span> (d &lt; <span class="hljs-keyword">this</span>.start) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
    }
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.exclusive) {
      <span class="hljs-keyword">return</span> d &lt; <span class="hljs-keyword">this</span>.end
    }
    <span class="hljs-keyword">return</span> d &lt;= <span class="hljs-keyword">this</span>.end
  }
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">initialize</span>: b,
    <span class="hljs-attr">_each</span>: c,
    <span class="hljs-attr">include</span>: a
  }
})());
<span class="hljs-keyword">var</span> Ajax = {
  <span class="hljs-attr">getTransport</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> Try.these(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> XMLHttpRequest()
    }, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ActiveXObject(<span class="hljs-string">"Msxml2.XMLHTTP"</span>)
    }, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ActiveXObject(<span class="hljs-string">"Microsoft.XMLHTTP"</span>)
    }) || <span class="hljs-literal">false</span>
  },
  <span class="hljs-attr">activeRequestCount</span>: <span class="hljs-number">0</span>
};
Ajax.Responders = {
  <span class="hljs-attr">responders</span>: [],
  <span class="hljs-attr">_each</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
    <span class="hljs-keyword">this</span>.responders._each(a)
  },
  <span class="hljs-attr">register</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.include(a)) {
      <span class="hljs-keyword">this</span>.responders.push(a)
    }
  },
  <span class="hljs-attr">unregister</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
    <span class="hljs-keyword">this</span>.responders = <span class="hljs-keyword">this</span>.responders.without(a)
  },
  <span class="hljs-attr">dispatch</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">d, b, c, a</span>) </span>{
    <span class="hljs-keyword">this</span>.each(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">f</span>) </span>{
      <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.isFunction(f[d])) {
        <span class="hljs-keyword">try</span> {
          f[d].apply(f, [b, c, a])
        } <span class="hljs-keyword">catch</span> (g) {}
      }
    })
  }
};
<span class="hljs-built_in">Object</span>.extend(Ajax.Responders, Enumerable);
Ajax.Responders.register({
  <span class="hljs-attr">onCreate</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    Ajax.activeRequestCount++
  },
  <span class="hljs-attr">onComplete</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    Ajax.activeRequestCount--
  }
});
Ajax.Base = Class.create({
  <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
    <span class="hljs-keyword">this</span>.options = {
      <span class="hljs-attr">method</span>: <span class="hljs-string">"post"</span>,
      <span class="hljs-attr">asynchronous</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">contentType</span>: <span class="hljs-string">"application/x-www-form-urlencoded"</span>,
      <span class="hljs-attr">encoding</span>: <span class="hljs-string">"UTF-8"</span>,
      <span class="hljs-attr">parameters</span>: <span class="hljs-string">""</span>,
      <span class="hljs-attr">evalJSON</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">evalJS</span>: <span class="hljs-literal">true</span>
    };
    <span class="hljs-built_in">Object</span>.extend(<span class="hljs-keyword">this</span>.options, a || {});
    <span class="hljs-keyword">this</span>.options.method = <span class="hljs-keyword">this</span>.options.method.toLowerCase();
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.isHash(<span class="hljs-keyword">this</span>.options.parameters)) {
      <span class="hljs-keyword">this</span>.options.parameters = <span class="hljs-keyword">this</span>.options.parameters.toObject()
    }
  }
});
Ajax.Request = Class.create(Ajax.Base, {
  <span class="hljs-attr">_complete</span>: <span class="hljs-literal">false</span>,
  <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$super, b, a</span>) </span>{
    $<span class="hljs-keyword">super</span>(a);
    <span class="hljs-keyword">this</span>.transport = Ajax.getTransport();
    <span class="hljs-keyword">this</span>.request(b)
  },
  <span class="hljs-attr">request</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">b</span>) </span>{
    <span class="hljs-keyword">this</span>.url = b;
    <span class="hljs-keyword">this</span>.method = <span class="hljs-keyword">this</span>.options.method;
    <span class="hljs-keyword">var</span> d = <span class="hljs-built_in">Object</span>.isString(<span class="hljs-keyword">this</span>.options.parameters) ? <span class="hljs-keyword">this</span>.options.parameters : <span class="hljs-built_in">Object</span>.toQueryString(<span class="hljs-keyword">this</span>.options.parameters);
    <span class="hljs-keyword">if</span> (![<span class="hljs-string">"get"</span>, <span class="hljs-string">"post"</span>].include(<span class="hljs-keyword">this</span>.method)) {
      d += (d ? <span class="hljs-string">"&amp;"</span> : <span class="hljs-string">""</span>) + <span class="hljs-string">"_method="</span> + <span class="hljs-keyword">this</span>.method;
      <span class="hljs-keyword">this</span>.method = <span class="hljs-string">"post"</span>
    }
    <span class="hljs-keyword">if</span> (d &amp;&amp; <span class="hljs-keyword">this</span>.method === <span class="hljs-string">"get"</span>) {
      <span class="hljs-keyword">this</span>.url += (<span class="hljs-keyword">this</span>.url.include(<span class="hljs-string">"?"</span>) ? <span class="hljs-string">"&amp;"</span> : <span class="hljs-string">"?"</span>) + d
    }
    <span class="hljs-keyword">this</span>.parameters = d.toQueryParams();
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">var</span> a = <span class="hljs-keyword">new</span> Ajax.Response(<span class="hljs-keyword">this</span>);
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.onCreate) {
        <span class="hljs-keyword">this</span>.options.onCreate(a)
      }
      Ajax.Responders.dispatch(<span class="hljs-string">"onCreate"</span>, <span class="hljs-keyword">this</span>, a);
      <span class="hljs-keyword">this</span>.transport.open(<span class="hljs-keyword">this</span>.method.toUpperCase(), <span class="hljs-keyword">this</span>.url, <span class="hljs-keyword">this</span>.options.asynchronous);
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.asynchronous) {
        <span class="hljs-keyword">this</span>.respondToReadyState.bind(<span class="hljs-keyword">this</span>).defer(<span class="hljs-number">1</span>)
      }
      <span class="hljs-keyword">this</span>.transport.onreadystatechange = <span class="hljs-keyword">this</span>.onStateChange.bind(<span class="hljs-keyword">this</span>);
      <span class="hljs-keyword">this</span>.setRequestHeaders();
      <span class="hljs-keyword">this</span>.body = <span class="hljs-keyword">this</span>.method == <span class="hljs-string">"post"</span> ? (<span class="hljs-keyword">this</span>.options.postBody || d) : <span class="hljs-literal">null</span>;
      <span class="hljs-keyword">this</span>.transport.send(<span class="hljs-keyword">this</span>.body);
      <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.options.asynchronous &amp;&amp; <span class="hljs-keyword">this</span>.transport.overrideMimeType) {
        <span class="hljs-keyword">this</span>.onStateChange()
      }
    } <span class="hljs-keyword">catch</span> (c) {
      <span class="hljs-keyword">this</span>.dispatchException(c)
    }
  },
  <span class="hljs-attr">onStateChange</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> a = <span class="hljs-keyword">this</span>.transport.readyState;
    <span class="hljs-keyword">if</span> (a &gt; <span class="hljs-number">1</span> &amp;&amp; !((a == <span class="hljs-number">4</span>) &amp;&amp; <span class="hljs-keyword">this</span>._complete)) {
      <span class="hljs-keyword">this</span>.respondToReadyState(<span class="hljs-keyword">this</span>.transport.readyState)
    }
  },
  <span class="hljs-attr">setRequestHeaders</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> e = {
      <span class="hljs-string">"X-Requested-With"</span>: <span class="hljs-string">"XMLHttpRequest"</span>,
      <span class="hljs-string">"X-Prototype-Version"</span>: Prototype.Version,
      <span class="hljs-attr">Accept</span>: <span class="hljs-string">"text/javascript, text/html, application/xml, text/xml, */*"</span>
    };
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.method == <span class="hljs-string">"post"</span>) {
      e[<span class="hljs-string">"Content-type"</span>] = <span class="hljs-keyword">this</span>.options.contentType + (<span class="hljs-keyword">this</span>.options.encoding ? <span class="hljs-string">"; charset="</span> + <span class="hljs-keyword">this</span>.options.encoding : <span class="hljs-string">""</span>);
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.transport.overrideMimeType &amp;&amp; (navigator.userAgent.match(<span class="hljs-regexp">/Gecko\/(\d{4})/</span>) || [<span class="hljs-number">0</span>, <span class="hljs-number">2005</span>])[<span class="hljs-number">1</span>] &lt; <span class="hljs-number">2005</span>) {
        e.Connection = <span class="hljs-string">"close"</span>
      }
    }
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-keyword">this</span>.options.requestHeaders == <span class="hljs-string">"object"</span>) {
      <span class="hljs-keyword">var</span> c = <span class="hljs-keyword">this</span>.options.requestHeaders;
      <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.isFunction(c.push)) {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> b = <span class="hljs-number">0</span>, d = c.length; b &lt; d; b += <span class="hljs-number">2</span>) {
          e[c[b]] = c[b + <span class="hljs-number">1</span>]
        }
      } <span class="hljs-keyword">else</span> {
        $H(c).each(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">f</span>) </span>{
          e[f.key] = f.value
        })
      }
    }
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> a <span class="hljs-keyword">in</span> e) {
      <span class="hljs-keyword">this</span>.transport.setRequestHeader(a, e[a])
    }
  },
  <span class="hljs-attr">success</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> a = <span class="hljs-keyword">this</span>.getStatus();
    <span class="hljs-keyword">return</span> !a || (a &gt;= <span class="hljs-number">200</span> &amp;&amp; a &lt; <span class="hljs-number">300</span>) || a == <span class="hljs-number">304</span>
  },
  <span class="hljs-attr">getStatus</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.transport.status === <span class="hljs-number">1223</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-number">204</span>
      }
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.transport.status || <span class="hljs-number">0</span>
    } <span class="hljs-keyword">catch</span> (a) {
      <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>
    }
  },
  <span class="hljs-attr">respondToReadyState</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
    <span class="hljs-keyword">var</span> c = Ajax.Request.Events[a],
      b = <span class="hljs-keyword">new</span> Ajax.Response(<span class="hljs-keyword">this</span>);
    <span class="hljs-keyword">if</span> (c == <span class="hljs-string">"Complete"</span>) {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">this</span>._complete = <span class="hljs-literal">true</span>;
        (<span class="hljs-keyword">this</span>.options[<span class="hljs-string">"on"</span> + b.status] || <span class="hljs-keyword">this</span>.options[<span class="hljs-string">"on"</span> + (<span class="hljs-keyword">this</span>.success() ? <span class="hljs-string">"Success"</span> : <span class="hljs-string">"Failure"</span>)] || Prototype.emptyFunction)(b, b.headerJSON)
      } <span class="hljs-keyword">catch</span> (d) {
        <span class="hljs-keyword">this</span>.dispatchException(d)
      }
      <span class="hljs-keyword">var</span> f = b.getHeader(<span class="hljs-string">"Content-type"</span>);
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.evalJS == <span class="hljs-string">"force"</span> || (<span class="hljs-keyword">this</span>.options.evalJS &amp;&amp; <span class="hljs-keyword">this</span>.isSameOrigin() &amp;&amp; f &amp;&amp; f.match(<span class="hljs-regexp">/^\s*(text|application)\/(x-)?(java|ecma)script(;.*)?\s*$/i</span>))) {
        <span class="hljs-keyword">this</span>.evalResponse()
      }
    }
    <span class="hljs-keyword">try</span> {
      (<span class="hljs-keyword">this</span>.options[<span class="hljs-string">"on"</span> + c] || Prototype.emptyFunction)(b, b.headerJSON);
      Ajax.Responders.dispatch(<span class="hljs-string">"on"</span> + c, <span class="hljs-keyword">this</span>, b, b.headerJSON)
    } <span class="hljs-keyword">catch</span> (d) {
      <span class="hljs-keyword">this</span>.dispatchException(d)
    }
    <span class="hljs-keyword">if</span> (c == <span class="hljs-string">"Complete"</span>) {
      <span class="hljs-keyword">this</span>.transport.onreadystatechange = Prototype.emptyFunction
    }
  },
  <span class="hljs-attr">isSameOrigin</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> a = <span class="hljs-keyword">this</span>.url.match(<span class="hljs-regexp">/^\s*https?:\/\/[^\/]*/</span>);
    <span class="hljs-keyword">return</span> !a || (a[<span class="hljs-number">0</span>] == <span class="hljs-string">"#{protocol}//#{domain}#{port}"</span>.interpolate({
      <span class="hljs-attr">protocol</span>: location.protocol,
      <span class="hljs-attr">domain</span>: <span class="hljs-built_in">document</span>.domain,
      <span class="hljs-attr">port</span>: location.port ? <span class="hljs-string">":"</span> + location.port : <span class="hljs-string">""</span>
    }))
  },
  <span class="hljs-attr">getHeader</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.transport.getResponseHeader(a) || <span class="hljs-literal">null</span>
    } <span class="hljs-keyword">catch</span> (b) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>
    }
  },
  <span class="hljs-attr">evalResponse</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">return</span> <span class="hljs-built_in">eval</span>((<span class="hljs-keyword">this</span>.transport.responseText || <span class="hljs-string">""</span>).unfilterJSON())
    } <span class="hljs-keyword">catch</span> (e) {
      <span class="hljs-keyword">this</span>.dispatchException(e)
    }
  },
  <span class="hljs-attr">dispatchException</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
    (<span class="hljs-keyword">this</span>.options.onException || Prototype.emptyFunction)(<span class="hljs-keyword">this</span>, a);
    Ajax.Responders.dispatch(<span class="hljs-string">"onException"</span>, <span class="hljs-keyword">this</span>, a)
  }
});
Ajax.Request.Events = [<span class="hljs-string">"Uninitialized"</span>, <span class="hljs-string">"Loading"</span>, <span class="hljs-string">"Loaded"</span>, <span class="hljs-string">"Interactive"</span>, <span class="hljs-string">"Complete"</span>];
Ajax.Response = Class.create({
  <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">c</span>) </span>{
    <span class="hljs-keyword">this</span>.request = c;
    <span class="hljs-keyword">var</span> d = <span class="hljs-keyword">this</span>.transport = c.transport,
      a = <span class="hljs-keyword">this</span>.readyState = d.readyState;
    <span class="hljs-keyword">if</span> ((a &gt; <span class="hljs-number">2</span> &amp;&amp; !Prototype.Browser.IE) || a == <span class="hljs-number">4</span>) {
      <span class="hljs-keyword">this</span>.status = <span class="hljs-keyword">this</span>.getStatus();
      <span class="hljs-keyword">this</span>.statusText = <span class="hljs-keyword">this</span>.getStatusText();
      <span class="hljs-keyword">this</span>.responseText = <span class="hljs-built_in">String</span>.interpret(d.responseText);
      <span class="hljs-keyword">this</span>.headerJSON = <span class="hljs-keyword">this</span>._getHeaderJSON()
    }
    <span class="hljs-keyword">if</span> (a == <span class="hljs-number">4</span>) {
      <span class="hljs-keyword">var</span> b = d.responseXML;
      <span class="hljs-keyword">this</span>.responseXML = <span class="hljs-built_in">Object</span>.isUndefined(b) ? <span class="hljs-literal">null</span> : b;
      <span class="hljs-keyword">this</span>.responseJSON = <span class="hljs-keyword">this</span>._getResponseJSON()
    }
  },
  <span class="hljs-attr">status</span>: <span class="hljs-number">0</span>,
  <span class="hljs-attr">statusText</span>: <span class="hljs-string">""</span>,
  <span class="hljs-attr">getStatus</span>: Ajax.Request.prototype.getStatus,
  <span class="hljs-attr">getStatusText</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.transport.statusText || <span class="hljs-string">""</span>
    } <span class="hljs-keyword">catch</span> (a) {
      <span class="hljs-keyword">return</span> <span class="hljs-string">""</span>
    }
  },
  <span class="hljs-attr">getHeader</span>: Ajax.Request.prototype.getHeader,
  <span class="hljs-attr">getAllHeaders</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.getAllResponseHeaders()
    } <span class="hljs-keyword">catch</span> (a) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>
    }
  },
  <span class="hljs-attr">getResponseHeader</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.transport.getResponseHeader(a)
  },
  <span class="hljs-attr">getAllResponseHeaders</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.transport.getAllResponseHeaders()
  },
  <span class="hljs-attr">_getHeaderJSON</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> a = <span class="hljs-keyword">this</span>.getHeader(<span class="hljs-string">"X-JSON"</span>);
    <span class="hljs-keyword">if</span> (!a) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>
    }
    a = <span class="hljs-built_in">decodeURIComponent</span>(<span class="hljs-built_in">escape</span>(a));
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">return</span> a.evalJSON(<span class="hljs-keyword">this</span>.request.options.sanitizeJSON || !<span class="hljs-keyword">this</span>.request.isSameOrigin())
    } <span class="hljs-keyword">catch</span> (b) {
      <span class="hljs-keyword">this</span>.request.dispatchException(b)
    }
  },
  <span class="hljs-attr">_getResponseJSON</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> a = <span class="hljs-keyword">this</span>.request.options;
    <span class="hljs-keyword">if</span> (!a.evalJSON || (a.evalJSON != <span class="hljs-string">"force"</span> &amp;&amp; !(<span class="hljs-keyword">this</span>.getHeader(<span class="hljs-string">"Content-type"</span>) || <span class="hljs-string">""</span>).include(<span class="hljs-string">"application/json"</span>)) || <span class="hljs-keyword">this</span>.responseText.blank()) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>
    }
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.responseText.evalJSON(a.sanitizeJSON || !<span class="hljs-keyword">this</span>.request.isSameOrigin())
    } <span class="hljs-keyword">catch</span> (b) {
      <span class="hljs-keyword">this</span>.request.dispatchException(b)
    }
  }
});
Ajax.Updater = Class.create(Ajax.Request, {
  <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$super, a, c, b</span>) </span>{
    <span class="hljs-keyword">this</span>.container = {
      <span class="hljs-attr">success</span>: (a.success || a),
      <span class="hljs-attr">failure</span>: (a.failure || (a.success ? <span class="hljs-literal">null</span> : a))
    };
    b = <span class="hljs-built_in">Object</span>.clone(b);
    <span class="hljs-keyword">var</span> d = b.onComplete;
    b.onComplete = (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e, f</span>) </span>{
      <span class="hljs-keyword">this</span>.updateContent(e.responseText);
      <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.isFunction(d)) {
        d(e, f)
      }
    }).bind(<span class="hljs-keyword">this</span>);
    $<span class="hljs-keyword">super</span>(c, b)
  },
  <span class="hljs-attr">updateContent</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">d</span>) </span>{
    <span class="hljs-keyword">var</span> c = <span class="hljs-keyword">this</span>.container[<span class="hljs-keyword">this</span>.success() ? <span class="hljs-string">"success"</span> : <span class="hljs-string">"failure"</span>],
      a = <span class="hljs-keyword">this</span>.options;
    <span class="hljs-keyword">if</span> (!a.evalScripts) {
      d = d.stripScripts()
    }
    <span class="hljs-keyword">if</span> (c = $(c)) {
      <span class="hljs-keyword">if</span> (a.insertion) {
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.isString(a.insertion)) {
          <span class="hljs-keyword">var</span> b = {};
          b[a.insertion] = d;
          c.insert(b)
        } <span class="hljs-keyword">else</span> {
          a.insertion(c, d)
        }
      } <span class="hljs-keyword">else</span> {
        c.update(d)
      }
    }
  }
});
Ajax.PeriodicalUpdater = Class.create(Ajax.Base, {
  <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$super, a, c, b</span>) </span>{
    $<span class="hljs-keyword">super</span>(b);
    <span class="hljs-keyword">this</span>.onComplete = <span class="hljs-keyword">this</span>.options.onComplete;
    <span class="hljs-keyword">this</span>.frequency = (<span class="hljs-keyword">this</span>.options.frequency || <span class="hljs-number">2</span>);
    <span class="hljs-keyword">this</span>.decay = (<span class="hljs-keyword">this</span>.options.decay || <span class="hljs-number">1</span>);
    <span class="hljs-keyword">this</span>.updater = {};
    <span class="hljs-keyword">this</span>.container = a;
    <span class="hljs-keyword">this</span>.url = c;
    <span class="hljs-keyword">this</span>.start()
  },
  <span class="hljs-attr">start</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>.options.onComplete = <span class="hljs-keyword">this</span>.updateComplete.bind(<span class="hljs-keyword">this</span>);
    <span class="hljs-keyword">this</span>.onTimerEvent()
  },
  <span class="hljs-attr">stop</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>.updater.options.onComplete = <span class="hljs-literal">undefined</span>;
    clearTimeout(<span class="hljs-keyword">this</span>.timer);
    (<span class="hljs-keyword">this</span>.onComplete || Prototype.emptyFunction).apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>)
  },
  <span class="hljs-attr">updateComplete</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.decay) {
      <span class="hljs-keyword">this</span>.decay = (a.responseText == <span class="hljs-keyword">this</span>.lastText ? <span class="hljs-keyword">this</span>.decay * <span class="hljs-keyword">this</span>.options.decay : <span class="hljs-number">1</span>);
      <span class="hljs-keyword">this</span>.lastText = a.responseText
    }
    <span class="hljs-keyword">this</span>.timer = <span class="hljs-keyword">this</span>.onTimerEvent.bind(<span class="hljs-keyword">this</span>).delay(<span class="hljs-keyword">this</span>.decay * <span class="hljs-keyword">this</span>.frequency)
  },
  <span class="hljs-attr">onTimerEvent</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>.updater = <span class="hljs-keyword">new</span> Ajax.Updater(<span class="hljs-keyword">this</span>.container, <span class="hljs-keyword">this</span>.url, <span class="hljs-keyword">this</span>.options)
  }
});

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$</span>(<span class="hljs-params">b</span>) </span>{
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">arguments</span>.length &gt; <span class="hljs-number">1</span>) {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> a = <span class="hljs-number">0</span>, d = [], c = <span class="hljs-built_in">arguments</span>.length; a &lt; c; a++) {
      d.push($(<span class="hljs-built_in">arguments</span>[a]))
    }
    <span class="hljs-keyword">return</span> d
  }
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.isString(b)) {
    b = <span class="hljs-built_in">document</span>.getElementById(b)
  }
  <span class="hljs-keyword">return</span> Element.extend(b)
}
<span class="hljs-keyword">if</span> (Prototype.BrowserFeatures.XPath) {
  <span class="hljs-built_in">document</span>._getElementsByXPath = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">f, a</span>) </span>{
    <span class="hljs-keyword">var</span> c = [];
    <span class="hljs-keyword">var</span> e = <span class="hljs-built_in">document</span>.evaluate(f, $(a) || <span class="hljs-built_in">document</span>, <span class="hljs-literal">null</span>, XPathResult.ORDERED_NODE_SNAPSHOT_TYPE, <span class="hljs-literal">null</span>);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> b = <span class="hljs-number">0</span>, d = e.snapshotLength; b &lt; d; b++) {
      c.push(Element.extend(e.snapshotItem(b)))
    }
    <span class="hljs-keyword">return</span> c
  }
}
<span class="hljs-keyword">if</span> (!Node) {
  <span class="hljs-keyword">var</span> Node = {}
}
<span class="hljs-keyword">if</span> (!Node.ELEMENT_NODE) {
  <span class="hljs-built_in">Object</span>.extend(Node, {
    <span class="hljs-attr">ELEMENT_NODE</span>: <span class="hljs-number">1</span>,
    <span class="hljs-attr">ATTRIBUTE_NODE</span>: <span class="hljs-number">2</span>,
    <span class="hljs-attr">TEXT_NODE</span>: <span class="hljs-number">3</span>,
    <span class="hljs-attr">CDATA_SECTION_NODE</span>: <span class="hljs-number">4</span>,
    <span class="hljs-attr">ENTITY_REFERENCE_NODE</span>: <span class="hljs-number">5</span>,
    <span class="hljs-attr">ENTITY_NODE</span>: <span class="hljs-number">6</span>,
    <span class="hljs-attr">PROCESSING_INSTRUCTION_NODE</span>: <span class="hljs-number">7</span>,
    <span class="hljs-attr">COMMENT_NODE</span>: <span class="hljs-number">8</span>,
    <span class="hljs-attr">DOCUMENT_NODE</span>: <span class="hljs-number">9</span>,
    <span class="hljs-attr">DOCUMENT_TYPE_NODE</span>: <span class="hljs-number">10</span>,
    <span class="hljs-attr">DOCUMENT_FRAGMENT_NODE</span>: <span class="hljs-number">11</span>,
    <span class="hljs-attr">NOTATION_NODE</span>: <span class="hljs-number">12</span>
  })
}(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">c</span>) </span>{
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">d</span>(<span class="hljs-params">f, e</span>) </span>{
    <span class="hljs-keyword">if</span> (f === <span class="hljs-string">"select"</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
    }
    <span class="hljs-keyword">if</span> (<span class="hljs-string">"type"</span> <span class="hljs-keyword">in</span> e) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
  }
  <span class="hljs-keyword">var</span> b = (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">var</span> e = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'&lt;input name="x"&gt;'</span>);
      <span class="hljs-keyword">return</span> e.tagName.toLowerCase() === <span class="hljs-string">"input"</span> &amp;&amp; e.name === <span class="hljs-string">"x"</span>
    } <span class="hljs-keyword">catch</span> (f) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
    }
  })();
  <span class="hljs-keyword">var</span> a = c.Element;
  c.Element = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">g, f</span>) </span>{
    f = f || {};
    g = g.toLowerCase();
    <span class="hljs-keyword">var</span> e = Element.cache;
    <span class="hljs-keyword">if</span> (b &amp;&amp; f.name) {
      g = <span class="hljs-string">"&lt;"</span> + g + <span class="hljs-string">' name="'</span> + f.name + <span class="hljs-string">'"&gt;'</span>;
      <span class="hljs-keyword">delete</span> f.name;
      <span class="hljs-keyword">return</span> Element.writeAttribute(<span class="hljs-built_in">document</span>.createElement(g), f)
    }
    <span class="hljs-keyword">if</span> (!e[g]) {
      e[g] = Element.extend(<span class="hljs-built_in">document</span>.createElement(g))
    }
    <span class="hljs-keyword">var</span> h = d(g, f) ? e[g].cloneNode(<span class="hljs-literal">false</span>) : <span class="hljs-built_in">document</span>.createElement(g);
    <span class="hljs-keyword">return</span> Element.writeAttribute(h, f)
  };
  <span class="hljs-built_in">Object</span>.extend(c.Element, a || {});
  <span class="hljs-keyword">if</span> (a) {
    c.Element.prototype = a.prototype
  }
})(<span class="hljs-keyword">this</span>);
Element.idCounter = <span class="hljs-number">1</span>;
Element.cache = {};
Element._purgeElement = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">b</span>) </span>{
  <span class="hljs-keyword">var</span> a = b._prototypeUID;
  <span class="hljs-keyword">if</span> (a) {
    Element.stopObserving(b);
    b._prototypeUID = <span class="hljs-keyword">void</span> <span class="hljs-number">0</span>;
    <span class="hljs-keyword">delete</span> Element.Storage[a]
  }
};
Element.Methods = {
  <span class="hljs-attr">visible</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
    <span class="hljs-keyword">return</span> $(a).style.display != <span class="hljs-string">"none"</span>
  },
  <span class="hljs-attr">toggle</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
    a = $(a);
    Element[Element.visible(a) ? <span class="hljs-string">"hide"</span> : <span class="hljs-string">"show"</span>](a);
    <span class="hljs-keyword">return</span> a
  },
  <span class="hljs-attr">hide</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
    a = $(a);
    a.style.display = <span class="hljs-string">"none"</span>;
    <span class="hljs-keyword">return</span> a
  },
  <span class="hljs-attr">show</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
    a = $(a);
    a.style.display = <span class="hljs-string">""</span>;
    <span class="hljs-keyword">return</span> a
  },
  <span class="hljs-attr">remove</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
    a = $(a);
    a.parentNode.removeChild(a);
    <span class="hljs-keyword">return</span> a
  },
  <span class="hljs-attr">update</span>: (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> d = (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> g = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"select"</span>),
        h = <span class="hljs-literal">true</span>;
      g.innerHTML = <span class="hljs-string">'&lt;option value="test"&gt;test&lt;/option&gt;'</span>;
      <span class="hljs-keyword">if</span> (g.options &amp;&amp; g.options[<span class="hljs-number">0</span>]) {
        h = g.options[<span class="hljs-number">0</span>].nodeName.toUpperCase() !== <span class="hljs-string">"OPTION"</span>
      }
      g = <span class="hljs-literal">null</span>;
      <span class="hljs-keyword">return</span> h
    })();
    <span class="hljs-keyword">var</span> b = (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">var</span> g = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"table"</span>);
        <span class="hljs-keyword">if</span> (g &amp;&amp; g.tBodies) {
          g.innerHTML = <span class="hljs-string">"&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;test&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;"</span>;
          <span class="hljs-keyword">var</span> i = <span class="hljs-keyword">typeof</span> g.tBodies[<span class="hljs-number">0</span>] == <span class="hljs-string">"undefined"</span>;
          g = <span class="hljs-literal">null</span>;
          <span class="hljs-keyword">return</span> i
        }
      } <span class="hljs-keyword">catch</span> (h) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
      }
    })();
    <span class="hljs-keyword">var</span> a = (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">var</span> g = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"div"</span>);
        g.innerHTML = <span class="hljs-string">"&lt;link&gt;"</span>;
        <span class="hljs-keyword">var</span> i = (g.childNodes.length === <span class="hljs-number">0</span>);
        g = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">return</span> i
      } <span class="hljs-keyword">catch</span> (h) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
      }
    })();
    <span class="hljs-keyword">var</span> c = d || b || a;
    <span class="hljs-keyword">var</span> f = (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> g = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"script"</span>),
        i = <span class="hljs-literal">false</span>;
      <span class="hljs-keyword">try</span> {
        g.appendChild(<span class="hljs-built_in">document</span>.createTextNode(<span class="hljs-string">""</span>));
        i = !g.firstChild || g.firstChild &amp;&amp; g.firstChild.nodeType !== <span class="hljs-number">3</span>
      } <span class="hljs-keyword">catch</span> (h) {
        i = <span class="hljs-literal">true</span>
      }
      g = <span class="hljs-literal">null</span>;
      <span class="hljs-keyword">return</span> i
    })();

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">e</span>(<span class="hljs-params">l, m</span>) </span>{
      l = $(l);
      <span class="hljs-keyword">var</span> g = Element._purgeElement;
      <span class="hljs-keyword">var</span> n = l.getElementsByTagName(<span class="hljs-string">"*"</span>),
        k = n.length;
      <span class="hljs-keyword">while</span> (k--) {
        g(n[k])
      }
      <span class="hljs-keyword">if</span> (m &amp;&amp; m.toElement) {
        m = m.toElement()
      }
      <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.isElement(m)) {
        <span class="hljs-keyword">return</span> l.update().insert(m)
      }
      m = <span class="hljs-built_in">Object</span>.toHTML(m);
      <span class="hljs-keyword">var</span> j = l.tagName.toUpperCase();
      <span class="hljs-keyword">if</span> (j === <span class="hljs-string">"SCRIPT"</span> &amp;&amp; f) {
        l.text = m;
        <span class="hljs-keyword">return</span> l
      }
      <span class="hljs-keyword">if</span> (c) {
        <span class="hljs-keyword">if</span> (j <span class="hljs-keyword">in</span> Element._insertionTranslations.tags) {
          <span class="hljs-keyword">while</span> (l.firstChild) {
            l.removeChild(l.firstChild)
          }
          Element._getContentFromAnonymousElement(j, m.stripScripts()).each(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">i</span>) </span>{
            l.appendChild(i)
          })
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">if</span> (a &amp;&amp; <span class="hljs-built_in">Object</span>.isString(m) &amp;&amp; m.indexOf(<span class="hljs-string">"&lt;link"</span>) &gt; <span class="hljs-number">-1</span>) {
            <span class="hljs-keyword">while</span> (l.firstChild) {
              l.removeChild(l.firstChild)
            }
            <span class="hljs-keyword">var</span> h = Element._getContentFromAnonymousElement(j, m.stripScripts(), <span class="hljs-literal">true</span>);
            h.each(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">i</span>) </span>{
              l.appendChild(i)
            })
          } <span class="hljs-keyword">else</span> {
            l.innerHTML = m.stripScripts()
          }
        }
      } <span class="hljs-keyword">else</span> {
        l.innerHTML = m.stripScripts()
      }
      m.evalScripts.bind(m).defer();
      <span class="hljs-keyword">return</span> l
    }
    <span class="hljs-keyword">return</span> e
  })(),
  <span class="hljs-attr">replace</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">b, c</span>) </span>{
    b = $(b);
    <span class="hljs-keyword">if</span> (c &amp;&amp; c.toElement) {
      c = c.toElement()
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">Object</span>.isElement(c)) {
        c = <span class="hljs-built_in">Object</span>.toHTML(c);
        <span class="hljs-keyword">var</span> a = b.ownerDocument.createRange();
        a.selectNode(b);
        c.evalScripts.bind(c).defer();
        c = a.createContextualFragment(c.stripScripts())
      }
    }
    b.parentNode.replaceChild(c, b);
    <span class="hljs-keyword">return</span> b
  },
  <span class="hljs-attr">insert</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">c, e</span>) </span>{
    c = $(c);
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.isString(e) || <span class="hljs-built_in">Object</span>.isNumber(e) || <span class="hljs-built_in">Object</span>.isElement(e) || (e &amp;&amp; (e.toElement || e.toHTML))) {
      e = {
        <span class="hljs-attr">bottom</span>: e
      }
    }
    <span class="hljs-keyword">var</span> d, f, b, g;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> a <span class="hljs-keyword">in</span> e) {
      d = e[a];
      a = a.toLowerCase();
      f = Element._insertionTranslations[a];
      <span class="hljs-keyword">if</span> (d &amp;&amp; d.toElement) {
        d = d.toElement()
      }
      <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.isElement(d)) {
        f(c, d);
        <span class="hljs-keyword">continue</span>
      }
      d = <span class="hljs-built_in">Object</span>.toHTML(d);
      b = ((a == <span class="hljs-string">"before"</span> || a == <span class="hljs-string">"after"</span>) ? c.parentNode : c).tagName.toUpperCase();
      g = Element._getContentFromAnonymousElement(b, d.stripScripts());
      <span class="hljs-keyword">if</span> (a == <span class="hljs-string">"top"</span> || a == <span class="hljs-string">"after"</span>) {
        g.reverse()
      }
      g.each(f.curry(c));
      d.evalScripts.bind(d).defer()
    }
    <span class="hljs-keyword">return</span> c
  },
  <span class="hljs-attr">wrap</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">b, c, a</span>) </span>{
    b = $(b);
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.isElement(c)) {
      $(c).writeAttribute(a || {})
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.isString(c)) {
        c = <span class="hljs-keyword">new</span> Element(c, a)
      } <span class="hljs-keyword">else</span> {
        c = <span class="hljs-keyword">new</span> Element(<span class="hljs-string">"div"</span>, c)
      }
    }
    <span class="hljs-keyword">if</span> (b.parentNode) {
      b.parentNode.replaceChild(c, b)
    }
    c.appendChild(b);
    <span class="hljs-keyword">return</span> c
  },
  <span class="hljs-attr">inspect</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">b</span>) </span>{
    b = $(b);
    <span class="hljs-keyword">var</span> a = <span class="hljs-string">"&lt;"</span> + b.tagName.toLowerCase();
    $H({
      <span class="hljs-attr">id</span>: <span class="hljs-string">"id"</span>,
      <span class="hljs-attr">className</span>: <span class="hljs-string">"class"</span>
    }).each(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">f</span>) </span>{
      <span class="hljs-keyword">var</span> e = f.first(),
        c = f.last(),
        d = (b[e] || <span class="hljs-string">""</span>).toString();
      <span class="hljs-keyword">if</span> (d) {
        a += <span class="hljs-string">" "</span> + c + <span class="hljs-string">"="</span> + d.inspect(<span class="hljs-literal">true</span>)
      }
    });
    <span class="hljs-keyword">return</span> a + <span class="hljs-string">"&gt;"</span>
  },
  <span class="hljs-attr">recursivelyCollect</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a, c, d</span>) </span>{
    a = $(a);
    d = d || <span class="hljs-number">-1</span>;
    <span class="hljs-keyword">var</span> b = [];
    <span class="hljs-keyword">while</span> (a = a[c]) {
      <span class="hljs-keyword">if</span> (a.nodeType == <span class="hljs-number">1</span>) {
        b.push(Element.extend(a))
      }
      <span class="hljs-keyword">if</span> (b.length == d) {
        <span class="hljs-keyword">break</span>
      }
    }
    <span class="hljs-keyword">return</span> b
  },
  <span class="hljs-attr">ancestors</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
    <span class="hljs-keyword">return</span> Element.recursivelyCollect(a, <span class="hljs-string">"parentNode"</span>)
  },
  <span class="hljs-attr">descendants</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
    <span class="hljs-keyword">return</span> Element.select(a, <span class="hljs-string">"*"</span>)
  },
  <span class="hljs-attr">firstDescendant</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
    a = $(a).firstChild;
    <span class="hljs-keyword">while</span> (a &amp;&amp; a.nodeType != <span class="hljs-number">1</span>) {
      a = a.nextSibling
    }
    <span class="hljs-keyword">return</span> $(a)
  },
  <span class="hljs-attr">immediateDescendants</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">b</span>) </span>{
    <span class="hljs-keyword">var</span> a = [],
      c = $(b).firstChild;
    <span class="hljs-keyword">while</span> (c) {
      <span class="hljs-keyword">if</span> (c.nodeType === <span class="hljs-number">1</span>) {
        a.push(Element.extend(c))
      }
      c = c.nextSibling
    }
    <span class="hljs-keyword">return</span> a
  },
  <span class="hljs-attr">previousSiblings</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a, b</span>) </span>{
    <span class="hljs-keyword">return</span> Element.recursivelyCollect(a, <span class="hljs-string">"previousSibling"</span>)
  },
  <span class="hljs-attr">nextSiblings</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
    <span class="hljs-keyword">return</span> Element.recursivelyCollect(a, <span class="hljs-string">"nextSibling"</span>)
  },
  <span class="hljs-attr">siblings</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
    a = $(a);
    <span class="hljs-keyword">return</span> Element.previousSiblings(a).reverse().concat(Element.nextSiblings(a))
  },
  <span class="hljs-attr">match</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">b, a</span>) </span>{
    b = $(b);
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.isString(a)) {
      <span class="hljs-keyword">return</span> Prototype.Selector.match(b, a)
    }
    <span class="hljs-keyword">return</span> a.match(b)
  },
  <span class="hljs-attr">up</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">b, d, a</span>) </span>{
    b = $(b);
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">arguments</span>.length == <span class="hljs-number">1</span>) {
      <span class="hljs-keyword">return</span> $(b.parentNode)
    }
    <span class="hljs-keyword">var</span> c = Element.ancestors(b);
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">Object</span>.isNumber(d) ? c[d] : Prototype.Selector.find(c, d, a)
  },
  <span class="hljs-attr">down</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">b, c, a</span>) </span>{
    b = $(b);
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">arguments</span>.length == <span class="hljs-number">1</span>) {
      <span class="hljs-keyword">return</span> Element.firstDescendant(b)
    }
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">Object</span>.isNumber(c) ? Element.descendants(b)[c] : Element.select(b, c)[a || <span class="hljs-number">0</span>]
  },
  <span class="hljs-attr">previous</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">b, c, a</span>) </span>{
    b = $(b);
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.isNumber(c)) {
      a = c, c = <span class="hljs-literal">false</span>
    }
    <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">Object</span>.isNumber(a)) {
      a = <span class="hljs-number">0</span>
    }
    <span class="hljs-keyword">if</span> (c) {
      <span class="hljs-keyword">return</span> Prototype.Selector.find(b.previousSiblings(), c, a)
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">return</span> b.recursivelyCollect(<span class="hljs-string">"previousSibling"</span>, a + <span class="hljs-number">1</span>)[a]
    }
  },
  <span class="hljs-attr">next</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">b, d, a</span>) </span>{
    b = $(b);
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.isNumber(d)) {
      a = d, d = <span class="hljs-literal">false</span>
    }
    <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">Object</span>.isNumber(a)) {
      a = <span class="hljs-number">0</span>
    }
    <span class="hljs-keyword">if</span> (d) {
      <span class="hljs-keyword">return</span> Prototype.Selector.find(b.nextSiblings(), d, a)
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">var</span> c = <span class="hljs-built_in">Object</span>.isNumber(a) ? a + <span class="hljs-number">1</span> : <span class="hljs-number">1</span>;
      <span class="hljs-keyword">return</span> b.recursivelyCollect(<span class="hljs-string">"nextSibling"</span>, a + <span class="hljs-number">1</span>)[a]
    }
  },
  <span class="hljs-attr">select</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
    a = $(a);
    <span class="hljs-keyword">var</span> b = <span class="hljs-built_in">Array</span>.prototype.slice.call(<span class="hljs-built_in">arguments</span>, <span class="hljs-number">1</span>).join(<span class="hljs-string">", "</span>);
    <span class="hljs-keyword">return</span> Prototype.Selector.select(b, a)
  },
  <span class="hljs-attr">adjacent</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
    a = $(a);
    <span class="hljs-keyword">var</span> b = <span class="hljs-built_in">Array</span>.prototype.slice.call(<span class="hljs-built_in">arguments</span>, <span class="hljs-number">1</span>).join(<span class="hljs-string">", "</span>);
    <span class="hljs-keyword">return</span> Prototype.Selector.select(b, a.parentNode).without(a)
  },
  <span class="hljs-attr">identify</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
    a = $(a);
    <span class="hljs-keyword">var</span> b = Element.readAttribute(a, <span class="hljs-string">"id"</span>);
    <span class="hljs-keyword">if</span> (b) {
      <span class="hljs-keyword">return</span> b
    }
    <span class="hljs-keyword">do</span> {
      b = <span class="hljs-string">"anonymous_element_"</span> + Element.idCounter++
    } <span class="hljs-keyword">while</span> ($(b));
    Element.writeAttribute(a, <span class="hljs-string">"id"</span>, b);
    <span class="hljs-keyword">return</span> b
  },
  <span class="hljs-attr">readAttribute</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">c, a</span>) </span>{
    c = $(c);
    <span class="hljs-keyword">if</span> (Prototype.Browser.IE) {
      <span class="hljs-keyword">var</span> b = Element._attributeTranslations.read;
      <span class="hljs-keyword">if</span> (b.values[a]) {
        <span class="hljs-keyword">return</span> b.values[a](c, a)
      }
      <span class="hljs-keyword">if</span> (b.names[a]) {
        a = b.names[a]
      }
      <span class="hljs-keyword">if</span> (a.include(<span class="hljs-string">":"</span>)) {
        <span class="hljs-keyword">return</span> (!c.attributes || !c.attributes[a]) ? <span class="hljs-literal">null</span> : c.attributes[a].value
      }
    }
    <span class="hljs-keyword">return</span> c.getAttribute(a)
  },
  <span class="hljs-attr">writeAttribute</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e, c, f</span>) </span>{
    e = $(e);
    <span class="hljs-keyword">var</span> b = {},
      d = Element._attributeTranslations.write;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> c == <span class="hljs-string">"object"</span>) {
      b = c
    } <span class="hljs-keyword">else</span> {
      b[c] = <span class="hljs-built_in">Object</span>.isUndefined(f) ? <span class="hljs-literal">true</span> : f
    }
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> a <span class="hljs-keyword">in</span> b) {
      c = d.names[a] || a;
      f = b[a];
      <span class="hljs-keyword">if</span> (d.values[a]) {
        c = d.values[a](e, f)
      }
      <span class="hljs-keyword">if</span> (f === <span class="hljs-literal">false</span> || f === <span class="hljs-literal">null</span>) {
        e.removeAttribute(c)
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">if</span> (f === <span class="hljs-literal">true</span>) {
          e.setAttribute(c, c)
        } <span class="hljs-keyword">else</span> {
          e.setAttribute(c, f)
        }
      }
    }
    <span class="hljs-keyword">return</span> e
  },
  <span class="hljs-attr">getHeight</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
    <span class="hljs-keyword">return</span> Element.getDimensions(a).height
  },
  <span class="hljs-attr">getWidth</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
    <span class="hljs-keyword">return</span> Element.getDimensions(a).width
  },
  <span class="hljs-attr">classNames</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Element.ClassNames(a)
  },
  <span class="hljs-attr">hasClassName</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a, b</span>) </span>{
    <span class="hljs-keyword">if</span> (!(a = $(a))) {
      <span class="hljs-keyword">return</span>
    }
    <span class="hljs-keyword">var</span> c = a.className;
    <span class="hljs-keyword">return</span> (c.length &gt; <span class="hljs-number">0</span> &amp;&amp; (c == b || <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(<span class="hljs-string">"(^|\\s)"</span> + b + <span class="hljs-string">"(\\s|$)"</span>).test(c)))
  },
  <span class="hljs-attr">addClassName</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a, b</span>) </span>{
    <span class="hljs-keyword">if</span> (!(a = $(a))) {
      <span class="hljs-keyword">return</span>
    }
    <span class="hljs-keyword">if</span> (!Element.hasClassName(a, b)) {
      a.className += (a.className ? <span class="hljs-string">" "</span> : <span class="hljs-string">""</span>) + b
    }
    <span class="hljs-keyword">return</span> a
  },
  <span class="hljs-attr">removeClassName</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a, b</span>) </span>{
    <span class="hljs-keyword">if</span> (!(a = $(a))) {
      <span class="hljs-keyword">return</span>
    }
    a.className = a.className.replace(<span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(<span class="hljs-string">"(^|\\s+)"</span> + b + <span class="hljs-string">"(\\s+|$)"</span>), <span class="hljs-string">" "</span>).strip();
    <span class="hljs-keyword">return</span> a
  },
  <span class="hljs-attr">toggleClassName</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a, b</span>) </span>{
    <span class="hljs-keyword">if</span> (!(a = $(a))) {
      <span class="hljs-keyword">return</span>
    }
    <span class="hljs-keyword">return</span> Element[Element.hasClassName(a, b) ? <span class="hljs-string">"removeClassName"</span> : <span class="hljs-string">"addClassName"</span>](a, b)
  },
  <span class="hljs-attr">cleanWhitespace</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">b</span>) </span>{
    b = $(b);
    <span class="hljs-keyword">var</span> c = b.firstChild;
    <span class="hljs-keyword">while</span> (c) {
      <span class="hljs-keyword">var</span> a = c.nextSibling;
      <span class="hljs-keyword">if</span> (c.nodeType == <span class="hljs-number">3</span> &amp;&amp; !<span class="hljs-regexp">/\S/</span>.test(c.nodeValue)) {
        b.removeChild(c)
      }
      c = a
    }
    <span class="hljs-keyword">return</span> b
  },
  <span class="hljs-attr">empty</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
    <span class="hljs-keyword">return</span> $(a).innerHTML.blank()
  },
  <span class="hljs-attr">descendantOf</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">b, a</span>) </span>{
    b = $(b), a = $(a);
    <span class="hljs-keyword">if</span> (b.compareDocumentPosition) {
      <span class="hljs-keyword">return</span> (b.compareDocumentPosition(a) &amp; <span class="hljs-number">8</span>) === <span class="hljs-number">8</span>
    }
    <span class="hljs-keyword">if</span> (a.contains) {
      <span class="hljs-keyword">return</span> a.contains(b) &amp;&amp; a !== b
    }
    <span class="hljs-keyword">while</span> (b = b.parentNode) {
      <span class="hljs-keyword">if</span> (b == a) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
      }
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
  },
  <span class="hljs-attr">scrollTo</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
    a = $(a);
    <span class="hljs-keyword">var</span> b = Element.cumulativeOffset(a);
    <span class="hljs-built_in">window</span>.scrollTo(b[<span class="hljs-number">0</span>], b[<span class="hljs-number">1</span>]);
    <span class="hljs-keyword">return</span> a
  },
  <span class="hljs-attr">getStyle</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">b, c</span>) </span>{
    b = $(b);
    c = c == <span class="hljs-string">"float"</span> ? <span class="hljs-string">"cssFloat"</span> : c.camelize();
    <span class="hljs-keyword">var</span> d = b.style[c];
    <span class="hljs-keyword">if</span> (!d || d == <span class="hljs-string">"auto"</span>) {
      <span class="hljs-keyword">var</span> a = <span class="hljs-built_in">document</span>.defaultView.getComputedStyle(b, <span class="hljs-literal">null</span>);
      d = a ? a[c] : <span class="hljs-literal">null</span>
    }
    <span class="hljs-keyword">if</span> (c == <span class="hljs-string">"opacity"</span>) {
      <span class="hljs-keyword">return</span> d ? <span class="hljs-built_in">parseFloat</span>(d) : <span class="hljs-number">1</span>
    }
    <span class="hljs-keyword">return</span> d == <span class="hljs-string">"auto"</span> ? <span class="hljs-literal">null</span> : d
  },
  <span class="hljs-attr">getOpacity</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
    <span class="hljs-keyword">return</span> $(a).getStyle(<span class="hljs-string">"opacity"</span>)
  },
  <span class="hljs-attr">setStyle</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">b, c</span>) </span>{
    b = $(b);
    <span class="hljs-keyword">var</span> e = b.style,
      a;
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.isString(c)) {
      b.style.cssText += <span class="hljs-string">";"</span> + c;
      <span class="hljs-keyword">return</span> c.include(<span class="hljs-string">"opacity"</span>) ? b.setOpacity(c.match(<span class="hljs-regexp">/opacity:\s*(\d?\.?\d*)/</span>)[<span class="hljs-number">1</span>]) : b
    }
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> d <span class="hljs-keyword">in</span> c) {
      <span class="hljs-keyword">if</span> (d == <span class="hljs-string">"opacity"</span>) {
        b.setOpacity(c[d])
      } <span class="hljs-keyword">else</span> {
        e[(d == <span class="hljs-string">"float"</span> || d == <span class="hljs-string">"cssFloat"</span>) ? (<span class="hljs-built_in">Object</span>.isUndefined(e.styleFloat) ? <span class="hljs-string">"cssFloat"</span> : <span class="hljs-string">"styleFloat"</span>) : d] = c[d]
      }
    }
    <span class="hljs-keyword">return</span> b
  },
  <span class="hljs-attr">setOpacity</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a, b</span>) </span>{
    a = $(a);
    a.style.opacity = (b == <span class="hljs-number">1</span> || b === <span class="hljs-string">""</span>) ? <span class="hljs-string">""</span> : (b &lt; <span class="hljs-number">0.00001</span>) ? <span class="hljs-number">0</span> : b;
    <span class="hljs-keyword">return</span> a
  },
  <span class="hljs-attr">makePositioned</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
    a = $(a);
    <span class="hljs-keyword">var</span> b = Element.getStyle(a, <span class="hljs-string">"position"</span>);
    <span class="hljs-keyword">if</span> (b == <span class="hljs-string">"static"</span> || !b) {
      a._madePositioned = <span class="hljs-literal">true</span>;
      a.style.position = <span class="hljs-string">"relative"</span>;
      <span class="hljs-keyword">if</span> (Prototype.Browser.Opera) {
        a.style.top = <span class="hljs-number">0</span>;
        a.style.left = <span class="hljs-number">0</span>
      }
    }
    <span class="hljs-keyword">return</span> a
  },
  <span class="hljs-attr">undoPositioned</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
    a = $(a);
    <span class="hljs-keyword">if</span> (a._madePositioned) {
      a._madePositioned = <span class="hljs-literal">undefined</span>;
      a.style.position = a.style.top = a.style.left = a.style.bottom = a.style.right = <span class="hljs-string">""</span>
    }
    <span class="hljs-keyword">return</span> a
  },
  <span class="hljs-attr">makeClipping</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
    a = $(a);
    <span class="hljs-keyword">if</span> (a._overflow) {
      <span class="hljs-keyword">return</span> a
    }
    a._overflow = Element.getStyle(a, <span class="hljs-string">"overflow"</span>) || <span class="hljs-string">"auto"</span>;
    <span class="hljs-keyword">if</span> (a._overflow !== <span class="hljs-string">"hidden"</span>) {
      a.style.overflow = <span class="hljs-string">"hidden"</span>
    }
    <span class="hljs-keyword">return</span> a
  },
  <span class="hljs-attr">undoClipping</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
    a = $(a);
    <span class="hljs-keyword">if</span> (!a._overflow) {
      <span class="hljs-keyword">return</span> a
    }
    a.style.overflow = a._overflow == <span class="hljs-string">"auto"</span> ? <span class="hljs-string">""</span> : a._overflow;
    a._overflow = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">return</span> a
  },
  <span class="hljs-attr">clonePosition</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">b, d</span>) </span>{
    <span class="hljs-keyword">var</span> a = <span class="hljs-built_in">Object</span>.extend({
      <span class="hljs-attr">setLeft</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">setTop</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">setWidth</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">setHeight</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">offsetTop</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">offsetLeft</span>: <span class="hljs-number">0</span>
    }, <span class="hljs-built_in">arguments</span>[<span class="hljs-number">2</span>] || {});
    d = $(d);
    <span class="hljs-keyword">var</span> e = Element.viewportOffset(d),
      f = [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>],
      c = <span class="hljs-literal">null</span>;
    b = $(b);
    <span class="hljs-keyword">if</span> (Element.getStyle(b, <span class="hljs-string">"position"</span>) == <span class="hljs-string">"absolute"</span>) {
      c = Element.getOffsetParent(b);
      f = Element.viewportOffset(c)
    }
    <span class="hljs-keyword">if</span> (c == <span class="hljs-built_in">document</span>.body) {
      f[<span class="hljs-number">0</span>] -= <span class="hljs-built_in">document</span>.body.offsetLeft;
      f[<span class="hljs-number">1</span>] -= <span class="hljs-built_in">document</span>.body.offsetTop
    }
    <span class="hljs-keyword">if</span> (a.setLeft) {
      b.style.left = (e[<span class="hljs-number">0</span>] - f[<span class="hljs-number">0</span>] + a.offsetLeft) + <span class="hljs-string">"px"</span>
    }
    <span class="hljs-keyword">if</span> (a.setTop) {
      b.style.top = (e[<span class="hljs-number">1</span>] - f[<span class="hljs-number">1</span>] + a.offsetTop) + <span class="hljs-string">"px"</span>
    }
    <span class="hljs-keyword">if</span> (a.setWidth) {
      b.style.width = d.offsetWidth + <span class="hljs-string">"px"</span>
    }
    <span class="hljs-keyword">if</span> (a.setHeight) {
      b.style.height = d.offsetHeight + <span class="hljs-string">"px"</span>
    }
    <span class="hljs-keyword">return</span> b
  }
};
<span class="hljs-built_in">Object</span>.extend(Element.Methods, {
  <span class="hljs-attr">getElementsBySelector</span>: Element.Methods.select,
  <span class="hljs-attr">childElements</span>: Element.Methods.immediateDescendants
});
Element._attributeTranslations = {
  <span class="hljs-attr">write</span>: {
    <span class="hljs-attr">names</span>: {
      <span class="hljs-attr">className</span>: <span class="hljs-string">"class"</span>,
      <span class="hljs-attr">htmlFor</span>: <span class="hljs-string">"for"</span>
    },
    <span class="hljs-attr">values</span>: {}
  }
};
<span class="hljs-keyword">if</span> (Prototype.Browser.Opera) {
  Element.Methods.getStyle = Element.Methods.getStyle.wrap(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">d, b, c</span>) </span>{
    <span class="hljs-keyword">switch</span> (c) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">"height"</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-string">"width"</span>:
        <span class="hljs-keyword">if</span> (!Element.visible(b)) {
          <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>
        }
        <span class="hljs-keyword">var</span> e = <span class="hljs-built_in">parseInt</span>(d(b, c), <span class="hljs-number">10</span>);
        <span class="hljs-keyword">if</span> (e !== b[<span class="hljs-string">"offset"</span> + c.capitalize()]) {
          <span class="hljs-keyword">return</span> e + <span class="hljs-string">"px"</span>
        }
        <span class="hljs-keyword">var</span> a;
        <span class="hljs-keyword">if</span> (c === <span class="hljs-string">"height"</span>) {
          a = [<span class="hljs-string">"border-top-width"</span>, <span class="hljs-string">"padding-top"</span>, <span class="hljs-string">"padding-bottom"</span>, <span class="hljs-string">"border-bottom-width"</span>]
        } <span class="hljs-keyword">else</span> {
          a = [<span class="hljs-string">"border-left-width"</span>, <span class="hljs-string">"padding-left"</span>, <span class="hljs-string">"padding-right"</span>, <span class="hljs-string">"border-right-width"</span>]
        }
        <span class="hljs-keyword">return</span> a.inject(e, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">f, g</span>) </span>{
          <span class="hljs-keyword">var</span> h = d(b, g);
          <span class="hljs-keyword">return</span> h === <span class="hljs-literal">null</span> ? f : f - <span class="hljs-built_in">parseInt</span>(h, <span class="hljs-number">10</span>)
        }) + <span class="hljs-string">"px"</span>;
      <span class="hljs-keyword">default</span>:
        <span class="hljs-keyword">return</span> d(b, c)
    }
  });
  Element.Methods.readAttribute = Element.Methods.readAttribute.wrap(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">c, a, b</span>) </span>{
    <span class="hljs-keyword">if</span> (b === <span class="hljs-string">"title"</span>) {
      <span class="hljs-keyword">return</span> a.title
    }
    <span class="hljs-keyword">return</span> c(a, b)
  })
} <span class="hljs-keyword">else</span> {
  <span class="hljs-keyword">if</span> (Prototype.Browser.IE) {
    Element.Methods.getStyle = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a, b</span>) </span>{
      a = $(a);
      b = (b == <span class="hljs-string">"float"</span> || b == <span class="hljs-string">"cssFloat"</span>) ? <span class="hljs-string">"styleFloat"</span> : b.camelize();
      <span class="hljs-keyword">var</span> c = a.style[b];
      <span class="hljs-keyword">if</span> (!c &amp;&amp; a.currentStyle) {
        c = a.currentStyle[b]
      }
      <span class="hljs-keyword">if</span> (b == <span class="hljs-string">"opacity"</span>) {
        <span class="hljs-keyword">if</span> (c = (a.getStyle(<span class="hljs-string">"filter"</span>) || <span class="hljs-string">""</span>).match(<span class="hljs-regexp">/alpha\(opacity=(.*)\)/</span>)) {
          <span class="hljs-keyword">if</span> (c[<span class="hljs-number">1</span>]) {
            <span class="hljs-keyword">return</span> <span class="hljs-built_in">parseFloat</span>(c[<span class="hljs-number">1</span>]) / <span class="hljs-number">100</span>
          }
        }
        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>
      }
      <span class="hljs-keyword">if</span> (c == <span class="hljs-string">"auto"</span>) {
        <span class="hljs-keyword">if</span> ((b == <span class="hljs-string">"width"</span> || b == <span class="hljs-string">"height"</span>) &amp;&amp; (a.getStyle(<span class="hljs-string">"display"</span>) != <span class="hljs-string">"none"</span>)) {
          <span class="hljs-keyword">return</span> a[<span class="hljs-string">"offset"</span> + b.capitalize()] + <span class="hljs-string">"px"</span>
        }
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>
      }
      <span class="hljs-keyword">return</span> c
    };
    Element.Methods.setOpacity = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">b, e</span>) </span>{
      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">f</span>(<span class="hljs-params">g</span>) </span>{
        <span class="hljs-keyword">return</span> g.replace(<span class="hljs-regexp">/alpha\([^\)]*\)/gi</span>, <span class="hljs-string">""</span>)
      }
      b = $(b);
      <span class="hljs-keyword">var</span> a = b.currentStyle;
      <span class="hljs-keyword">if</span> ((a &amp;&amp; !a.hasLayout) || (!a &amp;&amp; b.style.zoom == <span class="hljs-string">"normal"</span>)) {
        b.style.zoom = <span class="hljs-number">1</span>
      }
      <span class="hljs-keyword">var</span> d = b.getStyle(<span class="hljs-string">"filter"</span>),
        c = b.style;
      <span class="hljs-keyword">if</span> (e == <span class="hljs-number">1</span> || e === <span class="hljs-string">""</span>) {
        (d = f(d)) ? c.filter = d: c.removeAttribute(<span class="hljs-string">"filter"</span>);
        <span class="hljs-keyword">return</span> b
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">if</span> (e &lt; <span class="hljs-number">0.00001</span>) {
          e = <span class="hljs-number">0</span>
        }
      }
      c.filter = f(d) + <span class="hljs-string">"alpha(opacity="</span> + (e * <span class="hljs-number">100</span>) + <span class="hljs-string">")"</span>;
      <span class="hljs-keyword">return</span> b
    };
    Element._attributeTranslations = (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> b = <span class="hljs-string">"className"</span>,
        a = <span class="hljs-string">"for"</span>,
        c = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"div"</span>);
      c.setAttribute(b, <span class="hljs-string">"x"</span>);
      <span class="hljs-keyword">if</span> (c.className !== <span class="hljs-string">"x"</span>) {
        c.setAttribute(<span class="hljs-string">"class"</span>, <span class="hljs-string">"x"</span>);
        <span class="hljs-keyword">if</span> (c.className === <span class="hljs-string">"x"</span>) {
          b = <span class="hljs-string">"class"</span>
        }
      }
      c = <span class="hljs-literal">null</span>;
      c = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"label"</span>);
      c.setAttribute(a, <span class="hljs-string">"x"</span>);
      <span class="hljs-keyword">if</span> (c.htmlFor !== <span class="hljs-string">"x"</span>) {
        c.setAttribute(<span class="hljs-string">"htmlFor"</span>, <span class="hljs-string">"x"</span>);
        <span class="hljs-keyword">if</span> (c.htmlFor === <span class="hljs-string">"x"</span>) {
          a = <span class="hljs-string">"htmlFor"</span>
        }
      }
      c = <span class="hljs-literal">null</span>;
      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">read</span>: {
          <span class="hljs-attr">names</span>: {
            <span class="hljs-string">"class"</span>: b,
            <span class="hljs-attr">className</span>: b,
            <span class="hljs-string">"for"</span>: a,
            <span class="hljs-attr">htmlFor</span>: a
          },
          <span class="hljs-attr">values</span>: {
            <span class="hljs-attr">_getAttr</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">d, e</span>) </span>{
              <span class="hljs-keyword">return</span> d.getAttribute(e)
            },
            <span class="hljs-attr">_getAttr2</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">d, e</span>) </span>{
              <span class="hljs-keyword">return</span> d.getAttribute(e, <span class="hljs-number">2</span>)
            },
            <span class="hljs-attr">_getAttrNode</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">d, f</span>) </span>{
              <span class="hljs-keyword">var</span> e = d.getAttributeNode(f);
              <span class="hljs-keyword">return</span> e ? e.value : <span class="hljs-string">""</span>
            },
            <span class="hljs-attr">_getEv</span>: (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
              <span class="hljs-keyword">var</span> d = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"div"</span>),
                g;
              d.onclick = Prototype.emptyFunction;
              <span class="hljs-keyword">var</span> e = d.getAttribute(<span class="hljs-string">"onclick"</span>);
              <span class="hljs-keyword">if</span> (<span class="hljs-built_in">String</span>(e).indexOf(<span class="hljs-string">"{"</span>) &gt; <span class="hljs-number">-1</span>) {
                g = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">f, h</span>) </span>{
                  h = f.getAttribute(h);
                  <span class="hljs-keyword">if</span> (!h) {
                    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>
                  }
                  h = h.toString();
                  h = h.split(<span class="hljs-string">"{"</span>)[<span class="hljs-number">1</span>];
                  h = h.split(<span class="hljs-string">"}"</span>)[<span class="hljs-number">0</span>];
                  <span class="hljs-keyword">return</span> h.strip()
                }
              } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">if</span> (e === <span class="hljs-string">""</span>) {
                  g = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">f, h</span>) </span>{
                    h = f.getAttribute(h);
                    <span class="hljs-keyword">if</span> (!h) {
                      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>
                    }
                    <span class="hljs-keyword">return</span> h.strip()
                  }
                }
              }
              d = <span class="hljs-literal">null</span>;
              <span class="hljs-keyword">return</span> g
            })(),
            <span class="hljs-attr">_flag</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">d, e</span>) </span>{
              <span class="hljs-keyword">return</span> $(d).hasAttribute(e) ? e : <span class="hljs-literal">null</span>
            },
            <span class="hljs-attr">style</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">d</span>) </span>{
              <span class="hljs-keyword">return</span> d.style.cssText.toLowerCase()
            },
            <span class="hljs-attr">title</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">d</span>) </span>{
              <span class="hljs-keyword">return</span> d.title
            }
          }
        }
      }
    })();
    Element._attributeTranslations.write = {
      <span class="hljs-attr">names</span>: <span class="hljs-built_in">Object</span>.extend({
        <span class="hljs-attr">cellpadding</span>: <span class="hljs-string">"cellPadding"</span>,
        <span class="hljs-attr">cellspacing</span>: <span class="hljs-string">"cellSpacing"</span>
      }, Element._attributeTranslations.read.names),
      <span class="hljs-attr">values</span>: {
        <span class="hljs-attr">checked</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a, b</span>) </span>{
          a.checked = !!b
        },
        <span class="hljs-attr">style</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a, b</span>) </span>{
          a.style.cssText = b ? b : <span class="hljs-string">""</span>
        }
      }
    };
    Element._attributeTranslations.has = {};
    $w(<span class="hljs-string">"colSpan rowSpan vAlign dateTime accessKey tabIndex encType maxLength readOnly longDesc frameBorder"</span>).each(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
      Element._attributeTranslations.write.names[a.toLowerCase()] = a;
      Element._attributeTranslations.has[a.toLowerCase()] = a
    });
    (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
      <span class="hljs-built_in">Object</span>.extend(a, {
        <span class="hljs-attr">href</span>: a._getAttr2,
        <span class="hljs-attr">src</span>: a._getAttr2,
        <span class="hljs-attr">type</span>: a._getAttr,
        <span class="hljs-attr">action</span>: a._getAttrNode,
        <span class="hljs-attr">disabled</span>: a._flag,
        <span class="hljs-attr">checked</span>: a._flag,
        <span class="hljs-attr">readonly</span>: a._flag,
        <span class="hljs-attr">multiple</span>: a._flag,
        <span class="hljs-attr">onload</span>: a._getEv,
        <span class="hljs-attr">onunload</span>: a._getEv,
        <span class="hljs-attr">onclick</span>: a._getEv,
        <span class="hljs-attr">ondblclick</span>: a._getEv,
        <span class="hljs-attr">onmousedown</span>: a._getEv,
        <span class="hljs-attr">onmouseup</span>: a._getEv,
        <span class="hljs-attr">onmouseover</span>: a._getEv,
        <span class="hljs-attr">onmousemove</span>: a._getEv,
        <span class="hljs-attr">onmouseout</span>: a._getEv,
        <span class="hljs-attr">onfocus</span>: a._getEv,
        <span class="hljs-attr">onblur</span>: a._getEv,
        <span class="hljs-attr">onkeypress</span>: a._getEv,
        <span class="hljs-attr">onkeydown</span>: a._getEv,
        <span class="hljs-attr">onkeyup</span>: a._getEv,
        <span class="hljs-attr">onsubmit</span>: a._getEv,
        <span class="hljs-attr">onreset</span>: a._getEv,
        <span class="hljs-attr">onselect</span>: a._getEv,
        <span class="hljs-attr">onchange</span>: a._getEv
      })
    })(Element._attributeTranslations.read.values);
    <span class="hljs-keyword">if</span> (Prototype.BrowserFeatures.ElementExtensions) {
      (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">a</span>(<span class="hljs-params">e</span>) </span>{
          <span class="hljs-keyword">var</span> b = e.getElementsByTagName(<span class="hljs-string">"*"</span>),
            d = [];
          <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> c = <span class="hljs-number">0</span>, f; f = b[c]; c++) {
            <span class="hljs-keyword">if</span> (f.tagName !== <span class="hljs-string">"!"</span>) {
              d.push(f)
            }
          }
          <span class="hljs-keyword">return</span> d
        }
        Element.Methods.down = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">c, d, b</span>) </span>{
          c = $(c);
          <span class="hljs-keyword">if</span> (<span class="hljs-built_in">arguments</span>.length == <span class="hljs-number">1</span>) {
            <span class="hljs-keyword">return</span> c.firstDescendant()
          }
          <span class="hljs-keyword">return</span> <span class="hljs-built_in">Object</span>.isNumber(d) ? a(c)[d] : Element.select(c, d)[b || <span class="hljs-number">0</span>]
        }
      })()
    }
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">if</span> (Prototype.Browser.Gecko &amp;&amp; <span class="hljs-regexp">/rv:1\.8\.0/</span>.test(navigator.userAgent)) {
      Element.Methods.setOpacity = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a, b</span>) </span>{
        a = $(a);
        a.style.opacity = (b == <span class="hljs-number">1</span>) ? <span class="hljs-number">0.999999</span> : (b === <span class="hljs-string">""</span>) ? <span class="hljs-string">""</span> : (b &lt; <span class="hljs-number">0.00001</span>) ? <span class="hljs-number">0</span> : b;
        <span class="hljs-keyword">return</span> a
      }
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">if</span> (Prototype.Browser.WebKit) {
        Element.Methods.setOpacity = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a, b</span>) </span>{
          a = $(a);
          a.style.opacity = (b == <span class="hljs-number">1</span> || b === <span class="hljs-string">""</span>) ? <span class="hljs-string">""</span> : (b &lt; <span class="hljs-number">0.00001</span>) ? <span class="hljs-number">0</span> : b;
          <span class="hljs-keyword">if</span> (b == <span class="hljs-number">1</span>) {
            <span class="hljs-keyword">if</span> (a.tagName.toUpperCase() == <span class="hljs-string">"IMG"</span> &amp;&amp; a.width) {
              a.width++;
              a.width--
            } <span class="hljs-keyword">else</span> {
              <span class="hljs-keyword">try</span> {
                <span class="hljs-keyword">var</span> d = <span class="hljs-built_in">document</span>.createTextNode(<span class="hljs-string">" "</span>);
                a.appendChild(d);
                a.removeChild(d)
              } <span class="hljs-keyword">catch</span> (c) {}
            }
          }
          <span class="hljs-keyword">return</span> a
        }
      }
    }
  }
}
<span class="hljs-keyword">if</span> (<span class="hljs-string">"outerHTML"</span> <span class="hljs-keyword">in</span> <span class="hljs-built_in">document</span>.documentElement) {
  Element.Methods.replace = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">c, e</span>) </span>{
    c = $(c);
    <span class="hljs-keyword">if</span> (e &amp;&amp; e.toElement) {
      e = e.toElement()
    }
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.isElement(e)) {
      c.parentNode.replaceChild(e, c);
      <span class="hljs-keyword">return</span> c
    }
    e = <span class="hljs-built_in">Object</span>.toHTML(e);
    <span class="hljs-keyword">var</span> d = c.parentNode,
      b = d.tagName.toUpperCase();
    <span class="hljs-keyword">if</span> (Element._insertionTranslations.tags[b]) {
      <span class="hljs-keyword">var</span> f = c.next(),
        a = Element._getContentFromAnonymousElement(b, e.stripScripts());
      d.removeChild(c);
      <span class="hljs-keyword">if</span> (f) {
        a.each(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">g</span>) </span>{
          d.insertBefore(g, f)
        })
      } <span class="hljs-keyword">else</span> {
        a.each(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">g</span>) </span>{
          d.appendChild(g)
        })
      }
    } <span class="hljs-keyword">else</span> {
      c.outerHTML = e.stripScripts()
    }
    e.evalScripts.bind(e).defer();
    <span class="hljs-keyword">return</span> c
  }
}
Element._returnOffset = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">b, c</span>) </span>{
  <span class="hljs-keyword">var</span> a = [b, c];
  a.left = b;
  a.top = c;
  <span class="hljs-keyword">return</span> a
};
Element._getContentFromAnonymousElement = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e, d, f</span>) </span>{
  <span class="hljs-keyword">var</span> g = <span class="hljs-keyword">new</span> Element(<span class="hljs-string">"div"</span>),
    c = Element._insertionTranslations.tags[e];
  <span class="hljs-keyword">var</span> a = <span class="hljs-literal">false</span>;
  <span class="hljs-keyword">if</span> (c) {
    a = <span class="hljs-literal">true</span>
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">if</span> (f) {
      a = <span class="hljs-literal">true</span>;
      c = [<span class="hljs-string">""</span>, <span class="hljs-string">""</span>, <span class="hljs-number">0</span>]
    }
  }
  <span class="hljs-keyword">if</span> (a) {
    g.innerHTML = <span class="hljs-string">"&amp;nbsp;"</span> + c[<span class="hljs-number">0</span>] + d + c[<span class="hljs-number">1</span>];
    g.removeChild(g.firstChild);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> b = c[<span class="hljs-number">2</span>]; b--;) {
      g = g.firstChild
    }
  } <span class="hljs-keyword">else</span> {
    g.innerHTML = d
  }
  <span class="hljs-keyword">return</span> $A(g.childNodes)
};
Element._insertionTranslations = {
  <span class="hljs-attr">before</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a, b</span>) </span>{
    a.parentNode.insertBefore(b, a)
  },
  <span class="hljs-attr">top</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a, b</span>) </span>{
    a.insertBefore(b, a.firstChild)
  },
  <span class="hljs-attr">bottom</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a, b</span>) </span>{
    a.appendChild(b)
  },
  <span class="hljs-attr">after</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a, b</span>) </span>{
    a.parentNode.insertBefore(b, a.nextSibling)
  },
  <span class="hljs-attr">tags</span>: {
    <span class="hljs-attr">TABLE</span>: [<span class="hljs-string">"&lt;table&gt;"</span>, <span class="hljs-string">"&lt;/table&gt;"</span>, <span class="hljs-number">1</span>],
    <span class="hljs-attr">TBODY</span>: [<span class="hljs-string">"&lt;table&gt;&lt;tbody&gt;"</span>, <span class="hljs-string">"&lt;/tbody&gt;&lt;/table&gt;"</span>, <span class="hljs-number">2</span>],
    <span class="hljs-attr">TR</span>: [<span class="hljs-string">"&lt;table&gt;&lt;tbody&gt;&lt;tr&gt;"</span>, <span class="hljs-string">"&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;"</span>, <span class="hljs-number">3</span>],
    <span class="hljs-attr">TD</span>: [<span class="hljs-string">"&lt;table&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;"</span>, <span class="hljs-string">"&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;"</span>, <span class="hljs-number">4</span>],
    <span class="hljs-attr">SELECT</span>: [<span class="hljs-string">"&lt;select&gt;"</span>, <span class="hljs-string">"&lt;/select&gt;"</span>, <span class="hljs-number">1</span>]
  }
};
(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> a = Element._insertionTranslations.tags;
  <span class="hljs-built_in">Object</span>.extend(a, {
    <span class="hljs-attr">THEAD</span>: a.TBODY,
    <span class="hljs-attr">TFOOT</span>: a.TBODY,
    <span class="hljs-attr">TH</span>: a.TD
  })
})();
Element.Methods.Simulated = {
  <span class="hljs-attr">hasAttribute</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a, c</span>) </span>{
    c = Element._attributeTranslations.has[c] || c;
    <span class="hljs-keyword">var</span> b = $(a).getAttributeNode(c);
    <span class="hljs-keyword">return</span> !!(b &amp;&amp; b.specified)
  }
};
Element.Methods.ByTag = {};
<span class="hljs-built_in">Object</span>.extend(Element, Element.Methods);
(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
  <span class="hljs-keyword">if</span> (!Prototype.BrowserFeatures.ElementExtensions &amp;&amp; a.__proto__) {
    <span class="hljs-built_in">window</span>.HTMLElement = {};
    <span class="hljs-built_in">window</span>.HTMLElement.prototype = a.__proto__;
    Prototype.BrowserFeatures.ElementExtensions = <span class="hljs-literal">true</span>
  }
  a = <span class="hljs-literal">null</span>
})(<span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"div"</span>));
Element.extend = (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">c</span>(<span class="hljs-params">g</span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">window</span>.Element != <span class="hljs-string">"undefined"</span>) {
      <span class="hljs-keyword">var</span> i = <span class="hljs-built_in">window</span>.Element.prototype;
      <span class="hljs-keyword">if</span> (i) {
        <span class="hljs-keyword">var</span> k = <span class="hljs-string">"_"</span> + (<span class="hljs-built_in">Math</span>.random() + <span class="hljs-string">""</span>).slice(<span class="hljs-number">2</span>),
          h = <span class="hljs-built_in">document</span>.createElement(g);
        i[k] = <span class="hljs-string">"x"</span>;
        <span class="hljs-keyword">var</span> j = (h[k] !== <span class="hljs-string">"x"</span>);
        <span class="hljs-keyword">delete</span> i[k];
        h = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">return</span> j
      }
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">b</span>(<span class="hljs-params">h, g</span>) </span>{
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> j <span class="hljs-keyword">in</span> g) {
      <span class="hljs-keyword">var</span> i = g[j];
      <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.isFunction(i) &amp;&amp; !(j <span class="hljs-keyword">in</span> h)) {
        h[j] = i.methodize()
      }
    }
  }
  <span class="hljs-keyword">var</span> d = c(<span class="hljs-string">"object"</span>);
  <span class="hljs-keyword">if</span> (Prototype.BrowserFeatures.SpecificElementExtensions) {
    <span class="hljs-keyword">if</span> (d) {
      <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">h</span>) </span>{
        <span class="hljs-keyword">if</span> (h &amp;&amp; <span class="hljs-keyword">typeof</span> h._extendedByPrototype == <span class="hljs-string">"undefined"</span>) {
          <span class="hljs-keyword">var</span> g = h.tagName;
          <span class="hljs-keyword">if</span> (g &amp;&amp; (<span class="hljs-regexp">/^(?:object|applet|embed)$/i</span>.test(g))) {
            b(h, Element.Methods);
            b(h, Element.Methods.Simulated);
            b(h, Element.Methods.ByTag[g.toUpperCase()])
          }
        }
        <span class="hljs-keyword">return</span> h
      }
    }
    <span class="hljs-keyword">return</span> Prototype.K
  }
  <span class="hljs-keyword">var</span> a = {},
    e = Element.Methods.ByTag;
  <span class="hljs-keyword">var</span> f = <span class="hljs-built_in">Object</span>.extend(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">i</span>) </span>{
    <span class="hljs-keyword">if</span> (!i || <span class="hljs-keyword">typeof</span> i._extendedByPrototype != <span class="hljs-string">"undefined"</span> || i.nodeType != <span class="hljs-number">1</span> || i == <span class="hljs-built_in">window</span>) {
      <span class="hljs-keyword">return</span> i
    }
    <span class="hljs-keyword">var</span> g = <span class="hljs-built_in">Object</span>.clone(a),
      h = i.tagName.toUpperCase();
    <span class="hljs-keyword">if</span> (e[h]) {
      <span class="hljs-built_in">Object</span>.extend(g, e[h])
    }
    b(i, g);
    i._extendedByPrototype = Prototype.emptyFunction;
    <span class="hljs-keyword">return</span> i
  }, {
    <span class="hljs-attr">refresh</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">if</span> (!Prototype.BrowserFeatures.ElementExtensions) {
        <span class="hljs-built_in">Object</span>.extend(a, Element.Methods);
        <span class="hljs-built_in">Object</span>.extend(a, Element.Methods.Simulated)
      }
    }
  });
  f.refresh();
  <span class="hljs-keyword">return</span> f
})();
<span class="hljs-keyword">if</span> (<span class="hljs-built_in">document</span>.documentElement.hasAttribute) {
  Element.hasAttribute = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a, b</span>) </span>{
    <span class="hljs-keyword">return</span> a.hasAttribute(b)
  }
} <span class="hljs-keyword">else</span> {
  Element.hasAttribute = Element.Methods.Simulated.hasAttribute
}
Element.addMethods = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">c</span>) </span>{
  <span class="hljs-keyword">var</span> i = Prototype.BrowserFeatures,
    d = Element.Methods.ByTag;
  <span class="hljs-keyword">if</span> (!c) {
    <span class="hljs-built_in">Object</span>.extend(Form, Form.Methods);
    <span class="hljs-built_in">Object</span>.extend(Form.Element, Form.Element.Methods);
    <span class="hljs-built_in">Object</span>.extend(Element.Methods.ByTag, {
      <span class="hljs-attr">FORM</span>: <span class="hljs-built_in">Object</span>.clone(Form.Methods),
      <span class="hljs-attr">INPUT</span>: <span class="hljs-built_in">Object</span>.clone(Form.Element.Methods),
      <span class="hljs-attr">SELECT</span>: <span class="hljs-built_in">Object</span>.clone(Form.Element.Methods),
      <span class="hljs-attr">TEXTAREA</span>: <span class="hljs-built_in">Object</span>.clone(Form.Element.Methods),
      <span class="hljs-attr">BUTTON</span>: <span class="hljs-built_in">Object</span>.clone(Form.Element.Methods)
    })
  }
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">arguments</span>.length == <span class="hljs-number">2</span>) {
    <span class="hljs-keyword">var</span> b = c;
    c = <span class="hljs-built_in">arguments</span>[<span class="hljs-number">1</span>]
  }
  <span class="hljs-keyword">if</span> (!b) {
    <span class="hljs-built_in">Object</span>.extend(Element.Methods, c || {})
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.isArray(b)) {
      b.each(g)
    } <span class="hljs-keyword">else</span> {
      g(b)
    }
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">g</span>(<span class="hljs-params">k</span>) </span>{
    k = k.toUpperCase();
    <span class="hljs-keyword">if</span> (!Element.Methods.ByTag[k]) {
      Element.Methods.ByTag[k] = {}
    }
    <span class="hljs-built_in">Object</span>.extend(Element.Methods.ByTag[k], c)
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">a</span>(<span class="hljs-params">m, l, k</span>) </span>{
    k = k || <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> o <span class="hljs-keyword">in</span> m) {
      <span class="hljs-keyword">var</span> n = m[o];
      <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">Object</span>.isFunction(n)) {
        <span class="hljs-keyword">continue</span>
      }
      <span class="hljs-keyword">if</span> (!k || !(o <span class="hljs-keyword">in</span> l)) {
        l[o] = n.methodize()
      }
    }
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">e</span>(<span class="hljs-params">n</span>) </span>{
    <span class="hljs-keyword">var</span> k;
    <span class="hljs-keyword">var</span> m = {
      <span class="hljs-attr">OPTGROUP</span>: <span class="hljs-string">"OptGroup"</span>,
      <span class="hljs-attr">TEXTAREA</span>: <span class="hljs-string">"TextArea"</span>,
      <span class="hljs-attr">P</span>: <span class="hljs-string">"Paragraph"</span>,
      <span class="hljs-attr">FIELDSET</span>: <span class="hljs-string">"FieldSet"</span>,
      <span class="hljs-attr">UL</span>: <span class="hljs-string">"UList"</span>,
      <span class="hljs-attr">OL</span>: <span class="hljs-string">"OList"</span>,
      <span class="hljs-attr">DL</span>: <span class="hljs-string">"DList"</span>,
      <span class="hljs-attr">DIR</span>: <span class="hljs-string">"Directory"</span>,
      <span class="hljs-attr">H1</span>: <span class="hljs-string">"Heading"</span>,
      <span class="hljs-attr">H2</span>: <span class="hljs-string">"Heading"</span>,
      <span class="hljs-attr">H3</span>: <span class="hljs-string">"Heading"</span>,
      <span class="hljs-attr">H4</span>: <span class="hljs-string">"Heading"</span>,
      <span class="hljs-attr">H5</span>: <span class="hljs-string">"Heading"</span>,
      <span class="hljs-attr">H6</span>: <span class="hljs-string">"Heading"</span>,
      <span class="hljs-attr">Q</span>: <span class="hljs-string">"Quote"</span>,
      <span class="hljs-attr">INS</span>: <span class="hljs-string">"Mod"</span>,
      <span class="hljs-attr">DEL</span>: <span class="hljs-string">"Mod"</span>,
      <span class="hljs-attr">A</span>: <span class="hljs-string">"Anchor"</span>,
      <span class="hljs-attr">IMG</span>: <span class="hljs-string">"Image"</span>,
      <span class="hljs-attr">CAPTION</span>: <span class="hljs-string">"TableCaption"</span>,
      <span class="hljs-attr">COL</span>: <span class="hljs-string">"TableCol"</span>,
      <span class="hljs-attr">COLGROUP</span>: <span class="hljs-string">"TableCol"</span>,
      <span class="hljs-attr">THEAD</span>: <span class="hljs-string">"TableSection"</span>,
      <span class="hljs-attr">TFOOT</span>: <span class="hljs-string">"TableSection"</span>,
      <span class="hljs-attr">TBODY</span>: <span class="hljs-string">"TableSection"</span>,
      <span class="hljs-attr">TR</span>: <span class="hljs-string">"TableRow"</span>,
      <span class="hljs-attr">TH</span>: <span class="hljs-string">"TableCell"</span>,
      <span class="hljs-attr">TD</span>: <span class="hljs-string">"TableCell"</span>,
      <span class="hljs-attr">FRAMESET</span>: <span class="hljs-string">"FrameSet"</span>,
      <span class="hljs-attr">IFRAME</span>: <span class="hljs-string">"IFrame"</span>
    };
    <span class="hljs-keyword">if</span> (m[n]) {
      k = <span class="hljs-string">"HTML"</span> + m[n] + <span class="hljs-string">"Element"</span>
    }
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>[k]) {
      <span class="hljs-keyword">return</span> <span class="hljs-built_in">window</span>[k]
    }
    k = <span class="hljs-string">"HTML"</span> + n + <span class="hljs-string">"Element"</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>[k]) {
      <span class="hljs-keyword">return</span> <span class="hljs-built_in">window</span>[k]
    }
    k = <span class="hljs-string">"HTML"</span> + n.capitalize() + <span class="hljs-string">"Element"</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>[k]) {
      <span class="hljs-keyword">return</span> <span class="hljs-built_in">window</span>[k]
    }
    <span class="hljs-keyword">var</span> l = <span class="hljs-built_in">document</span>.createElement(n),
      o = l.__proto__ || l.constructor.prototype;
    l = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">return</span> o
  }
  <span class="hljs-keyword">var</span> h = <span class="hljs-built_in">window</span>.HTMLElement ? HTMLElement.prototype : Element.prototype;
  <span class="hljs-keyword">if</span> (i.ElementExtensions) {
    a(Element.Methods, h);
    a(Element.Methods.Simulated, h, <span class="hljs-literal">true</span>)
  }
  <span class="hljs-keyword">if</span> (i.SpecificElementExtensions) {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> j <span class="hljs-keyword">in</span> Element.Methods.ByTag) {
      <span class="hljs-keyword">var</span> f = e(j);
      <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.isUndefined(f)) {
        <span class="hljs-keyword">continue</span>
      }
      a(d[j], f.prototype)
    }
  }
  <span class="hljs-built_in">Object</span>.extend(Element, Element.Methods);
  <span class="hljs-keyword">delete</span> Element.ByTag;
  <span class="hljs-keyword">if</span> (Element.extend.refresh) {
    Element.extend.refresh()
  }
  Element.cache = {}
};
<span class="hljs-built_in">document</span>.viewport = {
  <span class="hljs-attr">getDimensions</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">width</span>: <span class="hljs-keyword">this</span>.getWidth(),
      <span class="hljs-attr">height</span>: <span class="hljs-keyword">this</span>.getHeight()
    }
  },
  <span class="hljs-attr">getScrollOffsets</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> Element._returnOffset(<span class="hljs-built_in">window</span>.pageXOffset || <span class="hljs-built_in">document</span>.documentElement.scrollLeft || <span class="hljs-built_in">document</span>.body.scrollLeft, <span class="hljs-built_in">window</span>.pageYOffset || <span class="hljs-built_in">document</span>.documentElement.scrollTop || <span class="hljs-built_in">document</span>.body.scrollTop)
  }
};
(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">b</span>) </span>{
  <span class="hljs-keyword">var</span> g = Prototype.Browser,
    e = <span class="hljs-built_in">document</span>,
    c, d = {};

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">a</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (g.WebKit &amp;&amp; !e.evaluate) {
      <span class="hljs-keyword">return</span> <span class="hljs-built_in">document</span>
    }
    <span class="hljs-keyword">if</span> (g.Opera &amp;&amp; <span class="hljs-built_in">window</span>.parseFloat(<span class="hljs-built_in">window</span>.opera.version()) &lt; <span class="hljs-number">9.5</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-built_in">document</span>.body
    }
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">document</span>.documentElement
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">f</span>(<span class="hljs-params">h</span>) </span>{
    <span class="hljs-keyword">if</span> (!c) {
      c = a()
    }
    d[h] = <span class="hljs-string">"client"</span> + h;
    b[<span class="hljs-string">"get"</span> + h] = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">return</span> c[d[h]]
    };
    <span class="hljs-keyword">return</span> b[<span class="hljs-string">"get"</span> + h]()
  }
  b.getWidth = f.curry(<span class="hljs-string">"Width"</span>);
  b.getHeight = f.curry(<span class="hljs-string">"Height"</span>)
})(<span class="hljs-built_in">document</span>.viewport);
Element.Storage = {
  <span class="hljs-attr">UID</span>: <span class="hljs-number">1</span>
};
Element.addMethods({
  <span class="hljs-attr">getStorage</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">b</span>) </span>{
    <span class="hljs-keyword">if</span> (!(b = $(b))) {
      <span class="hljs-keyword">return</span>
    }
    <span class="hljs-keyword">var</span> a;
    <span class="hljs-keyword">if</span> (b === <span class="hljs-built_in">window</span>) {
      a = <span class="hljs-number">0</span>
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> b._prototypeUID === <span class="hljs-string">"undefined"</span>) {
        b._prototypeUID = Element.Storage.UID++
      }
      a = b._prototypeUID
    }
    <span class="hljs-keyword">if</span> (!Element.Storage[a]) {
      Element.Storage[a] = $H()
    }
    <span class="hljs-keyword">return</span> Element.Storage[a]
  },
  <span class="hljs-attr">store</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">b, a, c</span>) </span>{
    <span class="hljs-keyword">if</span> (!(b = $(b))) {
      <span class="hljs-keyword">return</span>
    }
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">arguments</span>.length === <span class="hljs-number">2</span>) {
      Element.getStorage(b).update(a)
    } <span class="hljs-keyword">else</span> {
      Element.getStorage(b).set(a, c)
    }
    <span class="hljs-keyword">return</span> b
  },
  <span class="hljs-attr">retrieve</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">c, b, a</span>) </span>{
    <span class="hljs-keyword">if</span> (!(c = $(c))) {
      <span class="hljs-keyword">return</span>
    }
    <span class="hljs-keyword">var</span> e = Element.getStorage(c),
      d = e.get(b);
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.isUndefined(d)) {
      e.set(b, a);
      d = a
    }
    <span class="hljs-keyword">return</span> d
  },
  <span class="hljs-attr">clone</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">c, a</span>) </span>{
    <span class="hljs-keyword">if</span> (!(c = $(c))) {
      <span class="hljs-keyword">return</span>
    }
    <span class="hljs-keyword">var</span> e = c.cloneNode(a);
    e._prototypeUID = <span class="hljs-keyword">void</span> <span class="hljs-number">0</span>;
    <span class="hljs-keyword">if</span> (a) {
      <span class="hljs-keyword">var</span> d = Element.select(e, <span class="hljs-string">"*"</span>),
        b = d.length;
      <span class="hljs-keyword">while</span> (b--) {
        d[b]._prototypeUID = <span class="hljs-keyword">void</span> <span class="hljs-number">0</span>
      }
    }
    <span class="hljs-keyword">return</span> Element.extend(e)
  },
  <span class="hljs-attr">purge</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">c</span>) </span>{
    <span class="hljs-keyword">if</span> (!(c = $(c))) {
      <span class="hljs-keyword">return</span>
    }
    <span class="hljs-keyword">var</span> a = Element._purgeElement;
    a(c);
    <span class="hljs-keyword">var</span> d = c.getElementsByTagName(<span class="hljs-string">"*"</span>),
      b = d.length;
    <span class="hljs-keyword">while</span> (b--) {
      a(d[b])
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>
  }
});
(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">h</span>(<span class="hljs-params">v</span>) </span>{
    <span class="hljs-keyword">var</span> u = v.match(<span class="hljs-regexp">/^(\d+)%?$/i</span>);
    <span class="hljs-keyword">if</span> (!u) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>
    }
    <span class="hljs-keyword">return</span> (<span class="hljs-built_in">Number</span>(u[<span class="hljs-number">1</span>]) / <span class="hljs-number">100</span>)
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">o</span>(<span class="hljs-params">F, G, v</span>) </span>{
    <span class="hljs-keyword">var</span> y = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.isElement(F)) {
      y = F;
      F = y.getStyle(G)
    }
    <span class="hljs-keyword">if</span> (F === <span class="hljs-literal">null</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>
    }
    <span class="hljs-keyword">if</span> ((<span class="hljs-regexp">/^(?:-)?\d+(\.\d+)?(px)?$/i</span>).test(F)) {
      <span class="hljs-keyword">return</span> <span class="hljs-built_in">window</span>.parseFloat(F)
    }
    <span class="hljs-keyword">var</span> A = F.include(<span class="hljs-string">"%"</span>),
      w = (v === <span class="hljs-built_in">document</span>.viewport);
    <span class="hljs-keyword">if</span> (<span class="hljs-regexp">/\d/</span>.test(F) &amp;&amp; y &amp;&amp; y.runtimeStyle &amp;&amp; !(A &amp;&amp; w)) {
      <span class="hljs-keyword">var</span> u = y.style.left,
        E = y.runtimeStyle.left;
      y.runtimeStyle.left = y.currentStyle.left;
      y.style.left = F || <span class="hljs-number">0</span>;
      F = y.style.pixelLeft;
      y.style.left = u;
      y.runtimeStyle.left = E;
      <span class="hljs-keyword">return</span> F
    }
    <span class="hljs-keyword">if</span> (y &amp;&amp; A) {
      v = v || y.parentNode;
      <span class="hljs-keyword">var</span> x = h(F);
      <span class="hljs-keyword">var</span> B = <span class="hljs-literal">null</span>;
      <span class="hljs-keyword">var</span> z = y.getStyle(<span class="hljs-string">"position"</span>);
      <span class="hljs-keyword">var</span> D = G.include(<span class="hljs-string">"left"</span>) || G.include(<span class="hljs-string">"right"</span>) || G.include(<span class="hljs-string">"width"</span>);
      <span class="hljs-keyword">var</span> C = G.include(<span class="hljs-string">"top"</span>) || G.include(<span class="hljs-string">"bottom"</span>) || G.include(<span class="hljs-string">"height"</span>);
      <span class="hljs-keyword">if</span> (v === <span class="hljs-built_in">document</span>.viewport) {
        <span class="hljs-keyword">if</span> (D) {
          B = <span class="hljs-built_in">document</span>.viewport.getWidth()
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">if</span> (C) {
            B = <span class="hljs-built_in">document</span>.viewport.getHeight()
          }
        }
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">if</span> (D) {
          B = $(v).measure(<span class="hljs-string">"width"</span>)
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">if</span> (C) {
            B = $(v).measure(<span class="hljs-string">"height"</span>)
          }
        }
      }
      <span class="hljs-keyword">return</span> (B === <span class="hljs-literal">null</span>) ? <span class="hljs-number">0</span> : B * x
    }
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">g</span>(<span class="hljs-params">u</span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.isString(u) &amp;&amp; u.endsWith(<span class="hljs-string">"px"</span>)) {
      <span class="hljs-keyword">return</span> u
    }
    <span class="hljs-keyword">return</span> u + <span class="hljs-string">"px"</span>
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">j</span>(<span class="hljs-params">v</span>) </span>{
    <span class="hljs-keyword">var</span> u = v;
    <span class="hljs-keyword">while</span> (v &amp;&amp; v.parentNode) {
      <span class="hljs-keyword">var</span> w = v.getStyle(<span class="hljs-string">"display"</span>);
      <span class="hljs-keyword">if</span> (w === <span class="hljs-string">"none"</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
      }
      v = $(v.parentNode)
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
  }
  <span class="hljs-keyword">var</span> d = Prototype.K;
  <span class="hljs-keyword">if</span> (<span class="hljs-string">"currentStyle"</span> <span class="hljs-keyword">in</span> <span class="hljs-built_in">document</span>.documentElement) {
    d = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">u</span>) </span>{
      <span class="hljs-keyword">if</span> (!u.currentStyle.hasLayout) {
        u.style.zoom = <span class="hljs-number">1</span>
      }
      <span class="hljs-keyword">return</span> u
    }
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">f</span>(<span class="hljs-params">u</span>) </span>{
    <span class="hljs-keyword">if</span> (u.include(<span class="hljs-string">"border"</span>)) {
      u = u + <span class="hljs-string">"-width"</span>
    }
    <span class="hljs-keyword">return</span> u.camelize()
  }
  Element.Layout = Class.create(Hash, {
    <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$super, v, u</span>) </span>{
      $<span class="hljs-keyword">super</span>();
      <span class="hljs-keyword">this</span>.element = $(v);
      Element.Layout.PROPERTIES.each(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">w</span>) </span>{
        <span class="hljs-keyword">this</span>._set(w, <span class="hljs-literal">null</span>)
      }, <span class="hljs-keyword">this</span>);
      <span class="hljs-keyword">if</span> (u) {
        <span class="hljs-keyword">this</span>._preComputing = <span class="hljs-literal">true</span>;
        <span class="hljs-keyword">this</span>._begin();
        Element.Layout.PROPERTIES.each(<span class="hljs-keyword">this</span>._compute, <span class="hljs-keyword">this</span>);
        <span class="hljs-keyword">this</span>._end();
        <span class="hljs-keyword">this</span>._preComputing = <span class="hljs-literal">false</span>
      }
    },
    <span class="hljs-attr">_set</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">v, u</span>) </span>{
      <span class="hljs-keyword">return</span> Hash.prototype.set.call(<span class="hljs-keyword">this</span>, v, u)
    },
    <span class="hljs-attr">set</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">v, u</span>) </span>{
      <span class="hljs-keyword">throw</span> <span class="hljs-string">"Properties of Element.Layout are read-only."</span>
    },
    <span class="hljs-attr">get</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$super, v</span>) </span>{
      <span class="hljs-keyword">var</span> u = $<span class="hljs-keyword">super</span>(v);
      <span class="hljs-keyword">return</span> u === <span class="hljs-literal">null</span> ? <span class="hljs-keyword">this</span>._compute(v) : u
    },
    <span class="hljs-attr">_begin</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._prepared) {
        <span class="hljs-keyword">return</span>
      }
      <span class="hljs-keyword">var</span> y = <span class="hljs-keyword">this</span>.element;
      <span class="hljs-keyword">if</span> (j(y)) {
        <span class="hljs-keyword">this</span>._prepared = <span class="hljs-literal">true</span>;
        <span class="hljs-keyword">return</span>
      }
      <span class="hljs-keyword">var</span> A = {
        <span class="hljs-attr">position</span>: y.style.position || <span class="hljs-string">""</span>,
        <span class="hljs-attr">width</span>: y.style.width || <span class="hljs-string">""</span>,
        <span class="hljs-attr">visibility</span>: y.style.visibility || <span class="hljs-string">""</span>,
        <span class="hljs-attr">display</span>: y.style.display || <span class="hljs-string">""</span>
      };
      y.store(<span class="hljs-string">"prototype_original_styles"</span>, A);
      <span class="hljs-keyword">var</span> B = y.getStyle(<span class="hljs-string">"position"</span>),
        u = y.getStyle(<span class="hljs-string">"width"</span>);
      <span class="hljs-keyword">if</span> (u === <span class="hljs-string">"0px"</span> || u === <span class="hljs-literal">null</span>) {
        y.style.display = <span class="hljs-string">"block"</span>;
        u = y.getStyle(<span class="hljs-string">"width"</span>)
      }
      <span class="hljs-keyword">var</span> v = (B === <span class="hljs-string">"fixed"</span>) ? <span class="hljs-built_in">document</span>.viewport : y.parentNode;
      y.setStyle({
        <span class="hljs-attr">position</span>: <span class="hljs-string">"absolute"</span>,
        <span class="hljs-attr">visibility</span>: <span class="hljs-string">"hidden"</span>,
        <span class="hljs-attr">display</span>: <span class="hljs-string">"block"</span>
      });
      <span class="hljs-keyword">var</span> w = y.getStyle(<span class="hljs-string">"width"</span>);
      <span class="hljs-keyword">var</span> x;
      <span class="hljs-keyword">if</span> (u &amp;&amp; (w === u)) {
        x = o(y, <span class="hljs-string">"width"</span>, v)
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">if</span> (B === <span class="hljs-string">"absolute"</span> || B === <span class="hljs-string">"fixed"</span>) {
          x = o(y, <span class="hljs-string">"width"</span>, v)
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">var</span> C = y.parentNode,
            z = $(C).getLayout();
          x = z.get(<span class="hljs-string">"width"</span>) - <span class="hljs-keyword">this</span>.get(<span class="hljs-string">"margin-left"</span>) - <span class="hljs-keyword">this</span>.get(<span class="hljs-string">"border-left"</span>) - <span class="hljs-keyword">this</span>.get(<span class="hljs-string">"padding-left"</span>) - <span class="hljs-keyword">this</span>.get(<span class="hljs-string">"padding-right"</span>) - <span class="hljs-keyword">this</span>.get(<span class="hljs-string">"border-right"</span>) - <span class="hljs-keyword">this</span>.get(<span class="hljs-string">"margin-right"</span>)
        }
      }
      y.setStyle({
        <span class="hljs-attr">width</span>: x + <span class="hljs-string">"px"</span>
      });
      <span class="hljs-keyword">this</span>._prepared = <span class="hljs-literal">true</span>
    },
    <span class="hljs-attr">_end</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> v = <span class="hljs-keyword">this</span>.element;
      <span class="hljs-keyword">var</span> u = v.retrieve(<span class="hljs-string">"prototype_original_styles"</span>);
      v.store(<span class="hljs-string">"prototype_original_styles"</span>, <span class="hljs-literal">null</span>);
      v.setStyle(u);
      <span class="hljs-keyword">this</span>._prepared = <span class="hljs-literal">false</span>
    },
    <span class="hljs-attr">_compute</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">v</span>) </span>{
      <span class="hljs-keyword">var</span> u = Element.Layout.COMPUTATIONS;
      <span class="hljs-keyword">if</span> (!(v <span class="hljs-keyword">in</span> u)) {
        <span class="hljs-keyword">throw</span> <span class="hljs-string">"Property not found."</span>
      }
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._set(v, u[v].call(<span class="hljs-keyword">this</span>, <span class="hljs-keyword">this</span>.element))
    },
    <span class="hljs-attr">toObject</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> u = $A(<span class="hljs-built_in">arguments</span>);
      <span class="hljs-keyword">var</span> v = (u.length === <span class="hljs-number">0</span>) ? Element.Layout.PROPERTIES : u.join(<span class="hljs-string">" "</span>).split(<span class="hljs-string">" "</span>);
      <span class="hljs-keyword">var</span> w = {};
      v.each(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">x</span>) </span>{
        <span class="hljs-keyword">if</span> (!Element.Layout.PROPERTIES.include(x)) {
          <span class="hljs-keyword">return</span>
        }
        <span class="hljs-keyword">var</span> y = <span class="hljs-keyword">this</span>.get(x);
        <span class="hljs-keyword">if</span> (y != <span class="hljs-literal">null</span>) {
          w[x] = y
        }
      }, <span class="hljs-keyword">this</span>);
      <span class="hljs-keyword">return</span> w
    },
    <span class="hljs-attr">toHash</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> u = <span class="hljs-keyword">this</span>.toObject.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Hash(u)
    },
    <span class="hljs-attr">toCSS</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> u = $A(<span class="hljs-built_in">arguments</span>);
      <span class="hljs-keyword">var</span> w = (u.length === <span class="hljs-number">0</span>) ? Element.Layout.PROPERTIES : u.join(<span class="hljs-string">" "</span>).split(<span class="hljs-string">" "</span>);
      <span class="hljs-keyword">var</span> v = {};
      w.each(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">x</span>) </span>{
        <span class="hljs-keyword">if</span> (!Element.Layout.PROPERTIES.include(x)) {
          <span class="hljs-keyword">return</span>
        }
        <span class="hljs-keyword">if</span> (Element.Layout.COMPOSITE_PROPERTIES.include(x)) {
          <span class="hljs-keyword">return</span>
        }
        <span class="hljs-keyword">var</span> y = <span class="hljs-keyword">this</span>.get(x);
        <span class="hljs-keyword">if</span> (y != <span class="hljs-literal">null</span>) {
          v[f(x)] = y + <span class="hljs-string">"px"</span>
        }
      }, <span class="hljs-keyword">this</span>);
      <span class="hljs-keyword">return</span> v
    },
    <span class="hljs-attr">inspect</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-string">"#&lt;Element.Layout&gt;"</span>
    }
  });
  <span class="hljs-built_in">Object</span>.extend(Element.Layout, {
    <span class="hljs-attr">PROPERTIES</span>: $w(<span class="hljs-string">"height width top left right bottom border-left border-right border-top border-bottom padding-left padding-right padding-top padding-bottom margin-top margin-bottom margin-left margin-right padding-box-width padding-box-height border-box-width border-box-height margin-box-width margin-box-height"</span>),
    <span class="hljs-attr">COMPOSITE_PROPERTIES</span>: $w(<span class="hljs-string">"padding-box-width padding-box-height margin-box-width margin-box-height border-box-width border-box-height"</span>),
    <span class="hljs-attr">COMPUTATIONS</span>: {
      <span class="hljs-attr">height</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">w</span>) </span>{
        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>._preComputing) {
          <span class="hljs-keyword">this</span>._begin()
        }
        <span class="hljs-keyword">var</span> u = <span class="hljs-keyword">this</span>.get(<span class="hljs-string">"border-box-height"</span>);
        <span class="hljs-keyword">if</span> (u &lt;= <span class="hljs-number">0</span>) {
          <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>._preComputing) {
            <span class="hljs-keyword">this</span>._end()
          }
          <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>
        }
        <span class="hljs-keyword">var</span> x = <span class="hljs-keyword">this</span>.get(<span class="hljs-string">"border-top"</span>),
          v = <span class="hljs-keyword">this</span>.get(<span class="hljs-string">"border-bottom"</span>);
        <span class="hljs-keyword">var</span> z = <span class="hljs-keyword">this</span>.get(<span class="hljs-string">"padding-top"</span>),
          y = <span class="hljs-keyword">this</span>.get(<span class="hljs-string">"padding-bottom"</span>);
        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>._preComputing) {
          <span class="hljs-keyword">this</span>._end()
        }
        <span class="hljs-keyword">return</span> u - x - v - z - y
      },
      <span class="hljs-attr">width</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">w</span>) </span>{
        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>._preComputing) {
          <span class="hljs-keyword">this</span>._begin()
        }
        <span class="hljs-keyword">var</span> v = <span class="hljs-keyword">this</span>.get(<span class="hljs-string">"border-box-width"</span>);
        <span class="hljs-keyword">if</span> (v &lt;= <span class="hljs-number">0</span>) {
          <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>._preComputing) {
            <span class="hljs-keyword">this</span>._end()
          }
          <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>
        }
        <span class="hljs-keyword">var</span> z = <span class="hljs-keyword">this</span>.get(<span class="hljs-string">"border-left"</span>),
          u = <span class="hljs-keyword">this</span>.get(<span class="hljs-string">"border-right"</span>);
        <span class="hljs-keyword">var</span> x = <span class="hljs-keyword">this</span>.get(<span class="hljs-string">"padding-left"</span>),
          y = <span class="hljs-keyword">this</span>.get(<span class="hljs-string">"padding-right"</span>);
        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>._preComputing) {
          <span class="hljs-keyword">this</span>._end()
        }
        <span class="hljs-keyword">return</span> v - z - u - x - y
      },
      <span class="hljs-string">"padding-box-height"</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">v</span>) </span>{
        <span class="hljs-keyword">var</span> u = <span class="hljs-keyword">this</span>.get(<span class="hljs-string">"height"</span>),
          x = <span class="hljs-keyword">this</span>.get(<span class="hljs-string">"padding-top"</span>),
          w = <span class="hljs-keyword">this</span>.get(<span class="hljs-string">"padding-bottom"</span>);
        <span class="hljs-keyword">return</span> u + x + w
      },
      <span class="hljs-string">"padding-box-width"</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">u</span>) </span>{
        <span class="hljs-keyword">var</span> v = <span class="hljs-keyword">this</span>.get(<span class="hljs-string">"width"</span>),
          w = <span class="hljs-keyword">this</span>.get(<span class="hljs-string">"padding-left"</span>),
          x = <span class="hljs-keyword">this</span>.get(<span class="hljs-string">"padding-right"</span>);
        <span class="hljs-keyword">return</span> v + w + x
      },
      <span class="hljs-string">"border-box-height"</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">v</span>) </span>{
        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>._preComputing) {
          <span class="hljs-keyword">this</span>._begin()
        }
        <span class="hljs-keyword">var</span> u = v.offsetHeight;
        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>._preComputing) {
          <span class="hljs-keyword">this</span>._end()
        }
        <span class="hljs-keyword">return</span> u
      },
      <span class="hljs-string">"border-box-width"</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">u</span>) </span>{
        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>._preComputing) {
          <span class="hljs-keyword">this</span>._begin()
        }
        <span class="hljs-keyword">var</span> v = u.offsetWidth;
        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>._preComputing) {
          <span class="hljs-keyword">this</span>._end()
        }
        <span class="hljs-keyword">return</span> v
      },
      <span class="hljs-string">"margin-box-height"</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">v</span>) </span>{
        <span class="hljs-keyword">var</span> u = <span class="hljs-keyword">this</span>.get(<span class="hljs-string">"border-box-height"</span>),
          w = <span class="hljs-keyword">this</span>.get(<span class="hljs-string">"margin-top"</span>),
          x = <span class="hljs-keyword">this</span>.get(<span class="hljs-string">"margin-bottom"</span>);
        <span class="hljs-keyword">if</span> (u &lt;= <span class="hljs-number">0</span>) {
          <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>
        }
        <span class="hljs-keyword">return</span> u + w + x
      },
      <span class="hljs-string">"margin-box-width"</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">w</span>) </span>{
        <span class="hljs-keyword">var</span> v = <span class="hljs-keyword">this</span>.get(<span class="hljs-string">"border-box-width"</span>),
          x = <span class="hljs-keyword">this</span>.get(<span class="hljs-string">"margin-left"</span>),
          u = <span class="hljs-keyword">this</span>.get(<span class="hljs-string">"margin-right"</span>);
        <span class="hljs-keyword">if</span> (v &lt;= <span class="hljs-number">0</span>) {
          <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>
        }
        <span class="hljs-keyword">return</span> v + x + u
      },
      <span class="hljs-attr">top</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">u</span>) </span>{
        <span class="hljs-keyword">var</span> v = u.positionedOffset();
        <span class="hljs-keyword">return</span> v.top
      },
      <span class="hljs-attr">bottom</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">u</span>) </span>{
        <span class="hljs-keyword">var</span> x = u.positionedOffset(),
          v = u.getOffsetParent(),
          w = v.measure(<span class="hljs-string">"height"</span>);
        <span class="hljs-keyword">var</span> y = <span class="hljs-keyword">this</span>.get(<span class="hljs-string">"border-box-height"</span>);
        <span class="hljs-keyword">return</span> w - y - x.top
      },
      <span class="hljs-attr">left</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">u</span>) </span>{
        <span class="hljs-keyword">var</span> v = u.positionedOffset();
        <span class="hljs-keyword">return</span> v.left
      },
      <span class="hljs-attr">right</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">w</span>) </span>{
        <span class="hljs-keyword">var</span> y = w.positionedOffset(),
          x = w.getOffsetParent(),
          u = x.measure(<span class="hljs-string">"width"</span>);
        <span class="hljs-keyword">var</span> v = <span class="hljs-keyword">this</span>.get(<span class="hljs-string">"border-box-width"</span>);
        <span class="hljs-keyword">return</span> u - v - y.left
      },
      <span class="hljs-string">"padding-top"</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">u</span>) </span>{
        <span class="hljs-keyword">return</span> o(u, <span class="hljs-string">"paddingTop"</span>)
      },
      <span class="hljs-string">"padding-bottom"</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">u</span>) </span>{
        <span class="hljs-keyword">return</span> o(u, <span class="hljs-string">"paddingBottom"</span>)
      },
      <span class="hljs-string">"padding-left"</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">u</span>) </span>{
        <span class="hljs-keyword">return</span> o(u, <span class="hljs-string">"paddingLeft"</span>)
      },
      <span class="hljs-string">"padding-right"</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">u</span>) </span>{
        <span class="hljs-keyword">return</span> o(u, <span class="hljs-string">"paddingRight"</span>)
      },
      <span class="hljs-string">"border-top"</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">u</span>) </span>{
        <span class="hljs-keyword">return</span> o(u, <span class="hljs-string">"borderTopWidth"</span>)
      },
      <span class="hljs-string">"border-bottom"</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">u</span>) </span>{
        <span class="hljs-keyword">return</span> o(u, <span class="hljs-string">"borderBottomWidth"</span>)
      },
      <span class="hljs-string">"border-left"</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">u</span>) </span>{
        <span class="hljs-keyword">return</span> o(u, <span class="hljs-string">"borderLeftWidth"</span>)
      },
      <span class="hljs-string">"border-right"</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">u</span>) </span>{
        <span class="hljs-keyword">return</span> o(u, <span class="hljs-string">"borderRightWidth"</span>)
      },
      <span class="hljs-string">"margin-top"</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">u</span>) </span>{
        <span class="hljs-keyword">return</span> o(u, <span class="hljs-string">"marginTop"</span>)
      },
      <span class="hljs-string">"margin-bottom"</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">u</span>) </span>{
        <span class="hljs-keyword">return</span> o(u, <span class="hljs-string">"marginBottom"</span>)
      },
      <span class="hljs-string">"margin-left"</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">u</span>) </span>{
        <span class="hljs-keyword">return</span> o(u, <span class="hljs-string">"marginLeft"</span>)
      },
      <span class="hljs-string">"margin-right"</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">u</span>) </span>{
        <span class="hljs-keyword">return</span> o(u, <span class="hljs-string">"marginRight"</span>)
      }
    }
  });
  <span class="hljs-keyword">if</span> (<span class="hljs-string">"getBoundingClientRect"</span> <span class="hljs-keyword">in</span> <span class="hljs-built_in">document</span>.documentElement) {
    <span class="hljs-built_in">Object</span>.extend(Element.Layout.COMPUTATIONS, {
      <span class="hljs-attr">right</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">v</span>) </span>{
        <span class="hljs-keyword">var</span> w = d(v.getOffsetParent());
        <span class="hljs-keyword">var</span> x = v.getBoundingClientRect(),
          u = w.getBoundingClientRect();
        <span class="hljs-keyword">return</span> (u.right - x.right).round()
      },
      <span class="hljs-attr">bottom</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">v</span>) </span>{
        <span class="hljs-keyword">var</span> w = d(v.getOffsetParent());
        <span class="hljs-keyword">var</span> x = v.getBoundingClientRect(),
          u = w.getBoundingClientRect();
        <span class="hljs-keyword">return</span> (u.bottom - x.bottom).round()
      }
    })
  }
  Element.Offset = Class.create({
    <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">v, u</span>) </span>{
      <span class="hljs-keyword">this</span>.left = v.round();
      <span class="hljs-keyword">this</span>.top = u.round();
      <span class="hljs-keyword">this</span>[<span class="hljs-number">0</span>] = <span class="hljs-keyword">this</span>.left;
      <span class="hljs-keyword">this</span>[<span class="hljs-number">1</span>] = <span class="hljs-keyword">this</span>.top
    },
    <span class="hljs-attr">relativeTo</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">u</span>) </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Element.Offset(<span class="hljs-keyword">this</span>.left - u.left, <span class="hljs-keyword">this</span>.top - u.top)
    },
    <span class="hljs-attr">inspect</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-string">"#&lt;Element.Offset left: #{left} top: #{top}&gt;"</span>.interpolate(<span class="hljs-keyword">this</span>)
    },
    <span class="hljs-attr">toString</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-string">"[#{left}, #{top}]"</span>.interpolate(<span class="hljs-keyword">this</span>)
    },
    <span class="hljs-attr">toArray</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">return</span> [<span class="hljs-keyword">this</span>.left, <span class="hljs-keyword">this</span>.top]
    }
  });

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">r</span>(<span class="hljs-params">v, u</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Element.Layout(v, u)
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">b</span>(<span class="hljs-params">u, v</span>) </span>{
    <span class="hljs-keyword">return</span> $(u).getLayout().get(v)
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">n</span>(<span class="hljs-params">v</span>) </span>{
    v = $(v);
    <span class="hljs-keyword">var</span> z = Element.getStyle(v, <span class="hljs-string">"display"</span>);
    <span class="hljs-keyword">if</span> (z &amp;&amp; z !== <span class="hljs-string">"none"</span>) {
      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">width</span>: v.offsetWidth,
        <span class="hljs-attr">height</span>: v.offsetHeight
      }
    }
    <span class="hljs-keyword">var</span> w = v.style;
    <span class="hljs-keyword">var</span> u = {
      <span class="hljs-attr">visibility</span>: w.visibility,
      <span class="hljs-attr">position</span>: w.position,
      <span class="hljs-attr">display</span>: w.display
    };
    <span class="hljs-keyword">var</span> y = {
      <span class="hljs-attr">visibility</span>: <span class="hljs-string">"hidden"</span>,
      <span class="hljs-attr">display</span>: <span class="hljs-string">"block"</span>
    };
    <span class="hljs-keyword">if</span> (u.position !== <span class="hljs-string">"fixed"</span>) {
      y.position = <span class="hljs-string">"absolute"</span>
    }
    Element.setStyle(v, y);
    <span class="hljs-keyword">var</span> x = {
      <span class="hljs-attr">width</span>: v.offsetWidth,
      <span class="hljs-attr">height</span>: v.offsetHeight
    };
    Element.setStyle(v, u);
    <span class="hljs-keyword">return</span> x
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">l</span>(<span class="hljs-params">u</span>) </span>{
    u = $(u);
    <span class="hljs-keyword">if</span> (e(u) || c(u) || m(u) || k(u)) {
      <span class="hljs-keyword">return</span> $(<span class="hljs-built_in">document</span>.body)
    }
    <span class="hljs-keyword">var</span> v = (Element.getStyle(u, <span class="hljs-string">"display"</span>) === <span class="hljs-string">"inline"</span>);
    <span class="hljs-keyword">if</span> (!v &amp;&amp; u.offsetParent) {
      <span class="hljs-keyword">return</span> $(u.offsetParent)
    }
    <span class="hljs-keyword">while</span> ((u = u.parentNode) &amp;&amp; u !== <span class="hljs-built_in">document</span>.body) {
      <span class="hljs-keyword">if</span> (Element.getStyle(u, <span class="hljs-string">"position"</span>) !== <span class="hljs-string">"static"</span>) {
        <span class="hljs-keyword">return</span> k(u) ? $(<span class="hljs-built_in">document</span>.body) : $(u)
      }
    }
    <span class="hljs-keyword">return</span> $(<span class="hljs-built_in">document</span>.body)
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">t</span>(<span class="hljs-params">v</span>) </span>{
    v = $(v);
    <span class="hljs-keyword">var</span> u = <span class="hljs-number">0</span>,
      w = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">if</span> (v.parentNode) {
      <span class="hljs-keyword">do</span> {
        u += v.offsetTop || <span class="hljs-number">0</span>;
        w += v.offsetLeft || <span class="hljs-number">0</span>;
        v = v.offsetParent
      } <span class="hljs-keyword">while</span> (v)
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Element.Offset(w, u)
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">p</span>(<span class="hljs-params">v</span>) </span>{
    v = $(v);
    <span class="hljs-keyword">var</span> w = v.getLayout();
    <span class="hljs-keyword">var</span> u = <span class="hljs-number">0</span>,
      y = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">do</span> {
      u += v.offsetTop || <span class="hljs-number">0</span>;
      y += v.offsetLeft || <span class="hljs-number">0</span>;
      v = v.offsetParent;
      <span class="hljs-keyword">if</span> (v) {
        <span class="hljs-keyword">if</span> (m(v)) {
          <span class="hljs-keyword">break</span>
        }
        <span class="hljs-keyword">var</span> x = Element.getStyle(v, <span class="hljs-string">"position"</span>);
        <span class="hljs-keyword">if</span> (x !== <span class="hljs-string">"static"</span>) {
          <span class="hljs-keyword">break</span>
        }
      }
    } <span class="hljs-keyword">while</span> (v);
    y -= w.get(<span class="hljs-string">"margin-top"</span>);
    u -= w.get(<span class="hljs-string">"margin-left"</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Element.Offset(y, u)
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">a</span>(<span class="hljs-params">v</span>) </span>{
    <span class="hljs-keyword">var</span> u = <span class="hljs-number">0</span>,
      w = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">do</span> {
      u += v.scrollTop || <span class="hljs-number">0</span>;
      w += v.scrollLeft || <span class="hljs-number">0</span>;
      v = v.parentNode
    } <span class="hljs-keyword">while</span> (v);
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Element.Offset(w, u)
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">s</span>(<span class="hljs-params">y</span>) </span>{
    v = $(v);
    <span class="hljs-keyword">var</span> u = <span class="hljs-number">0</span>,
      x = <span class="hljs-number">0</span>,
      w = <span class="hljs-built_in">document</span>.body;
    <span class="hljs-keyword">var</span> v = y;
    <span class="hljs-keyword">do</span> {
      u += v.offsetTop || <span class="hljs-number">0</span>;
      x += v.offsetLeft || <span class="hljs-number">0</span>;
      <span class="hljs-keyword">if</span> (v.offsetParent == w &amp;&amp; Element.getStyle(v, <span class="hljs-string">"position"</span>) == <span class="hljs-string">"absolute"</span>) {
        <span class="hljs-keyword">break</span>
      }
    } <span class="hljs-keyword">while</span> (v = v.offsetParent);
    v = y;
    <span class="hljs-keyword">do</span> {
      <span class="hljs-keyword">if</span> (v != w) {
        u -= v.scrollTop || <span class="hljs-number">0</span>;
        x -= v.scrollLeft || <span class="hljs-number">0</span>
      }
    } <span class="hljs-keyword">while</span> (v = v.parentNode);
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Element.Offset(x, u)
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">q</span>(<span class="hljs-params">u</span>) </span>{
    u = $(u);
    <span class="hljs-keyword">if</span> (Element.getStyle(u, <span class="hljs-string">"position"</span>) === <span class="hljs-string">"absolute"</span>) {
      <span class="hljs-keyword">return</span> u
    }
    <span class="hljs-keyword">var</span> y = l(u);
    <span class="hljs-keyword">var</span> x = u.viewportOffset(),
      v = y.viewportOffset();
    <span class="hljs-keyword">var</span> z = x.relativeTo(v);
    <span class="hljs-keyword">var</span> w = u.getLayout();
    u.store(<span class="hljs-string">"prototype_absolutize_original_styles"</span>, {
      <span class="hljs-attr">left</span>: u.getStyle(<span class="hljs-string">"left"</span>),
      <span class="hljs-attr">top</span>: u.getStyle(<span class="hljs-string">"top"</span>),
      <span class="hljs-attr">width</span>: u.getStyle(<span class="hljs-string">"width"</span>),
      <span class="hljs-attr">height</span>: u.getStyle(<span class="hljs-string">"height"</span>)
    });
    u.setStyle({
      <span class="hljs-attr">position</span>: <span class="hljs-string">"absolute"</span>,
      <span class="hljs-attr">top</span>: z.top + <span class="hljs-string">"px"</span>,
      <span class="hljs-attr">left</span>: z.left + <span class="hljs-string">"px"</span>,
      <span class="hljs-attr">width</span>: w.get(<span class="hljs-string">"width"</span>) + <span class="hljs-string">"px"</span>,
      <span class="hljs-attr">height</span>: w.get(<span class="hljs-string">"height"</span>) + <span class="hljs-string">"px"</span>
    });
    <span class="hljs-keyword">return</span> u
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">i</span>(<span class="hljs-params">v</span>) </span>{
    v = $(v);
    <span class="hljs-keyword">if</span> (Element.getStyle(v, <span class="hljs-string">"position"</span>) === <span class="hljs-string">"relative"</span>) {
      <span class="hljs-keyword">return</span> v
    }
    <span class="hljs-keyword">var</span> u = v.retrieve(<span class="hljs-string">"prototype_absolutize_original_styles"</span>);
    <span class="hljs-keyword">if</span> (u) {
      v.setStyle(u)
    }
    <span class="hljs-keyword">return</span> v
  }
  <span class="hljs-keyword">if</span> (Prototype.Browser.IE) {
    l = l.wrap(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">w, v</span>) </span>{
      v = $(v);
      <span class="hljs-keyword">if</span> (e(v) || c(v) || m(v) || k(v)) {
        <span class="hljs-keyword">return</span> $(<span class="hljs-built_in">document</span>.body)
      }
      <span class="hljs-keyword">var</span> u = v.getStyle(<span class="hljs-string">"position"</span>);
      <span class="hljs-keyword">if</span> (u !== <span class="hljs-string">"static"</span>) {
        <span class="hljs-keyword">return</span> w(v)
      }
      v.setStyle({
        <span class="hljs-attr">position</span>: <span class="hljs-string">"relative"</span>
      });
      <span class="hljs-keyword">var</span> x = w(v);
      v.setStyle({
        <span class="hljs-attr">position</span>: u
      });
      <span class="hljs-keyword">return</span> x
    });
    p = p.wrap(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">x, v</span>) </span>{
      v = $(v);
      <span class="hljs-keyword">if</span> (!v.parentNode) {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Element.Offset(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>)
      }
      <span class="hljs-keyword">var</span> u = v.getStyle(<span class="hljs-string">"position"</span>);
      <span class="hljs-keyword">if</span> (u !== <span class="hljs-string">"static"</span>) {
        <span class="hljs-keyword">return</span> x(v)
      }
      <span class="hljs-keyword">var</span> w = v.getOffsetParent();
      <span class="hljs-keyword">if</span> (w &amp;&amp; w.getStyle(<span class="hljs-string">"position"</span>) === <span class="hljs-string">"fixed"</span>) {
        d(w)
      }
      v.setStyle({
        <span class="hljs-attr">position</span>: <span class="hljs-string">"relative"</span>
      });
      <span class="hljs-keyword">var</span> y = x(v);
      v.setStyle({
        <span class="hljs-attr">position</span>: u
      });
      <span class="hljs-keyword">return</span> y
    })
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">if</span> (Prototype.Browser.Webkit) {
      t = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">v</span>) </span>{
        v = $(v);
        <span class="hljs-keyword">var</span> u = <span class="hljs-number">0</span>,
          w = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">do</span> {
          u += v.offsetTop || <span class="hljs-number">0</span>;
          w += v.offsetLeft || <span class="hljs-number">0</span>;
          <span class="hljs-keyword">if</span> (v.offsetParent == <span class="hljs-built_in">document</span>.body) {
            <span class="hljs-keyword">if</span> (Element.getStyle(v, <span class="hljs-string">"position"</span>) == <span class="hljs-string">"absolute"</span>) {
              <span class="hljs-keyword">break</span>
            }
          }
          v = v.offsetParent
        } <span class="hljs-keyword">while</span> (v);
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Element.Offset(w, u)
      }
    }
  }
  Element.addMethods({
    <span class="hljs-attr">getLayout</span>: r,
    <span class="hljs-attr">measure</span>: b,
    <span class="hljs-attr">getDimensions</span>: n,
    <span class="hljs-attr">getOffsetParent</span>: l,
    <span class="hljs-attr">cumulativeOffset</span>: t,
    <span class="hljs-attr">positionedOffset</span>: p,
    <span class="hljs-attr">cumulativeScrollOffset</span>: a,
    <span class="hljs-attr">viewportOffset</span>: s,
    <span class="hljs-attr">absolutize</span>: q,
    <span class="hljs-attr">relativize</span>: i
  });

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">m</span>(<span class="hljs-params">u</span>) </span>{
    <span class="hljs-keyword">return</span> u.nodeName.toUpperCase() === <span class="hljs-string">"BODY"</span>
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">k</span>(<span class="hljs-params">u</span>) </span>{
    <span class="hljs-keyword">return</span> u.nodeName.toUpperCase() === <span class="hljs-string">"HTML"</span>
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">e</span>(<span class="hljs-params">u</span>) </span>{
    <span class="hljs-keyword">return</span> u.nodeType === Node.DOCUMENT_NODE
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">c</span>(<span class="hljs-params">u</span>) </span>{
    <span class="hljs-keyword">return</span> u !== <span class="hljs-built_in">document</span>.body &amp;&amp; !Element.descendantOf(u, <span class="hljs-built_in">document</span>.body)
  }
  <span class="hljs-keyword">if</span> (<span class="hljs-string">"getBoundingClientRect"</span> <span class="hljs-keyword">in</span> <span class="hljs-built_in">document</span>.documentElement) {
    Element.addMethods({
      <span class="hljs-attr">viewportOffset</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">u</span>) </span>{
        u = $(u);
        <span class="hljs-keyword">if</span> (c(u)) {
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Element.Offset(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>)
        }
        <span class="hljs-keyword">var</span> v = u.getBoundingClientRect(),
          w = <span class="hljs-built_in">document</span>.documentElement;
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Element.Offset(v.left - w.clientLeft, v.top - w.clientTop)
      }
    })
  }
})();
<span class="hljs-built_in">window</span>.$$ = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> a = $A(<span class="hljs-built_in">arguments</span>).join(<span class="hljs-string">", "</span>);
  <span class="hljs-keyword">return</span> Prototype.Selector.select(a, <span class="hljs-built_in">document</span>)
};
Prototype.Selector = (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">a</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'Method "Prototype.Selector.select" must be defined.'</span>)
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">c</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'Method "Prototype.Selector.match" must be defined.'</span>)
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">d</span>(<span class="hljs-params">l, m, h</span>) </span>{
    h = h || <span class="hljs-number">0</span>;
    <span class="hljs-keyword">var</span> g = Prototype.Selector.match,
      k = l.length,
      f = <span class="hljs-number">0</span>,
      j;
    <span class="hljs-keyword">for</span> (j = <span class="hljs-number">0</span>; j &lt; k; j++) {
      <span class="hljs-keyword">if</span> (g(l[j], m) &amp;&amp; h == f++) {
        <span class="hljs-keyword">return</span> Element.extend(l[j])
      }
    }
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">e</span>(<span class="hljs-params">h</span>) </span>{
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> f = <span class="hljs-number">0</span>, g = h.length; f &lt; g; f++) {
      Element.extend(h[f])
    }
    <span class="hljs-keyword">return</span> h
  }
  <span class="hljs-keyword">var</span> b = Prototype.K;
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">select</span>: a,
    <span class="hljs-attr">match</span>: c,
    <span class="hljs-attr">find</span>: d,
    <span class="hljs-attr">extendElements</span>: (Element.extend === b) ? b : e,
    <span class="hljs-attr">extendElement</span>: Element.extend
  }
})();
Prototype._original_property = <span class="hljs-built_in">window</span>.Sizzle;
<span class="hljs-comment">/*!
 * Sizzle CSS Selector Engine - v1.0
 *  Copyright 2009, The Dojo Foundation
 *  Released under the MIT, BSD, and GPL Licenses.
 *  More information: http://sizzlejs.com/
 */</span>
(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> q = <span class="hljs-regexp">/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^[\]]*\]|['"][^'"]*['"]|[^[\]'"]+)+\]|\\.|[^ &gt;+~,(\[\\]+)+|[&gt;+~])(\s*,\s*)?((?:.|\r|\n)*)/g</span>,
    j = <span class="hljs-number">0</span>,
    d = <span class="hljs-built_in">Object</span>.prototype.toString,
    o = <span class="hljs-literal">false</span>,
    i = <span class="hljs-literal">true</span>;
  [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>].sort(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    i = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>
  });
  <span class="hljs-keyword">var</span> b = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">E, u, B, w</span>) </span>{
    B = B || [];
    <span class="hljs-keyword">var</span> e = u = u || <span class="hljs-built_in">document</span>;
    <span class="hljs-keyword">if</span> (u.nodeType !== <span class="hljs-number">1</span> &amp;&amp; u.nodeType !== <span class="hljs-number">9</span>) {
      <span class="hljs-keyword">return</span> []
    }
    <span class="hljs-keyword">if</span> (!E || <span class="hljs-keyword">typeof</span> E !== <span class="hljs-string">"string"</span>) {
      <span class="hljs-keyword">return</span> B
    }
    <span class="hljs-keyword">var</span> C = [],
      D, z, I, H, A, t, s = <span class="hljs-literal">true</span>,
      x = p(u),
      G = E;
    <span class="hljs-keyword">while</span> ((q.exec(<span class="hljs-string">""</span>), D = q.exec(G)) !== <span class="hljs-literal">null</span>) {
      G = D[<span class="hljs-number">3</span>];
      C.push(D[<span class="hljs-number">1</span>]);
      <span class="hljs-keyword">if</span> (D[<span class="hljs-number">2</span>]) {
        t = D[<span class="hljs-number">3</span>];
        <span class="hljs-keyword">break</span>
      }
    }
    <span class="hljs-keyword">if</span> (C.length &gt; <span class="hljs-number">1</span> &amp;&amp; k.exec(E)) {
      <span class="hljs-keyword">if</span> (C.length === <span class="hljs-number">2</span> &amp;&amp; f.relative[C[<span class="hljs-number">0</span>]]) {
        z = g(C[<span class="hljs-number">0</span>] + C[<span class="hljs-number">1</span>], u)
      } <span class="hljs-keyword">else</span> {
        z = f.relative[C[<span class="hljs-number">0</span>]] ? [u] : b(C.shift(), u);
        <span class="hljs-keyword">while</span> (C.length) {
          E = C.shift();
          <span class="hljs-keyword">if</span> (f.relative[E]) {
            E += C.shift()
          }
          z = g(E, z)
        }
      }
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">if</span> (!w &amp;&amp; C.length &gt; <span class="hljs-number">1</span> &amp;&amp; u.nodeType === <span class="hljs-number">9</span> &amp;&amp; !x &amp;&amp; f.match.ID.test(C[<span class="hljs-number">0</span>]) &amp;&amp; !f.match.ID.test(C[C.length - <span class="hljs-number">1</span>])) {
        <span class="hljs-keyword">var</span> J = b.find(C.shift(), u, x);
        u = J.expr ? b.filter(J.expr, J.set)[<span class="hljs-number">0</span>] : J.set[<span class="hljs-number">0</span>]
      }
      <span class="hljs-keyword">if</span> (u) {
        <span class="hljs-keyword">var</span> J = w ? {
          <span class="hljs-attr">expr</span>: C.pop(),
          <span class="hljs-attr">set</span>: a(w)
        } : b.find(C.pop(), C.length === <span class="hljs-number">1</span> &amp;&amp; (C[<span class="hljs-number">0</span>] === <span class="hljs-string">"~"</span> || C[<span class="hljs-number">0</span>] === <span class="hljs-string">"+"</span>) &amp;&amp; u.parentNode ? u.parentNode : u, x);
        z = J.expr ? b.filter(J.expr, J.set) : J.set;
        <span class="hljs-keyword">if</span> (C.length &gt; <span class="hljs-number">0</span>) {
          I = a(z)
        } <span class="hljs-keyword">else</span> {
          s = <span class="hljs-literal">false</span>
        }
        <span class="hljs-keyword">while</span> (C.length) {
          <span class="hljs-keyword">var</span> v = C.pop(),
            y = v;
          <span class="hljs-keyword">if</span> (!f.relative[v]) {
            v = <span class="hljs-string">""</span>
          } <span class="hljs-keyword">else</span> {
            y = C.pop()
          }
          <span class="hljs-keyword">if</span> (y == <span class="hljs-literal">null</span>) {
            y = u
          }
          f.relative[v](I, y, x)
        }
      } <span class="hljs-keyword">else</span> {
        I = C = []
      }
    }
    <span class="hljs-keyword">if</span> (!I) {
      I = z
    }
    <span class="hljs-keyword">if</span> (!I) {
      <span class="hljs-keyword">throw</span> <span class="hljs-string">"Syntax error, unrecognized expression: "</span> + (v || E)
    }
    <span class="hljs-keyword">if</span> (d.call(I) === <span class="hljs-string">"[object Array]"</span>) {
      <span class="hljs-keyword">if</span> (!s) {
        B.push.apply(B, I)
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">if</span> (u &amp;&amp; u.nodeType === <span class="hljs-number">1</span>) {
          <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> F = <span class="hljs-number">0</span>; I[F] != <span class="hljs-literal">null</span>; F++) {
            <span class="hljs-keyword">if</span> (I[F] &amp;&amp; (I[F] === <span class="hljs-literal">true</span> || I[F].nodeType === <span class="hljs-number">1</span> &amp;&amp; h(u, I[F]))) {
              B.push(z[F])
            }
          }
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> F = <span class="hljs-number">0</span>; I[F] != <span class="hljs-literal">null</span>; F++) {
            <span class="hljs-keyword">if</span> (I[F] &amp;&amp; I[F].nodeType === <span class="hljs-number">1</span>) {
              B.push(z[F])
            }
          }
        }
      }
    } <span class="hljs-keyword">else</span> {
      a(I, B)
    }
    <span class="hljs-keyword">if</span> (t) {
      b(t, e, B, w);
      b.uniqueSort(B)
    }
    <span class="hljs-keyword">return</span> B
  };
  b.uniqueSort = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">s</span>) </span>{
    <span class="hljs-keyword">if</span> (c) {
      o = i;
      s.sort(c);
      <span class="hljs-keyword">if</span> (o) {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> e = <span class="hljs-number">1</span>; e &lt; s.length; e++) {
          <span class="hljs-keyword">if</span> (s[e] === s[e - <span class="hljs-number">1</span>]) {
            s.splice(e--, <span class="hljs-number">1</span>)
          }
        }
      }
    }
    <span class="hljs-keyword">return</span> s
  };
  b.matches = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e, s</span>) </span>{
    <span class="hljs-keyword">return</span> b(e, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, s)
  };
  b.find = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">y, e, z</span>) </span>{
    <span class="hljs-keyword">var</span> x, v;
    <span class="hljs-keyword">if</span> (!y) {
      <span class="hljs-keyword">return</span> []
    }
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> u = <span class="hljs-number">0</span>, t = f.order.length; u &lt; t; u++) {
      <span class="hljs-keyword">var</span> w = f.order[u],
        v;
      <span class="hljs-keyword">if</span> ((v = f.leftMatch[w].exec(y))) {
        <span class="hljs-keyword">var</span> s = v[<span class="hljs-number">1</span>];
        v.splice(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>);
        <span class="hljs-keyword">if</span> (s.substr(s.length - <span class="hljs-number">1</span>) !== <span class="hljs-string">"\\"</span>) {
          v[<span class="hljs-number">1</span>] = (v[<span class="hljs-number">1</span>] || <span class="hljs-string">""</span>).replace(<span class="hljs-regexp">/\\/g</span>, <span class="hljs-string">""</span>);
          x = f.find[w](v, e, z);
          <span class="hljs-keyword">if</span> (x != <span class="hljs-literal">null</span>) {
            y = y.replace(f.match[w], <span class="hljs-string">""</span>);
            <span class="hljs-keyword">break</span>
          }
        }
      }
    }
    <span class="hljs-keyword">if</span> (!x) {
      x = e.getElementsByTagName(<span class="hljs-string">"*"</span>)
    }
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">set</span>: x,
      <span class="hljs-attr">expr</span>: y
    }
  };
  b.filter = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">B, A, E, u</span>) </span>{
    <span class="hljs-keyword">var</span> t = B,
      G = [],
      y = A,
      w, e, x = A &amp;&amp; A[<span class="hljs-number">0</span>] &amp;&amp; p(A[<span class="hljs-number">0</span>]);
    <span class="hljs-keyword">while</span> (B &amp;&amp; A.length) {
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> z <span class="hljs-keyword">in</span> f.filter) {
        <span class="hljs-keyword">if</span> ((w = f.match[z].exec(B)) != <span class="hljs-literal">null</span>) {
          <span class="hljs-keyword">var</span> s = f.filter[z],
            F, D;
          e = <span class="hljs-literal">false</span>;
          <span class="hljs-keyword">if</span> (y == G) {
            G = []
          }
          <span class="hljs-keyword">if</span> (f.preFilter[z]) {
            w = f.preFilter[z](w, y, E, G, u, x);
            <span class="hljs-keyword">if</span> (!w) {
              e = F = <span class="hljs-literal">true</span>
            } <span class="hljs-keyword">else</span> {
              <span class="hljs-keyword">if</span> (w === <span class="hljs-literal">true</span>) {
                <span class="hljs-keyword">continue</span>
              }
            }
          }
          <span class="hljs-keyword">if</span> (w) {
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> v = <span class="hljs-number">0</span>;
              (D = y[v]) != <span class="hljs-literal">null</span>; v++) {
              <span class="hljs-keyword">if</span> (D) {
                F = s(D, w, v, y);
                <span class="hljs-keyword">var</span> C = u ^ !!F;
                <span class="hljs-keyword">if</span> (E &amp;&amp; F != <span class="hljs-literal">null</span>) {
                  <span class="hljs-keyword">if</span> (C) {
                    e = <span class="hljs-literal">true</span>
                  } <span class="hljs-keyword">else</span> {
                    y[v] = <span class="hljs-literal">false</span>
                  }
                } <span class="hljs-keyword">else</span> {
                  <span class="hljs-keyword">if</span> (C) {
                    G.push(D);
                    e = <span class="hljs-literal">true</span>
                  }
                }
              }
            }
          }
          <span class="hljs-keyword">if</span> (F !== <span class="hljs-literal">undefined</span>) {
            <span class="hljs-keyword">if</span> (!E) {
              y = G
            }
            B = B.replace(f.match[z], <span class="hljs-string">""</span>);
            <span class="hljs-keyword">if</span> (!e) {
              <span class="hljs-keyword">return</span> []
            }
            <span class="hljs-keyword">break</span>
          }
        }
      }
      <span class="hljs-keyword">if</span> (B == t) {
        <span class="hljs-keyword">if</span> (e == <span class="hljs-literal">null</span>) {
          <span class="hljs-keyword">throw</span> <span class="hljs-string">"Syntax error, unrecognized expression: "</span> + B
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">break</span>
        }
      }
      t = B
    }
    <span class="hljs-keyword">return</span> y
  };
  <span class="hljs-keyword">var</span> f = b.selectors = {
    <span class="hljs-attr">order</span>: [<span class="hljs-string">"ID"</span>, <span class="hljs-string">"NAME"</span>, <span class="hljs-string">"TAG"</span>],
    <span class="hljs-attr">match</span>: {
      <span class="hljs-attr">ID</span>: <span class="hljs-regexp">/#((?:[\w\u00c0-\uFFFF-]|\\.)+)/</span>,
      <span class="hljs-attr">CLASS</span>: <span class="hljs-regexp">/\.((?:[\w\u00c0-\uFFFF-]|\\.)+)/</span>,
      <span class="hljs-attr">NAME</span>: <span class="hljs-regexp">/\[name=['"]*((?:[\w\u00c0-\uFFFF-]|\\.)+)['"]*\]/</span>,
      <span class="hljs-attr">ATTR</span>: <span class="hljs-regexp">/\[\s*((?:[\w\u00c0-\uFFFF-]|\\.)+)\s*(?:(\S?=)\s*(['"]*)(.*?)\3|)\s*\]/</span>,
      <span class="hljs-attr">TAG</span>: <span class="hljs-regexp">/^((?:[\w\u00c0-\uFFFF\*-]|\\.)+)/</span>,
      <span class="hljs-attr">CHILD</span>: <span class="hljs-regexp">/:(only|nth|last|first)-child(?:\((even|odd|[\dn+-]*)\))?/</span>,
      <span class="hljs-attr">POS</span>: <span class="hljs-regexp">/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^-]|$)/</span>,
      <span class="hljs-attr">PSEUDO</span>: <span class="hljs-regexp">/:((?:[\w\u00c0-\uFFFF-]|\\.)+)(?:\((['"]*)((?:\([^\)]+\)|[^\2\(\)]*)+)\2\))?/</span>
    },
    <span class="hljs-attr">leftMatch</span>: {},
    <span class="hljs-attr">attrMap</span>: {
      <span class="hljs-string">"class"</span>: <span class="hljs-string">"className"</span>,
      <span class="hljs-string">"for"</span>: <span class="hljs-string">"htmlFor"</span>
    },
    <span class="hljs-attr">attrHandle</span>: {
      <span class="hljs-attr">href</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
        <span class="hljs-keyword">return</span> e.getAttribute(<span class="hljs-string">"href"</span>)
      }
    },
    <span class="hljs-attr">relative</span>: {
      <span class="hljs-string">"+"</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">y, e, x</span>) </span>{
        <span class="hljs-keyword">var</span> v = <span class="hljs-keyword">typeof</span> e === <span class="hljs-string">"string"</span>,
          z = v &amp;&amp; !<span class="hljs-regexp">/\W/</span>.test(e),
          w = v &amp;&amp; !z;
        <span class="hljs-keyword">if</span> (z &amp;&amp; !x) {
          e = e.toUpperCase()
        }
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> u = <span class="hljs-number">0</span>, t = y.length, s; u &lt; t; u++) {
          <span class="hljs-keyword">if</span> ((s = y[u])) {
            <span class="hljs-keyword">while</span> ((s = s.previousSibling) &amp;&amp; s.nodeType !== <span class="hljs-number">1</span>) {}
            y[u] = w || s &amp;&amp; s.nodeName === e ? s || <span class="hljs-literal">false</span> : s === e
          }
        }
        <span class="hljs-keyword">if</span> (w) {
          b.filter(e, y, <span class="hljs-literal">true</span>)
        }
      },
      <span class="hljs-string">"&gt;"</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">x, s, y</span>) </span>{
        <span class="hljs-keyword">var</span> v = <span class="hljs-keyword">typeof</span> s === <span class="hljs-string">"string"</span>;
        <span class="hljs-keyword">if</span> (v &amp;&amp; !<span class="hljs-regexp">/\W/</span>.test(s)) {
          s = y ? s : s.toUpperCase();
          <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> t = <span class="hljs-number">0</span>, e = x.length; t &lt; e; t++) {
            <span class="hljs-keyword">var</span> w = x[t];
            <span class="hljs-keyword">if</span> (w) {
              <span class="hljs-keyword">var</span> u = w.parentNode;
              x[t] = u.nodeName === s ? u : <span class="hljs-literal">false</span>
            }
          }
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> t = <span class="hljs-number">0</span>, e = x.length; t &lt; e; t++) {
            <span class="hljs-keyword">var</span> w = x[t];
            <span class="hljs-keyword">if</span> (w) {
              x[t] = v ? w.parentNode : w.parentNode === s
            }
          }
          <span class="hljs-keyword">if</span> (v) {
            b.filter(s, x, <span class="hljs-literal">true</span>)
          }
        }
      },
      <span class="hljs-string">""</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">u, s, w</span>) </span>{
        <span class="hljs-keyword">var</span> t = j++,
          e = r;
        <span class="hljs-keyword">if</span> (!<span class="hljs-regexp">/\W/</span>.test(s)) {
          <span class="hljs-keyword">var</span> v = s = w ? s : s.toUpperCase();
          e = n
        }
        e(<span class="hljs-string">"parentNode"</span>, s, t, u, v, w)
      },
      <span class="hljs-string">"~"</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">u, s, w</span>) </span>{
        <span class="hljs-keyword">var</span> t = j++,
          e = r;
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> s === <span class="hljs-string">"string"</span> &amp;&amp; !<span class="hljs-regexp">/\W/</span>.test(s)) {
          <span class="hljs-keyword">var</span> v = s = w ? s : s.toUpperCase();
          e = n
        }
        e(<span class="hljs-string">"previousSibling"</span>, s, t, u, v, w)
      }
    },
    <span class="hljs-attr">find</span>: {
      <span class="hljs-attr">ID</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">s, t, u</span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> t.getElementById !== <span class="hljs-string">"undefined"</span> &amp;&amp; !u) {
          <span class="hljs-keyword">var</span> e = t.getElementById(s[<span class="hljs-number">1</span>]);
          <span class="hljs-keyword">return</span> e ? [e] : []
        }
      },
      <span class="hljs-attr">NAME</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">t, w, x</span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> w.getElementsByName !== <span class="hljs-string">"undefined"</span>) {
          <span class="hljs-keyword">var</span> s = [],
            v = w.getElementsByName(t[<span class="hljs-number">1</span>]);
          <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> u = <span class="hljs-number">0</span>, e = v.length; u &lt; e; u++) {
            <span class="hljs-keyword">if</span> (v[u].getAttribute(<span class="hljs-string">"name"</span>) === t[<span class="hljs-number">1</span>]) {
              s.push(v[u])
            }
          }
          <span class="hljs-keyword">return</span> s.length === <span class="hljs-number">0</span> ? <span class="hljs-literal">null</span> : s
        }
      },
      <span class="hljs-attr">TAG</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e, s</span>) </span>{
        <span class="hljs-keyword">return</span> s.getElementsByTagName(e[<span class="hljs-number">1</span>])
      }
    },
    <span class="hljs-attr">preFilter</span>: {
      <span class="hljs-attr">CLASS</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">u, s, t, e, x, y</span>) </span>{
        u = <span class="hljs-string">" "</span> + u[<span class="hljs-number">1</span>].replace(<span class="hljs-regexp">/\\/g</span>, <span class="hljs-string">""</span>) + <span class="hljs-string">" "</span>;
        <span class="hljs-keyword">if</span> (y) {
          <span class="hljs-keyword">return</span> u
        }
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> v = <span class="hljs-number">0</span>, w;
          (w = s[v]) != <span class="hljs-literal">null</span>; v++) {
          <span class="hljs-keyword">if</span> (w) {
            <span class="hljs-keyword">if</span> (x ^ (w.className &amp;&amp; (<span class="hljs-string">" "</span> + w.className + <span class="hljs-string">" "</span>).indexOf(u) &gt;= <span class="hljs-number">0</span>)) {
              <span class="hljs-keyword">if</span> (!t) {
                e.push(w)
              }
            } <span class="hljs-keyword">else</span> {
              <span class="hljs-keyword">if</span> (t) {
                s[v] = <span class="hljs-literal">false</span>
              }
            }
          }
        }
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
      },
      <span class="hljs-attr">ID</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
        <span class="hljs-keyword">return</span> e[<span class="hljs-number">1</span>].replace(<span class="hljs-regexp">/\\/g</span>, <span class="hljs-string">""</span>)
      },
      <span class="hljs-attr">TAG</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">s, e</span>) </span>{
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> t = <span class="hljs-number">0</span>; e[t] === <span class="hljs-literal">false</span>; t++) {}
        <span class="hljs-keyword">return</span> e[t] &amp;&amp; p(e[t]) ? s[<span class="hljs-number">1</span>] : s[<span class="hljs-number">1</span>].toUpperCase()
      },
      <span class="hljs-attr">CHILD</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
        <span class="hljs-keyword">if</span> (e[<span class="hljs-number">1</span>] == <span class="hljs-string">"nth"</span>) {
          <span class="hljs-keyword">var</span> s = <span class="hljs-regexp">/(-?)(\d*)n((?:\+|-)?\d*)/</span>.exec(e[<span class="hljs-number">2</span>] == <span class="hljs-string">"even"</span> &amp;&amp; <span class="hljs-string">"2n"</span> || e[<span class="hljs-number">2</span>] == <span class="hljs-string">"odd"</span> &amp;&amp; <span class="hljs-string">"2n+1"</span> || !<span class="hljs-regexp">/\D/</span>.test(e[<span class="hljs-number">2</span>]) &amp;&amp; <span class="hljs-string">"0n+"</span> + e[<span class="hljs-number">2</span>] || e[<span class="hljs-number">2</span>]);
          e[<span class="hljs-number">2</span>] = (s[<span class="hljs-number">1</span>] + (s[<span class="hljs-number">2</span>] || <span class="hljs-number">1</span>)) - <span class="hljs-number">0</span>;
          e[<span class="hljs-number">3</span>] = s[<span class="hljs-number">3</span>] - <span class="hljs-number">0</span>
        }
        e[<span class="hljs-number">0</span>] = j++;
        <span class="hljs-keyword">return</span> e
      },
      <span class="hljs-attr">ATTR</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">v, s, t, e, w, x</span>) </span>{
        <span class="hljs-keyword">var</span> u = v[<span class="hljs-number">1</span>].replace(<span class="hljs-regexp">/\\/g</span>, <span class="hljs-string">""</span>);
        <span class="hljs-keyword">if</span> (!x &amp;&amp; f.attrMap[u]) {
          v[<span class="hljs-number">1</span>] = f.attrMap[u]
        }
        <span class="hljs-keyword">if</span> (v[<span class="hljs-number">2</span>] === <span class="hljs-string">"~="</span>) {
          v[<span class="hljs-number">4</span>] = <span class="hljs-string">" "</span> + v[<span class="hljs-number">4</span>] + <span class="hljs-string">" "</span>
        }
        <span class="hljs-keyword">return</span> v
      },
      <span class="hljs-attr">PSEUDO</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">v, s, t, e, w</span>) </span>{
        <span class="hljs-keyword">if</span> (v[<span class="hljs-number">1</span>] === <span class="hljs-string">"not"</span>) {
          <span class="hljs-keyword">if</span> ((q.exec(v[<span class="hljs-number">3</span>]) || <span class="hljs-string">""</span>).length &gt; <span class="hljs-number">1</span> || <span class="hljs-regexp">/^\w/</span>.test(v[<span class="hljs-number">3</span>])) {
            v[<span class="hljs-number">3</span>] = b(v[<span class="hljs-number">3</span>], <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, s)
          } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">var</span> u = b.filter(v[<span class="hljs-number">3</span>], s, t, <span class="hljs-literal">true</span> ^ w);
            <span class="hljs-keyword">if</span> (!t) {
              e.push.apply(e, u)
            }
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
          }
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">if</span> (f.match.POS.test(v[<span class="hljs-number">0</span>]) || f.match.CHILD.test(v[<span class="hljs-number">0</span>])) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
          }
        }
        <span class="hljs-keyword">return</span> v
      },
      <span class="hljs-attr">POS</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
        e.unshift(<span class="hljs-literal">true</span>);
        <span class="hljs-keyword">return</span> e
      }
    },
    <span class="hljs-attr">filters</span>: {
      <span class="hljs-attr">enabled</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
        <span class="hljs-keyword">return</span> e.disabled === <span class="hljs-literal">false</span> &amp;&amp; e.type !== <span class="hljs-string">"hidden"</span>
      },
      <span class="hljs-attr">disabled</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
        <span class="hljs-keyword">return</span> e.disabled === <span class="hljs-literal">true</span>
      },
      <span class="hljs-attr">checked</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
        <span class="hljs-keyword">return</span> e.checked === <span class="hljs-literal">true</span>
      },
      <span class="hljs-attr">selected</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
        e.parentNode.selectedIndex;
        <span class="hljs-keyword">return</span> e.selected === <span class="hljs-literal">true</span>
      },
      <span class="hljs-attr">parent</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
        <span class="hljs-keyword">return</span> !!e.firstChild
      },
      <span class="hljs-attr">empty</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
        <span class="hljs-keyword">return</span> !e.firstChild
      },
      <span class="hljs-attr">has</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">t, s, e</span>) </span>{
        <span class="hljs-keyword">return</span> !!b(e[<span class="hljs-number">3</span>], t).length
      },
      <span class="hljs-attr">header</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-regexp">/h\d/i</span>.test(e.nodeName)
      },
      <span class="hljs-attr">text</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-string">"text"</span> === e.type
      },
      <span class="hljs-attr">radio</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-string">"radio"</span> === e.type
      },
      <span class="hljs-attr">checkbox</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-string">"checkbox"</span> === e.type
      },
      <span class="hljs-attr">file</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-string">"file"</span> === e.type
      },
      <span class="hljs-attr">password</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-string">"password"</span> === e.type
      },
      <span class="hljs-attr">submit</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-string">"submit"</span> === e.type
      },
      <span class="hljs-attr">image</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-string">"image"</span> === e.type
      },
      <span class="hljs-attr">reset</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-string">"reset"</span> === e.type
      },
      <span class="hljs-attr">button</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-string">"button"</span> === e.type || e.nodeName.toUpperCase() === <span class="hljs-string">"BUTTON"</span>
      },
      <span class="hljs-attr">input</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-regexp">/input|select|textarea|button/i</span>.test(e.nodeName)
      }
    },
    <span class="hljs-attr">setFilters</span>: {
      <span class="hljs-attr">first</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">s, e</span>) </span>{
        <span class="hljs-keyword">return</span> e === <span class="hljs-number">0</span>
      },
      <span class="hljs-attr">last</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">t, s, e, u</span>) </span>{
        <span class="hljs-keyword">return</span> s === u.length - <span class="hljs-number">1</span>
      },
      <span class="hljs-attr">even</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">s, e</span>) </span>{
        <span class="hljs-keyword">return</span> e % <span class="hljs-number">2</span> === <span class="hljs-number">0</span>
      },
      <span class="hljs-attr">odd</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">s, e</span>) </span>{
        <span class="hljs-keyword">return</span> e % <span class="hljs-number">2</span> === <span class="hljs-number">1</span>
      },
      <span class="hljs-attr">lt</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">t, s, e</span>) </span>{
        <span class="hljs-keyword">return</span> s &lt; e[<span class="hljs-number">3</span>] - <span class="hljs-number">0</span>
      },
      <span class="hljs-attr">gt</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">t, s, e</span>) </span>{
        <span class="hljs-keyword">return</span> s &gt; e[<span class="hljs-number">3</span>] - <span class="hljs-number">0</span>
      },
      <span class="hljs-attr">nth</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">t, s, e</span>) </span>{
        <span class="hljs-keyword">return</span> e[<span class="hljs-number">3</span>] - <span class="hljs-number">0</span> == s
      },
      <span class="hljs-attr">eq</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">t, s, e</span>) </span>{
        <span class="hljs-keyword">return</span> e[<span class="hljs-number">3</span>] - <span class="hljs-number">0</span> == s
      }
    },
    <span class="hljs-attr">filter</span>: {
      <span class="hljs-attr">PSEUDO</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">x, t, u, y</span>) </span>{
        <span class="hljs-keyword">var</span> s = t[<span class="hljs-number">1</span>],
          v = f.filters[s];
        <span class="hljs-keyword">if</span> (v) {
          <span class="hljs-keyword">return</span> v(x, u, t, y)
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">if</span> (s === <span class="hljs-string">"contains"</span>) {
            <span class="hljs-keyword">return</span> (x.textContent || x.innerText || <span class="hljs-string">""</span>).indexOf(t[<span class="hljs-number">3</span>]) &gt;= <span class="hljs-number">0</span>
          } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">if</span> (s === <span class="hljs-string">"not"</span>) {
              <span class="hljs-keyword">var</span> w = t[<span class="hljs-number">3</span>];
              <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> u = <span class="hljs-number">0</span>, e = w.length; u &lt; e; u++) {
                <span class="hljs-keyword">if</span> (w[u] === x) {
                  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
                }
              }
              <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
            }
          }
        }
      },
      <span class="hljs-attr">CHILD</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e, u</span>) </span>{
        <span class="hljs-keyword">var</span> x = u[<span class="hljs-number">1</span>],
          s = e;
        <span class="hljs-keyword">switch</span> (x) {
          <span class="hljs-keyword">case</span> <span class="hljs-string">"only"</span>:
          <span class="hljs-keyword">case</span> <span class="hljs-string">"first"</span>:
            <span class="hljs-keyword">while</span> ((s = s.previousSibling)) {
              <span class="hljs-keyword">if</span> (s.nodeType === <span class="hljs-number">1</span>) {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
              }
            }
            <span class="hljs-keyword">if</span> (x == <span class="hljs-string">"first"</span>) {
              <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
            }
            s = e;
          <span class="hljs-keyword">case</span> <span class="hljs-string">"last"</span>:
            <span class="hljs-keyword">while</span> ((s = s.nextSibling)) {
              <span class="hljs-keyword">if</span> (s.nodeType === <span class="hljs-number">1</span>) {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
              }
            }
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
          <span class="hljs-keyword">case</span> <span class="hljs-string">"nth"</span>:
            <span class="hljs-keyword">var</span> t = u[<span class="hljs-number">2</span>],
              A = u[<span class="hljs-number">3</span>];
            <span class="hljs-keyword">if</span> (t == <span class="hljs-number">1</span> &amp;&amp; A == <span class="hljs-number">0</span>) {
              <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
            }
            <span class="hljs-keyword">var</span> w = u[<span class="hljs-number">0</span>],
              z = e.parentNode;
            <span class="hljs-keyword">if</span> (z &amp;&amp; (z.sizcache !== w || !e.nodeIndex)) {
              <span class="hljs-keyword">var</span> v = <span class="hljs-number">0</span>;
              <span class="hljs-keyword">for</span> (s = z.firstChild; s; s = s.nextSibling) {
                <span class="hljs-keyword">if</span> (s.nodeType === <span class="hljs-number">1</span>) {
                  s.nodeIndex = ++v
                }
              }
              z.sizcache = w
            }
            <span class="hljs-keyword">var</span> y = e.nodeIndex - A;
            <span class="hljs-keyword">if</span> (t == <span class="hljs-number">0</span>) {
              <span class="hljs-keyword">return</span> y == <span class="hljs-number">0</span>
            } <span class="hljs-keyword">else</span> {
              <span class="hljs-keyword">return</span> (y % t == <span class="hljs-number">0</span> &amp;&amp; y / t &gt;= <span class="hljs-number">0</span>)
            }
        }
      },
      <span class="hljs-attr">ID</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">s, e</span>) </span>{
        <span class="hljs-keyword">return</span> s.nodeType === <span class="hljs-number">1</span> &amp;&amp; s.getAttribute(<span class="hljs-string">"id"</span>) === e
      },
      <span class="hljs-attr">TAG</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">s, e</span>) </span>{
        <span class="hljs-keyword">return</span> (e === <span class="hljs-string">"*"</span> &amp;&amp; s.nodeType === <span class="hljs-number">1</span>) || s.nodeName === e
      },
      <span class="hljs-attr">CLASS</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">s, e</span>) </span>{
        <span class="hljs-keyword">return</span> (<span class="hljs-string">" "</span> + (s.className || s.getAttribute(<span class="hljs-string">"class"</span>)) + <span class="hljs-string">" "</span>).indexOf(e) &gt; <span class="hljs-number">-1</span>
      },
      <span class="hljs-attr">ATTR</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">w, u</span>) </span>{
        <span class="hljs-keyword">var</span> t = u[<span class="hljs-number">1</span>],
          e = f.attrHandle[t] ? f.attrHandle[t](w) : w[t] != <span class="hljs-literal">null</span> ? w[t] : w.getAttribute(t),
          x = e + <span class="hljs-string">""</span>,
          v = u[<span class="hljs-number">2</span>],
          s = u[<span class="hljs-number">4</span>];
        <span class="hljs-keyword">return</span> e == <span class="hljs-literal">null</span> ? v === <span class="hljs-string">"!="</span> : v === <span class="hljs-string">"="</span> ? x === s : v === <span class="hljs-string">"*="</span> ? x.indexOf(s) &gt;= <span class="hljs-number">0</span> : v === <span class="hljs-string">"~="</span> ? (<span class="hljs-string">" "</span> + x + <span class="hljs-string">" "</span>).indexOf(s) &gt;= <span class="hljs-number">0</span> : !s ? x &amp;&amp; e !== <span class="hljs-literal">false</span> : v === <span class="hljs-string">"!="</span> ? x != s : v === <span class="hljs-string">"^="</span> ? x.indexOf(s) === <span class="hljs-number">0</span> : v === <span class="hljs-string">"$="</span> ? x.substr(x.length - s.length) === s : v === <span class="hljs-string">"|="</span> ? x === s || x.substr(<span class="hljs-number">0</span>, s.length + <span class="hljs-number">1</span>) === s + <span class="hljs-string">"-"</span> : <span class="hljs-literal">false</span>
      },
      <span class="hljs-attr">POS</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">v, s, t, w</span>) </span>{
        <span class="hljs-keyword">var</span> e = s[<span class="hljs-number">2</span>],
          u = f.setFilters[e];
        <span class="hljs-keyword">if</span> (u) {
          <span class="hljs-keyword">return</span> u(v, t, s, w)
        }
      }
    }
  };
  <span class="hljs-keyword">var</span> k = f.match.POS;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> m <span class="hljs-keyword">in</span> f.match) {
    f.match[m] = <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(f.match[m].source + <span class="hljs-regexp">/(?![^\[]*\])(?![^\(]*\))/</span>.source);
    f.leftMatch[m] = <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(<span class="hljs-regexp">/(^(?:.|\r|\n)*?)/</span>.source + f.match[m].source)
  }
  <span class="hljs-keyword">var</span> a = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">s, e</span>) </span>{
    s = <span class="hljs-built_in">Array</span>.prototype.slice.call(s, <span class="hljs-number">0</span>);
    <span class="hljs-keyword">if</span> (e) {
      e.push.apply(e, s);
      <span class="hljs-keyword">return</span> e
    }
    <span class="hljs-keyword">return</span> s
  };
  <span class="hljs-keyword">try</span> {
    <span class="hljs-built_in">Array</span>.prototype.slice.call(<span class="hljs-built_in">document</span>.documentElement.childNodes, <span class="hljs-number">0</span>)
  } <span class="hljs-keyword">catch</span> (l) {
    a = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">v, u</span>) </span>{
      <span class="hljs-keyword">var</span> s = u || [];
      <span class="hljs-keyword">if</span> (d.call(v) === <span class="hljs-string">"[object Array]"</span>) {
        <span class="hljs-built_in">Array</span>.prototype.push.apply(s, v)
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> v.length === <span class="hljs-string">"number"</span>) {
          <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> t = <span class="hljs-number">0</span>, e = v.length; t &lt; e; t++) {
            s.push(v[t])
          }
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> t = <span class="hljs-number">0</span>; v[t]; t++) {
            s.push(v[t])
          }
        }
      }
      <span class="hljs-keyword">return</span> s
    }
  }
  <span class="hljs-keyword">var</span> c;
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">document</span>.documentElement.compareDocumentPosition) {
    c = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">s, e</span>) </span>{
      <span class="hljs-keyword">if</span> (!s.compareDocumentPosition || !e.compareDocumentPosition) {
        <span class="hljs-keyword">if</span> (s == e) {
          o = <span class="hljs-literal">true</span>
        }
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>
      }
      <span class="hljs-keyword">var</span> t = s.compareDocumentPosition(e) &amp; <span class="hljs-number">4</span> ? <span class="hljs-number">-1</span> : s === e ? <span class="hljs-number">0</span> : <span class="hljs-number">1</span>;
      <span class="hljs-keyword">if</span> (t === <span class="hljs-number">0</span>) {
        o = <span class="hljs-literal">true</span>
      }
      <span class="hljs-keyword">return</span> t
    }
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">if</span> (<span class="hljs-string">"sourceIndex"</span> <span class="hljs-keyword">in</span> <span class="hljs-built_in">document</span>.documentElement) {
      c = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">s, e</span>) </span>{
        <span class="hljs-keyword">if</span> (!s.sourceIndex || !e.sourceIndex) {
          <span class="hljs-keyword">if</span> (s == e) {
            o = <span class="hljs-literal">true</span>
          }
          <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>
        }
        <span class="hljs-keyword">var</span> t = s.sourceIndex - e.sourceIndex;
        <span class="hljs-keyword">if</span> (t === <span class="hljs-number">0</span>) {
          o = <span class="hljs-literal">true</span>
        }
        <span class="hljs-keyword">return</span> t
      }
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">if</span> (<span class="hljs-built_in">document</span>.createRange) {
        c = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">u, s</span>) </span>{
          <span class="hljs-keyword">if</span> (!u.ownerDocument || !s.ownerDocument) {
            <span class="hljs-keyword">if</span> (u == s) {
              o = <span class="hljs-literal">true</span>
            }
            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>
          }
          <span class="hljs-keyword">var</span> t = u.ownerDocument.createRange(),
            e = s.ownerDocument.createRange();
          t.setStart(u, <span class="hljs-number">0</span>);
          t.setEnd(u, <span class="hljs-number">0</span>);
          e.setStart(s, <span class="hljs-number">0</span>);
          e.setEnd(s, <span class="hljs-number">0</span>);
          <span class="hljs-keyword">var</span> v = t.compareBoundaryPoints(Range.START_TO_END, e);
          <span class="hljs-keyword">if</span> (v === <span class="hljs-number">0</span>) {
            o = <span class="hljs-literal">true</span>
          }
          <span class="hljs-keyword">return</span> v
        }
      }
    }
  }(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> s = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"div"</span>),
      t = <span class="hljs-string">"script"</span> + (<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>).getTime();
    s.innerHTML = <span class="hljs-string">"&lt;a name='"</span> + t + <span class="hljs-string">"'/&gt;"</span>;
    <span class="hljs-keyword">var</span> e = <span class="hljs-built_in">document</span>.documentElement;
    e.insertBefore(s, e.firstChild);
    <span class="hljs-keyword">if</span> (!!<span class="hljs-built_in">document</span>.getElementById(t)) {
      f.find.ID = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">v, w, x</span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> w.getElementById !== <span class="hljs-string">"undefined"</span> &amp;&amp; !x) {
          <span class="hljs-keyword">var</span> u = w.getElementById(v[<span class="hljs-number">1</span>]);
          <span class="hljs-keyword">return</span> u ? u.id === v[<span class="hljs-number">1</span>] || <span class="hljs-keyword">typeof</span> u.getAttributeNode !== <span class="hljs-string">"undefined"</span> &amp;&amp; u.getAttributeNode(<span class="hljs-string">"id"</span>).nodeValue === v[<span class="hljs-number">1</span>] ? [u] : <span class="hljs-literal">undefined</span> : []
        }
      };
      f.filter.ID = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">w, u</span>) </span>{
        <span class="hljs-keyword">var</span> v = <span class="hljs-keyword">typeof</span> w.getAttributeNode !== <span class="hljs-string">"undefined"</span> &amp;&amp; w.getAttributeNode(<span class="hljs-string">"id"</span>);
        <span class="hljs-keyword">return</span> w.nodeType === <span class="hljs-number">1</span> &amp;&amp; v &amp;&amp; v.nodeValue === u
      }
    }
    e.removeChild(s);
    e = s = <span class="hljs-literal">null</span>
  })();
  (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> e = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"div"</span>);
    e.appendChild(<span class="hljs-built_in">document</span>.createComment(<span class="hljs-string">""</span>));
    <span class="hljs-keyword">if</span> (e.getElementsByTagName(<span class="hljs-string">"*"</span>).length &gt; <span class="hljs-number">0</span>) {
      f.find.TAG = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">s, w</span>) </span>{
        <span class="hljs-keyword">var</span> v = w.getElementsByTagName(s[<span class="hljs-number">1</span>]);
        <span class="hljs-keyword">if</span> (s[<span class="hljs-number">1</span>] === <span class="hljs-string">"*"</span>) {
          <span class="hljs-keyword">var</span> u = [];
          <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> t = <span class="hljs-number">0</span>; v[t]; t++) {
            <span class="hljs-keyword">if</span> (v[t].nodeType === <span class="hljs-number">1</span>) {
              u.push(v[t])
            }
          }
          v = u
        }
        <span class="hljs-keyword">return</span> v
      }
    }
    e.innerHTML = <span class="hljs-string">"&lt;a href='#'&gt;&lt;/a&gt;"</span>;
    <span class="hljs-keyword">if</span> (e.firstChild &amp;&amp; <span class="hljs-keyword">typeof</span> e.firstChild.getAttribute !== <span class="hljs-string">"undefined"</span> &amp;&amp; e.firstChild.getAttribute(<span class="hljs-string">"href"</span>) !== <span class="hljs-string">"#"</span>) {
      f.attrHandle.href = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">s</span>) </span>{
        <span class="hljs-keyword">return</span> s.getAttribute(<span class="hljs-string">"href"</span>, <span class="hljs-number">2</span>)
      }
    }
    e = <span class="hljs-literal">null</span>
  })();
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">document</span>.querySelectorAll) {
    (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> e = b,
        t = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"div"</span>);
      t.innerHTML = <span class="hljs-string">"&lt;p class='TEST'&gt;&lt;/p&gt;"</span>;
      <span class="hljs-keyword">if</span> (t.querySelectorAll &amp;&amp; t.querySelectorAll(<span class="hljs-string">".TEST"</span>).length === <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">return</span>
      }
      b = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">x, w, u, v</span>) </span>{
        w = w || <span class="hljs-built_in">document</span>;
        <span class="hljs-keyword">if</span> (!v &amp;&amp; w.nodeType === <span class="hljs-number">9</span> &amp;&amp; !p(w)) {
          <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">return</span> a(w.querySelectorAll(x), u)
          } <span class="hljs-keyword">catch</span> (y) {}
        }
        <span class="hljs-keyword">return</span> e(x, w, u, v)
      };
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> s <span class="hljs-keyword">in</span> e) {
        b[s] = e[s]
      }
      t = <span class="hljs-literal">null</span>
    })()
  }
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">document</span>.getElementsByClassName &amp;&amp; <span class="hljs-built_in">document</span>.documentElement.getElementsByClassName) {
    (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> e = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"div"</span>);
      e.innerHTML = <span class="hljs-string">"&lt;div class='test e'&gt;&lt;/div&gt;&lt;div class='test'&gt;&lt;/div&gt;"</span>;
      <span class="hljs-keyword">if</span> (e.getElementsByClassName(<span class="hljs-string">"e"</span>).length === <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">return</span>
      }
      e.lastChild.className = <span class="hljs-string">"e"</span>;
      <span class="hljs-keyword">if</span> (e.getElementsByClassName(<span class="hljs-string">"e"</span>).length === <span class="hljs-number">1</span>) {
        <span class="hljs-keyword">return</span>
      }
      f.order.splice(<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-string">"CLASS"</span>);
      f.find.CLASS = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">s, t, u</span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> t.getElementsByClassName !== <span class="hljs-string">"undefined"</span> &amp;&amp; !u) {
          <span class="hljs-keyword">return</span> t.getElementsByClassName(s[<span class="hljs-number">1</span>])
        }
      };
      e = <span class="hljs-literal">null</span>
    })()
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">n</span>(<span class="hljs-params">s, x, w, B, y, A</span>) </span>{
    <span class="hljs-keyword">var</span> z = s == <span class="hljs-string">"previousSibling"</span> &amp;&amp; !A;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> u = <span class="hljs-number">0</span>, t = B.length; u &lt; t; u++) {
      <span class="hljs-keyword">var</span> e = B[u];
      <span class="hljs-keyword">if</span> (e) {
        <span class="hljs-keyword">if</span> (z &amp;&amp; e.nodeType === <span class="hljs-number">1</span>) {
          e.sizcache = w;
          e.sizset = u
        }
        e = e[s];
        <span class="hljs-keyword">var</span> v = <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">while</span> (e) {
          <span class="hljs-keyword">if</span> (e.sizcache === w) {
            v = B[e.sizset];
            <span class="hljs-keyword">break</span>
          }
          <span class="hljs-keyword">if</span> (e.nodeType === <span class="hljs-number">1</span> &amp;&amp; !A) {
            e.sizcache = w;
            e.sizset = u
          }
          <span class="hljs-keyword">if</span> (e.nodeName === x) {
            v = e;
            <span class="hljs-keyword">break</span>
          }
          e = e[s]
        }
        B[u] = v
      }
    }
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">r</span>(<span class="hljs-params">s, x, w, B, y, A</span>) </span>{
    <span class="hljs-keyword">var</span> z = s == <span class="hljs-string">"previousSibling"</span> &amp;&amp; !A;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> u = <span class="hljs-number">0</span>, t = B.length; u &lt; t; u++) {
      <span class="hljs-keyword">var</span> e = B[u];
      <span class="hljs-keyword">if</span> (e) {
        <span class="hljs-keyword">if</span> (z &amp;&amp; e.nodeType === <span class="hljs-number">1</span>) {
          e.sizcache = w;
          e.sizset = u
        }
        e = e[s];
        <span class="hljs-keyword">var</span> v = <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">while</span> (e) {
          <span class="hljs-keyword">if</span> (e.sizcache === w) {
            v = B[e.sizset];
            <span class="hljs-keyword">break</span>
          }
          <span class="hljs-keyword">if</span> (e.nodeType === <span class="hljs-number">1</span>) {
            <span class="hljs-keyword">if</span> (!A) {
              e.sizcache = w;
              e.sizset = u
            }
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> x !== <span class="hljs-string">"string"</span>) {
              <span class="hljs-keyword">if</span> (e === x) {
                v = <span class="hljs-literal">true</span>;
                <span class="hljs-keyword">break</span>
              }
            } <span class="hljs-keyword">else</span> {
              <span class="hljs-keyword">if</span> (b.filter(x, [e]).length &gt; <span class="hljs-number">0</span>) {
                v = e;
                <span class="hljs-keyword">break</span>
              }
            }
          }
          e = e[s]
        }
        B[u] = v
      }
    }
  }
  <span class="hljs-keyword">var</span> h = <span class="hljs-built_in">document</span>.compareDocumentPosition ? <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">s, e</span>) </span>{
    <span class="hljs-keyword">return</span> s.compareDocumentPosition(e) &amp; <span class="hljs-number">16</span>
  } : <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">s, e</span>) </span>{
    <span class="hljs-keyword">return</span> s !== e &amp;&amp; (s.contains ? s.contains(e) : <span class="hljs-literal">true</span>)
  };
  <span class="hljs-keyword">var</span> p = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
    <span class="hljs-keyword">return</span> e.nodeType === <span class="hljs-number">9</span> &amp;&amp; e.documentElement.nodeName !== <span class="hljs-string">"HTML"</span> || !!e.ownerDocument &amp;&amp; e.ownerDocument.documentElement.nodeName !== <span class="hljs-string">"HTML"</span>
  };
  <span class="hljs-keyword">var</span> g = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e, y</span>) </span>{
    <span class="hljs-keyword">var</span> u = [],
      v = <span class="hljs-string">""</span>,
      w, t = y.nodeType ? [y] : y;
    <span class="hljs-keyword">while</span> ((w = f.match.PSEUDO.exec(e))) {
      v += w[<span class="hljs-number">0</span>];
      e = e.replace(f.match.PSEUDO, <span class="hljs-string">""</span>)
    }
    e = f.relative[e] ? e + <span class="hljs-string">"*"</span> : e;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> x = <span class="hljs-number">0</span>, s = t.length; x &lt; s; x++) {
      b(e, t[x], u)
    }
    <span class="hljs-keyword">return</span> b.filter(v, u)
  };
  <span class="hljs-built_in">window</span>.Sizzle = b
})();
(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">c</span>) </span>{
  <span class="hljs-keyword">var</span> d = Prototype.Selector.extendElements;

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">a</span>(<span class="hljs-params">e, f</span>) </span>{
    <span class="hljs-keyword">return</span> d(c(e, f || <span class="hljs-built_in">document</span>))
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">b</span>(<span class="hljs-params">f, e</span>) </span>{
    <span class="hljs-keyword">return</span> c.matches(e, [f]).length == <span class="hljs-number">1</span>
  }
  Prototype.Selector.engine = c;
  Prototype.Selector.select = a;
  Prototype.Selector.match = b
})(Sizzle);
<span class="hljs-built_in">window</span>.Sizzle = Prototype._original_property;
<span class="hljs-keyword">delete</span> Prototype._original_property;
<span class="hljs-keyword">var</span> Form = {
  <span class="hljs-attr">reset</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
    a = $(a);
    a.reset();
    <span class="hljs-keyword">return</span> a
  },
  <span class="hljs-attr">serializeElements</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">h, d</span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> d != <span class="hljs-string">"object"</span>) {
      d = {
        <span class="hljs-attr">hash</span>: !!d
      }
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.isUndefined(d.hash)) {
        d.hash = <span class="hljs-literal">true</span>
      }
    }
    <span class="hljs-keyword">var</span> e, g, a = <span class="hljs-literal">false</span>,
      f = d.submit,
      b, c;
    <span class="hljs-keyword">if</span> (d.hash) {
      c = {};
      b = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">i, j, k</span>) </span>{
        <span class="hljs-keyword">if</span> (j <span class="hljs-keyword">in</span> i) {
          <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">Object</span>.isArray(i[j])) {
            i[j] = [i[j]]
          }
          i[j].push(k)
        } <span class="hljs-keyword">else</span> {
          i[j] = k
        }
        <span class="hljs-keyword">return</span> i
      }
    } <span class="hljs-keyword">else</span> {
      c = <span class="hljs-string">""</span>;
      b = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">i, j, k</span>) </span>{
        <span class="hljs-keyword">return</span> i + (i ? <span class="hljs-string">"&amp;"</span> : <span class="hljs-string">""</span>) + <span class="hljs-built_in">encodeURIComponent</span>(j) + <span class="hljs-string">"="</span> + <span class="hljs-built_in">encodeURIComponent</span>(k)
      }
    }
    <span class="hljs-keyword">return</span> h.inject(c, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">i, j</span>) </span>{
      <span class="hljs-keyword">if</span> (!j.disabled &amp;&amp; j.name) {
        e = j.name;
        g = $(j).getValue();
        <span class="hljs-keyword">if</span> (g != <span class="hljs-literal">null</span> &amp;&amp; j.type != <span class="hljs-string">"file"</span> &amp;&amp; (j.type != <span class="hljs-string">"submit"</span> || (!a &amp;&amp; f !== <span class="hljs-literal">false</span> &amp;&amp; (!f || e == f) &amp;&amp; (a = <span class="hljs-literal">true</span>)))) {
          i = b(i, e, g)
        }
      }
      <span class="hljs-keyword">return</span> i
    })
  }
};
Form.Methods = {
  <span class="hljs-attr">serialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">b, a</span>) </span>{
    <span class="hljs-keyword">return</span> Form.serializeElements(Form.getElements(b), a)
  },
  <span class="hljs-attr">getElements</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
    <span class="hljs-keyword">var</span> f = $(e).getElementsByTagName(<span class="hljs-string">"*"</span>),
      d, a = [],
      c = Form.Element.Serializers;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> b = <span class="hljs-number">0</span>; d = f[b]; b++) {
      a.push(d)
    }
    <span class="hljs-keyword">return</span> a.inject([], <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">g, h</span>) </span>{
      <span class="hljs-keyword">if</span> (c[h.tagName.toLowerCase()]) {
        g.push(Element.extend(h))
      }
      <span class="hljs-keyword">return</span> g
    })
  },
  <span class="hljs-attr">getInputs</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">g, c, d</span>) </span>{
    g = $(g);
    <span class="hljs-keyword">var</span> a = g.getElementsByTagName(<span class="hljs-string">"input"</span>);
    <span class="hljs-keyword">if</span> (!c &amp;&amp; !d) {
      <span class="hljs-keyword">return</span> $A(a).map(Element.extend)
    }
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> e = <span class="hljs-number">0</span>, h = [], f = a.length; e &lt; f; e++) {
      <span class="hljs-keyword">var</span> b = a[e];
      <span class="hljs-keyword">if</span> ((c &amp;&amp; b.type != c) || (d &amp;&amp; b.name != d)) {
        <span class="hljs-keyword">continue</span>
      }
      h.push(Element.extend(b))
    }
    <span class="hljs-keyword">return</span> h
  },
  <span class="hljs-attr">disable</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
    a = $(a);
    Form.getElements(a).invoke(<span class="hljs-string">"disable"</span>);
    <span class="hljs-keyword">return</span> a
  },
  <span class="hljs-attr">enable</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
    a = $(a);
    Form.getElements(a).invoke(<span class="hljs-string">"enable"</span>);
    <span class="hljs-keyword">return</span> a
  },
  <span class="hljs-attr">findFirstElement</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">b</span>) </span>{
    <span class="hljs-keyword">var</span> c = $(b).getElements().findAll(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">d</span>) </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-string">"hidden"</span> != d.type &amp;&amp; !d.disabled
    });
    <span class="hljs-keyword">var</span> a = c.findAll(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">d</span>) </span>{
      <span class="hljs-keyword">return</span> d.hasAttribute(<span class="hljs-string">"tabIndex"</span>) &amp;&amp; d.tabIndex &gt;= <span class="hljs-number">0</span>
    }).sortBy(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">d</span>) </span>{
      <span class="hljs-keyword">return</span> d.tabIndex
    }).first();
    <span class="hljs-keyword">return</span> a ? a : c.find(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">d</span>) </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-regexp">/^(?:input|select|textarea)$/i</span>.test(d.tagName)
    })
  },
  <span class="hljs-attr">focusFirstElement</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">b</span>) </span>{
    b = $(b);
    <span class="hljs-keyword">var</span> a = b.findFirstElement();
    <span class="hljs-keyword">if</span> (a) {
      a.activate()
    }
    <span class="hljs-keyword">return</span> b
  },
  <span class="hljs-attr">request</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">b, a</span>) </span>{
    b = $(b), a = <span class="hljs-built_in">Object</span>.clone(a || {});
    <span class="hljs-keyword">var</span> d = a.parameters,
      c = b.readAttribute(<span class="hljs-string">"action"</span>) || <span class="hljs-string">""</span>;
    <span class="hljs-keyword">if</span> (c.blank()) {
      c = <span class="hljs-built_in">window</span>.location.href
    }
    a.parameters = b.serialize(<span class="hljs-literal">true</span>);
    <span class="hljs-keyword">if</span> (d) {
      <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.isString(d)) {
        d = d.toQueryParams()
      }
      <span class="hljs-built_in">Object</span>.extend(a.parameters, d)
    }
    <span class="hljs-keyword">if</span> (b.hasAttribute(<span class="hljs-string">"method"</span>) &amp;&amp; !a.method) {
      a.method = b.method
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Ajax.Request(c, a)
  }
};
Form.Element = {
  <span class="hljs-attr">focus</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
    $(a).focus();
    <span class="hljs-keyword">return</span> a
  },
  <span class="hljs-attr">select</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
    $(a).select();
    <span class="hljs-keyword">return</span> a
  }
};
Form.Element.Methods = {
  <span class="hljs-attr">serialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
    a = $(a);
    <span class="hljs-keyword">if</span> (!a.disabled &amp;&amp; a.name) {
      <span class="hljs-keyword">var</span> b = a.getValue();
      <span class="hljs-keyword">if</span> (b != <span class="hljs-literal">undefined</span>) {
        <span class="hljs-keyword">var</span> c = {};
        c[a.name] = b;
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">Object</span>.toQueryString(c)
      }
    }
    <span class="hljs-keyword">return</span> <span class="hljs-string">""</span>
  },
  <span class="hljs-attr">getValue</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
    a = $(a);
    <span class="hljs-keyword">var</span> b = a.tagName.toLowerCase();
    <span class="hljs-keyword">return</span> Form.Element.Serializers[b](a)
  },
  <span class="hljs-attr">setValue</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a, b</span>) </span>{
    a = $(a);
    <span class="hljs-keyword">var</span> c = a.tagName.toLowerCase();
    Form.Element.Serializers[c](a, b);
    <span class="hljs-keyword">return</span> a
  },
  <span class="hljs-attr">clear</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
    $(a).value = <span class="hljs-string">""</span>;
    <span class="hljs-keyword">return</span> a
  },
  <span class="hljs-attr">present</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
    <span class="hljs-keyword">return</span> $(a).value != <span class="hljs-string">""</span>
  },
  <span class="hljs-attr">activate</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
    a = $(a);
    <span class="hljs-keyword">try</span> {
      a.focus();
      <span class="hljs-keyword">if</span> (a.select &amp;&amp; (a.tagName.toLowerCase() != <span class="hljs-string">"input"</span> || !(<span class="hljs-regexp">/^(?:button|reset|submit)$/i</span>.test(a.type)))) {
        a.select()
      }
    } <span class="hljs-keyword">catch</span> (b) {}
    <span class="hljs-keyword">return</span> a
  },
  <span class="hljs-attr">disable</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
    a = $(a);
    a.disabled = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">return</span> a
  },
  <span class="hljs-attr">enable</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
    a = $(a);
    a.disabled = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">return</span> a
  }
};
<span class="hljs-keyword">var</span> Field = Form.Element;
<span class="hljs-keyword">var</span> $F = Form.Element.Methods.getValue;
Form.Element.Serializers = (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">b</span>(<span class="hljs-params">h, i</span>) </span>{
    <span class="hljs-keyword">switch</span> (h.type.toLowerCase()) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">"checkbox"</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-string">"radio"</span>:
        <span class="hljs-keyword">return</span> f(h, i);
      <span class="hljs-keyword">default</span>:
        <span class="hljs-keyword">return</span> e(h, i)
    }
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">f</span>(<span class="hljs-params">h, i</span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.isUndefined(i)) {
      <span class="hljs-keyword">return</span> h.checked ? h.value : <span class="hljs-literal">null</span>
    } <span class="hljs-keyword">else</span> {
      h.checked = !!i
    }
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">e</span>(<span class="hljs-params">h, i</span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.isUndefined(i)) {
      <span class="hljs-keyword">return</span> h.value
    } <span class="hljs-keyword">else</span> {
      h.value = i
    }
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">a</span>(<span class="hljs-params">k, n</span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.isUndefined(n)) {
      <span class="hljs-keyword">return</span> (k.type === <span class="hljs-string">"select-one"</span> ? c : d)(k)
    }
    <span class="hljs-keyword">var</span> j, l, o = !<span class="hljs-built_in">Object</span>.isArray(n);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> h = <span class="hljs-number">0</span>, m = k.length; h &lt; m; h++) {
      j = k.options[h];
      l = <span class="hljs-keyword">this</span>.optionValue(j);
      <span class="hljs-keyword">if</span> (o) {
        <span class="hljs-keyword">if</span> (l == n) {
          j.selected = <span class="hljs-literal">true</span>;
          <span class="hljs-keyword">return</span>
        }
      } <span class="hljs-keyword">else</span> {
        j.selected = n.include(l)
      }
    }
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">c</span>(<span class="hljs-params">i</span>) </span>{
    <span class="hljs-keyword">var</span> h = i.selectedIndex;
    <span class="hljs-keyword">return</span> h &gt;= <span class="hljs-number">0</span> ? g(i.options[h]) : <span class="hljs-literal">null</span>
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">d</span>(<span class="hljs-params">l</span>) </span>{
    <span class="hljs-keyword">var</span> h, m = l.length;
    <span class="hljs-keyword">if</span> (!m) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>
    }
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> k = <span class="hljs-number">0</span>, h = []; k &lt; m; k++) {
      <span class="hljs-keyword">var</span> j = l.options[k];
      <span class="hljs-keyword">if</span> (j.selected) {
        h.push(g(j))
      }
    }
    <span class="hljs-keyword">return</span> h
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">g</span>(<span class="hljs-params">h</span>) </span>{
    <span class="hljs-keyword">return</span> Element.hasAttribute(h, <span class="hljs-string">"value"</span>) ? h.value : h.text
  }
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">input</span>: b,
    <span class="hljs-attr">inputSelector</span>: f,
    <span class="hljs-attr">textarea</span>: e,
    <span class="hljs-attr">select</span>: a,
    <span class="hljs-attr">selectOne</span>: c,
    <span class="hljs-attr">selectMany</span>: d,
    <span class="hljs-attr">optionValue</span>: g,
    <span class="hljs-attr">button</span>: e
  }
})();
Abstract.TimedObserver = Class.create(PeriodicalExecuter, {
  <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$super, a, b, c</span>) </span>{
    $<span class="hljs-keyword">super</span>(c, b);
    <span class="hljs-keyword">this</span>.element = $(a);
    <span class="hljs-keyword">this</span>.lastValue = <span class="hljs-keyword">this</span>.getValue()
  },
  <span class="hljs-attr">execute</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> a = <span class="hljs-keyword">this</span>.getValue();
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.isString(<span class="hljs-keyword">this</span>.lastValue) &amp;&amp; <span class="hljs-built_in">Object</span>.isString(a) ? <span class="hljs-keyword">this</span>.lastValue != a : <span class="hljs-built_in">String</span>(<span class="hljs-keyword">this</span>.lastValue) != <span class="hljs-built_in">String</span>(a)) {
      <span class="hljs-keyword">this</span>.callback(<span class="hljs-keyword">this</span>.element, a);
      <span class="hljs-keyword">this</span>.lastValue = a
    }
  }
});
Form.Element.Observer = Class.create(Abstract.TimedObserver, {
  <span class="hljs-attr">getValue</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> Form.Element.getValue(<span class="hljs-keyword">this</span>.element)
  }
});
Form.Observer = Class.create(Abstract.TimedObserver, {
  <span class="hljs-attr">getValue</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> Form.serialize(<span class="hljs-keyword">this</span>.element)
  }
});
Abstract.EventObserver = Class.create({
  <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a, b</span>) </span>{
    <span class="hljs-keyword">this</span>.element = $(a);
    <span class="hljs-keyword">this</span>.callback = b;
    <span class="hljs-keyword">this</span>.lastValue = <span class="hljs-keyword">this</span>.getValue();
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.element.tagName.toLowerCase() == <span class="hljs-string">"form"</span>) {
      <span class="hljs-keyword">this</span>.registerFormCallbacks()
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">this</span>.registerCallback(<span class="hljs-keyword">this</span>.element)
    }
  },
  <span class="hljs-attr">onElementEvent</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> a = <span class="hljs-keyword">this</span>.getValue();
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.lastValue != a) {
      <span class="hljs-keyword">this</span>.callback(<span class="hljs-keyword">this</span>.element, a);
      <span class="hljs-keyword">this</span>.lastValue = a
    }
  },
  <span class="hljs-attr">registerFormCallbacks</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    Form.getElements(<span class="hljs-keyword">this</span>.element).each(<span class="hljs-keyword">this</span>.registerCallback, <span class="hljs-keyword">this</span>)
  },
  <span class="hljs-attr">registerCallback</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
    <span class="hljs-keyword">if</span> (a.type) {
      <span class="hljs-keyword">switch</span> (a.type.toLowerCase()) {
        <span class="hljs-keyword">case</span> <span class="hljs-string">"checkbox"</span>:
        <span class="hljs-keyword">case</span> <span class="hljs-string">"radio"</span>:
          Event.observe(a, <span class="hljs-string">"click"</span>, <span class="hljs-keyword">this</span>.onElementEvent.bind(<span class="hljs-keyword">this</span>));
          <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">default</span>:
          Event.observe(a, <span class="hljs-string">"change"</span>, <span class="hljs-keyword">this</span>.onElementEvent.bind(<span class="hljs-keyword">this</span>));
          <span class="hljs-keyword">break</span>
      }
    }
  }
});
Form.Element.EventObserver = Class.create(Abstract.EventObserver, {
  <span class="hljs-attr">getValue</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> Form.Element.getValue(<span class="hljs-keyword">this</span>.element)
  }
});
Form.EventObserver = Class.create(Abstract.EventObserver, {
  <span class="hljs-attr">getValue</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> Form.serialize(<span class="hljs-keyword">this</span>.element)
  }
});
(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> C = {
    <span class="hljs-attr">KEY_BACKSPACE</span>: <span class="hljs-number">8</span>,
    <span class="hljs-attr">KEY_TAB</span>: <span class="hljs-number">9</span>,
    <span class="hljs-attr">KEY_RETURN</span>: <span class="hljs-number">13</span>,
    <span class="hljs-attr">KEY_ESC</span>: <span class="hljs-number">27</span>,
    <span class="hljs-attr">KEY_LEFT</span>: <span class="hljs-number">37</span>,
    <span class="hljs-attr">KEY_UP</span>: <span class="hljs-number">38</span>,
    <span class="hljs-attr">KEY_RIGHT</span>: <span class="hljs-number">39</span>,
    <span class="hljs-attr">KEY_DOWN</span>: <span class="hljs-number">40</span>,
    <span class="hljs-attr">KEY_DELETE</span>: <span class="hljs-number">46</span>,
    <span class="hljs-attr">KEY_HOME</span>: <span class="hljs-number">36</span>,
    <span class="hljs-attr">KEY_END</span>: <span class="hljs-number">35</span>,
    <span class="hljs-attr">KEY_PAGEUP</span>: <span class="hljs-number">33</span>,
    <span class="hljs-attr">KEY_PAGEDOWN</span>: <span class="hljs-number">34</span>,
    <span class="hljs-attr">KEY_INSERT</span>: <span class="hljs-number">45</span>,
    <span class="hljs-attr">cache</span>: {}
  };
  <span class="hljs-keyword">var</span> f = <span class="hljs-built_in">document</span>.documentElement;
  <span class="hljs-keyword">var</span> D = <span class="hljs-string">"onmouseenter"</span> <span class="hljs-keyword">in</span> f &amp;&amp; <span class="hljs-string">"onmouseleave"</span> <span class="hljs-keyword">in</span> f;
  <span class="hljs-keyword">var</span> a = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">E</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
  };
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.attachEvent) {
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.addEventListener) {
      a = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">E</span>) </span>{
        <span class="hljs-keyword">return</span> !(E <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">window</span>.Event)
      }
    } <span class="hljs-keyword">else</span> {
      a = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">E</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
      }
    }
  }
  <span class="hljs-keyword">var</span> r;

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">A</span>(<span class="hljs-params">F, E</span>) </span>{
    <span class="hljs-keyword">return</span> F.which ? (F.which === E + <span class="hljs-number">1</span>) : (F.button === E)
  }
  <span class="hljs-keyword">var</span> o = {
    <span class="hljs-number">0</span>: <span class="hljs-number">1</span>,
    <span class="hljs-number">1</span>: <span class="hljs-number">4</span>,
    <span class="hljs-number">2</span>: <span class="hljs-number">2</span>
  };

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">y</span>(<span class="hljs-params">F, E</span>) </span>{
    <span class="hljs-keyword">return</span> F.button === o[E]
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">B</span>(<span class="hljs-params">F, E</span>) </span>{
    <span class="hljs-keyword">switch</span> (E) {
      <span class="hljs-keyword">case</span> <span class="hljs-number">0</span>:
        <span class="hljs-keyword">return</span> F.which == <span class="hljs-number">1</span> &amp;&amp; !F.metaKey;
      <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:
        <span class="hljs-keyword">return</span> F.which == <span class="hljs-number">2</span> || (F.which == <span class="hljs-number">1</span> &amp;&amp; F.metaKey);
      <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:
        <span class="hljs-keyword">return</span> F.which == <span class="hljs-number">3</span>;
      <span class="hljs-keyword">default</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
    }
  }
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.attachEvent) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">window</span>.addEventListener) {
      r = y
    } <span class="hljs-keyword">else</span> {
      r = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">F, E</span>) </span>{
        <span class="hljs-keyword">return</span> a(F) ? y(F, E) : A(F, E)
      }
    }
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">if</span> (Prototype.Browser.WebKit) {
      r = B
    } <span class="hljs-keyword">else</span> {
      r = A
    }
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">v</span>(<span class="hljs-params">E</span>) </span>{
    <span class="hljs-keyword">return</span> r(E, <span class="hljs-number">0</span>)
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">t</span>(<span class="hljs-params">E</span>) </span>{
    <span class="hljs-keyword">return</span> r(E, <span class="hljs-number">1</span>)
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">n</span>(<span class="hljs-params">E</span>) </span>{
    <span class="hljs-keyword">return</span> r(E, <span class="hljs-number">2</span>)
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">d</span>(<span class="hljs-params">G</span>) </span>{
    G = C.extend(G);
    <span class="hljs-keyword">var</span> F = G.target,
      E = G.type,
      H = G.currentTarget;
    <span class="hljs-keyword">if</span> (H &amp;&amp; H.tagName) {
      <span class="hljs-keyword">if</span> (E === <span class="hljs-string">"load"</span> || E === <span class="hljs-string">"error"</span> || (E === <span class="hljs-string">"click"</span> &amp;&amp; H.tagName.toLowerCase() === <span class="hljs-string">"input"</span> &amp;&amp; H.type === <span class="hljs-string">"radio"</span>)) {
        F = H
      }
    }
    <span class="hljs-keyword">if</span> (F.nodeType == Node.TEXT_NODE) {
      F = F.parentNode
    }
    <span class="hljs-keyword">return</span> Element.extend(F)
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">p</span>(<span class="hljs-params">F, G</span>) </span>{
    <span class="hljs-keyword">var</span> E = C.element(F);
    <span class="hljs-keyword">if</span> (!G) {
      <span class="hljs-keyword">return</span> E
    }
    <span class="hljs-keyword">while</span> (E) {
      <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.isElement(E) &amp;&amp; Prototype.Selector.match(E, G)) {
        <span class="hljs-keyword">return</span> Element.extend(E)
      }
      E = E.parentNode
    }
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">s</span>(<span class="hljs-params">E</span>) </span>{
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">x</span>: c(E),
      <span class="hljs-attr">y</span>: b(E)
    }
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">c</span>(<span class="hljs-params">G</span>) </span>{
    <span class="hljs-keyword">var</span> F = <span class="hljs-built_in">document</span>.documentElement,
      E = <span class="hljs-built_in">document</span>.body || {
        <span class="hljs-attr">scrollLeft</span>: <span class="hljs-number">0</span>
      };
    <span class="hljs-keyword">return</span> G.pageX || (G.clientX + (F.scrollLeft || E.scrollLeft) - (F.clientLeft || <span class="hljs-number">0</span>))
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">b</span>(<span class="hljs-params">G</span>) </span>{
    <span class="hljs-keyword">var</span> F = <span class="hljs-built_in">document</span>.documentElement,
      E = <span class="hljs-built_in">document</span>.body || {
        <span class="hljs-attr">scrollTop</span>: <span class="hljs-number">0</span>
      };
    <span class="hljs-keyword">return</span> G.pageY || (G.clientY + (F.scrollTop || E.scrollTop) - (F.clientTop || <span class="hljs-number">0</span>))
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">q</span>(<span class="hljs-params">E</span>) </span>{
    C.extend(E);
    E.preventDefault();
    E.stopPropagation();
    E.stopped = <span class="hljs-literal">true</span>
  }
  C.Methods = {
    <span class="hljs-attr">isLeftClick</span>: v,
    <span class="hljs-attr">isMiddleClick</span>: t,
    <span class="hljs-attr">isRightClick</span>: n,
    <span class="hljs-attr">element</span>: d,
    <span class="hljs-attr">findElement</span>: p,
    <span class="hljs-attr">pointer</span>: s,
    <span class="hljs-attr">pointerX</span>: c,
    <span class="hljs-attr">pointerY</span>: b,
    <span class="hljs-attr">stop</span>: q
  };
  <span class="hljs-keyword">var</span> x = <span class="hljs-built_in">Object</span>.keys(C.Methods).inject({}, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">E, F</span>) </span>{
    E[F] = C.Methods[F].methodize();
    <span class="hljs-keyword">return</span> E
  });
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.attachEvent) {
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">i</span>(<span class="hljs-params">F</span>) </span>{
      <span class="hljs-keyword">var</span> E;
      <span class="hljs-keyword">switch</span> (F.type) {
        <span class="hljs-keyword">case</span> <span class="hljs-string">"mouseover"</span>:
        <span class="hljs-keyword">case</span> <span class="hljs-string">"mouseenter"</span>:
          E = F.fromElement;
          <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-string">"mouseout"</span>:
        <span class="hljs-keyword">case</span> <span class="hljs-string">"mouseleave"</span>:
          E = F.toElement;
          <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">default</span>:
          <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>
      }
      <span class="hljs-keyword">return</span> Element.extend(E)
    }
    <span class="hljs-keyword">var</span> u = {
      <span class="hljs-attr">stopPropagation</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">this</span>.cancelBubble = <span class="hljs-literal">true</span>
      },
      <span class="hljs-attr">preventDefault</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">this</span>.returnValue = <span class="hljs-literal">false</span>
      },
      <span class="hljs-attr">inspect</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-string">"[object Event]"</span>
      }
    };
    C.extend = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">F, E</span>) </span>{
      <span class="hljs-keyword">if</span> (!F) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
      }
      <span class="hljs-keyword">if</span> (!a(F)) {
        <span class="hljs-keyword">return</span> F
      }
      <span class="hljs-keyword">if</span> (F._extendedByPrototype) {
        <span class="hljs-keyword">return</span> F
      }
      F._extendedByPrototype = Prototype.emptyFunction;
      <span class="hljs-keyword">var</span> G = C.pointer(F);
      <span class="hljs-built_in">Object</span>.extend(F, {
        <span class="hljs-attr">target</span>: F.srcElement || E,
        <span class="hljs-attr">relatedTarget</span>: i(F),
        <span class="hljs-attr">pageX</span>: G.x,
        <span class="hljs-attr">pageY</span>: G.y
      });
      <span class="hljs-built_in">Object</span>.extend(F, x);
      <span class="hljs-built_in">Object</span>.extend(F, u);
      <span class="hljs-keyword">return</span> F
    }
  } <span class="hljs-keyword">else</span> {
    C.extend = Prototype.K
  }
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.addEventListener) {
    C.prototype = <span class="hljs-built_in">window</span>.Event.prototype || <span class="hljs-built_in">document</span>.createEvent(<span class="hljs-string">"HTMLEvents"</span>).__proto__;
    <span class="hljs-built_in">Object</span>.extend(C.prototype, x)
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">m</span>(<span class="hljs-params">I, H, J</span>) </span>{
    <span class="hljs-keyword">var</span> G = Element.retrieve(I, <span class="hljs-string">"prototype_event_registry"</span>);
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.isUndefined(G)) {
      e.push(I);
      G = Element.retrieve(I, <span class="hljs-string">"prototype_event_registry"</span>, $H())
    }
    <span class="hljs-keyword">var</span> E = G.get(H);
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.isUndefined(E)) {
      E = [];
      G.set(H, E)
    }
    <span class="hljs-keyword">if</span> (E.pluck(<span class="hljs-string">"handler"</span>).include(J)) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
    }
    <span class="hljs-keyword">var</span> F;
    <span class="hljs-keyword">if</span> (H.include(<span class="hljs-string">":"</span>)) {
      F = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">K</span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.isUndefined(K.eventName)) {
          <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
        }
        <span class="hljs-keyword">if</span> (K.eventName !== H) {
          <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
        }
        C.extend(K, I);
        J.call(I, K)
      }
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">if</span> (!D &amp;&amp; (H === <span class="hljs-string">"mouseenter"</span> || H === <span class="hljs-string">"mouseleave"</span>)) {
        <span class="hljs-keyword">if</span> (H === <span class="hljs-string">"mouseenter"</span> || H === <span class="hljs-string">"mouseleave"</span>) {
          F = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">L</span>) </span>{
            C.extend(L, I);
            <span class="hljs-keyword">var</span> K = L.relatedTarget;
            <span class="hljs-keyword">while</span> (K &amp;&amp; K !== I) {
              <span class="hljs-keyword">try</span> {
                K = K.parentNode
              } <span class="hljs-keyword">catch</span> (M) {
                K = I
              }
            }
            <span class="hljs-keyword">if</span> (K === I) {
              <span class="hljs-keyword">return</span>
            }
            J.call(I, L)
          }
        }
      } <span class="hljs-keyword">else</span> {
        F = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">K</span>) </span>{
          C.extend(K, I);
          J.call(I, K)
        }
      }
    }
    F.handler = J;
    E.push(F);
    <span class="hljs-keyword">return</span> F
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">h</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> E = <span class="hljs-number">0</span>, F = e.length; E &lt; F; E++) {
      C.stopObserving(e[E]);
      e[E] = <span class="hljs-literal">null</span>
    }
  }
  <span class="hljs-keyword">var</span> e = [];
  <span class="hljs-keyword">if</span> (Prototype.Browser.IE) {
    <span class="hljs-built_in">window</span>.attachEvent(<span class="hljs-string">"onunload"</span>, h)
  }
  <span class="hljs-keyword">if</span> (Prototype.Browser.WebKit) {
    <span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">"unload"</span>, Prototype.emptyFunction, <span class="hljs-literal">false</span>)
  }
  <span class="hljs-keyword">var</span> l = Prototype.K,
    g = {
      <span class="hljs-attr">mouseenter</span>: <span class="hljs-string">"mouseover"</span>,
      <span class="hljs-attr">mouseleave</span>: <span class="hljs-string">"mouseout"</span>
    };
  <span class="hljs-keyword">if</span> (!D) {
    l = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">E</span>) </span>{
      <span class="hljs-keyword">return</span> (g[E] || E)
    }
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">w</span>(<span class="hljs-params">H, G, I</span>) </span>{
    H = $(H);
    <span class="hljs-keyword">var</span> F = m(H, G, I);
    <span class="hljs-keyword">if</span> (!F) {
      <span class="hljs-keyword">return</span> H
    }
    <span class="hljs-keyword">if</span> (G.include(<span class="hljs-string">":"</span>)) {
      <span class="hljs-keyword">if</span> (H.addEventListener) {
        H.addEventListener(<span class="hljs-string">"dataavailable"</span>, F, <span class="hljs-literal">false</span>)
      } <span class="hljs-keyword">else</span> {
        H.attachEvent(<span class="hljs-string">"ondataavailable"</span>, F);
        H.attachEvent(<span class="hljs-string">"onlosecapture"</span>, F)
      }
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">var</span> E = l(G);
      <span class="hljs-keyword">if</span> (H.addEventListener) {
        H.addEventListener(E, F, <span class="hljs-literal">false</span>)
      } <span class="hljs-keyword">else</span> {
        H.attachEvent(<span class="hljs-string">"on"</span> + E, F)
      }
    }
    <span class="hljs-keyword">return</span> H
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">k</span>(<span class="hljs-params">K, H, L</span>) </span>{
    K = $(K);
    <span class="hljs-keyword">var</span> G = Element.retrieve(K, <span class="hljs-string">"prototype_event_registry"</span>);
    <span class="hljs-keyword">if</span> (!G) {
      <span class="hljs-keyword">return</span> K
    }
    <span class="hljs-keyword">if</span> (!H) {
      G.each(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">N</span>) </span>{
        <span class="hljs-keyword">var</span> M = N.key;
        k(K, M)
      });
      <span class="hljs-keyword">return</span> K
    }
    <span class="hljs-keyword">var</span> I = G.get(H);
    <span class="hljs-keyword">if</span> (!I) {
      <span class="hljs-keyword">return</span> K
    }
    <span class="hljs-keyword">if</span> (!L) {
      I.each(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">M</span>) </span>{
        k(K, H, M.handler)
      });
      <span class="hljs-keyword">return</span> K
    }
    <span class="hljs-keyword">var</span> J = I.length,
      F;
    <span class="hljs-keyword">while</span> (J--) {
      <span class="hljs-keyword">if</span> (I[J].handler === L) {
        F = I[J];
        <span class="hljs-keyword">break</span>
      }
    }
    <span class="hljs-keyword">if</span> (!F) {
      <span class="hljs-keyword">return</span> K
    }
    <span class="hljs-keyword">if</span> (H.include(<span class="hljs-string">":"</span>)) {
      <span class="hljs-keyword">if</span> (K.removeEventListener) {
        K.removeEventListener(<span class="hljs-string">"dataavailable"</span>, F, <span class="hljs-literal">false</span>)
      } <span class="hljs-keyword">else</span> {
        K.detachEvent(<span class="hljs-string">"ondataavailable"</span>, F);
        K.detachEvent(<span class="hljs-string">"onlosecapture"</span>, F)
      }
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">var</span> E = l(H);
      <span class="hljs-keyword">if</span> (K.removeEventListener) {
        K.removeEventListener(E, F, <span class="hljs-literal">false</span>)
      } <span class="hljs-keyword">else</span> {
        K.detachEvent(<span class="hljs-string">"on"</span> + E, F)
      }
    }
    G.set(H, I.without(F));
    <span class="hljs-keyword">return</span> K
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">z</span>(<span class="hljs-params">H, G, F, E</span>) </span>{
    H = $(H);
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.isUndefined(E)) {
      E = <span class="hljs-literal">true</span>
    }
    <span class="hljs-keyword">if</span> (H == <span class="hljs-built_in">document</span> &amp;&amp; <span class="hljs-built_in">document</span>.createEvent &amp;&amp; !H.dispatchEvent) {
      H = <span class="hljs-built_in">document</span>.documentElement
    }
    <span class="hljs-keyword">var</span> I;
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">document</span>.createEvent) {
      I = <span class="hljs-built_in">document</span>.createEvent(<span class="hljs-string">"HTMLEvents"</span>);
      I.initEvent(<span class="hljs-string">"dataavailable"</span>, E, <span class="hljs-literal">true</span>)
    } <span class="hljs-keyword">else</span> {
      I = <span class="hljs-built_in">document</span>.createEventObject();
      I.eventType = E ? <span class="hljs-string">"ondataavailable"</span> : <span class="hljs-string">"onlosecapture"</span>
    }
    I.eventName = G;
    I.memo = F || {};
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">document</span>.createEvent) {
      H.dispatchEvent(I)
    } <span class="hljs-keyword">else</span> {
      H.fireEvent(I.eventType, I)
    }
    <span class="hljs-keyword">return</span> C.extend(I)
  }
  C.Handler = Class.create({
    <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">G, F, E, H</span>) </span>{
      <span class="hljs-keyword">this</span>.element = $(G);
      <span class="hljs-keyword">this</span>.eventName = F;
      <span class="hljs-keyword">this</span>.selector = E;
      <span class="hljs-keyword">this</span>.callback = H;
      <span class="hljs-keyword">this</span>.handler = <span class="hljs-keyword">this</span>.handleEvent.bind(<span class="hljs-keyword">this</span>)
    },
    <span class="hljs-attr">start</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      C.observe(<span class="hljs-keyword">this</span>.element, <span class="hljs-keyword">this</span>.eventName, <span class="hljs-keyword">this</span>.handler);
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>
    },
    <span class="hljs-attr">stop</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      C.stopObserving(<span class="hljs-keyword">this</span>.element, <span class="hljs-keyword">this</span>.eventName, <span class="hljs-keyword">this</span>.handler);
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>
    },
    <span class="hljs-attr">handleEvent</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">F</span>) </span>{
      <span class="hljs-keyword">var</span> E = C.findElement(F, <span class="hljs-keyword">this</span>.selector);
      <span class="hljs-keyword">if</span> (E) {
        <span class="hljs-keyword">this</span>.callback.call(<span class="hljs-keyword">this</span>.element, F, E)
      }
    }
  });

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">j</span>(<span class="hljs-params">G, F, E, H</span>) </span>{
    G = $(G);
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.isFunction(E) &amp;&amp; <span class="hljs-built_in">Object</span>.isUndefined(H)) {
      H = E, E = <span class="hljs-literal">null</span>
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> C.Handler(G, F, E, H).start()
  }
  <span class="hljs-built_in">Object</span>.extend(C, C.Methods);
  <span class="hljs-built_in">Object</span>.extend(C, {
    <span class="hljs-attr">fire</span>: z,
    <span class="hljs-attr">observe</span>: w,
    <span class="hljs-attr">stopObserving</span>: k,
    <span class="hljs-attr">on</span>: j
  });
  Element.addMethods({
    <span class="hljs-attr">fire</span>: z,
    <span class="hljs-attr">observe</span>: w,
    <span class="hljs-attr">stopObserving</span>: k,
    <span class="hljs-attr">on</span>: j
  });
  <span class="hljs-built_in">Object</span>.extend(<span class="hljs-built_in">document</span>, {
    <span class="hljs-attr">fire</span>: z.methodize(),
    <span class="hljs-attr">observe</span>: w.methodize(),
    <span class="hljs-attr">stopObserving</span>: k.methodize(),
    <span class="hljs-attr">on</span>: j.methodize(),
    <span class="hljs-attr">loaded</span>: <span class="hljs-literal">false</span>
  });
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.Event) {
    <span class="hljs-built_in">Object</span>.extend(<span class="hljs-built_in">window</span>.Event, C)
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-built_in">window</span>.Event = C
  }
})();
(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> d;

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">a</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">document</span>.loaded) {
      <span class="hljs-keyword">return</span>
    }
    <span class="hljs-keyword">if</span> (d) {
      <span class="hljs-built_in">window</span>.clearTimeout(d)
    }
    <span class="hljs-built_in">document</span>.loaded = <span class="hljs-literal">true</span>;
    <span class="hljs-built_in">document</span>.fire(<span class="hljs-string">"dom:loaded"</span>)
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">c</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">document</span>.readyState === <span class="hljs-string">"complete"</span>) {
      <span class="hljs-built_in">document</span>.stopObserving(<span class="hljs-string">"readystatechange"</span>, c);
      a()
    }
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">b</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">try</span> {
      <span class="hljs-built_in">document</span>.documentElement.doScroll(<span class="hljs-string">"left"</span>)
    } <span class="hljs-keyword">catch</span> (f) {
      d = b.defer();
      <span class="hljs-keyword">return</span>
    }
    a()
  }
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">document</span>.addEventListener) {
    <span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">"DOMContentLoaded"</span>, a, <span class="hljs-literal">false</span>)
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-built_in">document</span>.observe(<span class="hljs-string">"readystatechange"</span>, c);
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span> == top) {
      d = b.defer()
    }
  }
  Event.observe(<span class="hljs-built_in">window</span>, <span class="hljs-string">"load"</span>, a)
})();
Element.addMethods();
Hash.toQueryString = <span class="hljs-built_in">Object</span>.toQueryString;
<span class="hljs-keyword">var</span> Toggle = {
  <span class="hljs-attr">display</span>: Element.toggle
};
Element.Methods.childOf = Element.Methods.descendantOf;
<span class="hljs-keyword">var</span> Insertion = {
  <span class="hljs-attr">Before</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a, b</span>) </span>{
    <span class="hljs-keyword">return</span> Element.insert(a, {
      <span class="hljs-attr">before</span>: b
    })
  },
  <span class="hljs-attr">Top</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a, b</span>) </span>{
    <span class="hljs-keyword">return</span> Element.insert(a, {
      <span class="hljs-attr">top</span>: b
    })
  },
  <span class="hljs-attr">Bottom</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a, b</span>) </span>{
    <span class="hljs-keyword">return</span> Element.insert(a, {
      <span class="hljs-attr">bottom</span>: b
    })
  },
  <span class="hljs-attr">After</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a, b</span>) </span>{
    <span class="hljs-keyword">return</span> Element.insert(a, {
      <span class="hljs-attr">after</span>: b
    })
  }
};
<span class="hljs-keyword">var</span> $<span class="hljs-keyword">continue</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'"throw $continue" is deprecated, use "return" instead'</span>);
<span class="hljs-keyword">var</span> Position = {
  <span class="hljs-attr">includeScrollOffsets</span>: <span class="hljs-literal">false</span>,
  <span class="hljs-attr">prepare</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>.deltaX = <span class="hljs-built_in">window</span>.pageXOffset || <span class="hljs-built_in">document</span>.documentElement.scrollLeft || <span class="hljs-built_in">document</span>.body.scrollLeft || <span class="hljs-number">0</span>;
    <span class="hljs-keyword">this</span>.deltaY = <span class="hljs-built_in">window</span>.pageYOffset || <span class="hljs-built_in">document</span>.documentElement.scrollTop || <span class="hljs-built_in">document</span>.body.scrollTop || <span class="hljs-number">0</span>
  },
  <span class="hljs-attr">within</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">b, a, c</span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.includeScrollOffsets) {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.withinIncludingScrolloffsets(b, a, c)
    }
    <span class="hljs-keyword">this</span>.xcomp = a;
    <span class="hljs-keyword">this</span>.ycomp = c;
    <span class="hljs-keyword">this</span>.offset = Element.cumulativeOffset(b);
    <span class="hljs-keyword">return</span> (c &gt;= <span class="hljs-keyword">this</span>.offset[<span class="hljs-number">1</span>] &amp;&amp; c &lt; <span class="hljs-keyword">this</span>.offset[<span class="hljs-number">1</span>] + b.offsetHeight &amp;&amp; a &gt;= <span class="hljs-keyword">this</span>.offset[<span class="hljs-number">0</span>] &amp;&amp; a &lt; <span class="hljs-keyword">this</span>.offset[<span class="hljs-number">0</span>] + b.offsetWidth)
  },
  <span class="hljs-attr">withinIncludingScrolloffsets</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">b, a, d</span>) </span>{
    <span class="hljs-keyword">var</span> c = Element.cumulativeScrollOffset(b);
    <span class="hljs-keyword">this</span>.xcomp = a + c[<span class="hljs-number">0</span>] - <span class="hljs-keyword">this</span>.deltaX;
    <span class="hljs-keyword">this</span>.ycomp = d + c[<span class="hljs-number">1</span>] - <span class="hljs-keyword">this</span>.deltaY;
    <span class="hljs-keyword">this</span>.offset = Element.cumulativeOffset(b);
    <span class="hljs-keyword">return</span> (<span class="hljs-keyword">this</span>.ycomp &gt;= <span class="hljs-keyword">this</span>.offset[<span class="hljs-number">1</span>] &amp;&amp; <span class="hljs-keyword">this</span>.ycomp &lt; <span class="hljs-keyword">this</span>.offset[<span class="hljs-number">1</span>] + b.offsetHeight &amp;&amp; <span class="hljs-keyword">this</span>.xcomp &gt;= <span class="hljs-keyword">this</span>.offset[<span class="hljs-number">0</span>] &amp;&amp; <span class="hljs-keyword">this</span>.xcomp &lt; <span class="hljs-keyword">this</span>.offset[<span class="hljs-number">0</span>] + b.offsetWidth)
  },
  <span class="hljs-attr">overlap</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">b, a</span>) </span>{
    <span class="hljs-keyword">if</span> (!b) {
      <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>
    }
    <span class="hljs-keyword">if</span> (b == <span class="hljs-string">"vertical"</span>) {
      <span class="hljs-keyword">return</span> ((<span class="hljs-keyword">this</span>.offset[<span class="hljs-number">1</span>] + a.offsetHeight) - <span class="hljs-keyword">this</span>.ycomp) / a.offsetHeight
    }
    <span class="hljs-keyword">if</span> (b == <span class="hljs-string">"horizontal"</span>) {
      <span class="hljs-keyword">return</span> ((<span class="hljs-keyword">this</span>.offset[<span class="hljs-number">0</span>] + a.offsetWidth) - <span class="hljs-keyword">this</span>.xcomp) / a.offsetWidth
    }
  },
  <span class="hljs-attr">cumulativeOffset</span>: Element.Methods.cumulativeOffset,
  <span class="hljs-attr">positionedOffset</span>: Element.Methods.positionedOffset,
  <span class="hljs-attr">absolutize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
    Position.prepare();
    <span class="hljs-keyword">return</span> Element.absolutize(a)
  },
  <span class="hljs-attr">relativize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
    Position.prepare();
    <span class="hljs-keyword">return</span> Element.relativize(a)
  },
  <span class="hljs-attr">realOffset</span>: Element.Methods.cumulativeScrollOffset,
  <span class="hljs-attr">offsetParent</span>: Element.Methods.getOffsetParent,
  <span class="hljs-attr">page</span>: Element.Methods.viewportOffset,
  <span class="hljs-attr">clone</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">b, c, a</span>) </span>{
    a = a || {};
    <span class="hljs-keyword">return</span> Element.clonePosition(c, b, a)
  }
};
<span class="hljs-keyword">if</span> (!<span class="hljs-built_in">document</span>.getElementsByClassName) {
  <span class="hljs-built_in">document</span>.getElementsByClassName = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">b</span>) </span>{
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">a</span>(<span class="hljs-params">c</span>) </span>{
      <span class="hljs-keyword">return</span> c.blank() ? <span class="hljs-literal">null</span> : <span class="hljs-string">"[contains(concat(' ', @class, ' '), ' "</span> + c + <span class="hljs-string">" ')]"</span>
    }
    b.getElementsByClassName = Prototype.BrowserFeatures.XPath ? <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">c, e</span>) </span>{
      e = e.toString().strip();
      <span class="hljs-keyword">var</span> d = <span class="hljs-regexp">/\s/</span>.test(e) ? $w(e).map(a).join(<span class="hljs-string">""</span>) : a(e);
      <span class="hljs-keyword">return</span> d ? <span class="hljs-built_in">document</span>._getElementsByXPath(<span class="hljs-string">".//*"</span> + d, c) : []
    } : <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e, f</span>) </span>{
      f = f.toString().strip();
      <span class="hljs-keyword">var</span> g = [],
        h = (<span class="hljs-regexp">/\s/</span>.test(f) ? $w(f) : <span class="hljs-literal">null</span>);
      <span class="hljs-keyword">if</span> (!h &amp;&amp; !f) {
        <span class="hljs-keyword">return</span> g
      }
      <span class="hljs-keyword">var</span> c = $(e).getElementsByTagName(<span class="hljs-string">"*"</span>);
      f = <span class="hljs-string">" "</span> + f + <span class="hljs-string">" "</span>;
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> d = <span class="hljs-number">0</span>, k, j; k = c[d]; d++) {
        <span class="hljs-keyword">if</span> (k.className &amp;&amp; (j = <span class="hljs-string">" "</span> + k.className + <span class="hljs-string">" "</span>) &amp;&amp; (j.include(f) || (h &amp;&amp; h.all(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">i</span>) </span>{
            <span class="hljs-keyword">return</span> !i.toString().blank() &amp;&amp; j.include(<span class="hljs-string">" "</span> + i + <span class="hljs-string">" "</span>)
          })))) {
          g.push(Element.extend(k))
        }
      }
      <span class="hljs-keyword">return</span> g
    };
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">d, c</span>) </span>{
      <span class="hljs-keyword">return</span> $(c || <span class="hljs-built_in">document</span>.body).getElementsByClassName(d)
    }
  }(Element.Methods)
}
Element.ClassNames = Class.create();
Element.ClassNames.prototype = {
  <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
    <span class="hljs-keyword">this</span>.element = $(a)
  },
  <span class="hljs-attr">_each</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
    <span class="hljs-keyword">this</span>.element.className.split(<span class="hljs-regexp">/\s+/</span>).select(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">b</span>) </span>{
      <span class="hljs-keyword">return</span> b.length &gt; <span class="hljs-number">0</span>
    })._each(a)
  },
  <span class="hljs-attr">set</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
    <span class="hljs-keyword">this</span>.element.className = a
  },
  <span class="hljs-attr">add</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.include(a)) {
      <span class="hljs-keyword">return</span>
    }
    <span class="hljs-keyword">this</span>.set($A(<span class="hljs-keyword">this</span>).concat(a).join(<span class="hljs-string">" "</span>))
  },
  <span class="hljs-attr">remove</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.include(a)) {
      <span class="hljs-keyword">return</span>
    }
    <span class="hljs-keyword">this</span>.set($A(<span class="hljs-keyword">this</span>).without(a).join(<span class="hljs-string">" "</span>))
  },
  <span class="hljs-attr">toString</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> $A(<span class="hljs-keyword">this</span>).join(<span class="hljs-string">" "</span>)
  }
};
<span class="hljs-built_in">Object</span>.extend(Element.ClassNames.prototype, Enumerable);
(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-built_in">window</span>.Selector = Class.create({
    <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
      <span class="hljs-keyword">this</span>.expression = a.strip()
    },
    <span class="hljs-attr">findElements</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
      <span class="hljs-keyword">return</span> Prototype.Selector.select(<span class="hljs-keyword">this</span>.expression, a)
    },
    <span class="hljs-attr">match</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
      <span class="hljs-keyword">return</span> Prototype.Selector.match(a, <span class="hljs-keyword">this</span>.expression)
    },
    <span class="hljs-attr">toString</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.expression
    },
    <span class="hljs-attr">inspect</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-string">"#&lt;Selector: "</span> + <span class="hljs-keyword">this</span>.expression + <span class="hljs-string">"&gt;"</span>
    }
  });
  <span class="hljs-built_in">Object</span>.extend(Selector, {
    <span class="hljs-attr">matchElements</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">f, g</span>) </span>{
      <span class="hljs-keyword">var</span> a = Prototype.Selector.match,
        d = [];
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> c = <span class="hljs-number">0</span>, e = f.length; c &lt; e; c++) {
        <span class="hljs-keyword">var</span> b = f[c];
        <span class="hljs-keyword">if</span> (a(b, g)) {
          d.push(Element.extend(b))
        }
      }
      <span class="hljs-keyword">return</span> d
    },
    <span class="hljs-attr">findElement</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">f, g, b</span>) </span>{
      b = b || <span class="hljs-number">0</span>;
      <span class="hljs-keyword">var</span> a = <span class="hljs-number">0</span>,
        d;
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> c = <span class="hljs-number">0</span>, e = f.length; c &lt; e; c++) {
        d = f[c];
        <span class="hljs-keyword">if</span> (Prototype.Selector.match(d, g) &amp;&amp; b === a++) {
          <span class="hljs-keyword">return</span> Element.extend(d)
        }
      }
    },
    <span class="hljs-attr">findChildElements</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">b, c</span>) </span>{
      <span class="hljs-keyword">var</span> a = c.toArray().join(<span class="hljs-string">", "</span>);
      <span class="hljs-keyword">return</span> Prototype.Selector.select(a, b || <span class="hljs-built_in">document</span>)
    }
  })
})();
<span class="hljs-comment">/*! RESOURCE: /scripts/lib/glide_updates/prototype.js */</span>
<span class="hljs-built_in">Object</span>.extendsObject = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> Class.create.apply(<span class="hljs-literal">null</span>, <span class="hljs-built_in">arguments</span>).prototype;
}
Prototype.ScriptFragmentDetailed = <span class="hljs-string">'&lt;script(?:[^&gt;]*type=\"([^&gt;]*?)\")?(?:[^&gt;]*src=\"([^&gt;]*?)\")?[^&gt;]*&gt;([\\S\\s]*?)&lt;\/script&gt;'</span>;
<span class="hljs-keyword">var</span> g_evalScriptCache = {};
<span class="hljs-built_in">Object</span>.extend(<span class="hljs-built_in">String</span>.prototype, (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">extractScriptsDetailed</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> matchAll = <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(Prototype.ScriptFragmentDetailed, <span class="hljs-string">'img'</span>);
    <span class="hljs-keyword">var</span> matchOne = <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(Prototype.ScriptFragmentDetailed, <span class="hljs-string">'im'</span>);
    <span class="hljs-keyword">return</span> (<span class="hljs-keyword">this</span>.match(matchAll) || []).map(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">scriptTag</span>) </span>{
      <span class="hljs-keyword">var</span> m = scriptTag.match(matchOne) || [<span class="hljs-string">''</span>, <span class="hljs-string">''</span>, <span class="hljs-string">''</span>, <span class="hljs-string">''</span>];
      <span class="hljs-keyword">if</span> (m[<span class="hljs-number">1</span>] == <span class="hljs-string">'application/xml'</span>)
        <span class="hljs-keyword">return</span>;
      <span class="hljs-keyword">if</span> (m[<span class="hljs-number">1</span>] == <span class="hljs-string">'text/html'</span>)
        <span class="hljs-keyword">return</span>;
      <span class="hljs-keyword">if</span> (m[<span class="hljs-number">1</span>] == <span class="hljs-string">'text/ng-template'</span>)
        <span class="hljs-keyword">return</span>;
      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">script</span>: m[<span class="hljs-number">3</span>],
        <span class="hljs-attr">src</span>: m[<span class="hljs-number">2</span>]
      };
    });
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">evalScripts</span>(<span class="hljs-params">evalGlobal</span>) </span>{
    (<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_executer</span>(<span class="hljs-params">scripts</span>) </span>{
      <span class="hljs-keyword">if</span> (!scripts || scripts.length == <span class="hljs-number">0</span>)
        <span class="hljs-keyword">return</span>;
      <span class="hljs-keyword">var</span> script = scripts.shift();
      <span class="hljs-keyword">if</span> (!script)
        <span class="hljs-keyword">return</span> _executer(scripts);
      <span class="hljs-keyword">if</span> (script.src) {
        <span class="hljs-keyword">if</span> (!g_evalScriptCache[script.src]) {
          g_evalScriptCache[script.src] = {
            <span class="hljs-attr">state</span>: <span class="hljs-string">'loading'</span>,
            <span class="hljs-attr">scripts</span>: scripts
          };
          ajaxRequest(script.src, <span class="hljs-literal">null</span>, <span class="hljs-literal">true</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">r</span>) </span>{
            g_evalScriptCache[script.src].state = <span class="hljs-string">'loaded'</span>;
            <span class="hljs-keyword">var</span> toEvalScripts = g_evalScriptCache[script.src].scripts;
            <span class="hljs-keyword">if</span> (r &amp;&amp; r.responseText)
              evalScript(r.responseText, evalGlobal);
            <span class="hljs-keyword">return</span> _executer(toEvalScripts);
          });
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (g_evalScriptCache[script.src].state == <span class="hljs-string">'loading'</span>) {
          g_evalScriptCache[script.src].scripts = g_evalScriptCache[script.src].scripts.concat(scripts);
          <span class="hljs-keyword">return</span>;
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (g_evalScriptCache[script.src].state == <span class="hljs-string">'loaded'</span>)
          <span class="hljs-keyword">return</span> _executer(scripts);
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">if</span> (script.script)
          evalScript(script.script, evalGlobal);
        <span class="hljs-keyword">return</span> _executer(scripts);
      }
    })(<span class="hljs-keyword">this</span>.extractScriptsDetailed());
  }
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">evalScripts</span>: evalScripts,
    <span class="hljs-attr">extractScriptsDetailed</span>: extractScriptsDetailed
  };
})());

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">evalScript</span>(<span class="hljs-params">s, evalGlobal</span>) </span>{
  <span class="hljs-keyword">if</span> (s.length == <span class="hljs-number">0</span>)
    <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">if</span> (!evalGlobal)
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">eval</span>(s);
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.execScript)
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">window</span>.execScript(s);
  <span class="hljs-keyword">return</span> <span class="hljs-built_in">window</span>.eval ? <span class="hljs-built_in">window</span>.eval(s) : <span class="hljs-built_in">eval</span>(s);
}
<span class="hljs-keyword">if</span> (<span class="hljs-built_in">document</span>.getElementsByClassName &amp;&amp; <span class="hljs-keyword">typeof</span> Element.Methods.getElementsByClassName === <span class="hljs-string">"function"</span>)
  <span class="hljs-built_in">document</span>.getElementsByClassName = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">instanceMethods</span>) </span>{
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">iter</span>(<span class="hljs-params">name</span>) </span>{
      <span class="hljs-keyword">return</span> name.blank() ? <span class="hljs-literal">null</span> : <span class="hljs-string">"[contains(concat(' ', @class, ' '), ' "</span> + name + <span class="hljs-string">" ')]"</span>;
    }
    instanceMethods.getElementsByClassName = Prototype.BrowserFeatures.XPath ? <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">element, className</span>) </span>{
      className = className.toString().strip();
      <span class="hljs-keyword">var</span> cond = <span class="hljs-regexp">/\s/</span>.test(className) ? $w(className).map(iter).join(<span class="hljs-string">''</span>) : iter(className);
      <span class="hljs-keyword">return</span> cond ? <span class="hljs-built_in">document</span>._getElementsByXPath(<span class="hljs-string">'.//*'</span> + cond, element) : [];
    } : <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">element, className</span>) </span>{
      className = className.toString().strip();
      <span class="hljs-keyword">var</span> elements = [],
        classNames = (<span class="hljs-regexp">/\s/</span>.test(className) ? $w(className) : <span class="hljs-literal">null</span>);
      <span class="hljs-keyword">if</span> (!classNames &amp;&amp; !className)
        <span class="hljs-keyword">return</span> elements;
      <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.isString(element))
        element = <span class="hljs-built_in">document</span>.getElementById(element);
      Element.extend(element);
      <span class="hljs-keyword">var</span> nodes = element.getElementsByTagName(<span class="hljs-string">'*'</span>);
      className = <span class="hljs-string">' '</span> + className + <span class="hljs-string">' '</span>;
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, child, cn; child = nodes[i]; i++) {
        <span class="hljs-keyword">if</span> (child.className &amp;&amp; (cn = <span class="hljs-string">' '</span> + child.className + <span class="hljs-string">' '</span>) &amp;&amp;
          (cn.include(className) || (classNames &amp;&amp; classNames.all(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name</span>) </span>{
            <span class="hljs-keyword">return</span> !name.toString().blank() &amp;&amp; cn.include(<span class="hljs-string">' '</span> + name + <span class="hljs-string">' '</span>);
          }))))
          elements.push(Element.extend(child));
      }
      <span class="hljs-keyword">return</span> elements;
    };
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">className, parentElement</span>) </span>{
      <span class="hljs-keyword">return</span> $(parentElement || <span class="hljs-built_in">document</span>.body).getElementsByClassName(className);
    };
  }(Element.Methods);
<span class="hljs-built_in">Object</span>.equals = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">o1, o2</span>) </span>{
  <span class="hljs-keyword">var</span> i1 = <span class="hljs-number">0</span>,
    i2 = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> p <span class="hljs-keyword">in</span> o1) {
    <span class="hljs-keyword">if</span> (!o1 || !o2 || <span class="hljs-keyword">typeof</span> o1[p] !== <span class="hljs-keyword">typeof</span> o2[p] || ((o1[p] === <span class="hljs-literal">null</span>) !== (o2[p] === <span class="hljs-literal">null</span>)))
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">switch</span> (<span class="hljs-keyword">typeof</span> o1[p]) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">'undefined'</span>:
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> o2[p] != <span class="hljs-string">'undefined'</span>)
          <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">'object'</span>:
        <span class="hljs-keyword">if</span> (o1[p] !== <span class="hljs-literal">null</span> &amp;&amp; o2[p] !== <span class="hljs-literal">null</span> &amp;&amp; (o1[p].constructor.toString() !== o2[p].constructor.toString() || !<span class="hljs-built_in">Object</span>.equals(o1[p], o2[p])))
          <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">'function'</span>:
        <span class="hljs-keyword">if</span> (p != <span class="hljs-string">'equals'</span> &amp;&amp; o1[p].toString() != o2[p].toString())
          <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">default</span>:
        <span class="hljs-keyword">if</span> (o1[p] !== o2[p])
          <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
    i1++;
  }
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> p <span class="hljs-keyword">in</span> o2) i2++;
  <span class="hljs-keyword">if</span> (i1 != i2)
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
}
<span class="hljs-built_in">document</span>.viewport[<span class="hljs-string">'getDimensions'</span>] = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> el = <span class="hljs-built_in">window</span>.document.compatMode === <span class="hljs-string">'CSS1Compat'</span> &amp;&amp; (!Prototype.Browser.Opera ||
    <span class="hljs-built_in">window</span>.parseFloat(<span class="hljs-built_in">window</span>.opera.version()) &lt; <span class="hljs-number">9.5</span>) ? <span class="hljs-built_in">window</span>.document.documentElement : <span class="hljs-built_in">window</span>.document.body;
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">width</span>: el.clientWidth,
    <span class="hljs-attr">height</span>: el.clientHeight
  };
};;
<span class="hljs-comment">/*! RESOURCE: /scripts/lib/glide_updates/prototype.template.js */</span>
<span class="hljs-keyword">var</span> Template = Class.create({
  <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">template</span>) </span>{
    <span class="hljs-keyword">this</span>.template = template.toString();
    <span class="hljs-keyword">this</span>.pattern = <span class="hljs-regexp">/(^|.|\r|\n)(#\{((JS|HTML):)?(.*?)\})/</span>;
  },
  <span class="hljs-attr">evaluate</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">object</span>) </span>{
    <span class="hljs-keyword">if</span> (object &amp;&amp; <span class="hljs-built_in">Object</span>.isFunction(object.toTemplateReplacements))
      object = object.toTemplateReplacements();
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.template.gsub(<span class="hljs-keyword">this</span>.pattern, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">match</span>) </span>{
      <span class="hljs-keyword">if</span> (object === <span class="hljs-literal">null</span>)
        <span class="hljs-keyword">return</span> (match[<span class="hljs-number">1</span>] + <span class="hljs-string">''</span>);
      <span class="hljs-keyword">var</span> before = match[<span class="hljs-number">1</span>] || <span class="hljs-string">''</span>;
      <span class="hljs-keyword">if</span> (before === <span class="hljs-string">'\\'</span>)
        <span class="hljs-keyword">return</span> match[<span class="hljs-number">2</span>];
      <span class="hljs-keyword">var</span> ctx = object,
        expr = match[<span class="hljs-number">5</span>],
        <span class="hljs-built_in">escape</span> = match[<span class="hljs-number">4</span>],
        pattern = <span class="hljs-regexp">/^([^.[]+|\[((?:.*?[^\\])?)\])(\.|\[|$)/</span>;
      match = pattern.exec(expr);
      <span class="hljs-keyword">if</span> (match === <span class="hljs-literal">null</span>)
        <span class="hljs-keyword">return</span> before;
      <span class="hljs-keyword">while</span> (match != <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">var</span> comp = match[<span class="hljs-number">1</span>].startsWith(<span class="hljs-string">'['</span>) ? match[<span class="hljs-number">2</span>].replace(<span class="hljs-regexp">/\\\\]/g</span>, <span class="hljs-string">']'</span>) : match[<span class="hljs-number">1</span>];
        ctx = ctx[comp];
        <span class="hljs-keyword">if</span> (<span class="hljs-literal">null</span> === ctx || <span class="hljs-string">''</span> === match[<span class="hljs-number">3</span>])
          <span class="hljs-keyword">break</span>;
        expr = expr.substring(<span class="hljs-string">'['</span> === match[<span class="hljs-number">3</span>] ? match[<span class="hljs-number">1</span>].length : match[<span class="hljs-number">0</span>].length);
        match = pattern.exec(expr);
      }
      ctx = ctx || <span class="hljs-string">''</span>;
      <span class="hljs-keyword">switch</span> (<span class="hljs-built_in">escape</span> || <span class="hljs-string">''</span>) {
        <span class="hljs-keyword">case</span> <span class="hljs-string">'HTML'</span>:
          ctx = ctx.replace(<span class="hljs-regexp">/'/g</span>, <span class="hljs-string">'&amp;#39;'</span>).replace(<span class="hljs-regexp">/"/g</span>, <span class="hljs-string">'&amp;#34;'</span>).replace(<span class="hljs-regexp">/&amp;(?![#|l|g])/g</span>, <span class="hljs-string">'&amp;amp;'</span>).replace(<span class="hljs-regexp">/\&lt;/g</span>, <span class="hljs-string">'&amp;lt;'</span>).replace(<span class="hljs-regexp">/\&gt;/g</span>, <span class="hljs-string">'&amp;gt;'</span>);
          <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-string">'JS'</span>:
          ctx = ctx.replace(<span class="hljs-regexp">/'/g</span>, <span class="hljs-string">'&amp;#39;'</span>).replace(<span class="hljs-regexp">/"/g</span>, <span class="hljs-string">'&amp;#34;'</span>);
          <span class="hljs-keyword">break</span>;
      }
      <span class="hljs-keyword">return</span> before + <span class="hljs-built_in">String</span>.interpret(ctx);
    });
  }
});
<span class="hljs-keyword">var</span> XMLTemplate = Class.create(Template, {
  <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$super, id</span>) </span>{
    <span class="hljs-keyword">var</span> s = $(id);
    $<span class="hljs-keyword">super</span>(s &amp;&amp; s.innerHTML ? s.innerHTML.replace(<span class="hljs-regexp">/%7B/g</span>, <span class="hljs-string">'{'</span>).replace(<span class="hljs-regexp">/%7D/g</span>, <span class="hljs-string">'}'</span>) : <span class="hljs-string">''</span>);
  },
  <span class="hljs-attr">toString</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-string">'XMLTemplate'</span>;
  }
});;
<span class="hljs-comment">/*! RESOURCE: /scripts/lib/glide_updates/prototype.plugin.js */</span>
<span class="hljs-keyword">var</span> Plugin = (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">create</span>(<span class="hljs-params">name</span>) </span>{
    <span class="hljs-keyword">var</span> args = $A(<span class="hljs-built_in">arguments</span>);
    args.shift();
    <span class="hljs-keyword">var</span> klass = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">argumentArray</span>) </span>{
      <span class="hljs-keyword">this</span>.initialize.apply(<span class="hljs-keyword">this</span>, argumentArray);
    };
    <span class="hljs-built_in">Object</span>.extend(klass, Class.Methods);
    <span class="hljs-built_in">Object</span>.extend(klass.prototype, args[<span class="hljs-number">0</span>] || {});
    <span class="hljs-keyword">if</span> (!klass.prototype.initialize)
      klass.prototype.initialize = Prototype.emptyFunction;
    klass.prototype.constructor = klass;
    <span class="hljs-keyword">var</span> methods = {};
    methods[name] = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">elem</span>) </span>{
      <span class="hljs-keyword">new</span> klass(<span class="hljs-built_in">arguments</span>);
      <span class="hljs-keyword">return</span> elem;
    }.bind(<span class="hljs-keyword">this</span>);
    Element.addMethods(methods);
  };
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">create</span>: create
  };
})();;
<span class="hljs-comment">/*! RESOURCE: /scripts/lib/labjs/LAB.min.js */</span>
<span class="hljs-comment">/*! LAB.js (LABjs :: Loading And Blocking JavaScript)
    v2.0.3 (c) Kyle Simpson
    MIT License
*/</span>
(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">o</span>) </span>{
  <span class="hljs-keyword">var</span> K = o.$LAB,
    y = <span class="hljs-string">"UseLocalXHR"</span>,
    z = <span class="hljs-string">"AlwaysPreserveOrder"</span>,
    u = <span class="hljs-string">"AllowDuplicates"</span>,
    A = <span class="hljs-string">"CacheBust"</span>,
    B = <span class="hljs-string">"BasePath"</span>,
    C = <span class="hljs-regexp">/^[^?#]*\//</span>.exec(location.href)[<span class="hljs-number">0</span>],
    D = <span class="hljs-regexp">/^\w+\:\/\/\/?[^\/]+/</span>.exec(C)[<span class="hljs-number">0</span>],
    i = <span class="hljs-built_in">document</span>.head || <span class="hljs-built_in">document</span>.getElementsByTagName(<span class="hljs-string">"head"</span>),
    L = (o.opera &amp;&amp; <span class="hljs-built_in">Object</span>.prototype.toString.call(o.opera) == <span class="hljs-string">"[object Opera]"</span>) || (<span class="hljs-string">"MozAppearance"</span> <span class="hljs-keyword">in</span> <span class="hljs-built_in">document</span>.documentElement.style),
    q = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"script"</span>),
    E = <span class="hljs-keyword">typeof</span> q.preload == <span class="hljs-string">"boolean"</span>,
    r = E || (q.readyState &amp;&amp; q.readyState == <span class="hljs-string">"uninitialized"</span>),
    F = !r &amp;&amp; q.async === <span class="hljs-literal">true</span>,
    M = !r &amp;&amp; !F &amp;&amp; !L;

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">G</span>(<span class="hljs-params">a</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">Object</span>.prototype.toString.call(a) == <span class="hljs-string">"[object Function]"</span>
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">H</span>(<span class="hljs-params">a</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">Object</span>.prototype.toString.call(a) == <span class="hljs-string">"[object Array]"</span>
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">N</span>(<span class="hljs-params">a, c</span>) </span>{
    <span class="hljs-keyword">var</span> b = <span class="hljs-regexp">/^\w+\:\/\//</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-regexp">/^\/\/\/?/</span>.test(a)) {
      a = location.protocol + a
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!b.test(a) &amp;&amp; a.charAt(<span class="hljs-number">0</span>) != <span class="hljs-string">"/"</span>) {
      a = (c || <span class="hljs-string">""</span>) + a
    }
    <span class="hljs-keyword">return</span> b.test(a) ? a : ((a.charAt(<span class="hljs-number">0</span>) == <span class="hljs-string">"/"</span> ? D : C) + a)
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">s</span>(<span class="hljs-params">a, c</span>) </span>{
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> b <span class="hljs-keyword">in</span> a) {
      <span class="hljs-keyword">if</span> (a.hasOwnProperty(b)) {
        c[b] = a[b]
      }
    }
    <span class="hljs-keyword">return</span> c
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">O</span>(<span class="hljs-params">a</span>) </span>{
    <span class="hljs-keyword">var</span> c = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> b = <span class="hljs-number">0</span>; b &lt; a.scripts.length; b++) {
      <span class="hljs-keyword">if</span> (a.scripts[b].ready &amp;&amp; a.scripts[b].exec_trigger) {
        c = <span class="hljs-literal">true</span>;
        a.scripts[b].exec_trigger();
        a.scripts[b].exec_trigger = <span class="hljs-literal">null</span>
      }
    }
    <span class="hljs-keyword">return</span> c
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">t</span>(<span class="hljs-params">a, c, b, d</span>) </span>{
    a.onload = a.onreadystatechange = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">if</span> ((a.readyState &amp;&amp; a.readyState != <span class="hljs-string">"complete"</span> &amp;&amp; a.readyState != <span class="hljs-string">"loaded"</span>) || c[b]) <span class="hljs-keyword">return</span>;
      a.onload = a.onreadystatechange = <span class="hljs-literal">null</span>;
      d()
    }
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">I</span>(<span class="hljs-params">a</span>) </span>{
    a.ready = a.finished = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> c = <span class="hljs-number">0</span>; c &lt; a.finished_listeners.length; c++) {
      a.finished_listeners[c]()
    }
    a.ready_listeners = [];
    a.finished_listeners = []
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">P</span>(<span class="hljs-params">d, f, e, g, h</span>) </span>{
    setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> a, c = f.real_src,
        b;
      <span class="hljs-keyword">if</span> (<span class="hljs-string">"item"</span> <span class="hljs-keyword">in</span> i) {
        <span class="hljs-keyword">if</span> (!i[<span class="hljs-number">0</span>]) {
          setTimeout(<span class="hljs-built_in">arguments</span>.callee, <span class="hljs-number">25</span>);
          <span class="hljs-keyword">return</span>
        }
        i = i[<span class="hljs-number">0</span>]
      }
      a = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"script"</span>);
      <span class="hljs-keyword">if</span> (f.type) a.type = f.type;
      <span class="hljs-keyword">if</span> (f.charset) a.charset = f.charset;
      <span class="hljs-keyword">if</span> (h) {
        <span class="hljs-keyword">if</span> (r) {
          e.elem = a;
          <span class="hljs-keyword">if</span> (E) {
            a.preload = <span class="hljs-literal">true</span>;
            a.onpreload = g
          } <span class="hljs-keyword">else</span> {
            a.onreadystatechange = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
              <span class="hljs-keyword">if</span> (a.readyState == <span class="hljs-string">"loaded"</span>) g()
            }
          }
          a.src = c
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (h &amp;&amp; c.indexOf(D) == <span class="hljs-number">0</span> &amp;&amp; d[y]) {
          b = <span class="hljs-keyword">new</span> XMLHttpRequest();
          b.onreadystatechange = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">if</span> (b.readyState == <span class="hljs-number">4</span>) {
              b.onreadystatechange = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{};
              e.text = b.responseText + <span class="hljs-string">"\n//@ sourceURL="</span> + c;
              g()
            }
          };
          b.open(<span class="hljs-string">"GET"</span>, c);
          b.send()
        } <span class="hljs-keyword">else</span> {
          a.type = <span class="hljs-string">"text/cache-script"</span>;
          t(a, e, <span class="hljs-string">"ready"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            i.removeChild(a);
            g()
          });
          a.src = c;
          i.insertBefore(a, i.firstChild)
        }
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (F) {
        a.async = <span class="hljs-literal">false</span>;
        t(a, e, <span class="hljs-string">"finished"</span>, g);
        a.src = c;
        i.insertBefore(a, i.firstChild)
      } <span class="hljs-keyword">else</span> {
        t(a, e, <span class="hljs-string">"finished"</span>, g);
        a.src = c;
        i.insertBefore(a, i.firstChild)
      }
    }, <span class="hljs-number">0</span>)
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">J</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> l = {},
      Q = r || M,
      n = [],
      p = {},
      m;
    l[y] = <span class="hljs-literal">true</span>;
    l[z] = <span class="hljs-literal">false</span>;
    l[u] = <span class="hljs-literal">false</span>;
    l[A] = <span class="hljs-literal">false</span>;
    l[B] = <span class="hljs-string">""</span>;

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">R</span>(<span class="hljs-params">a, c, b</span>) </span>{
      <span class="hljs-keyword">var</span> d;

      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">f</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">if</span> (d != <span class="hljs-literal">null</span>) {
          d = <span class="hljs-literal">null</span>;
          I(b)
        }
      }
      <span class="hljs-keyword">if</span> (p[c.src].finished) <span class="hljs-keyword">return</span>;
      <span class="hljs-keyword">if</span> (!a[u]) p[c.src].finished = <span class="hljs-literal">true</span>;
      d = b.elem || <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"script"</span>);
      <span class="hljs-keyword">if</span> (c.type) d.type = c.type;
      <span class="hljs-keyword">if</span> (c.charset) d.charset = c.charset;
      t(d, b, <span class="hljs-string">"finished"</span>, f);
      <span class="hljs-keyword">if</span> (b.elem) {
        b.elem = <span class="hljs-literal">null</span>
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (b.text) {
        d.onload = d.onreadystatechange = <span class="hljs-literal">null</span>;
        d.text = b.text
      } <span class="hljs-keyword">else</span> {
        d.src = c.real_src
      }
      i.insertBefore(d, i.firstChild);
      <span class="hljs-keyword">if</span> (b.text) {
        f()
      }
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">S</span>(<span class="hljs-params">c, b, d, f</span>) </span>{
      <span class="hljs-keyword">var</span> e, g, h = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
          b.ready_cb(b, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            R(c, b, e)
          })
        },
        j = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
          b.finished_cb(b, d)
        };
      b.src = N(b.src, c[B]);
      b.real_src = b.src + (c[A] ? ((<span class="hljs-regexp">/\?.*$/</span>.test(b.src) ? <span class="hljs-string">"&amp;_"</span> : <span class="hljs-string">"?_"</span>) + ~~(<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">1E9</span>) + <span class="hljs-string">"="</span>) : <span class="hljs-string">""</span>);
      <span class="hljs-keyword">if</span> (!p[b.src]) p[b.src] = {
        <span class="hljs-attr">items</span>: [],
        <span class="hljs-attr">finished</span>: <span class="hljs-literal">false</span>
      };
      g = p[b.src].items;
      <span class="hljs-keyword">if</span> (c[u] || g.length == <span class="hljs-number">0</span>) {
        e = g[g.length] = {
          <span class="hljs-attr">ready</span>: <span class="hljs-literal">false</span>,
          <span class="hljs-attr">finished</span>: <span class="hljs-literal">false</span>,
          <span class="hljs-attr">ready_listeners</span>: [h],
          <span class="hljs-attr">finished_listeners</span>: [j]
        };
        P(c, b, e, ((f) ? <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
          e.ready = <span class="hljs-literal">true</span>;
          <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> a = <span class="hljs-number">0</span>; a &lt; e.ready_listeners.length; a++) {
            e.ready_listeners[a]()
          }
          e.ready_listeners = []
        } : <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
          I(e)
        }), f)
      } <span class="hljs-keyword">else</span> {
        e = g[<span class="hljs-number">0</span>];
        <span class="hljs-keyword">if</span> (e.finished) {
          j()
        } <span class="hljs-keyword">else</span> {
          e.finished_listeners.push(j)
        }
      }
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">v</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> e, g = s(l, {}),
        h = [],
        j = <span class="hljs-number">0</span>,
        w = <span class="hljs-literal">false</span>,
        k;

      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">T</span>(<span class="hljs-params">a, c</span>) </span>{
        a.ready = <span class="hljs-literal">true</span>;
        a.exec_trigger = c;
        x()
      }

      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">U</span>(<span class="hljs-params">a, c</span>) </span>{
        a.ready = a.finished = <span class="hljs-literal">true</span>;
        a.exec_trigger = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> b = <span class="hljs-number">0</span>; b &lt; c.scripts.length; b++) {
          <span class="hljs-keyword">if</span> (!c.scripts[b].finished) <span class="hljs-keyword">return</span>
        }
        c.finished = <span class="hljs-literal">true</span>;
        x()
      }

      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">x</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">while</span> (j &lt; h.length) {
          <span class="hljs-keyword">if</span> (G(h[j])) {
            <span class="hljs-keyword">try</span> {
              h[j++]()
            } <span class="hljs-keyword">catch</span> (err) {}
            <span class="hljs-keyword">continue</span>
          } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!h[j].finished) {
            <span class="hljs-keyword">if</span> (O(h[j])) <span class="hljs-keyword">continue</span>;
            <span class="hljs-keyword">break</span>
          }
          j++
        }
        <span class="hljs-keyword">if</span> (j == h.length) {
          w = <span class="hljs-literal">false</span>;
          k = <span class="hljs-literal">false</span>
        }
      }

      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">V</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">if</span> (!k || !k.scripts) {
          h.push(k = {
            <span class="hljs-attr">scripts</span>: [],
            <span class="hljs-attr">finished</span>: <span class="hljs-literal">true</span>
          })
        }
      }
      e = {
        <span class="hljs-attr">script</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
          <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> f = <span class="hljs-number">0</span>; f &lt; <span class="hljs-built_in">arguments</span>.length; f++) {
            (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a, c</span>) </span>{
              <span class="hljs-keyword">var</span> b;
              <span class="hljs-keyword">if</span> (!H(a)) {
                c = [a]
              }
              <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> d = <span class="hljs-number">0</span>; d &lt; c.length; d++) {
                V();
                a = c[d];
                <span class="hljs-keyword">if</span> (G(a)) a = a();
                <span class="hljs-keyword">if</span> (!a) <span class="hljs-keyword">continue</span>;
                <span class="hljs-keyword">if</span> (H(a)) {
                  b = [].slice.call(a);
                  b.unshift(d, <span class="hljs-number">1</span>);
                  [].splice.apply(c, b);
                  d--;
                  <span class="hljs-keyword">continue</span>
                }
                <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> a == <span class="hljs-string">"string"</span>) a = {
                  <span class="hljs-attr">src</span>: a
                };
                a = s(a, {
                  <span class="hljs-attr">ready</span>: <span class="hljs-literal">false</span>,
                  <span class="hljs-attr">ready_cb</span>: T,
                  <span class="hljs-attr">finished</span>: <span class="hljs-literal">false</span>,
                  <span class="hljs-attr">finished_cb</span>: U
                });
                k.finished = <span class="hljs-literal">false</span>;
                k.scripts.push(a);
                S(g, a, k, (Q &amp;&amp; w));
                w = <span class="hljs-literal">true</span>;
                <span class="hljs-keyword">if</span> (g[z]) e.wait()
              }
            })(<span class="hljs-built_in">arguments</span>[f], <span class="hljs-built_in">arguments</span>[f])
          }
          <span class="hljs-keyword">return</span> e
        },
        <span class="hljs-attr">wait</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
          <span class="hljs-keyword">if</span> (<span class="hljs-built_in">arguments</span>.length &gt; <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> a = <span class="hljs-number">0</span>; a &lt; <span class="hljs-built_in">arguments</span>.length; a++) {
              h.push(<span class="hljs-built_in">arguments</span>[a])
            }
            k = h[h.length - <span class="hljs-number">1</span>]
          } <span class="hljs-keyword">else</span> k = <span class="hljs-literal">false</span>;
          x();
          <span class="hljs-keyword">return</span> e
        }
      };
      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">script</span>: e.script,
        <span class="hljs-attr">wait</span>: e.wait,
        <span class="hljs-attr">setOptions</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
          s(a, g);
          <span class="hljs-keyword">return</span> e
        }
      }
    }
    m = {
      <span class="hljs-attr">setGlobalDefaults</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
        s(a, l);
        <span class="hljs-keyword">return</span> m
      },
      <span class="hljs-attr">setOptions</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> v().setOptions.apply(<span class="hljs-literal">null</span>, <span class="hljs-built_in">arguments</span>)
      },
      <span class="hljs-attr">script</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> v().script.apply(<span class="hljs-literal">null</span>, <span class="hljs-built_in">arguments</span>)
      },
      <span class="hljs-attr">wait</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> v().wait.apply(<span class="hljs-literal">null</span>, <span class="hljs-built_in">arguments</span>)
      },
      <span class="hljs-attr">queueScript</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        n[n.length] = {
          <span class="hljs-attr">type</span>: <span class="hljs-string">"script"</span>,
          <span class="hljs-attr">args</span>: [].slice.call(<span class="hljs-built_in">arguments</span>)
        };
        <span class="hljs-keyword">return</span> m
      },
      <span class="hljs-attr">queueWait</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        n[n.length] = {
          <span class="hljs-attr">type</span>: <span class="hljs-string">"wait"</span>,
          <span class="hljs-attr">args</span>: [].slice.call(<span class="hljs-built_in">arguments</span>)
        };
        <span class="hljs-keyword">return</span> m
      },
      <span class="hljs-attr">runQueue</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> a = m,
          c = n.length,
          b = c,
          d;
        <span class="hljs-keyword">for</span> (; --b &gt;= <span class="hljs-number">0</span>;) {
          d = n.shift();
          a = a[d.type].apply(<span class="hljs-literal">null</span>, d.args)
        }
        <span class="hljs-keyword">return</span> a
      },
      <span class="hljs-attr">noConflict</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        o.$LAB = K;
        <span class="hljs-keyword">return</span> m
      },
      <span class="hljs-attr">sandbox</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> J()
      }
    };
    <span class="hljs-keyword">return</span> m
  }
  o.$LAB = J();
  (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a, c, b</span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">document</span>.readyState == <span class="hljs-literal">null</span> &amp;&amp; <span class="hljs-built_in">document</span>[a]) {
      <span class="hljs-built_in">document</span>.readyState = <span class="hljs-string">"loading"</span>;
      <span class="hljs-built_in">document</span>[a](c, b = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-built_in">document</span>.removeEventListener(c, b, <span class="hljs-literal">false</span>);
        <span class="hljs-built_in">document</span>.readyState = <span class="hljs-string">"complete"</span>
      }, <span class="hljs-literal">false</span>)
    }
  })(<span class="hljs-string">"addEventListener"</span>, <span class="hljs-string">"DOMContentLoaded"</span>)
})(<span class="hljs-keyword">this</span>);
<span class="hljs-comment">/*! RESOURCE: /scripts/ScriptLoader.js */</span>
<span class="hljs-keyword">var</span> ScriptLoader = {
  <span class="hljs-attr">getScripts</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">scripts, callback</span>) </span>{
    <span class="hljs-keyword">if</span> (!(scripts <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Array</span>))
      scripts = [scripts];
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; scripts.length; i++)
      $LAB.queueScript(scripts[i]);
    $LAB.queueWait(callback);
    $LAB.runQueue();
  }
};;
<span class="hljs-comment">/*! RESOURCE: /scripts/consts/GlideEvent.js */</span>
<span class="hljs-keyword">var</span> GlideEvent = {
  <span class="hljs-attr">WINDOW_CLICKED</span>: <span class="hljs-string">'glide:window_clicked'</span>,
  <span class="hljs-attr">WINDOW_BLURRED</span>: <span class="hljs-string">'glide:window_blurred'</span>,
  <span class="hljs-attr">WINDOW_FOCUSED</span>: <span class="hljs-string">'glide:window_focused'</span>,
  <span class="hljs-attr">IMAGE_PICKED</span>: <span class="hljs-string">'glide:image_picked'</span>,
  <span class="hljs-attr">NAV_MANAGER_LOADED</span>: <span class="hljs-string">'glide:nav_manager_loaded'</span>,
  <span class="hljs-attr">NAV_FORM_DIRTY_CANCEL_STAY</span>: <span class="hljs-string">'glide:nav_form_dirty_cancel_stay'</span>,
  <span class="hljs-attr">NAV_SYNC_LIST_WITH_FORM</span>: <span class="hljs-string">'glide:nav_sync_list_with_form'</span>,
  <span class="hljs-attr">NAV_LOAD_FORM_FROM_LIST</span>: <span class="hljs-string">'glide:nav_load_form_from_list'</span>,
  <span class="hljs-attr">NAV_SAVE_PREFERENCES</span>: <span class="hljs-string">'glide:nav_save_preferences'</span>,
  <span class="hljs-attr">NAV_UPDATE_EDGE_BUTTON_STATES</span>: <span class="hljs-string">'glide:nav_update_edge_button_states'</span>,
  <span class="hljs-attr">NAV_OPEN_URL</span>: <span class="hljs-string">'glide:nav_open_url'</span>,
  <span class="hljs-attr">NAV_ADD_BOOKMARK</span>: <span class="hljs-string">'glide:nav_add_bookmark'</span>,
  <span class="hljs-attr">NAV_REMOVE_BOOKMARK</span>: <span class="hljs-string">'glide:nav_remove_bookmark'</span>,
  <span class="hljs-attr">NAV_UPDATE_BOOKMARK</span>: <span class="hljs-string">'glide:nav_update_bookmark'</span>,
  <span class="hljs-attr">NAV_DRAGGING_BOOKMARK_START</span>: <span class="hljs-string">'glide:nav_dragging_bookmark_start'</span>,
  <span class="hljs-attr">NAV_DRAGGING_BOOKMARK_STOP</span>: <span class="hljs-string">'glide:nav_dragging_bookmark_stop'</span>,
  <span class="hljs-attr">NAV_HIDE_ALL_TOOLTIPS</span>: <span class="hljs-string">'glide:nav_hide_all_tooltips'</span>,
  <span class="hljs-attr">NAV_QUEUE_BOOKMARK_OPEN_FLYOUT</span>: <span class="hljs-string">'glide:nav_queue_bookmark_open_flyout'</span>,
  <span class="hljs-attr">NAV_OPEN_BOOKMARK</span>: <span class="hljs-string">'glide:nav_open_bookmark'</span>,
  <span class="hljs-attr">NAV_EAST_PANE_RESIZED</span>: <span class="hljs-string">'glide:nav_east_pane_resized'</span>,
  <span class="hljs-attr">NAV_ADD_FLYOUT</span>: <span class="hljs-string">'glide:nav_add_flyout'</span>,
  <span class="hljs-attr">NAV_REMOVE_FLYOUT</span>: <span class="hljs-string">'glide:nav_remove_flyout'</span>,
  <span class="hljs-attr">NAV_TOGGLE_FLYOUT</span>: <span class="hljs-string">'glide:nav_toggle_flyout'</span>,
  <span class="hljs-attr">NAV_HIDE_FLYOUTS</span>: <span class="hljs-string">'glide:nav_hide_flyouts'</span>,
  <span class="hljs-attr">NAV_PANE_CLICKED</span>: <span class="hljs-string">'glide:nav_window_clicked'</span>
};;
<span class="hljs-comment">/*! RESOURCE: /scripts/functions/textutil.js */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">htmlEscape</span>(<span class="hljs-params">s</span>) </span>{
  <span class="hljs-keyword">return</span> s.replace(<span class="hljs-regexp">/&amp;/g</span>, <span class="hljs-string">"&amp;amp;"</span>).replace(<span class="hljs-regexp">/'/g</span>, <span class="hljs-string">"&amp;#39;"</span>).replace(<span class="hljs-regexp">/"/g</span>, <span class="hljs-string">"&amp;quot;"</span>).replace(<span class="hljs-regexp">/&lt;/g</span>, <span class="hljs-string">"&amp;#60;"</span>).replace(<span class="hljs-regexp">/&gt;/g</span>, <span class="hljs-string">"&amp;#62;"</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">htmlEscapeQuote</span>(<span class="hljs-params">s</span>) </span>{
  <span class="hljs-keyword">return</span> s.replace(<span class="hljs-regexp">/'/g</span>, <span class="hljs-string">"&amp;#39;"</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">htmlEscapeDoubleQuote</span>(<span class="hljs-params">s</span>) </span>{
  <span class="hljs-keyword">return</span> s.replace(<span class="hljs-regexp">/"/g</span>, <span class="hljs-string">"&amp;quot;"</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">loadXML</span>(<span class="hljs-params">r</span>) </span>{
  <span class="hljs-keyword">var</span> xml = r.responseXML;
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> xml != <span class="hljs-string">'undefined'</span>)
    <span class="hljs-keyword">return</span> xml;
  <span class="hljs-keyword">var</span> dom = <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.DOMParser) {
    <span class="hljs-keyword">try</span> {
      dom = (<span class="hljs-keyword">new</span> DOMParser()).parseFromString(r, <span class="hljs-string">'text/xml'</span>);
    } <span class="hljs-keyword">catch</span> (e) {
      dom = <span class="hljs-literal">null</span>;
    }
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.ActiveXObject) {
    <span class="hljs-keyword">try</span> {
      dom = <span class="hljs-keyword">new</span> ActiveXObject(<span class="hljs-string">'Microsoft.XMLDOM'</span>);
      dom.async = <span class="hljs-literal">false</span>;
      <span class="hljs-keyword">if</span> (!dom.loadXML(r))
        jslog(<span class="hljs-string">'ERROR: '</span> + dom.parseError.reason + dom.parseError.srcText);
    } <span class="hljs-keyword">catch</span> (e) {
      dom = <span class="hljs-literal">null</span>;
    }
  } <span class="hljs-keyword">else</span>
    jslog(<span class="hljs-string">'ERROR: Cannot parse xml string - "'</span> + r + <span class="hljs-string">'".'</span>);
  <span class="hljs-keyword">return</span> dom;
};
<span class="hljs-comment">/*! RESOURCE: /scripts/doctype/functions_bootstrap14.js */</span>
<span class="hljs-keyword">var</span> userAgentLowerCase = navigator.userAgent.toLowerCase();
<span class="hljs-keyword">var</span> isMSIE = userAgentLowerCase.indexOf(<span class="hljs-string">"msie"</span>) &gt;= <span class="hljs-number">0</span>;
<span class="hljs-keyword">var</span> ie5 = <span class="hljs-literal">false</span>;
<span class="hljs-keyword">var</span> isMSIE6 = <span class="hljs-literal">false</span>
<span class="hljs-keyword">var</span> isMSIE7 = <span class="hljs-literal">false</span>;
<span class="hljs-keyword">var</span> isMSIE8 = <span class="hljs-literal">false</span>;
<span class="hljs-keyword">var</span> isMSIE9 = userAgentLowerCase.indexOf(<span class="hljs-string">"msie 9"</span>) &gt;= <span class="hljs-number">0</span>;
<span class="hljs-keyword">var</span> isMSIE10 = userAgentLowerCase.indexOf(<span class="hljs-string">"msie 10"</span>) &gt;= <span class="hljs-number">0</span>;
<span class="hljs-keyword">var</span> isMSIE11 = userAgentLowerCase.indexOf(<span class="hljs-string">"rv:11.0"</span>) &gt; <span class="hljs-number">0</span>;
<span class="hljs-keyword">var</span> isChrome = userAgentLowerCase.indexOf(<span class="hljs-string">"chrome"</span>) &gt;= <span class="hljs-number">0</span>;
<span class="hljs-keyword">var</span> isFirefox = userAgentLowerCase.indexOf(<span class="hljs-string">"firefox"</span>) &gt;= <span class="hljs-number">0</span>;
<span class="hljs-keyword">var</span> isSafari = !isChrome &amp;&amp; (userAgentLowerCase.indexOf(<span class="hljs-string">"safari"</span>) &gt;= <span class="hljs-number">0</span>);
<span class="hljs-keyword">var</span> isSafari5 = <span class="hljs-literal">false</span>;
<span class="hljs-keyword">if</span> (isSafari) {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">var</span> reSafariVersion = <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(<span class="hljs-string">"version/([\\d\\.]{3,5}) safari/"</span>);
    <span class="hljs-keyword">var</span> results = reSafariVersion.exec(userAgentLowerCase);
    <span class="hljs-keyword">if</span> (results.length &gt; <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">var</span> reMajor = <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(<span class="hljs-string">"([\\d])."</span>);
      <span class="hljs-keyword">var</span> results = reMajor.exec(results[<span class="hljs-number">1</span>]);
      <span class="hljs-keyword">if</span> (results.length &gt; <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">var</span> mv = <span class="hljs-built_in">parseInt</span>(results[<span class="hljs-number">1</span>]);
        isSafari5 = mv &lt; <span class="hljs-number">6</span>;
      }
    }
  } <span class="hljs-keyword">catch</span> (e) {}
}
<span class="hljs-keyword">var</span> isMacintosh = userAgentLowerCase.indexOf(<span class="hljs-string">"macintosh"</span>) &gt;= <span class="hljs-number">0</span>;
<span class="hljs-keyword">var</span> isWebKit = navigator.userAgent.indexOf(<span class="hljs-string">"WebKit"</span>) &gt;= <span class="hljs-number">0</span>;
<span class="hljs-keyword">var</span> isTouchDevice = navigator.userAgent.indexOf(<span class="hljs-string">'iPhone'</span>) &gt; <span class="hljs-number">-1</span> || navigator.userAgent.indexOf(<span class="hljs-string">'iPad'</span>) &gt; <span class="hljs-number">-1</span>;
<span class="hljs-keyword">var</span> GJSV = <span class="hljs-number">1.0</span>;
(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> defined = {};
  <span class="hljs-keyword">var</span> waiting = {};

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">listen</span>(<span class="hljs-params">id, then</span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> id !== <span class="hljs-string">'string'</span>)
      listenMany(id, then);
    <span class="hljs-keyword">if</span> (defined[id]) {
      <span class="hljs-keyword">return</span> then(defined[id]);
    }
    <span class="hljs-keyword">if</span> (!waiting[id]) {
      waiting[id] = [];
    }
    waiting[id].push(then);
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">emit</span>(<span class="hljs-params">id, data</span>) </span>{
    defined[id] = data;
    <span class="hljs-keyword">var</span> listeners = waiting[id];
    <span class="hljs-keyword">if</span> (!listeners) {
      <span class="hljs-keyword">return</span>;
    }
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, l = listeners.length; i &lt; l; i++) {
      listeners[i](data);
    }
    waiting[id] = [];
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">listenMany</span>(<span class="hljs-params">dependencies, then</span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> dependencies.length === <span class="hljs-string">'undefined'</span>) {
      <span class="hljs-keyword">return</span>;
    }
    <span class="hljs-keyword">var</span> unDef = {
      <span class="hljs-attr">isUndefined</span>: <span class="hljs-literal">true</span>
    };
    <span class="hljs-keyword">var</span> resolved = [];

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">resolve</span>(<span class="hljs-params">dep, i</span>) </span>{
      resolved[i] = dep;
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, l = resolved.length; i &lt; l; i++) {
        <span class="hljs-keyword">if</span> (resolved[i] === unDef)
          <span class="hljs-keyword">return</span>;
      }
      then.apply(<span class="hljs-literal">undefined</span>, resolved);
    };
    dependencies.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">depId, idx</span>) </span>{
      resolved[idx] = unDef;
      listen(depId, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">dep</span>) </span>{
        resolve(dep, idx);
      });
    });
  }
  <span class="hljs-built_in">window</span>.CachedEvent = {
    <span class="hljs-attr">after</span>: listen,
    <span class="hljs-attr">emit</span>: emit
  };
})();
<span class="hljs-keyword">var</span> g_afterPageLoadedFunctions = [];
<span class="hljs-built_in">window</span>.g_render_functions = <span class="hljs-built_in">window</span>.g_render_functions || [];
<span class="hljs-built_in">window</span>.g_load_functions = <span class="hljs-built_in">window</span>.g_load_functions || [];
<span class="hljs-built_in">window</span>.g_late_load_functions = <span class="hljs-built_in">window</span>.g_late_load_functions || [];

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">runBeforeRender</span>(<span class="hljs-params"></span>) </span>{
  _runInlineScripts();
  jslog(<span class="hljs-string">"runBeforeRender"</span>);
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i != g_render_functions.length; i++) {
    <span class="hljs-keyword">var</span> f = g_render_functions[i];
    f.call();
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_runInlineScripts</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> inlineScripts = $j(<span class="hljs-string">'script[type="application/javascript-deferred"]'</span>);
  jslog(<span class="hljs-string">"running inline scripts, count: "</span> + inlineScripts.length);
  inlineScripts.each(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">index, item</span>) </span>{
    <span class="hljs-keyword">var</span> script = $j(item).text();
    <span class="hljs-keyword">try</span> {
      $j.globalEval(script);
    } <span class="hljs-keyword">catch</span> (e) {
      jslog(<span class="hljs-string">"error in script "</span> + script);
    }
  });
}
<span class="hljs-built_in">window</span>.g_hasRunAfterAllLoaded = <span class="hljs-literal">false</span>;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">runAfterAllLoaded</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">if</span> (g_hasRunAfterAllLoaded) {
    jslog(<span class="hljs-string">"Redundant call to runAfterAllLoaded"</span>);
    <span class="hljs-keyword">return</span>;
  }
  g_hasRunAfterAllLoaded = <span class="hljs-literal">true</span>;
  <span class="hljs-keyword">var</span> sw = <span class="hljs-keyword">new</span> StopWatch();
  jslog(<span class="hljs-string">"runAfterAllLoaded, functions: "</span> + g_load_functions.length);
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i != g_load_functions.length; i++) {
    <span class="hljs-keyword">var</span> f = g_load_functions[i];
    <span class="hljs-keyword">var</span> t = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().getTime();
    f.call();
    t = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().getTime() - t;
    <span class="hljs-keyword">if</span> (t &gt; <span class="hljs-number">5000</span>)
      jslog(<span class="hljs-string">"Time: "</span> + t + <span class="hljs-string">" for: ["</span> + i + <span class="hljs-string">"] "</span> + f);
  }
  jslog(<span class="hljs-string">"late load functions: "</span> + g_late_load_functions.length);
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i != g_late_load_functions.length; i++) {
    <span class="hljs-keyword">var</span> f = g_late_load_functions[i];
    f.call();
  }
  <span class="hljs-built_in">window</span>.self.loaded = <span class="hljs-literal">true</span>;
  sw.jslog(<span class="hljs-string">"runAfterAllLoaded finished"</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addLoadEvent</span>(<span class="hljs-params">func</span>) </span>{
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.self.loaded) {
    setTimeout(func, <span class="hljs-number">0</span>);
    <span class="hljs-keyword">return</span>;
  }
  g_load_functions.push(func);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addLateLoadEvent</span>(<span class="hljs-params">func</span>) </span>{
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.self.loaded) {
    setTimeout(func, <span class="hljs-number">0</span>);
    <span class="hljs-keyword">return</span>;
  }
  g_late_load_functions.push(func);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">pageLoaded</span>(<span class="hljs-params"></span>) </span>{
  CustomEvent.observe(<span class="hljs-string">"body_clicked"</span>, contextMenuHide);
  setMandatoryExplained.defer();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addRenderEvent</span>(<span class="hljs-params">func</span>) </span>{
  <span class="hljs-keyword">if</span> (isRenderEventRegistered(func))
    <span class="hljs-keyword">return</span>;
  addRenderEventToArray(func);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addRenderEventToArray</span>(<span class="hljs-params">func</span>) </span>{
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.self.loaded) {
    setTimeout(func, <span class="hljs-number">0</span>);
    <span class="hljs-keyword">return</span>;
  }
  g_render_functions.push(func);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isRenderEventRegistered</span>(<span class="hljs-params">func</span>) </span>{
  <span class="hljs-keyword">var</span> s = func.toString();
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; g_render_functions.length; i++)
    <span class="hljs-keyword">if</span> (g_render_functions[i].toString() == s)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addRenderEventLogged</span>(<span class="hljs-params">func, name, funcname</span>) </span>{
  addRenderEventToArray(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    CustomEvent.fire(<span class="hljs-string">'glide_optics_inspect_put_cs_context'</span>, funcname, <span class="hljs-string">'load'</span>);
    <span class="hljs-keyword">var</span> sw = <span class="hljs-keyword">new</span> StopWatch();
    <span class="hljs-keyword">var</span> __rtmr = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>();
    <span class="hljs-keyword">try</span> {
      func();
    } <span class="hljs-keyword">catch</span> (e) {
      jslog(<span class="hljs-string">'***************************************************'</span>);
      jslog(<span class="hljs-string">'A script has encountered an error in render events'</span>);
      jslog(e.toString());
      jslog(<span class="hljs-string">'Script ends. Continuing happily'</span>);
      jslog(<span class="hljs-string">'***************************************************'</span>);
    }
    CustomEvent.fire(<span class="hljs-string">'page_timing'</span>, {
      <span class="hljs-attr">name</span>: <span class="hljs-string">'CSOL'</span>,
      <span class="hljs-attr">child</span>: {
        <span class="hljs-attr">description</span>: name.substr(<span class="hljs-number">7</span>),
        <span class="hljs-attr">sys_id</span>: g_event_handler_ids[funcname],
        <span class="hljs-attr">source_table</span>: <span class="hljs-string">'sys_script_client'</span>
      },
      <span class="hljs-attr">startTime</span>: __rtmr,
      <span class="hljs-attr">win</span>: <span class="hljs-built_in">window</span>
    });
    sw.jslog(name);
    CustomEvent.fire(<span class="hljs-string">'glide_optics_inspect_pop_cs_context'</span>, funcname, <span class="hljs-string">'load'</span>);
  });
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addTopRenderEvent</span>(<span class="hljs-params">func</span>) </span>{
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.self.loaded) {
    setTimeout(func, <span class="hljs-number">0</span>);
    <span class="hljs-keyword">return</span>;
  }
  g_render_functions.unshift(func);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addAfterPageLoadedEvent</span>(<span class="hljs-params">func</span>) </span>{
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.self.loaded) {
    setTimeout(func, <span class="hljs-number">0</span>);
    <span class="hljs-keyword">return</span>;
  }
  g_afterPageLoadedFunctions.push(func);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">runAfterPageLoadedEvents</span>(<span class="hljs-params"></span>) </span>{
  jslog(<span class="hljs-string">"after page loaded starting"</span>);
  <span class="hljs-keyword">var</span> sw = <span class="hljs-keyword">new</span> StopWatch();
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i != g_afterPageLoadedFunctions.length; i++) {
    <span class="hljs-keyword">var</span> f = g_afterPageLoadedFunctions[i];
    f.call();
  }
  sw.jslog(<span class="hljs-string">"after page loaded complete, functions called: "</span> + g_afterPageLoadedFunctions.length);
  g_afterPageLoadedFunctions = [];
}
addLateLoadEvent(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  setTimeout(runAfterPageLoadedEvents, <span class="hljs-number">30</span>);
});

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addUnloadEvent</span>(<span class="hljs-params">func</span>) </span>{
  Event.observe(<span class="hljs-built_in">window</span>, <span class="hljs-string">'unload'</span>, func, <span class="hljs-literal">false</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addTinymceLoadEvent</span>(<span class="hljs-params">id, func</span>) </span>{
  CachedEvent.after(<span class="hljs-string">'tinyeditor_init.'</span> + id, func);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fireTinymceLoadEvent</span>(<span class="hljs-params">id, ed</span>) </span>{
  CachedEvent.emit(<span class="hljs-string">'tinyeditor_init.'</span> + id, ed);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">gel</span>(<span class="hljs-params">id</span>) </span>{
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> id != <span class="hljs-string">'string'</span>)
    <span class="hljs-keyword">return</span> id;
  <span class="hljs-keyword">return</span> <span class="hljs-built_in">document</span>.getElementById(id);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">cel</span>(<span class="hljs-params">name, parent</span>) </span>{
  <span class="hljs-keyword">var</span> e = <span class="hljs-built_in">document</span>.createElement(name);
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">arguments</span>.length &gt; <span class="hljs-number">1</span>)
    parent.appendChild(e);
  <span class="hljs-keyword">return</span> e;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">rel</span>(<span class="hljs-params">id</span>) </span>{
  <span class="hljs-keyword">var</span> e = gel(id);
  <span class="hljs-keyword">if</span> (e)
    e.parentNode.removeChild(e);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addChild</span>(<span class="hljs-params">element</span>) </span>{
  getFormContentParent().appendChild(element);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">inner</span>(<span class="hljs-params">id, data</span>) </span>{
  <span class="hljs-keyword">var</span> el = gel(id);
  <span class="hljs-keyword">if</span> (el != <span class="hljs-literal">null</span>)
    el.innerHTML = data;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">clearNodes</span>(<span class="hljs-params">t</span>) </span>{
  <span class="hljs-keyword">if</span> (!t)
    <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">while</span> (t.hasChildNodes())
    t.removeChild(t.childNodes[<span class="hljs-number">0</span>]);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getTopWindow</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> topWindow = <span class="hljs-built_in">window</span>.self;
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">while</span> (topWindow.GJSV &amp;&amp; topWindow != topWindow.parent &amp;&amp; topWindow.parent.GJSV) {
      topWindow = topWindow.parent;
    }
  } <span class="hljs-keyword">catch</span> (e) {}
  <span class="hljs-keyword">return</span> topWindow;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">inFrame</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> getTopWindow() != <span class="hljs-built_in">window</span>.self;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getMainWindow</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> topWindow = getTopWindow();
  <span class="hljs-keyword">return</span> topWindow[<span class="hljs-string">'gsft_main'</span>];
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getMainFormWindow</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> topWindow = getTopWindow();
  <span class="hljs-keyword">return</span> topWindow[<span class="hljs-string">'gsft_main_form'</span>];
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getNavWindow</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> topWindow = getTopWindow();
  <span class="hljs-keyword">return</span> topWindow[<span class="hljs-string">'gsft_nav'</span>];
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">reloadWindow</span>(<span class="hljs-params">win</span>) </span>{
  <span class="hljs-keyword">var</span> href = win.location.href;
  <span class="hljs-keyword">var</span> len = href.length;
  <span class="hljs-keyword">if</span> (win.frames[<span class="hljs-string">'iframe_live_feed'</span>] &amp;&amp; href.endsWith(<span class="hljs-string">'#'</span>) &amp;&amp; len &gt; <span class="hljs-number">2</span>)
    href = href.substring(<span class="hljs-number">0</span>, len - <span class="hljs-number">2</span>)
  href = addDomainParameters(href);
  win.location.href = href;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addDomainParameters</span>(<span class="hljs-params">href</span>) </span>{
  <span class="hljs-keyword">var</span> url = <span class="hljs-keyword">new</span> GlideURL(href);
  <span class="hljs-keyword">if</span> (url.getParam(<span class="hljs-string">'sysparm_domain'</span>) == <span class="hljs-string">'picker'</span>) {
    url.deleteParam(<span class="hljs-string">'sysparm_domain'</span>);
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">var</span> domainElement = gel(<span class="hljs-string">'sysparm_domain'</span>);
    <span class="hljs-keyword">if</span> (domainElement) {
      <span class="hljs-keyword">if</span> (domainElement.value != <span class="hljs-string">'picker'</span>) {
        url.addParam(<span class="hljs-string">'sysparm_domain'</span>, domainElement.value);
        <span class="hljs-keyword">var</span> domainScope = gel(<span class="hljs-string">'sysparm_domain_scope'</span>);
        <span class="hljs-keyword">if</span> (domainScope) {
          url.addParam(<span class="hljs-string">'sysparm_domain_scope'</span>, domainScope.value);
        }
      }
    }
  }
  url.addParam(<span class="hljs-string">'sysparm_nostack'</span>, <span class="hljs-string">'true'</span>);
  url.setEncode(<span class="hljs-literal">false</span>);
  <span class="hljs-keyword">return</span> url.getURL();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addOnSubmitEvent</span>(<span class="hljs-params">form, func, funcname</span>) </span>{
  <span class="hljs-keyword">if</span> (!form)
    <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">var</span> oldonsubmit = form.onsubmit;
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> form.onsubmit != <span class="hljs-string">'function'</span>)
    form.onsubmit = func;
  <span class="hljs-keyword">else</span> {
    form.onsubmit = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> formFuncCalled = <span class="hljs-literal">false</span>;
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">if</span> (oldonsubmit() == <span class="hljs-literal">false</span>)
          <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        CustomEvent.fire(<span class="hljs-string">'glide_optics_inspect_put_cs_context'</span>, funcname, <span class="hljs-string">'submit'</span>);
        formFuncCalled = <span class="hljs-literal">true</span>;
        <span class="hljs-keyword">var</span> returnvalue = func();
        formFuncCalled = <span class="hljs-literal">false</span>;
        CustomEvent.fire(<span class="hljs-string">'glide_optics_inspect_pop_cs_context'</span>, funcname, <span class="hljs-string">'submit'</span>);
        <span class="hljs-keyword">if</span> (returnvalue == <span class="hljs-literal">false</span>)
          <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
      } <span class="hljs-keyword">catch</span> (ex) {
        <span class="hljs-keyword">if</span> (formFuncCalled)
          CustomEvent.fire(<span class="hljs-string">'glide_optics_inspect_pop_cs_context'</span>, funcname, <span class="hljs-string">'load'</span>);
        formFuncError(<span class="hljs-string">"onSubmit"</span>, func, ex);
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
      }
    }
  }
  form = <span class="hljs-literal">null</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">formFuncError</span>(<span class="hljs-params">type, func, ex</span>) </span>{
  <span class="hljs-keyword">var</span> funcStr = func.toString();
  funcStr = funcStr.replace(<span class="hljs-regexp">/onSubmit[a-fA-F0-9]{32}\(/</span>, <span class="hljs-string">"onSubmit("</span>);
  <span class="hljs-keyword">var</span> msg;
  <span class="hljs-keyword">if</span> (g_user.hasRole(<span class="hljs-string">"client_script_admin"</span>))
    msg = type + <span class="hljs-string">" script error: "</span> + ex.toString() + <span class="hljs-string">":&lt;br/&gt;"</span> + funcStr.replace(<span class="hljs-regexp">/\n/g</span>, <span class="hljs-string">"&lt;br/&gt;"</span>).replace(<span class="hljs-regexp">/\s/g</span>, <span class="hljs-string">"&amp;nbsp;"</span>);
  <span class="hljs-keyword">else</span>
    msg = <span class="hljs-string">"Submit canceled due to a script error - please contact your System Administrator"</span>;
  g_form.addErrorMessage(msg);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hide</span>(<span class="hljs-params">element</span>) </span>{
  <span class="hljs-keyword">var</span> e = <span class="hljs-keyword">typeof</span> element === <span class="hljs-string">"string"</span> ? gel(element) : element;
  <span class="hljs-keyword">if</span> (!e)
    <span class="hljs-keyword">return</span>;
  e.style.display = <span class="hljs-string">'none'</span>;
  _frameChanged();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">show</span>(<span class="hljs-params">element</span>) </span>{
  <span class="hljs-keyword">var</span> e = <span class="hljs-keyword">typeof</span> element === <span class="hljs-string">"string"</span> ? gel(element) : element;
  <span class="hljs-keyword">if</span> (!e)
    <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">if</span> (e.tagName == <span class="hljs-string">"TR"</span>)
    e.style.display = <span class="hljs-string">'table-row'</span>;
  <span class="hljs-keyword">else</span>
    e.style.display = <span class="hljs-string">'block'</span>;
  _frameChanged();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hideObject</span>(<span class="hljs-params">o, visibilityOnly</span>) </span>{
  <span class="hljs-keyword">if</span> (!o)
    <span class="hljs-keyword">return</span>;
  o.style.visibility = <span class="hljs-string">"hidden"</span>;
  <span class="hljs-keyword">if</span> (!visibilityOnly)
    o.style.display = <span class="hljs-string">"none"</span>;
  _frameChanged();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">showObject</span>(<span class="hljs-params">o, visibilityOnly</span>) </span>{
  <span class="hljs-keyword">if</span> (!o)
    <span class="hljs-keyword">return</span>;
  o.style.visibility = <span class="hljs-string">"visible"</span>;
  <span class="hljs-keyword">if</span> (!visibilityOnly)
    o.style.display = <span class="hljs-string">"block"</span>;
  _frameChanged();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">showObjectInline</span>(<span class="hljs-params">o</span>) </span>{
  <span class="hljs-keyword">if</span> (!o)
    <span class="hljs-keyword">return</span>;
  o.style.visibility = <span class="hljs-string">"visible"</span>;
  o.style.display = <span class="hljs-string">"inline"</span>;
  _frameChanged();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">showObjectInlineBlock</span>(<span class="hljs-params">o</span>) </span>{
  <span class="hljs-keyword">if</span> (!o)
    <span class="hljs-keyword">return</span>;
  o.style.visibility = <span class="hljs-string">"visible"</span>;
  o.style.display = <span class="hljs-string">"inline-block"</span>;
  _frameChanged();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">focusFirstElement</span>(<span class="hljs-params">form</span>) </span>{
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">var</span> e = findFirstEditableElement(form);
    <span class="hljs-keyword">if</span> (e) {
      Field.activate(e);
      triggerEvent(e, <span class="hljs-string">'focus'</span>, <span class="hljs-literal">true</span>);
    }
  } <span class="hljs-keyword">catch</span> (ex) {}
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">findFirstEditableElement</span>(<span class="hljs-params">form</span>) </span>{
  <span class="hljs-keyword">var</span> tags = [<span class="hljs-string">'input'</span>, <span class="hljs-string">'select'</span>, <span class="hljs-string">'textarea'</span>];
  <span class="hljs-keyword">var</span> elements = form.getElementsByTagName(<span class="hljs-string">'*'</span>);
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, n = elements.length; i &lt; n; i++) {
    <span class="hljs-keyword">var</span> element = elements[i];
    <span class="hljs-keyword">if</span> (element.type == <span class="hljs-string">'hidden'</span>)
      <span class="hljs-keyword">continue</span>;
    <span class="hljs-keyword">var</span> tagName = element.tagName.toLowerCase();
    <span class="hljs-keyword">if</span> (!tags.include(tagName))
      <span class="hljs-keyword">continue</span>;
    element = $(element);
    <span class="hljs-keyword">var</span> formGroup = element.up(<span class="hljs-string">'.form-group'</span>);
    <span class="hljs-keyword">if</span> (!element.disabled &amp;&amp;
      !element.readOnly &amp;&amp;
      element.style.visibility != <span class="hljs-string">'hidden'</span> &amp;&amp;
      element.style.display != <span class="hljs-string">'none'</span> &amp;&amp;
      element.offsetParent != <span class="hljs-literal">null</span> &amp;&amp;
      formGroup &amp;&amp;
      formGroup.style.display != <span class="hljs-string">'none'</span>)
      <span class="hljs-keyword">return</span> element;
  }
  <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">triggerEvent</span>(<span class="hljs-params">element, eventType, canBubble</span>) </span>{
  canBubble = (<span class="hljs-keyword">typeof</span>(canBubble) == <span class="hljs-literal">undefined</span>) ? <span class="hljs-literal">true</span> : canBubble;
  <span class="hljs-keyword">if</span> (element &amp;&amp; element.disabled &amp;&amp; eventType == <span class="hljs-string">"change"</span> &amp;&amp; element.onchange) {
    element.onchange.call(element);
    <span class="hljs-keyword">return</span>;
  }
  <span class="hljs-keyword">if</span> (element.fireEvent) {
    element.fireEvent(<span class="hljs-string">'on'</span> + eventType);
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">var</span> evt = <span class="hljs-built_in">document</span>.createEvent(<span class="hljs-string">'HTMLEvents'</span>);
    evt.initEvent(eventType, canBubble, <span class="hljs-literal">true</span>);
    element.dispatchEvent(evt);
  }
}
<span class="hljs-keyword">var</span> g_form_dirty_message;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onWindowClose</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> g_form == <span class="hljs-string">'undefined'</span>)
    <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">if</span> (!g_form.submitted &amp;&amp; g_form.modified) {
    g_submitted = <span class="hljs-literal">false</span>;
    setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      CustomEvent.fireTop(<span class="hljs-string">'glide:nav_form_dirty_cancel_stay'</span>, <span class="hljs-built_in">window</span>);
    }, <span class="hljs-number">750</span>);
    <span class="hljs-keyword">return</span> g_form_dirty_message;
  }
  g_form.submitted = <span class="hljs-literal">false</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">jslog</span>(<span class="hljs-params">msg, src, dateTime</span>) </span>{
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">if</span> (!src) {
      <span class="hljs-keyword">var</span> path = <span class="hljs-built_in">window</span>.self.location.pathname;
      src = path.substring(path.lastIndexOf(<span class="hljs-string">'/'</span>) + <span class="hljs-number">1</span>);
    }
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.self.opener &amp;&amp; <span class="hljs-built_in">window</span> != <span class="hljs-built_in">window</span>.self.opener) {
      <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.self.opener.jslog) {
        <span class="hljs-built_in">window</span>.self.opener.jslog(msg, src, dateTime);
      }
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (parent &amp;&amp; parent.jslog &amp;&amp; jslog != parent.jslog) {
      parent.jslog(msg, src, dateTime);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (parent.parent &amp;&amp; parent.parent.jslog &amp;&amp; jslog != parent.parent.jslog) {
      parent.parent.jslog(msg, src, dateTime);
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.console &amp;&amp; <span class="hljs-built_in">window</span>.console.log)
        <span class="hljs-built_in">console</span>.log(msg);
    }
  } <span class="hljs-keyword">catch</span> (e) {}
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getXMLIsland</span>(<span class="hljs-params">name</span>) </span>{
  <span class="hljs-keyword">var</span> xml = gel(name);
  <span class="hljs-keyword">if</span> (xml == <span class="hljs-literal">null</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  xml = <span class="hljs-string">"&lt;xml&gt;"</span> + xml.innerHTML + <span class="hljs-string">"&lt;/xml&gt;"</span>;
  xml = loadXML(xml);
  <span class="hljs-keyword">return</span> xml;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">lock</span>(<span class="hljs-params">me, ref, edit_id, nonedit_id, current_value_id, update_id</span>) </span>{
  <span class="hljs-keyword">if</span> (me)
    me.style.display = <span class="hljs-string">"none"</span>;
  <span class="hljs-keyword">var</span> unlock = gel(ref + <span class="hljs-string">'_unlock'</span>);
  unlock.style.display = <span class="hljs-string">""</span>;
  <span class="hljs-keyword">var</span> edit_span = gel(edit_id);
  edit_span.style.display = <span class="hljs-string">"none"</span>;
  <span class="hljs-keyword">var</span> nonedit_span = gel(nonedit_id);
  nonedit_span.style.display = <span class="hljs-string">"inline-block"</span>;
  <span class="hljs-keyword">var</span> current_value = gel(current_value_id);
  <span class="hljs-keyword">var</span> the_value = <span class="hljs-string">""</span>;
  <span class="hljs-keyword">if</span> (current_value.options) {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; current_value.options.length; i++) {
      <span class="hljs-keyword">if</span> (i &gt; <span class="hljs-number">0</span>)
        the_value += g_glide_list_separator;
      the_value += current_value.options[i].text;
    }
  } <span class="hljs-keyword">else</span>
    the_value = current_value.value;
  <span class="hljs-keyword">var</span> update_element = gel(update_id);
  <span class="hljs-keyword">if</span> (update_element.href)
    update_element.href = the_value;
  update_element.innerHTML = htmlEscape(the_value);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">unlock</span>(<span class="hljs-params">me, ref, edit_id, nonedit_id</span>) </span>{
  <span class="hljs-keyword">if</span> (me)
    me.style.display = <span class="hljs-string">"none"</span>;
  <span class="hljs-keyword">var</span> unlock = gel(ref + <span class="hljs-string">'_lock'</span>);
  <span class="hljs-keyword">if</span> (unlock)
    showObjectInlineBlock(unlock);
  <span class="hljs-keyword">var</span> edit_span = gel(edit_id);
  edit_span.style.display = <span class="hljs-string">""</span>;
  <span class="hljs-keyword">var</span> nonedit_span = gel(nonedit_id);
  nonedit_span.style.display = <span class="hljs-string">"none"</span>;
  <span class="hljs-keyword">var</span> list_foc = gel(<span class="hljs-string">"sys_display."</span> + ref);
  <span class="hljs-keyword">if</span> (list_foc) {
    <span class="hljs-keyword">try</span> {
      list_foc.focus();
    } <span class="hljs-keyword">catch</span> (e) {}
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setMandatoryExplained</span>(<span class="hljs-params">enforce</span>) </span>{
  <span class="hljs-keyword">var</span> showexp = gel(<span class="hljs-string">'mandatory_explained'</span>);
  <span class="hljs-keyword">if</span> (!showexp)
    <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">if</span> (enforce || foundAMandatoryField())
    showexp.style.display = <span class="hljs-string">"inline"</span>;
  <span class="hljs-keyword">else</span>
    showexp.style.display = <span class="hljs-string">"none"</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">foundAMandatoryField</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> spanTags = <span class="hljs-built_in">document</span>.getElementsByTagName(<span class="hljs-string">'span'</span>);
  <span class="hljs-keyword">if</span> (!spanTags)
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> c = <span class="hljs-number">0</span>, n = spanTags.length; c != n; ++c) {
    <span class="hljs-keyword">var</span> spanTag = spanTags[c];
    <span class="hljs-keyword">var</span> id = spanTag.id;
    <span class="hljs-keyword">if</span> (!id)
      <span class="hljs-keyword">continue</span>;
    <span class="hljs-keyword">if</span> (id.indexOf(<span class="hljs-string">'status.'</span>) == <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">var</span> mandatory = spanTag.getAttribute(<span class="hljs-string">"mandatory"</span>) + <span class="hljs-string">""</span>;
      <span class="hljs-keyword">if</span> (mandatory == <span class="hljs-string">'true'</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
  }
  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}
<span class="hljs-keyword">var</span> _frameChangedTimer = <span class="hljs-literal">null</span>;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_frameChanged</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">if</span> (_frameChangedTimer)
    clearTimeout(_frameChangedTimer);
  _frameChangedTimer = setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    _frameChangedTimer = <span class="hljs-literal">null</span>;
    CustomEvent.fire(<span class="hljs-string">'frame.resized'</span>);
    CustomEvent.fire(<span class="hljs-string">'refresh.event'</span>);
  }, <span class="hljs-number">300</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getFormContentParent</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> glideOverlay = $(<span class="hljs-built_in">document</span>.body).select(<span class="hljs-string">"div.glide_overlay"</span>);
  <span class="hljs-keyword">var</span> exposeMask = $(<span class="hljs-string">'glide_expose_mask'</span>);
  <span class="hljs-keyword">if</span> (glideOverlay.length &gt; <span class="hljs-number">0</span> &amp;&amp; exposeMask &amp;&amp; exposeMask.visible())
    <span class="hljs-keyword">return</span> glideOverlay[<span class="hljs-number">0</span>];
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> g_section_contents == <span class="hljs-string">'undefined'</span> || !g_section_contents)
    g_section_contents = $(<span class="hljs-built_in">document</span>.body).select(<span class="hljs-string">".section_header_content_no_scroll"</span>);
  <span class="hljs-keyword">if</span> (g_section_contents.length &gt; <span class="hljs-number">0</span>)
    <span class="hljs-keyword">return</span> g_section_contents[<span class="hljs-number">0</span>];
  <span class="hljs-keyword">return</span> <span class="hljs-built_in">document</span>.body;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addClassName</span>(<span class="hljs-params">element, name</span>) </span>{
  <span class="hljs-keyword">if</span> (!element)
    <span class="hljs-keyword">return</span>;
  $(element).addClassName(name);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">removeClassName</span>(<span class="hljs-params">element, name</span>) </span>{
  <span class="hljs-keyword">if</span> (!element)
    <span class="hljs-keyword">return</span>;
  $(element).removeClassName(name);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hasClassName</span>(<span class="hljs-params">element, name</span>) </span>{
  <span class="hljs-keyword">if</span> (!element)
    <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">if</span> (!element.hasClassName)
    <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">return</span> $(element).hasClassName(name);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getIFrameDocument</span>(<span class="hljs-params">iframe</span>) </span>{
  <span class="hljs-keyword">return</span> iframe.contentWindow ? iframe.contentWindow.document : (iframe.contentDocument || <span class="hljs-literal">null</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">writeTitle</span>(<span class="hljs-params">element, title</span>) </span>{
  element.title = title;
  <span class="hljs-keyword">if</span> (element.alt)
    element.alt = title;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">contextMenuHide</span>(<span class="hljs-params">e</span>) </span>{
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> contextHide === <span class="hljs-string">'undefined'</span>)
    <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">if</span> (!isMSIE &amp;&amp; e) {
    <span class="hljs-keyword">if</span> (isTouchDevice &amp;&amp; !isTouchRightClick(e)) {
      <span class="hljs-keyword">if</span> (e.type == <span class="hljs-string">'touchend'</span> &amp;&amp; $(e.target).up(<span class="hljs-string">'.context_menu'</span>))
        <span class="hljs-keyword">return</span>;
      contextHide();
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (isLeftClick(e)) {
      contextHide();
    }
  } <span class="hljs-keyword">else</span>
    contextHide();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">trim</span>(<span class="hljs-params">s</span>) </span>{
  <span class="hljs-keyword">return</span> s.replace(<span class="hljs-regexp">/^\s+|\s+$/g</span>, <span class="hljs-string">''</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">htmlEscape</span>(<span class="hljs-params">s</span>) </span>{
  <span class="hljs-keyword">return</span> s.replace(<span class="hljs-regexp">/&amp;/g</span>, <span class="hljs-string">"&amp;amp;"</span>).replace(<span class="hljs-regexp">/'/g</span>, <span class="hljs-string">"&amp;#39;"</span>).replace(<span class="hljs-regexp">/"/g</span>,
    <span class="hljs-string">"&amp;quot;"</span>).replace(<span class="hljs-regexp">/&lt;/g</span>, <span class="hljs-string">"&amp;#60;"</span>).replace(<span class="hljs-regexp">/&gt;/g</span>, <span class="hljs-string">"&amp;#62;"</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">htmlEscapeQuote</span>(<span class="hljs-params">s</span>) </span>{
  <span class="hljs-keyword">return</span> s.replace(<span class="hljs-regexp">/'/g</span>, <span class="hljs-string">"&amp;#39;"</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">htmlEscapeDoubleQuote</span>(<span class="hljs-params">s</span>) </span>{
  <span class="hljs-keyword">return</span> s.replace(<span class="hljs-regexp">/"/g</span>, <span class="hljs-string">"&amp;quot;"</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">loadXML</span>(<span class="hljs-params">r</span>) </span>{
  <span class="hljs-keyword">var</span> xml = r.responseXML;
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> xml != <span class="hljs-string">'undefined'</span>)
    <span class="hljs-keyword">return</span> xml;
  <span class="hljs-keyword">var</span> dom = <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">try</span> {
    dom = <span class="hljs-keyword">new</span> DOMParser().parseFromString(r, <span class="hljs-string">'text/xml'</span>);
  } <span class="hljs-keyword">catch</span> (e) {}
  <span class="hljs-keyword">return</span> dom;
}
<span class="hljs-keyword">if</span> (!<span class="hljs-built_in">window</span>.GwtDateTimePicker) {
  <span class="hljs-built_in">window</span>.GwtDateTimePicker = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name, format, showTime</span>) </span>{
    ScriptLoader.getScripts(<span class="hljs-string">'scripts/classes/GwtDateTimePicker.js'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">new</span> GwtDateTimePicker(name, format, showTime);
    });
  }
};
<span class="hljs-comment">/*! RESOURCE: /scripts/functions/xmlhttp.js */</span>
<span class="hljs-keyword">var</span> isMicrosoftXMLHTTP = <span class="hljs-literal">false</span>;
<span class="hljs-keyword">var</span> XML_HTTP = <span class="hljs-string">"xmlhttp.do"</span>;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">AJAXEvaluateSynchronously</span>(<span class="hljs-params">expression</span>) </span>{
  <span class="hljs-keyword">var</span> ajax = <span class="hljs-keyword">new</span> GlideAjax(<span class="hljs-string">"AJAXEvaluator"</span>);
  ajax.addParam(<span class="hljs-string">"sysparm_expression"</span>, expression);
  ajax.getXMLWait();
  <span class="hljs-keyword">return</span> ajax.getAnswer();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">AJAXEvaluate</span>(<span class="hljs-params">expression, callbackAndArgs</span>) </span>{
  <span class="hljs-keyword">var</span> ajax = <span class="hljs-keyword">new</span> GlideAjax(<span class="hljs-string">"AJAXEvaluator"</span>);
  ajax.addParam(<span class="hljs-string">"sysparm_expression"</span>, expression);
  ajax.getXML(AJAXEvaluateResponse, <span class="hljs-string">""</span>, callbackAndArgs);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">AJAXEvaluateResponse</span>(<span class="hljs-params">response, callbackAndArgs</span>) </span>{
  <span class="hljs-keyword">var</span> xml = response.responseXML;
  <span class="hljs-keyword">var</span> answer = xml.documentElement.getAttribute(<span class="hljs-string">"answer"</span>);
  <span class="hljs-keyword">if</span> (callbackAndArgs != <span class="hljs-literal">null</span>) {
    <span class="hljs-keyword">var</span> callback = callbackAndArgs;
    <span class="hljs-keyword">var</span> args = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>();
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> callbackAndArgs != <span class="hljs-string">"function"</span> &amp;&amp; callbackAndArgs.length &gt; <span class="hljs-number">1</span>) {
      callback = callbackAndArgs.splice(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>)[<span class="hljs-number">0</span>];
      args = callbackAndArgs;
    }
    callback.call(answer, answer, response, args);
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">AJAXFunction</span>(<span class="hljs-params">func, args, callback, callbackArgs</span>) </span>{
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; args.length; i++) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> args[i] == <span class="hljs-string">"function"</span>)
      <span class="hljs-keyword">continue</span>;
    args[i] = args[i].replace(<span class="hljs-regexp">/"/g</span>, <span class="hljs-string">"\\\""</span>);
  }
  <span class="hljs-keyword">var</span> expression = func + <span class="hljs-string">'("'</span> + args.join(<span class="hljs-string">'","'</span>) + <span class="hljs-string">'");'</span>;
  <span class="hljs-keyword">var</span> newArgs = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>();
  newArgs.push(callback);
  newArgs = newArgs.concat(callbackArgs);
  AJAXEvaluate(expression, newArgs);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">serverRequest</span>(<span class="hljs-params">url, loadedFunction, args</span>) </span>{
  ajaxRequest(url, <span class="hljs-literal">null</span>, <span class="hljs-literal">true</span>, loadedFunction, args);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">serverRequestWait</span>(<span class="hljs-params">url, postString</span>) </span>{
  <span class="hljs-keyword">var</span> req = ajaxRequest(url, postString, <span class="hljs-literal">false</span>);
  <span class="hljs-keyword">if</span> (req.status == <span class="hljs-number">200</span>)
    <span class="hljs-keyword">return</span> req;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">serverRequestPost</span>(<span class="hljs-params">url, postString, loadedFunction, args</span>) </span>{
  ajaxRequest(url, postString, <span class="hljs-literal">true</span>, loadedFunction, args);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ajaxRequest</span>(<span class="hljs-params">url, postString, async, responseFunction, responseFunctionArgs</span>) </span>{
  <span class="hljs-keyword">var</span> req = getRequest();
  showLoading();
  <span class="hljs-keyword">if</span> (req) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">async</span> &amp;&amp; (responseFunction != <span class="hljs-literal">null</span>))
      req.onreadystatechange = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        processReqChange(req, responseFunction, responseFunctionArgs);
      };
    req.open((postString ? <span class="hljs-string">"POST"</span> : <span class="hljs-string">"GET"</span>), url, <span class="hljs-keyword">async</span>);
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> g_ck != <span class="hljs-string">'undefined'</span> &amp;&amp; g_ck != <span class="hljs-string">""</span>)
      req.setRequestHeader(<span class="hljs-string">'X-UserToken'</span>, g_ck);
    <span class="hljs-keyword">if</span> (postString) {
      req.setRequestHeader(<span class="hljs-string">'Content-Type'</span>, <span class="hljs-string">'application/x-www-form-urlencoded; charset=UTF-8'</span>);
      req.send(postString);
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">if</span> (isMicrosoftXMLHTTP)
        req.send();
      <span class="hljs-keyword">else</span>
        req.send(<span class="hljs-literal">null</span>);
    }
  }
  <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">async</span>)
    hideLoading();
  <span class="hljs-keyword">return</span> req;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getRequest</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> req = <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.XMLHttpRequest) {
    req = <span class="hljs-keyword">new</span> XMLHttpRequest();
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.ActiveXObject) {
    isMicrosoftXMLHTTP = <span class="hljs-literal">true</span>;
    req = <span class="hljs-keyword">new</span> ActiveXObject(<span class="hljs-string">"Microsoft.XMLHTTP"</span>);
  }
  <span class="hljs-keyword">return</span> req;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">processReqChange</span>(<span class="hljs-params">r, docLoadedFunction, docLoadedFunctionArgs</span>) </span>{
  <span class="hljs-keyword">if</span> (r.readyState == <span class="hljs-number">4</span>) {
    hideLoading();
    <span class="hljs-keyword">if</span> (r.status == <span class="hljs-number">200</span>) {
      lastActivity = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>();
      docLoadedFunction(r, docLoadedFunctionArgs);
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-built_in">window</span>.status = <span class="hljs-string">"There was a problem retrieving the XML data: "</span> + r.statusText;
      } <span class="hljs-keyword">catch</span> (e) {}
    }
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">showLoading</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">try</span> {
    CustomEvent.fireAll(<span class="hljs-string">"ajax.loading.start"</span>);
  } <span class="hljs-keyword">catch</span> (e) {}
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hideLoading</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">try</span> {
    CustomEvent.fireAll(<span class="hljs-string">"ajax.loading.end"</span>);
  } <span class="hljs-keyword">catch</span> (e) {}
};
<span class="hljs-comment">/*! RESOURCE: /scripts/classes/event/GwtObservable.js */</span>
<span class="hljs-keyword">var</span> GwtObservable = Class.create({
  <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>.events = {};
  },
  <span class="hljs-attr">on</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name, func</span>) </span>{
    <span class="hljs-keyword">if</span> (!func || <span class="hljs-keyword">typeof</span> func != <span class="hljs-string">'function'</span>)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">this</span>.events = <span class="hljs-keyword">this</span>.events || {};
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.events[name])
      <span class="hljs-keyword">this</span>.events[name] = [];
    <span class="hljs-keyword">this</span>.events[name].push(func);
  },
  <span class="hljs-attr">forward</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name, element, func</span>) </span>{
    GwtObservable.prototype.on.call(<span class="hljs-keyword">this</span>, name, func);
    Event.observe(element, name, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
      <span class="hljs-keyword">this</span>.fireEvent(e.type, <span class="hljs-keyword">this</span>, e);
    }.bind(<span class="hljs-keyword">this</span>));
  },
  <span class="hljs-attr">un</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name, func</span>) </span>{
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.events[name])
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">var</span> i = <span class="hljs-keyword">this</span>.events[name].indexOf(func);
    <span class="hljs-keyword">if</span> (i !== <span class="hljs-number">-1</span>)
      <span class="hljs-keyword">this</span>.events[name].splice(i, <span class="hljs-number">1</span>);
  },
  <span class="hljs-attr">unAll</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name</span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.events[name])
      <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.events[name];
  },
  <span class="hljs-attr">isFiring</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._isFiring;
  },
  <span class="hljs-attr">fireEvent</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.suppressEvents === <span class="hljs-literal">true</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">this</span>.events = <span class="hljs-keyword">this</span>.events || {};
    <span class="hljs-keyword">var</span> args = $A(<span class="hljs-built_in">arguments</span>);
    <span class="hljs-keyword">var</span> name = args.shift();
    <span class="hljs-keyword">var</span> eventList = <span class="hljs-keyword">this</span>.events[name];
    <span class="hljs-keyword">if</span> (!eventList)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">var</span> event = eventList.slice();
    <span class="hljs-keyword">this</span>._isFiring = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, l = event.length; i &lt; l; i++) {
      <span class="hljs-keyword">var</span> ev = event[i];
      <span class="hljs-keyword">if</span> (ev == <span class="hljs-literal">null</span>)
        <span class="hljs-keyword">continue</span>;
      <span class="hljs-keyword">if</span> (ev.apply(<span class="hljs-keyword">this</span>, args) === <span class="hljs-literal">false</span>) {
        <span class="hljs-keyword">this</span>._isFiring = <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
      }
    }
    <span class="hljs-keyword">this</span>._isFiring = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  },
  <span class="hljs-attr">toString</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-string">'GwtObservable'</span>;
  }
});;
<span class="hljs-comment">/*! RESOURCE: /scripts/doctype/CustomEventManager.js */</span>
<span class="hljs-keyword">var</span> NOW = NOW || {};
<span class="hljs-keyword">var</span> CustomEventManager = (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">existingCustomEvent</span>) </span>{
<span class="hljs-meta">  "use strict"</span>;
  <span class="hljs-keyword">var</span> events = (existingCustomEvent &amp;&amp; existingCustomEvent.events) || {};
  <span class="hljs-keyword">var</span> isFiringFlag = <span class="hljs-literal">false</span>;
  <span class="hljs-keyword">var</span> trace = <span class="hljs-literal">false</span>;
  <span class="hljs-keyword">var</span> suppressEvents = <span class="hljs-literal">false</span>;
  <span class="hljs-keyword">var</span> NOW_MSG = <span class="hljs-string">'NOW.PostMessage'</span>;

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">observe</span>(<span class="hljs-params">eventName, fn</span>) </span>{
    <span class="hljs-keyword">if</span> (trace)
      jslog(<span class="hljs-string">"$CustomEventManager observing: "</span> + eventName);
    on(eventName, fn);
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">on</span>(<span class="hljs-params">name, func</span>) </span>{
    <span class="hljs-keyword">if</span> (!func || <span class="hljs-keyword">typeof</span> func !== <span class="hljs-string">'function'</span>)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> name === <span class="hljs-string">'undefined'</span>)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">if</span> (!events[name])
      events[name] = [];
    events[name].push(func);
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">un</span>(<span class="hljs-params">name, func</span>) </span>{
    <span class="hljs-keyword">if</span> (!events[name])
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">var</span> idx = <span class="hljs-number">-1</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; events[name].length; i++) {
      <span class="hljs-keyword">if</span> (events[name][i] === func) {
        idx = i;
        <span class="hljs-keyword">break</span>;
      }
    }
    <span class="hljs-keyword">if</span> (idx &gt;= <span class="hljs-number">0</span>)
      events[name].splice(idx, <span class="hljs-number">1</span>)
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">unAll</span>(<span class="hljs-params">name</span>) </span>{
    <span class="hljs-keyword">if</span> (events[name])
      <span class="hljs-keyword">delete</span> events[name];
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fire</span>(<span class="hljs-params">eventName, args</span>) </span>{
    <span class="hljs-keyword">if</span> (trace)
      jslog(<span class="hljs-string">"$CustomEventManager firing: "</span> + eventName + <span class="hljs-string">" args: "</span> + <span class="hljs-built_in">arguments</span>.length);
    <span class="hljs-keyword">return</span> fireEvent.apply(<span class="hljs-literal">null</span>, <span class="hljs-built_in">arguments</span>);
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fireUp</span>(<span class="hljs-params">eventName, args</span>) </span>{
    <span class="hljs-keyword">var</span> win = <span class="hljs-built_in">window</span>;
    <span class="hljs-keyword">while</span> (win) {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">if</span> (win.CustomEvent.fireEvent.apply(<span class="hljs-literal">null</span>, <span class="hljs-built_in">arguments</span>) === <span class="hljs-literal">false</span>)
          <span class="hljs-keyword">return</span>;
        win = win.parent === win ? <span class="hljs-literal">null</span> : win.parent;
      } <span class="hljs-keyword">catch</span> (e) {
        <span class="hljs-keyword">return</span>;
      }
    }
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fireEvent</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (suppressEvents)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">var</span> args = <span class="hljs-built_in">Array</span>.prototype.slice.apply(<span class="hljs-built_in">arguments</span>);
    <span class="hljs-keyword">var</span> name = args.shift();
    <span class="hljs-keyword">var</span> eventList = events[name];
    <span class="hljs-keyword">if</span> (!eventList)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">var</span> event = eventList.slice();
    isFiringFlag = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, l = event.length; i &lt; l; i++) {
      <span class="hljs-keyword">var</span> ev = event[i];
      <span class="hljs-keyword">if</span> (!ev)
        <span class="hljs-keyword">continue</span>;
      <span class="hljs-keyword">if</span> (ev.apply(<span class="hljs-literal">null</span>, args) === <span class="hljs-literal">false</span>) {
        isFiringFlag = <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
      }
    }
    isFiringFlag = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isFiring</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> isFiringFlag;
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">forward</span>(<span class="hljs-params">name, element, func</span>) </span>{
    on(name, func);
    element.addEventListener(name, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
      fireEvent(e.type, <span class="hljs-keyword">this</span>, e);
    }.bind(api));
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">registerPostMessageEvent</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (NOW.registeredPostMessageEvent) {
      <span class="hljs-keyword">return</span>;
    }
    <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">window</span>.postMessage) {
      <span class="hljs-keyword">return</span>;
    }
    <span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">'message'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>{
      <span class="hljs-keyword">var</span> nowMessageJSON = event.data;
      <span class="hljs-keyword">var</span> nowMessage;
      <span class="hljs-keyword">try</span> {
        nowMessage = <span class="hljs-built_in">JSON</span>.parse(nowMessageJSON.toString());
      } <span class="hljs-keyword">catch</span> (e) {
        <span class="hljs-keyword">return</span>;
      }
      <span class="hljs-keyword">if</span> (!nowMessage.type == NOW_MSG) {
        <span class="hljs-keyword">return</span>;
      }
      fire(nowMessage.eventName, nowMessage.args);
    }, <span class="hljs-literal">false</span>);
    NOW.registeredPostMessageEvent = <span class="hljs-literal">true</span>;
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">doPostMessage</span>(<span class="hljs-params">win, event, msg, targetOrigin</span>) </span>{
    <span class="hljs-keyword">var</span> nowMessage = {
      <span class="hljs-attr">type</span>: NOW_MSG,
      <span class="hljs-attr">eventName</span>: event,
      <span class="hljs-attr">args</span>: msg
    };
    <span class="hljs-keyword">var</span> nowMessageJSON;
    <span class="hljs-keyword">if</span> (!win || !win.postMessage) {
      <span class="hljs-keyword">return</span>
    }
    nowMessageJSON = <span class="hljs-built_in">JSON</span>.stringify(nowMessage);
    win.postMessage(nowMessageJSON, targetOrigin);
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fireTop</span>(<span class="hljs-params">eventName, args</span>) </span>{
    <span class="hljs-keyword">if</span> (trace)
      jslog(<span class="hljs-string">"$CustomEventManager firing: "</span> + eventName + <span class="hljs-string">" args: "</span> + <span class="hljs-built_in">arguments</span>.length);
    fireEvent.apply(<span class="hljs-literal">null</span>, <span class="hljs-built_in">arguments</span>);
    <span class="hljs-keyword">var</span> t = getTopWindow();
    <span class="hljs-keyword">if</span> (t !== <span class="hljs-literal">null</span> &amp;&amp; <span class="hljs-built_in">window</span> !== t)
      t.CustomEvent.fire(eventName, args);
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fireAll</span>(<span class="hljs-params">eventName, args</span>) </span>{
    <span class="hljs-keyword">if</span> (trace)
      jslog(<span class="hljs-string">"$CustomEventManager firing: "</span> + eventName + <span class="hljs-string">" args: "</span> + <span class="hljs-built_in">arguments</span>.length);
    <span class="hljs-keyword">var</span> topWindow = getTopWindow();
    notifyAllFrom(topWindow);

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">notifyAllFrom</span>(<span class="hljs-params">rootFrame</span>) </span>{
      <span class="hljs-keyword">var</span> childFrame;
      rootFrame.CustomEvent.fireEvent(eventName, args);
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; rootFrame.length; i++) {
        <span class="hljs-keyword">try</span> {
          childFrame = rootFrame[i];
          <span class="hljs-keyword">if</span> (!childFrame)
            <span class="hljs-keyword">continue</span>;
          <span class="hljs-keyword">if</span> (childFrame.CustomEvent &amp;&amp; <span class="hljs-keyword">typeof</span> childFrame.CustomEvent.fireEvent === <span class="hljs-string">"function"</span>) {
            notifyAllFrom(childFrame);
          }
        } <span class="hljs-keyword">catch</span> (e) {}
      }
    }
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fireToWindow</span>(<span class="hljs-params">targetWindow, eventName, args, usePostMessage, targetOrigin</span>) </span>{
    <span class="hljs-keyword">if</span> (trace)
      jslog(<span class="hljs-string">"$CustomEventManager firing: "</span> + eventName + <span class="hljs-string">" args: "</span> + args.length);
    <span class="hljs-keyword">if</span> (usePostMessage) {
      doPostMessage(targetWindow, eventName, args, targetOrigin);
    } <span class="hljs-keyword">else</span> {
      targetWindow.CustomEvent.fireEvent(eventName, args);
    }
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getTopWindow</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> topWindow = <span class="hljs-built_in">window</span>.self;
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">while</span> (topWindow.CustomEvent.fireEvent &amp;&amp; topWindow !== topWindow.parent &amp;&amp; topWindow.parent.CustomEvent.fireEvent) {
        topWindow = topWindow.parent;
      }
    } <span class="hljs-keyword">catch</span> (e) {}
    <span class="hljs-keyword">return</span> topWindow;
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isTopWindow</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> getTopWindow() == <span class="hljs-built_in">window</span>.self;
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">jslog</span>(<span class="hljs-params">msg, src, dateTime</span>) </span>{
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">if</span> (!src) {
        <span class="hljs-keyword">var</span> path = <span class="hljs-built_in">window</span>.self.location.pathname;
        src = path.substring(path.lastIndexOf(<span class="hljs-string">'/'</span>) + <span class="hljs-number">1</span>);
      }
      <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.self.opener &amp;&amp; <span class="hljs-built_in">window</span> != <span class="hljs-built_in">window</span>.self.opener) {
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.self.opener.jslog) {
          <span class="hljs-built_in">window</span>.self.opener.jslog(msg, src, dateTime);
        }
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (parent &amp;&amp; parent.jslog &amp;&amp; jslog != parent.jslog) {
        parent.jslog(msg, src, dateTime);
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.console &amp;&amp; <span class="hljs-built_in">window</span>.console.log)
          <span class="hljs-built_in">console</span>.log(msg);
      }
    } <span class="hljs-keyword">catch</span> (e) {}
  }
  <span class="hljs-keyword">var</span> api = {
    set trace(value) {
      trace = !!value;
    },
    get trace() {
      <span class="hljs-keyword">return</span> trace;
    },
    set suppressEvents(value) {
      suppressEvents = !!value;
    },
    get suppressEvents() {
      <span class="hljs-keyword">return</span> suppressEvents;
    },
    get events() {
      <span class="hljs-keyword">return</span> events;
    },
    <span class="hljs-attr">on</span>: on,
    <span class="hljs-attr">un</span>: un,
    <span class="hljs-attr">unAll</span>: unAll,
    <span class="hljs-attr">forward</span>: forward,
    <span class="hljs-attr">isFiring</span>: isFiring,
    <span class="hljs-attr">fireEvent</span>: fireEvent,
    <span class="hljs-attr">observe</span>: observe,
    <span class="hljs-attr">fire</span>: fire,
    <span class="hljs-attr">fireTop</span>: fireTop,
    <span class="hljs-attr">fireAll</span>: fireAll,
    <span class="hljs-attr">fireToWindow</span>: fireToWindow,
    <span class="hljs-attr">isTopWindow</span>: isTopWindow,
    <span class="hljs-attr">fireUp</span>: fireUp,
    <span class="hljs-attr">toString</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-string">'CustomEventManager'</span>;
    }
  };
  registerPostMessageEvent();
  <span class="hljs-keyword">return</span> api;
})(NOW.CustomEvent);
NOW.CustomEvent = CustomEventManager;
<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> CustomEvent !== <span class="hljs-string">"undefined"</span>) {
  CustomEvent.observe = NOW.CustomEvent.observe.bind(NOW.CustomEvent);
  CustomEvent.fire = NOW.CustomEvent.fire.bind(NOW.CustomEvent);
  CustomEvent.fireUp = NOW.CustomEvent.fireUp.bind(NOW.CustomEvent);
  CustomEvent.fireTop = NOW.CustomEvent.fireTop.bind(NOW.CustomEvent);
  CustomEvent.fireAll = NOW.CustomEvent.fireAll.bind(NOW.CustomEvent);
  CustomEvent.fireToWindow = NOW.CustomEvent.fireToWindow.bind(NOW.CustomEvent);
  CustomEvent.on = NOW.CustomEvent.on.bind(NOW.CustomEvent);
  CustomEvent.un = NOW.CustomEvent.un.bind(NOW.CustomEvent);
  CustomEvent.unAll = NOW.CustomEvent.unAll.bind(NOW.CustomEvent);
  CustomEvent.forward = NOW.CustomEvent.forward.bind(NOW.CustomEvent);
  CustomEvent.isFiring = NOW.CustomEvent.isFiring.bind(NOW.CustomEvent);
  CustomEvent.fireEvent = NOW.CustomEvent.fireEvent.bind(NOW.CustomEvent);
  CustomEvent.events = NOW.CustomEvent.events;
  CustomEvent.isTopWindow = NOW.CustomEvent.isTopWindow.bind(NOW.CustomEvent);
} <span class="hljs-keyword">else</span> {
  <span class="hljs-built_in">window</span>.CustomEvent = NOW.CustomEvent;
};
<span class="hljs-comment">/*! RESOURCE: /scripts/classes/ui/Point.js */</span>
<span class="hljs-keyword">var</span> Point = Class.create();
Point.prototype = {
  <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">x, y</span>) </span>{
    <span class="hljs-keyword">this</span>.x = x;
    <span class="hljs-keyword">this</span>.y = y;
  },
  <span class="hljs-attr">getX</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.x;
  },
  <span class="hljs-attr">getY</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.y;
  }
};
<span class="hljs-comment">/*! RESOURCE: /scripts/classes/util/CookieJar.js */</span>
<span class="hljs-keyword">var</span> CookieJar = Class.create({
  <span class="hljs-attr">appendString</span>: <span class="hljs-string">"__CJ_"</span>,
  <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">options</span>) </span>{
    <span class="hljs-keyword">this</span>.options = {
      <span class="hljs-attr">expires</span>: <span class="hljs-number">3600</span>,
      <span class="hljs-attr">path</span>: <span class="hljs-string">''</span>,
      <span class="hljs-attr">domain</span>: <span class="hljs-string">''</span>,
      <span class="hljs-attr">secure</span>: <span class="hljs-string">''</span>
    };
    <span class="hljs-built_in">Object</span>.extend(<span class="hljs-keyword">this</span>.options, options || {});
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.expires != <span class="hljs-string">''</span>) {
      <span class="hljs-keyword">var</span> date = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>();
      date = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(date.getTime() + (<span class="hljs-keyword">this</span>.options.expires * <span class="hljs-number">1000</span>));
      <span class="hljs-keyword">this</span>.options.expires = <span class="hljs-string">'; expires='</span> + date.toGMTString();
    }
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.path != <span class="hljs-string">''</span>) {
      <span class="hljs-keyword">this</span>.options.path = <span class="hljs-string">'; path='</span> + <span class="hljs-built_in">escape</span>(<span class="hljs-keyword">this</span>.options.path);
    }
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.domain != <span class="hljs-string">''</span>) {
      <span class="hljs-keyword">this</span>.options.domain = <span class="hljs-string">'; domain='</span> + <span class="hljs-built_in">escape</span>(<span class="hljs-keyword">this</span>.options.domain);
    }
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.secure == <span class="hljs-string">'secure'</span>) {
      <span class="hljs-keyword">this</span>.options.secure = <span class="hljs-string">'; secure'</span>;
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">this</span>.options.secure = <span class="hljs-string">''</span>;
    }
  },
  <span class="hljs-attr">put</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name, value</span>) </span>{
    name = <span class="hljs-keyword">this</span>.appendString + name;
    cookie = <span class="hljs-keyword">this</span>.options;
    <span class="hljs-keyword">var</span> type = <span class="hljs-keyword">typeof</span> value;
    <span class="hljs-keyword">switch</span> (type) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">'undefined'</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-string">'function'</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-string">'unknown'</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">'boolean'</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-string">'string'</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-string">'number'</span>:
        value = <span class="hljs-built_in">String</span>(value.toString());
    }
    <span class="hljs-keyword">var</span> cookie_str = name + <span class="hljs-string">"="</span> + <span class="hljs-built_in">escape</span>(<span class="hljs-built_in">Object</span>.toJSON(value));
    <span class="hljs-keyword">try</span> {
      <span class="hljs-built_in">document</span>.cookie = cookie_str + cookie.expires + cookie.path + cookie.domain + cookie.secure;
    } <span class="hljs-keyword">catch</span> (e) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  },
  <span class="hljs-attr">get</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name</span>) </span>{
    name = <span class="hljs-keyword">this</span>.appendString + name;
    <span class="hljs-keyword">var</span> cookies = <span class="hljs-built_in">document</span>.cookie.match(name + <span class="hljs-string">'=(.*?)(;|$)'</span>);
    <span class="hljs-keyword">if</span> (cookies) {
      <span class="hljs-keyword">return</span> (<span class="hljs-built_in">unescape</span>(cookies[<span class="hljs-number">1</span>])).evalJSON();
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }
  }
});;
<span class="hljs-comment">/*! RESOURCE: /scripts/list_filter.js */</span>
<span class="hljs-keyword">var</span> runFilterHandlers = {}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setImage</span>(<span class="hljs-params">element, src</span>) </span>{
  element = $(element);
  <span class="hljs-keyword">if</span> (!element)
    <span class="hljs-keyword">return</span>;
  element.src = src;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">swapImage</span>(<span class="hljs-params">imgId, newSrc</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    setImage(imgId, newSrc);
  };
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setDisplay</span>(<span class="hljs-params">element, display</span>) </span>{
  <span class="hljs-keyword">var</span> i = $(element);
  i.style.display = display;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">runFilter</span>(<span class="hljs-params">name</span>) </span>{
  <span class="hljs-keyword">if</span> (queueFilters[name]) {
    columnsGet(name, runFilterCallBack);
    <span class="hljs-keyword">return</span>;
  }
  runFilter0(name);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">runFilterCallBack</span>(<span class="hljs-params"></span>) </span>{
  queueFilters[mainFilterTable] = <span class="hljs-literal">null</span>;
  runFilter0(mainFilterTable);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">runFilter0</span>(<span class="hljs-params">name</span>) </span>{
  <span class="hljs-keyword">var</span> filter = getFilter(name);
  <span class="hljs-keyword">if</span> (name.endsWith(<span class="hljs-string">'.'</span>))
    name = name.substring(<span class="hljs-number">0</span>, name.length - <span class="hljs-number">1</span>);
  <span class="hljs-keyword">if</span> (!runFilterHandlers[name])
    <span class="hljs-keyword">return</span>;
  runFilterHandlers[name](name, filter);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">saveFilterRadioChange</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> div = gel(<span class="hljs-string">'savefiltergroupref'</span>);
  <span class="hljs-keyword">var</span> grp = getMessage(<span class="hljs-string">'Group'</span>);
  <span class="hljs-keyword">if</span> (getGroupSaveOption() == grp)
    div.style.display = <span class="hljs-string">"inline"</span>;
  <span class="hljs-keyword">else</span>
    div.style.display = <span class="hljs-string">"none"</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getFilterVisibility</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> vis = getGroupSaveOption();
  <span class="hljs-keyword">var</span> me = getMessage(<span class="hljs-string">'Me'</span>);
  <span class="hljs-keyword">var</span> eone = getMessage(<span class="hljs-string">'Everyone'</span>);
  <span class="hljs-keyword">var</span> grp = getMessage(<span class="hljs-string">'Group'</span>);
  <span class="hljs-keyword">if</span> (vis == me)
    <span class="hljs-keyword">return</span> vis;
  <span class="hljs-keyword">if</span> (vis == eone)
    <span class="hljs-keyword">return</span> <span class="hljs-string">"GLOBAL"</span>;
  <span class="hljs-keyword">if</span> (vis != grp)
    <span class="hljs-keyword">return</span> me;
  <span class="hljs-keyword">var</span> vis = <span class="hljs-string">''</span>;
  <span class="hljs-keyword">var</span> e = gel(<span class="hljs-string">'save_filter_ref_id'</span>).value;
  <span class="hljs-keyword">var</span> e = gel(e);
  <span class="hljs-keyword">if</span> (e)
    vis = e.value;
  <span class="hljs-keyword">if</span> (!vis)
    <span class="hljs-keyword">return</span> me;
  <span class="hljs-keyword">return</span> vis;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getGroupSaveOption</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> rb = gel(<span class="hljs-string">'MeRadio'</span>);
  <span class="hljs-keyword">if</span> (rb &amp;&amp; rb.checked)
    <span class="hljs-keyword">return</span> rb.value;
  rb = gel(<span class="hljs-string">'EveryoneRadio'</span>);
  <span class="hljs-keyword">if</span> (rb &amp;&amp; rb.checked)
    <span class="hljs-keyword">return</span> rb.value;
  rb = gel(<span class="hljs-string">'GroupRadio'</span>);
  <span class="hljs-keyword">if</span> (rb &amp;&amp; rb.checked)
    <span class="hljs-keyword">return</span> rb.value;
  <span class="hljs-keyword">return</span> getMessage(<span class="hljs-string">'Me'</span>);
};
<span class="hljs-comment">/*! RESOURCE: /scripts/doctype/simpleStorage.js */</span>
(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">root, factory</span>) </span>{
<span class="hljs-meta">  "use strict"</span>;
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> define === <span class="hljs-string">'function'</span> &amp;&amp; define.amd)
    define(factory);
  <span class="hljs-keyword">else</span>
    root.simpleStorage = factory();
}(<span class="hljs-keyword">this</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
<span class="hljs-meta">  "use strict"</span>;
  <span class="hljs-keyword">var</span> VERSION = <span class="hljs-string">"0.1.2"</span>,
    _storage = <span class="hljs-literal">false</span>,
    _storage_size = <span class="hljs-number">0</span>,
    _storage_available = <span class="hljs-literal">false</span>,
    _ttl_timeout = <span class="hljs-literal">null</span>;

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_init</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-built_in">window</span>.localStorage.setItem(<span class="hljs-string">"__simpleStorageInitTest"</span>, <span class="hljs-string">"tmpval"</span>);
    <span class="hljs-built_in">window</span>.localStorage.removeItem(<span class="hljs-string">"__simpleStorageInitTest"</span>);
    _load_storage();
    _handleTTL();
    _setupUpdateObserver();
    <span class="hljs-keyword">if</span> (<span class="hljs-string">"addEventListener"</span> <span class="hljs-keyword">in</span> <span class="hljs-built_in">window</span>) {
      <span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">"pageshow"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>{
        <span class="hljs-keyword">if</span> (event.persisted) {
          _reloadData();
        }
      }, <span class="hljs-literal">false</span>);
    }
    _storage_available = <span class="hljs-literal">true</span>;
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_setupUpdateObserver</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-string">"addEventListener"</span> <span class="hljs-keyword">in</span> <span class="hljs-built_in">window</span>)
      <span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">"storage"</span>, _reloadData, <span class="hljs-literal">false</span>);
    <span class="hljs-keyword">else</span>
      <span class="hljs-built_in">document</span>.attachEvent(<span class="hljs-string">"onstorage"</span>, _reloadData);
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_reloadData</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">try</span> {
      _load_storage();
    } <span class="hljs-keyword">catch</span> (E) {
      _storage_available = <span class="hljs-literal">false</span>;
      <span class="hljs-keyword">return</span>;
    }
    _handleTTL();
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_load_storage</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> source = localStorage.getItem(<span class="hljs-string">"simpleStorage"</span>);
    <span class="hljs-keyword">try</span> {
      _storage = <span class="hljs-built_in">JSON</span>.parse(source) || {};
    } <span class="hljs-keyword">catch</span> (E) {
      _storage = {};
    }
    _storage_size = _get_storage_size();
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_save</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">try</span> {
      localStorage.setItem(<span class="hljs-string">"simpleStorage"</span>, <span class="hljs-built_in">JSON</span>.stringify(_storage));
      _storage_size = _get_storage_size();
    } <span class="hljs-keyword">catch</span> (E) {
      <span class="hljs-keyword">return</span> E;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_get_storage_size</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> source = localStorage.getItem(<span class="hljs-string">"simpleStorage"</span>);
    <span class="hljs-keyword">return</span> source ? <span class="hljs-built_in">String</span>(source).length : <span class="hljs-number">0</span>;
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_handleTTL</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> curtime, i, len, expire, keys, nextExpire = <span class="hljs-literal">Infinity</span>,
      expiredKeysCount = <span class="hljs-number">0</span>;
    clearTimeout(_ttl_timeout);
    <span class="hljs-keyword">if</span> (!_storage || !_storage.__simpleStorage_meta || !_storage.__simpleStorage_meta.TTL)
      <span class="hljs-keyword">return</span>;
    curtime = +<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>();
    keys = _storage.__simpleStorage_meta.TTL.keys || [];
    expire = _storage.__simpleStorage_meta.TTL.expire || {};
    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>, len = keys.length; i &lt; len; i++) {
      <span class="hljs-keyword">if</span> (expire[keys[i]] &lt;= curtime) {
        expiredKeysCount++;
        <span class="hljs-keyword">delete</span> _storage[keys[i]];
        <span class="hljs-keyword">delete</span> expire[keys[i]];
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">if</span> (expire[keys[i]] &lt; nextExpire) {
          nextExpire = expire[keys[i]];
        }
        <span class="hljs-keyword">break</span>;
      }
    }
    <span class="hljs-keyword">if</span> (nextExpire != <span class="hljs-literal">Infinity</span>) {
      _ttl_timeout = setTimeout(_handleTTL, <span class="hljs-built_in">Math</span>.min(nextExpire - curtime, <span class="hljs-number">0x7FFFFFFF</span>));
    }
    <span class="hljs-keyword">if</span> (expiredKeysCount) {
      keys.splice(<span class="hljs-number">0</span>, expiredKeysCount);
      _cleanMetaObject();
      _save();
    }
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_setTTL</span>(<span class="hljs-params">key, ttl</span>) </span>{
    <span class="hljs-keyword">var</span> curtime = +<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(),
      i, len, added = <span class="hljs-literal">false</span>;
    ttl = <span class="hljs-built_in">Number</span>(ttl) || <span class="hljs-number">0</span>;
    <span class="hljs-keyword">if</span> (ttl !== <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">if</span> (_storage.hasOwnProperty(key)) {
        <span class="hljs-keyword">if</span> (!_storage.__simpleStorage_meta)
          _storage.__simpleStorage_meta = {};
        <span class="hljs-keyword">if</span> (!_storage.__simpleStorage_meta.TTL)
          _storage.__simpleStorage_meta.TTL = {
            <span class="hljs-attr">expire</span>: {},
            <span class="hljs-attr">keys</span>: []
          };
        _storage.__simpleStorage_meta.TTL.expire[key] = curtime + ttl;
        <span class="hljs-keyword">if</span> (_storage.__simpleStorage_meta.TTL.expire.hasOwnProperty(key)) {
          <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>, len = _storage.__simpleStorage_meta.TTL.keys.length; i &lt; len; i++) {
            <span class="hljs-keyword">if</span> (_storage.__simpleStorage_meta.TTL.keys[i] == key) {
              _storage.__simpleStorage_meta.TTL.keys.splice(i);
            }
          }
        }
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>, len = _storage.__simpleStorage_meta.TTL.keys.length; i &lt; len; i++) {
          <span class="hljs-keyword">if</span> (_storage.__simpleStorage_meta.TTL.expire[_storage.__simpleStorage_meta.TTL.keys[i]] &gt; curtime + ttl) {
            _storage.__simpleStorage_meta.TTL.keys.splice(i, <span class="hljs-number">0</span>, key);
          }
        }
        <span class="hljs-keyword">if</span> (!added)
          _storage.__simpleStorage_meta.TTL.keys.push(key);
      } <span class="hljs-keyword">else</span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">if</span> (_storage &amp;&amp; _storage.__simpleStorage_meta &amp;&amp; _storage.__simpleStorage_meta.TTL) {
        <span class="hljs-keyword">if</span> (_storage.__simpleStorage_meta.TTL.expire.hasOwnProperty(key)) {
          <span class="hljs-keyword">delete</span> _storage.__simpleStorage_meta.TTL.expire[key];
          <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>, len = _storage.__simpleStorage_meta.TTL.keys.length; i &lt; len; i++) {
            <span class="hljs-keyword">if</span> (_storage.__simpleStorage_meta.TTL.keys[i] == key) {
              _storage.__simpleStorage_meta.TTL.keys.splice(i, <span class="hljs-number">1</span>);
              <span class="hljs-keyword">break</span>;
            }
          }
        }
        _cleanMetaObject();
      }
    }
    clearTimeout(_ttl_timeout);
    <span class="hljs-keyword">if</span> (_storage &amp;&amp; _storage.__simpleStorage_meta &amp;&amp; _storage.__simpleStorage_meta.TTL &amp;&amp; _storage.__simpleStorage_meta.TTL.keys.length) {
      _ttl_timeout = setTimeout(_handleTTL, <span class="hljs-built_in">Math</span>.min(<span class="hljs-built_in">Math</span>.max(_storage.__simpleStorage_meta.TTL.expire[_storage.__simpleStorage_meta.TTL.keys[<span class="hljs-number">0</span>]] - curtime, <span class="hljs-number">0</span>), <span class="hljs-number">0x7FFFFFFF</span>));
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_cleanMetaObject</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> updated = <span class="hljs-literal">false</span>,
      hasProperties = <span class="hljs-literal">false</span>,
      i;
    <span class="hljs-keyword">if</span> (!_storage || !_storage.__simpleStorage_meta)
      <span class="hljs-keyword">return</span> updated;
    <span class="hljs-keyword">if</span> (_storage.__simpleStorage_meta.TTL &amp;&amp; !_storage.__simpleStorage_meta.TTL.keys.length) {
      <span class="hljs-keyword">delete</span> _storage.__simpleStorage_meta.TTL;
      updated = <span class="hljs-literal">true</span>;
    }
    <span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> _storage.__simpleStorage_meta) {
      <span class="hljs-keyword">if</span> (_storage.__simpleStorage_meta.hasOwnProperty(i)) {
        hasProperties = <span class="hljs-literal">true</span>;
        <span class="hljs-keyword">break</span>;
      }
    }
    <span class="hljs-keyword">if</span> (!hasProperties) {
      <span class="hljs-keyword">delete</span> _storage.__simpleStorage_meta;
      updated = <span class="hljs-literal">true</span>;
    }
    <span class="hljs-keyword">return</span> updated;
  }
  <span class="hljs-keyword">try</span> {
    _init();
  } <span class="hljs-keyword">catch</span> (E) {}
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">version</span>: VERSION,
    <span class="hljs-attr">canUse</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">return</span> !!_storage_available;
    },
    <span class="hljs-attr">set</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">key, value, options</span>) </span>{
      <span class="hljs-keyword">if</span> (key == <span class="hljs-string">"__simpleStorage_meta"</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
      <span class="hljs-keyword">if</span> (!_storage)
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> value == <span class="hljs-string">"undefined"</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.deleteKey(key);
      options = options || {};
      <span class="hljs-keyword">try</span> {
        value = <span class="hljs-built_in">JSON</span>.parse(<span class="hljs-built_in">JSON</span>.stringify(value));
      } <span class="hljs-keyword">catch</span> (E) {
        <span class="hljs-keyword">return</span> E;
      }
      _storage[key] = value;
      _setTTL(key, options.TTL || <span class="hljs-number">0</span>);
      <span class="hljs-keyword">return</span> _save();
    },
    <span class="hljs-attr">get</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">key</span>) </span>{
      <span class="hljs-keyword">if</span> (!_storage)
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
      <span class="hljs-keyword">if</span> (_storage.hasOwnProperty(key) &amp;&amp;
        key != <span class="hljs-string">"__simpleStorage_meta"</span>) {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.getTTL(key)) {
          <span class="hljs-keyword">return</span> _storage[key];
        }
      }
    },
    <span class="hljs-attr">deleteKey</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">key</span>) </span>{
      <span class="hljs-keyword">if</span> (!_storage)
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
      <span class="hljs-keyword">if</span> (key <span class="hljs-keyword">in</span> _storage) {
        <span class="hljs-keyword">delete</span> _storage[key];
        _setTTL(key, <span class="hljs-number">0</span>);
        <span class="hljs-keyword">return</span> _save();
      }
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    },
    <span class="hljs-attr">setTTL</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">key, ttl</span>) </span>{
      <span class="hljs-keyword">if</span> (!_storage)
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
      _setTTL(key, ttl);
      <span class="hljs-keyword">return</span> _save();
    },
    <span class="hljs-attr">getTTL</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">key</span>) </span>{
      <span class="hljs-keyword">if</span> (!_storage)
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
      <span class="hljs-keyword">if</span> (_storage.hasOwnProperty(key)) {
        <span class="hljs-keyword">if</span> (_storage.__simpleStorage_meta &amp;&amp;
          _storage.__simpleStorage_meta.TTL &amp;&amp;
          _storage.__simpleStorage_meta.TTL.expire &amp;&amp;
          _storage.__simpleStorage_meta.TTL.expire
          .hasOwnProperty(key)) {
          <span class="hljs-keyword">var</span> ttl = <span class="hljs-built_in">Math</span>.max(_storage.__simpleStorage_meta.TTL.expire[key] - (+<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>()) || <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
          <span class="hljs-keyword">return</span> ttl || <span class="hljs-literal">false</span>;
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">return</span> <span class="hljs-literal">Infinity</span>;
        }
      }
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    },
    <span class="hljs-attr">flush</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">if</span> (!_storage)
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
      _storage = {};
      _storage_size = <span class="hljs-number">0</span>;
      <span class="hljs-keyword">try</span> {
        localStorage.removeItem(<span class="hljs-string">"simpleStorage"</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
      } <span class="hljs-keyword">catch</span> (E) {
        <span class="hljs-keyword">return</span> E;
      }
    },
    <span class="hljs-attr">index</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">if</span> (!_storage)
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
      <span class="hljs-keyword">var</span> index = [],
        i;
      <span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> _storage) {
        <span class="hljs-keyword">if</span> (_storage.hasOwnProperty(i) &amp;&amp;
          i != <span class="hljs-string">"__simpleStorage_meta"</span>) {
          index.push(i);
        }
      }
      <span class="hljs-keyword">return</span> index;
    },
    <span class="hljs-attr">storageSize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">return</span> _storage_size;
    },
    <span class="hljs-attr">getStorage</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">return</span> _storage;
    }
  };
}));;
<span class="hljs-comment">/*! RESOURCE: /scripts/doctype/GwtMessage14.js */</span>
<span class="hljs-keyword">var</span> GwtMessage = Class.create({
  <span class="hljs-attr">DEFAULT_LANGUAGE</span>: <span class="hljs-string">"en"</span>,
  <span class="hljs-attr">PREFETCH_ENTRY_KEY</span>: <span class="hljs-string">"PREFETCH_ENTRY_KEY"</span>,
  <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{},
  <span class="hljs-attr">set</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">n, v</span>) </span>{
    <span class="hljs-keyword">if</span> (!v)
      GwtMessage._messages[n] = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">else</span>
      GwtMessage._messages[n] = v;
  },
  <span class="hljs-attr">format</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">msg</span>) </span>{
    <span class="hljs-keyword">if</span> (!msg)
      <span class="hljs-keyword">return</span> <span class="hljs-string">""</span>;
    <span class="hljs-keyword">var</span> str = msg;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">1</span>; i &lt; <span class="hljs-built_in">arguments</span>.length; i++) {
      <span class="hljs-keyword">var</span> paramIndex = i - <span class="hljs-number">1</span>;
      <span class="hljs-keyword">var</span> rx = <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(<span class="hljs-string">"\{["</span> + paramIndex + <span class="hljs-string">"]\}"</span>, <span class="hljs-string">"g"</span>);
      str = str.replace(rx, <span class="hljs-built_in">arguments</span>[i]);
    }
    <span class="hljs-keyword">return</span> str;
  },
  <span class="hljs-attr">getMessage</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">strVal</span>) </span>{
    <span class="hljs-keyword">var</span> valList = [];
    valList.push(strVal);
    <span class="hljs-keyword">var</span> messages = <span class="hljs-keyword">this</span>.getMessages(valList);
    <span class="hljs-keyword">var</span> msg = messages[strVal];
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">arguments</span>.length &gt; <span class="hljs-number">1</span>) {
      <span class="hljs-keyword">var</span> realArray = [].slice.call(<span class="hljs-built_in">arguments</span>, <span class="hljs-number">0</span>);
      realArray[<span class="hljs-number">0</span>] = msg;
      msg = <span class="hljs-keyword">this</span>.format.apply(<span class="hljs-keyword">this</span>, realArray);
    }
    <span class="hljs-keyword">return</span> msg;
  },
  <span class="hljs-attr">getMessages</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">resolveList</span>) </span>{
    <span class="hljs-keyword">var</span> pageMsgs = {};
    <span class="hljs-keyword">var</span> dataRequiringAjaxCall = [];
    <span class="hljs-keyword">var</span> results = {};
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; resolveList.length; i++) {
      <span class="hljs-keyword">var</span> v = GwtMessage._messages[resolveList[i]];
      <span class="hljs-keyword">if</span> (v === <span class="hljs-literal">true</span>)
        pageMsgs[resolveList[i]] = resolveList[i];
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (v)
        pageMsgs[resolveList[i]] = v;
      <span class="hljs-keyword">else</span>
        dataRequiringAjaxCall.push(resolveList[i]);
    }
    <span class="hljs-keyword">if</span> (dataRequiringAjaxCall.length &gt; <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">this</span>._loadNewMessages(dataRequiringAjaxCall);
      results = <span class="hljs-keyword">this</span>._buildListFromCache(dataRequiringAjaxCall);
    }
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> key <span class="hljs-keyword">in</span> pageMsgs)
      results[key] = pageMsgs[key];
    <span class="hljs-keyword">return</span> results;
  },
  <span class="hljs-attr">_loadNewMessages</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">resolveList</span>) </span>{
    <span class="hljs-keyword">var</span> cachedMessages = <span class="hljs-keyword">this</span>._findCachedKeys(resolveList);
    <span class="hljs-keyword">var</span> keysToResolve = <span class="hljs-keyword">this</span>._removeCachedEntries(resolveList, cachedMessages);
    <span class="hljs-keyword">if</span> (keysToResolve.length == <span class="hljs-number">0</span>)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">var</span> ajax = <span class="hljs-keyword">new</span> GlideAjax(<span class="hljs-string">"SysMessageAjax"</span>);
    ajax.addParam(<span class="hljs-string">"sysparm_keys"</span>, keysToResolve.length);
    ajax.addParam(<span class="hljs-string">"sysparm_prefetch"</span>, <span class="hljs-keyword">this</span>._shouldPrefetch() ? <span class="hljs-string">"true"</span> : <span class="hljs-string">"false"</span>);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; keysToResolve.length; i++) {
      <span class="hljs-keyword">var</span> keyVal = <span class="hljs-string">"key"</span> + i;
      ajax.addParam(keyVal, keysToResolve[i]);
    }
    <span class="hljs-keyword">var</span> rxml = ajax.getXMLWait();
    <span class="hljs-keyword">this</span>._processResponse(rxml);
  },
  <span class="hljs-attr">_removeCachedEntries</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">resolveList</span>) </span>{
    <span class="hljs-keyword">var</span> messagesToResolve = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>();
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; resolveList.length; i++) {
      <span class="hljs-keyword">var</span> key = resolveList[i];
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._getCache().get(key))
        <span class="hljs-keyword">continue</span>;
      messagesToResolve.push(key);
    }
    <span class="hljs-keyword">return</span> messagesToResolve;
  },
  <span class="hljs-attr">_processResponse</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">rxml</span>) </span>{
    <span class="hljs-keyword">this</span>._processItems(rxml, <span class="hljs-string">"preitem"</span>);
    <span class="hljs-keyword">this</span>._processItems(rxml, <span class="hljs-string">"item"</span>);
  },
  <span class="hljs-attr">_shouldPrefetch</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> pf = <span class="hljs-keyword">this</span>._getCache().get(<span class="hljs-keyword">this</span>._PREFETCH_ENTRY_KEY);
    <span class="hljs-keyword">var</span> now = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().getTime();
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> pf == <span class="hljs-string">'undefined'</span> || (pf + <span class="hljs-number">60000</span>) &lt; now) {
      <span class="hljs-keyword">this</span>._getCache().put(<span class="hljs-keyword">this</span>._PREFETCH_ENTRY_KEY, now);
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  },
  <span class="hljs-attr">_processItems</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">xml, name</span>) </span>{
    <span class="hljs-keyword">var</span> items = xml.getElementsByTagName(name);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; items.length; i++) {
      <span class="hljs-keyword">var</span> key = items[i].getAttribute(<span class="hljs-string">"key"</span>);
      <span class="hljs-keyword">var</span> value = items[i].getAttribute(<span class="hljs-string">"value"</span>);
      <span class="hljs-keyword">this</span>.setMessage(key, value);
    }
  },
  <span class="hljs-attr">setMessage</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">key, msg</span>) </span>{
    <span class="hljs-keyword">this</span>._getCache().put(key, msg);
  },
  <span class="hljs-attr">isDefaultLanguage</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.getLanguage() == <span class="hljs-keyword">this</span>.getDefaultLanguage();
  },
  <span class="hljs-attr">getLanguage</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> g_lang;
  },
  <span class="hljs-attr">getDefaultLanguage</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.DEFAULT_LANGUAGE;
  },
  <span class="hljs-attr">_findCachedKeys</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">resolveList</span>) </span>{
    <span class="hljs-keyword">var</span> answer = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>();
    <span class="hljs-keyword">var</span> cache = <span class="hljs-keyword">this</span>._getCache();
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; resolveList.length; i++) {
      <span class="hljs-keyword">var</span> key = resolveList[i];
      <span class="hljs-keyword">var</span> value = cache.get(key);
      <span class="hljs-keyword">if</span> (value)
        answer.push(key);
    }
    <span class="hljs-keyword">return</span> answer;
  },
  <span class="hljs-attr">_buildListFromCache</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">resolveList</span>) </span>{
    <span class="hljs-keyword">var</span> answer = {};
    <span class="hljs-keyword">var</span> cache = <span class="hljs-keyword">this</span>._getCache();
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; resolveList.length; i++) {
      <span class="hljs-keyword">var</span> key = resolveList[i];
      <span class="hljs-keyword">var</span> value = cache.get(key);
      answer[key] = value;
    }
    <span class="hljs-keyword">return</span> answer;
  },
  <span class="hljs-attr">_getCache</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (NOW.useSimpleStorage &amp;&amp; simpleStorage.canUse()) {
      <span class="hljs-keyword">var</span> synch = simpleStorage.get(<span class="hljs-string">"simpleStorageSynch"</span>);
      <span class="hljs-keyword">if</span> (NOW.simpleStorageSynch != synch) {
        jslog(<span class="hljs-string">"*** simpleStorageSynch, size: "</span> + simpleStorage.storageSize());
        simpleStorage.flush();
        simpleStorage.set(<span class="hljs-string">"simpleStorageSynch"</span>, NOW.simpleStorageSynch);
      }
      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">put</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">key, value</span>) </span>{
          <span class="hljs-keyword">return</span> simpleStorage.set(<span class="hljs-string">"MSG_"</span> + NOW.language + <span class="hljs-string">"_"</span> + key, value);
        },
        <span class="hljs-attr">get</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">key</span>) </span>{
          <span class="hljs-keyword">return</span> simpleStorage.get(<span class="hljs-string">"MSG_"</span> + NOW.language + <span class="hljs-string">"_"</span> + key);
        }
      }
    }
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">if</span> (getTopWindow().g_cache_message)
        <span class="hljs-keyword">return</span> getTopWindow().g_cache_message;
    } <span class="hljs-keyword">catch</span> (e) {}
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span>(g_cache_message) != <span class="hljs-string">"undefined"</span>)
      <span class="hljs-keyword">return</span> g_cache_message;
    g_cache_message = <span class="hljs-keyword">new</span> GlideClientCache(<span class="hljs-number">500</span>);
    <span class="hljs-keyword">return</span> g_cache_message;
  },
  <span class="hljs-attr">fetch</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">resolveList, callback</span>) </span>{
    <span class="hljs-keyword">var</span> cachedMessages = <span class="hljs-keyword">this</span>._findCachedKeys(resolveList);
    <span class="hljs-keyword">var</span> keysToResolve = <span class="hljs-keyword">this</span>._removeCachedEntries(resolveList, cachedMessages);
    <span class="hljs-keyword">if</span> (keysToResolve.length == <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">var</span> answer = <span class="hljs-keyword">this</span>.getMessages(resolveList);
      callback(answer);
      <span class="hljs-keyword">return</span>;
    }
    <span class="hljs-keyword">var</span> ajax = <span class="hljs-keyword">new</span> GlideAjax(<span class="hljs-string">"SysMessageAjax"</span>);
    ajax.addParam(<span class="hljs-string">"sysparm_keys"</span>, keysToResolve.length);
    ajax.addParam(<span class="hljs-string">"sysparm_prefetch"</span>, <span class="hljs-keyword">this</span>._shouldPrefetch() ? <span class="hljs-string">"true"</span> : <span class="hljs-string">"false"</span>);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; keysToResolve.length; i++) {
      <span class="hljs-keyword">var</span> keyVal = <span class="hljs-string">"key"</span> + i;
      ajax.addParam(keyVal, keysToResolve[i]);
    }
    ajax.getXML(<span class="hljs-keyword">this</span>.fetched.bind(<span class="hljs-keyword">this</span>), <span class="hljs-literal">null</span>, {
      <span class="hljs-attr">fn</span>: callback,
      <span class="hljs-attr">list</span>: resolveList
    });
  },
  <span class="hljs-attr">fetched</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">response, parms</span>) </span>{
    <span class="hljs-keyword">this</span>._processResponse(response.responseXML);
    <span class="hljs-keyword">var</span> answer = <span class="hljs-keyword">this</span>.getMessages(parms.list);
    parms.fn(answer);
  }
});
GwtMessage._messages = {};

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getMessage</span>(<span class="hljs-params">msg, callback</span>) </span>{
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> callback == <span class="hljs-string">"function"</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> msg == <span class="hljs-string">"object"</span>)
      <span class="hljs-keyword">new</span> GwtMessage().fetch(msg, callback);
    <span class="hljs-keyword">else</span>
      <span class="hljs-keyword">new</span> GwtMessage().fetch([msg], <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">o</span>) </span>{
        callback(o[msg]);
      });
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> msg == <span class="hljs-string">"object"</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> GwtMessage().getMessages(msg);
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> GwtMessage().getMessage(msg);
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getMessages</span>(<span class="hljs-params">msgs</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> GwtMessage().getMessages(msgs);
};
<span class="hljs-comment">/*! RESOURCE: /scripts/classes/GlideFilterDescription.js */</span>
<span class="hljs-keyword">var</span> GlideFilterDescription = Class.create({
  <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{},
  <span class="hljs-attr">choices</span>: <span class="hljs-literal">null</span>,
  <span class="hljs-attr">setParsedQuery</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">strVal</span>) </span>{
    <span class="hljs-keyword">this</span>.parsedQuery = strVal;
  },
  <span class="hljs-attr">getParsedQuery</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.parsedQuery;
  },
  <span class="hljs-attr">setBaseLine</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>) </span>{
    <span class="hljs-keyword">this</span>.baseLine = value;
  },
  <span class="hljs-attr">getBaseLine</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.baseLine;
  },
  <span class="hljs-attr">setMetaData</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>) </span>{
    <span class="hljs-keyword">this</span>.metaData = value;
  },
  <span class="hljs-attr">getMetaData</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.metaData;
  },
  <span class="hljs-attr">setPreferenceParam</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>) </span>{
    <span class="hljs-keyword">this</span>.preference = value;
  },
  <span class="hljs-attr">getPreferenceParam</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.preference;
  },
  <span class="hljs-attr">setExpanded</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>) </span>{
    <span class="hljs-keyword">this</span>.expanded = value;
  },
  <span class="hljs-attr">getExpanded</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.expanded;
  },
  <span class="hljs-attr">setName</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>) </span>{
    <span class="hljs-keyword">this</span>.name = value;
  },
  <span class="hljs-attr">getName</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.name;
  },
  <span class="hljs-attr">setFilter</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>) </span>{
    <span class="hljs-keyword">this</span>.filter = value;
  },
  <span class="hljs-attr">getFilter</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.filter;
  },
  <span class="hljs-attr">setTableName</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>) </span>{
    <span class="hljs-keyword">this</span>.tableName = value;
  },
  <span class="hljs-attr">getTableName</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.tableName;
  },
  <span class="hljs-attr">setPinned</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>) </span>{
    <span class="hljs-keyword">this</span>.pinned = value;
  },
  <span class="hljs-attr">getPinned</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.pinned;
  },
  <span class="hljs-attr">setMainFilterTable</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">filterTable</span>) </span>{
    <span class="hljs-keyword">this</span>.mainFilterTable = filterTable;
  },
  <span class="hljs-attr">getMainFilterTable</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.mainFilterTable;
  },
  <span class="hljs-attr">setPinnable</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>) </span>{
    <span class="hljs-keyword">this</span>.pinnable = value;
  },
  <span class="hljs-attr">getPinnable</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.pinnable;
  },
  <span class="hljs-attr">setShowRelated</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>) </span>{
    <span class="hljs-keyword">this</span>.showRelated = value;
  },
  <span class="hljs-attr">getShowRelated</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.showRelated;
  },
  <span class="hljs-attr">setChoiceListMap</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>) </span>{
    <span class="hljs-keyword">this</span>.choiceList = value;
  },
  <span class="hljs-attr">getChoiceList</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">table</span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-keyword">this</span>.choiceList == <span class="hljs-string">'undefined'</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.choiceList[table];
  }
});;
<span class="hljs-comment">/*! RESOURCE: /scripts/classes/GlideFilterHandlers.js */</span>
<span class="hljs-keyword">var</span> GlideFilterHandler = Class.create({
  <span class="hljs-attr">filterClass</span>: <span class="hljs-string">""</span>,
  <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">tableName, item</span>) </span>{
    <span class="hljs-keyword">this</span>.maxValues = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">this</span>.tableName = tableName;
    <span class="hljs-keyword">this</span>.item = item;
    <span class="hljs-keyword">this</span>.isRightOperandShowingRelatedFields = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">this</span>.lastOperator = <span class="hljs-literal">null</span>;
  },
  <span class="hljs-attr">destroy</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.tr) {
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.tr.operSel)
        <span class="hljs-keyword">this</span>.tr.operSel.onchange = <span class="hljs-literal">null</span>;
      <span class="hljs-keyword">this</span>.tr = <span class="hljs-literal">null</span>;
    }
    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-keyword">this</span>.inputCnt; i++) {
      <span class="hljs-keyword">this</span>.inputs[i].onkeypress = <span class="hljs-literal">null</span>;
      <span class="hljs-keyword">this</span>.inputs[i].onchange = <span class="hljs-literal">null</span>;
      <span class="hljs-keyword">this</span>.inputs[i] = <span class="hljs-literal">null</span>;
    }
  },
  <span class="hljs-attr">create</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">tr, values, filterClass</span>) </span>{
    <span class="hljs-keyword">this</span>.tr = tr;
    <span class="hljs-keyword">this</span>._setup(values);
    <span class="hljs-keyword">this</span>._init(values);
    <span class="hljs-keyword">this</span>._build(filterClass);
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.listenForOperChange)
      <span class="hljs-keyword">this</span>.tr.operSel.onchange = <span class="hljs-keyword">this</span>._operOnChange.bind(<span class="hljs-keyword">this</span>);
    <span class="hljs-keyword">this</span>.isRightOperandShowingRelatedFields = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">this</span>.lastOperator = <span class="hljs-keyword">this</span>._getOperator();
  },
  <span class="hljs-attr">_setup</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">values</span>) </span>{},
  <span class="hljs-attr">getTableName</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.tableName;
  },
  <span class="hljs-attr">getFilterText</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">oper</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>;
  },
  <span class="hljs-attr">_init</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">values</span>) </span>{
    <span class="hljs-keyword">this</span>._initValues(values);
    <span class="hljs-keyword">this</span>._initInputs();
  },
  <span class="hljs-attr">_initValues</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">values</span>) </span>{
    <span class="hljs-keyword">var</span> op = <span class="hljs-keyword">this</span>._getOperator();
    <span class="hljs-keyword">if</span> (!values)
      <span class="hljs-keyword">this</span>.values = [];
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.tr &amp;&amp; <span class="hljs-keyword">this</span>.tr.varType === <span class="hljs-string">"variables"</span> &amp;&amp; !<span class="hljs-keyword">this</span>.userDateFormat) {
      <span class="hljs-keyword">this</span>.values = [values];
    } <span class="hljs-keyword">else</span>
      <span class="hljs-keyword">this</span>.values = values.split(<span class="hljs-string">"@"</span>);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-keyword">this</span>.values.length; i &lt; <span class="hljs-keyword">this</span>.maxValues; i++)
      <span class="hljs-keyword">this</span>.values[i] = <span class="hljs-string">""</span>;
  },
  <span class="hljs-attr">_initInputs</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>.inputCnt = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">this</span>.inputs = [];
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-keyword">this</span>.maxValues; i++)
      <span class="hljs-keyword">this</span>.inputs[i] = <span class="hljs-literal">null</span>;
  },
  <span class="hljs-attr">_clearValues</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>.values = [];
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-keyword">this</span>.maxValues; i++)
      <span class="hljs-keyword">this</span>.values[i] = <span class="hljs-string">""</span>;
  },
  <span class="hljs-attr">_isEmptyOper</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> op = <span class="hljs-keyword">this</span>._getOperator();
    <span class="hljs-keyword">if</span> (op == <span class="hljs-string">'ISEMPTY'</span> || op == <span class="hljs-string">'ISNOTEMPTY'</span> || op == <span class="hljs-string">'ANYTHING'</span> || op == <span class="hljs-string">'EMPTYSTRING'</span> || op == <span class="hljs-string">'VALCHANGES'</span>) {
      <span class="hljs-keyword">this</span>._clearValues();
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  },
  <span class="hljs-attr">_getOperator</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> getSelectedOption(<span class="hljs-keyword">this</span>.tr.operSel).value;
  },
  <span class="hljs-attr">_getInputValue</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">el</span>) </span>{
    <span class="hljs-keyword">var</span> value = <span class="hljs-string">""</span>;
    <span class="hljs-keyword">if</span> (el == <span class="hljs-literal">null</span>)
      <span class="hljs-keyword">return</span> value;
    <span class="hljs-keyword">if</span> (el.tagName.toUpperCase() == <span class="hljs-string">"TEXTAREA"</span>)
      <span class="hljs-keyword">return</span> el.value;
    <span class="hljs-keyword">if</span> (el.tagName.toUpperCase() == <span class="hljs-string">"INPUT"</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._escapeIfRequired(el.value);
    <span class="hljs-keyword">var</span> options = el.options;
    <span class="hljs-keyword">if</span> (el.multiple) {
      <span class="hljs-keyword">var</span> vals = [];
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; options.length; i++) {
        <span class="hljs-keyword">if</span> (options[i].selected)
          vals.push(options[i].value);
      }
      <span class="hljs-keyword">return</span> vals.join(<span class="hljs-string">","</span>);
    }
    <span class="hljs-keyword">return</span> options[el.selectedIndex].value;
  },
  <span class="hljs-attr">_escapeIfRequired</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._getOperator() == <span class="hljs-string">"BETWEEN"</span>) {
      <span class="hljs-keyword">if</span> (value == <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-keyword">this</span>.values; i++)
          <span class="hljs-keyword">this</span>.values[i] = <span class="hljs-keyword">this</span>._escape(<span class="hljs-keyword">this</span>.values[i]);
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.values;
      }
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._escape(value);
    }
    <span class="hljs-keyword">return</span> value;
  },
  <span class="hljs-attr">_escape</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>) </span>{
    <span class="hljs-keyword">if</span> (value == <span class="hljs-literal">null</span>)
      <span class="hljs-keyword">return</span>;
    value = value.replace(<span class="hljs-regexp">/\\/g</span>, <span class="hljs-string">"\\\\"</span>)
    value = value.replace(<span class="hljs-regexp">/@/g</span>, <span class="hljs-string">"\\@"</span>)
    <span class="hljs-keyword">return</span> value;
  },
  <span class="hljs-attr">_unescapeIfRequired</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._getOperator() == <span class="hljs-string">"BETWEEN"</span>)
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-keyword">this</span>.values.length; i++)
        <span class="hljs-keyword">this</span>.values[i] = <span class="hljs-keyword">this</span>._unescape(<span class="hljs-keyword">this</span>.values[i]);
  },
  <span class="hljs-attr">_unescape</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._parseValues(value, <span class="hljs-string">'@'</span>)[<span class="hljs-number">0</span>];
  },
  <span class="hljs-attr">_addTextInput</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">type, td</span>) </span>{
    <span class="hljs-keyword">if</span> (!td)
      td = <span class="hljs-keyword">this</span>.tr.tdValue;
    <span class="hljs-keyword">var</span> input = addTextInput(td, <span class="hljs-keyword">this</span>.values[<span class="hljs-keyword">this</span>.inputCnt], type);
    <span class="hljs-keyword">this</span>.inputs[<span class="hljs-keyword">this</span>.inputCnt] = input;
    <span class="hljs-keyword">this</span>.inputCnt++;
    <span class="hljs-keyword">return</span> input;
  },
  <span class="hljs-attr">_addBetweenTextInput</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">type, td</span>) </span>{
    <span class="hljs-keyword">if</span> (!td)
      td = <span class="hljs-keyword">this</span>.tr.tdValue;
    <span class="hljs-keyword">var</span> input = addTextInput(td, <span class="hljs-keyword">this</span>.values[<span class="hljs-keyword">this</span>.inputCnt], type);
    <span class="hljs-keyword">this</span>.inputs[<span class="hljs-keyword">this</span>.inputCnt] = input;
    <span class="hljs-keyword">this</span>.inputCnt++;
    <span class="hljs-keyword">return</span> input;
  },
  <span class="hljs-attr">_addTextArea</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> input = addTextArea(<span class="hljs-keyword">this</span>.tr.tdValue, <span class="hljs-keyword">this</span>.values[<span class="hljs-keyword">this</span>.inputCnt]);
    <span class="hljs-keyword">this</span>.inputs[<span class="hljs-keyword">this</span>.inputCnt] = input;
    <span class="hljs-keyword">this</span>.inputCnt++;
    <span class="hljs-keyword">return</span> input;
  },
  <span class="hljs-attr">_addSelect</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">width, multi, size</span>) </span>{
    <span class="hljs-keyword">var</span> s = _createFilterSelect(width, multi, size);
    <span class="hljs-keyword">this</span>.tr.tdValue.appendChild(s);
    <span class="hljs-keyword">this</span>.inputs[<span class="hljs-keyword">this</span>.inputCnt] = s;
    <span class="hljs-keyword">this</span>.inputCnt++;
    <span class="hljs-keyword">return</span> s;
  },
  <span class="hljs-attr">_operOnChange</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> lastOp = <span class="hljs-keyword">this</span>.lastOperator;
    <span class="hljs-keyword">this</span>.lastOperator = <span class="hljs-keyword">this</span>._getOperator();
    <span class="hljs-keyword">if</span> ((fieldComparisonOperators.indexOf(lastOp) &gt;= <span class="hljs-number">0</span>) != (fieldComparisonOperators.indexOf(<span class="hljs-keyword">this</span>.lastOperator) &gt;= <span class="hljs-number">0</span>) || lastOp == <span class="hljs-string">"DYNAMIC"</span>) {
      <span class="hljs-keyword">this</span>.inputCnt = <span class="hljs-number">0</span>;
      <span class="hljs-keyword">this</span>.input = [];
    }
    <span class="hljs-keyword">this</span>.getValues();
    <span class="hljs-keyword">this</span>._unescapeIfRequired();
    <span class="hljs-keyword">this</span>._build();
  },
  <span class="hljs-attr">_isTemplate</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> t = <span class="hljs-keyword">this</span>.tr;
    <span class="hljs-keyword">while</span> (t) {
      t = findParentByTag(t, <span class="hljs-string">'table'</span>);
      <span class="hljs-keyword">if</span> (t) {
        <span class="hljs-keyword">var</span> id = t.id + <span class="hljs-string">''</span>;
        <span class="hljs-keyword">if</span> (id.indexOf(<span class="hljs-string">'filters_table'</span>) != <span class="hljs-number">-1</span>)
          <span class="hljs-keyword">break</span>;
      }
    }
    <span class="hljs-keyword">if</span> (!t)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">return</span> t.getAttribute(<span class="hljs-string">'gsft_template'</span>) == <span class="hljs-string">'true'</span>;
  },
  <span class="hljs-attr">_renderDynamicOperandInput</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">op</span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> g_dynamic_filter_options == <span class="hljs-string">"undefined"</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">if</span> (op != <span class="hljs-string">"DYNAMIC"</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">var</span> addedReferenceInput = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">var</span> arr = g_dynamic_filter_options.split(<span class="hljs-string">"##"</span>);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; arr.length; i++) {
      <span class="hljs-keyword">var</span> aItem = arr[i];
      <span class="hljs-keyword">if</span> (aItem.length == <span class="hljs-number">0</span>)
        <span class="hljs-keyword">continue</span>;
      <span class="hljs-keyword">var</span> aItemArr = aItem.split(<span class="hljs-string">"::"</span>);
      <span class="hljs-keyword">if</span> (aItemArr.length &lt; <span class="hljs-number">3</span>)
        <span class="hljs-keyword">continue</span>;
      <span class="hljs-keyword">var</span> isExclusiveDynamic = <span class="hljs-keyword">typeof</span> gtf_exclusive_dynamics != <span class="hljs-string">'undefined'</span> &amp;&amp; gtf_exclusive_dynamics == <span class="hljs-string">"true"</span>;
      <span class="hljs-keyword">if</span> (!isExclusiveDynamic &amp;&amp; <span class="hljs-keyword">this</span>.item &amp;&amp; <span class="hljs-keyword">this</span>.item.getReference() == aItemArr[<span class="hljs-number">2</span>] || <span class="hljs-keyword">this</span>.originalTableName == aItemArr[<span class="hljs-number">3</span>]) {
        <span class="hljs-keyword">if</span> (!addedReferenceInput)
          <span class="hljs-keyword">var</span> input = <span class="hljs-keyword">this</span>._addSelect(<span class="hljs-number">180</span>, <span class="hljs-literal">false</span>, <span class="hljs-number">1</span>);
        <span class="hljs-keyword">var</span> arrInput = [];
        arrInput.push(aItemArr[<span class="hljs-number">1</span>]);
        <span class="hljs-keyword">var</span> translated = getMessages(arrInput);
        addOption(input, aItemArr[<span class="hljs-number">0</span>], translated[aItemArr[<span class="hljs-number">1</span>]], <span class="hljs-keyword">this</span>.rightOperand == aItemArr[<span class="hljs-number">0</span>]);
        addedReferenceInput = <span class="hljs-literal">true</span>;
      }
    }
    <span class="hljs-keyword">return</span> addedReferenceInput;
  },
  <span class="hljs-attr">setOriginalTable</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">tableNameFull</span>) </span>{
    <span class="hljs-keyword">if</span> (tableNameFull.indexOf(<span class="hljs-string">"."</span>) == <span class="hljs-number">-1</span>)
      <span class="hljs-keyword">this</span>.originalTableName = tableNameFull;
    <span class="hljs-keyword">else</span>
      <span class="hljs-keyword">this</span>.originalTableName = tableNameFull.split(<span class="hljs-string">"."</span>)[<span class="hljs-number">1</span>];
  },
  <span class="hljs-attr">getValues</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>._clearValues();
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.inputCnt == <span class="hljs-number">0</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-string">""</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-keyword">this</span>.maxValues; i++)
      <span class="hljs-keyword">this</span>.values[i] = <span class="hljs-keyword">this</span>._getInputValue(<span class="hljs-keyword">this</span>.inputs[i]);
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.inputCnt == <span class="hljs-number">1</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>];
    <span class="hljs-keyword">else</span>
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.values.join(<span class="hljs-string">"@"</span>);
  },
  <span class="hljs-attr">_populateRightOperandChoices</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> field = <span class="hljs-keyword">this</span>.item.name;
    <span class="hljs-keyword">var</span> table = <span class="hljs-string">""</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> mainFilterTable == <span class="hljs-string">"undefined"</span>)
      table = firstTable;
    <span class="hljs-keyword">else</span>
      table = mainFilterTable;
    <span class="hljs-keyword">var</span> selection = <span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>];
    <span class="hljs-keyword">if</span> (<span class="hljs-literal">null</span> != table &amp;&amp; <span class="hljs-string">""</span> != table &amp;&amp; <span class="hljs-literal">null</span> != field &amp;&amp; <span class="hljs-string">""</span> != field) {
      <span class="hljs-keyword">var</span> s = <span class="hljs-keyword">this</span>._addSelect(<span class="hljs-keyword">this</span>.width, <span class="hljs-literal">false</span>, <span class="hljs-number">1</span>);
      s.onchange = <span class="hljs-keyword">this</span>.rightOperandfieldOnChange.bind(s, table, <span class="hljs-keyword">this</span>);
      <span class="hljs-keyword">var</span> completeSelection = <span class="hljs-string">""</span>;
      <span class="hljs-keyword">if</span> (selection)
        completeSelection = table + <span class="hljs-string">'.'</span> + selection;
      <span class="hljs-keyword">else</span>
        completeSelection = table;
      <span class="hljs-keyword">var</span> showRelatedFields = <span class="hljs-string">"no"</span>;
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.isRightOperandShowingRelatedFields || (selection &amp;&amp; selection.indexOf(<span class="hljs-string">"."</span>) &gt;= <span class="hljs-number">0</span>))
        showRelatedFields = <span class="hljs-string">"yes"</span>;
      <span class="hljs-keyword">this</span>.addChoices(s, completeSelection, <span class="hljs-string">""</span>,
        <span class="hljs-keyword">this</span>._filterRightOperand, selection, <span class="hljs-literal">null</span>,
        showRelatedFields, <span class="hljs-keyword">this</span>.item);
      <span class="hljs-keyword">if</span> (<span class="hljs-literal">null</span> != selection)
        <span class="hljs-keyword">this</span>.selectRightOperand(s, selection);
    }
  },
  <span class="hljs-attr">selectRightOperand</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">select, selection</span>) </span>{
    <span class="hljs-keyword">var</span> o = getSelectedOption(select);
    <span class="hljs-keyword">var</span> options = select.options;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; options.length; i++) {
      <span class="hljs-keyword">var</span> option = options[i];
      <span class="hljs-keyword">if</span> (<span class="hljs-literal">null</span> != option &amp;&amp; option.value == selection) {
        option.innerHTML = getFullLabel(option);
        option.style.color = <span class="hljs-string">'green'</span>;
        option.wasSelected = <span class="hljs-string">'true'</span>;
        select.style.width = <span class="hljs-string">"240px"</span>;
        option.selected = <span class="hljs-literal">true</span>;
        select.selectedIndex = i;
        <span class="hljs-keyword">break</span>;
      }
    }
  },
  <span class="hljs-attr">_getReportTable</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> firstTable;
  },
  <span class="hljs-attr">rightOperandfieldOnChange</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">table, t</span>) </span>{
    <span class="hljs-keyword">var</span> fieldName = <span class="hljs-keyword">this</span>.value;
    <span class="hljs-keyword">var</span> idx = fieldName.indexOf(<span class="hljs-string">"..."</span>);
    <span class="hljs-keyword">var</span> f = fieldName.substring(<span class="hljs-number">0</span>, idx);
    <span class="hljs-keyword">if</span> (f != table)
      f = table + <span class="hljs-string">"."</span> + f;
    f = f + <span class="hljs-string">"."</span>;
    <span class="hljs-keyword">if</span> (idx != <span class="hljs-number">-1</span>) {
      <span class="hljs-keyword">if</span> (fieldName == <span class="hljs-string">'...Show Related Fields...'</span>) {
        t.isRightOperandShowingRelatedFields = <span class="hljs-literal">true</span>;
        t.addChoices(<span class="hljs-keyword">this</span>, f, <span class="hljs-string">""</span>, t._filterRightOperand,
          fieldName, <span class="hljs-literal">null</span>, <span class="hljs-string">"yes"</span>, t.item);
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (fieldName == <span class="hljs-string">'...Remove Related Fields...'</span>) {
        t.isRightOperandShowingRelatedFields = <span class="hljs-literal">false</span>;
        t.addChoices(<span class="hljs-keyword">this</span>, f, <span class="hljs-string">""</span>, t._filterRightOperand,
          fieldName, <span class="hljs-literal">null</span>, <span class="hljs-string">"no"</span>, t.item);
      } <span class="hljs-keyword">else</span> {
        t.isRightOperandShowingRelatedFields = <span class="hljs-literal">true</span>;
        t.addChoices(<span class="hljs-keyword">this</span>, f, <span class="hljs-string">""</span>, t._filterRightOperand,
          fieldName, <span class="hljs-literal">null</span>, <span class="hljs-string">"yes"</span>, t.item);
      }
      <span class="hljs-keyword">return</span>;
    }
    <span class="hljs-keyword">var</span> o = getSelectedOption(<span class="hljs-keyword">this</span>);
    <span class="hljs-keyword">var</span> fieldName = o.value;
    <span class="hljs-keyword">var</span> name = currentTable = getTableFromOption(o);
    <span class="hljs-keyword">var</span> options = <span class="hljs-keyword">this</span>.options;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; options.length; i++) {
      <span class="hljs-keyword">var</span> option = options[i];
      <span class="hljs-keyword">if</span> (optionWasSelected(option)) {
        option.innerHTML = getNormalLabel(option);
        option.style.color = <span class="hljs-string">'black'</span>;
        option.wasSelected = <span class="hljs-string">'false'</span>;
        <span class="hljs-keyword">break</span>;
      }
    }
    <span class="hljs-keyword">if</span> (setup(name) == <span class="hljs-literal">false</span>)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">var</span> tr = <span class="hljs-keyword">this</span>.parentNode.parentNode;
    o.normalLabel = o.innerHTML;
    o.innerHTML = getFullLabel(o);
    o.style.color = <span class="hljs-string">'green'</span>;
    o.wasSelected = <span class="hljs-string">'true'</span>;
    <span class="hljs-keyword">this</span>.style.width = <span class="hljs-string">"240px"</span>;
  },
  <span class="hljs-attr">addChoices</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">s, target, fValue, filterMethod, fieldName, filter, showRelated, leftOperandElement</span>) </span>{
    <span class="hljs-keyword">var</span> forFilter;
    <span class="hljs-keyword">var</span> onlyRestrictedFields;
    <span class="hljs-keyword">if</span> (filter) {
      forFilter = filter.getOpsWanted();
      onlyRestrictedFields = filter.onlyRestrictedFields;
    }
    <span class="hljs-keyword">var</span> messages = getMessages(MESSAGES_CONDITION_RELATED_FILES);
    <span class="hljs-keyword">while</span> (s.length &gt; <span class="hljs-number">0</span>)
      s.remove(<span class="hljs-number">0</span>);
    <span class="hljs-keyword">var</span> placeholder = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">var</span> selindex = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">var</span> indentLabel = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">var</span> savedItems = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Object</span>();
    <span class="hljs-keyword">var</span> savedLabels = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>();
    <span class="hljs-keyword">var</span> labelPrefix = <span class="hljs-string">''</span>;
    <span class="hljs-keyword">var</span> headersAdded = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">var</span> parts = target.split(<span class="hljs-string">"."</span>);
    <span class="hljs-keyword">var</span> tableName = parts[<span class="hljs-number">0</span>];
    <span class="hljs-keyword">var</span> tableDef = getTableReference(tableName);
    <span class="hljs-keyword">var</span> extension = <span class="hljs-string">''</span>;
    <span class="hljs-keyword">var</span> prefix = <span class="hljs-string">''</span>;
    <span class="hljs-keyword">if</span> (parts.length &gt; <span class="hljs-number">1</span> &amp;&amp; parts[<span class="hljs-number">1</span>] != <span class="hljs-literal">null</span> &amp;&amp; parts[<span class="hljs-number">1</span>] != <span class="hljs-string">''</span>) {
      <span class="hljs-keyword">var</span> o = <span class="hljs-literal">null</span>;
      <span class="hljs-keyword">if</span> (filterExpanded &amp;&amp; parts.length &gt; <span class="hljs-number">2</span>) {
        <span class="hljs-keyword">var</span> tableLabel = tableDef.getLabel();
        <span class="hljs-keyword">if</span> (tableLabel == <span class="hljs-literal">null</span>)
          tableLabel = <span class="hljs-string">"Parent"</span>;
        o = addOption(s, tableDef.getName() + <span class="hljs-string">"..."</span>, tableLabel +
          <span class="hljs-string">" "</span> + messages[<span class="hljs-string">'lowercase_fields'</span>], <span class="hljs-literal">false</span>);
        o.tableName = tableDef.getName();
        o.style.color = <span class="hljs-string">'blue'</span>;
      }
      <span class="hljs-keyword">if</span> (parts[<span class="hljs-number">1</span>] == PLACEHOLDERFIELD) {
        o = addOption(s, PLACEHOLDER,
          messages[<span class="hljs-string">'-- choose field --'</span>], <span class="hljs-literal">true</span>);
        o.style.color = <span class="hljs-string">'blue'</span>;
        o.tableName = tableDef.getName();
        o.fullLabel = messages[<span class="hljs-string">'-- choose field --'</span>];
        placeholder = <span class="hljs-literal">true</span>;
      }
      <span class="hljs-keyword">var</span> sPeriod = <span class="hljs-string">""</span>;
      <span class="hljs-keyword">var</span> cname = <span class="hljs-string">''</span>;
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">1</span>; i &lt; parts.length - <span class="hljs-number">1</span>; i++) {
        <span class="hljs-keyword">var</span> f = parts[i];
        <span class="hljs-keyword">if</span> (f == <span class="hljs-literal">null</span> || f == <span class="hljs-string">''</span>)
          <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">var</span> elementDef = tableDef.getElement(parts[i]);
        <span class="hljs-keyword">if</span> (elementDef == <span class="hljs-literal">null</span>)
          <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">var</span> childTable = tableName;
        <span class="hljs-keyword">if</span> (elementDef.isReference()) {
          childTable = elementDef.getReference();
          <span class="hljs-keyword">if</span> (elementDef.isExtensionElement())
            extension = childTable;
          <span class="hljs-keyword">else</span>
            extension = <span class="hljs-string">''</span>;
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">if</span> (fieldName != <span class="hljs-literal">null</span> &amp;&amp; fieldName.indexOf(<span class="hljs-string">"..."</span>) &gt; <span class="hljs-number">-1</span>) {
            childTable = parts[<span class="hljs-number">0</span>];
          } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">break</span>;
          }
        }
        <span class="hljs-keyword">var</span> parentTable = (extension != <span class="hljs-string">''</span>) ? extension : elementDef.getTable().getName();
        <span class="hljs-keyword">var</span> tableDef = getTableReference(childTable, parentTable);
        <span class="hljs-keyword">if</span> (cname.length)
          cname = cname + <span class="hljs-string">"."</span>;
        cname += elementDef.getName();
        sPeriod = <span class="hljs-string">"."</span> + sPeriod;
        <span class="hljs-keyword">var</span> clabel = sPeriod + elementDef.getLabel() + <span class="hljs-string">"--&gt;"</span> +
          elementDef.getRefLabel() + <span class="hljs-string">" "</span> +
          messages[<span class="hljs-string">'lowercase_fields'</span>];
        o = addOption(s, cname + <span class="hljs-string">"..."</span>, clabel, <span class="hljs-literal">false</span>);
        o.tablename = tableDef.getName();
        o.style.color = <span class="hljs-string">'blue'</span>;
        selindex++;
        indentLabel = <span class="hljs-literal">true</span>;
        headersAdded = <span class="hljs-literal">true</span>;
        <span class="hljs-keyword">if</span> (labelPrefix.length)
          labelPrefix += <span class="hljs-string">"."</span>;
        labelPrefix += elementDef.getLabel();
        <span class="hljs-keyword">if</span> (prefix.length)
          prefix += <span class="hljs-string">"."</span>;
        prefix += elementDef.getName();
      }
    }
    columns = tableDef.getColumns();
    queueColumns[tableDef.getName()] = columns;
    <span class="hljs-keyword">var</span> textIndex = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">if</span> (!noOps &amp;&amp; !indentLabel) {
      <span class="hljs-keyword">var</span> root = columns.getElementsByTagName(<span class="hljs-string">"xml"</span>);
      <span class="hljs-keyword">if</span> (root != <span class="hljs-literal">null</span> &amp;&amp; root.length == <span class="hljs-number">1</span>) {
        root = root[<span class="hljs-number">0</span>];
        textIndex = root.getAttribute(<span class="hljs-string">"textIndex"</span>);
      }
    }
    <span class="hljs-keyword">var</span> items = (extension != <span class="hljs-string">''</span>) ? tableDef.getTableElements(extension) : tableDef.getElements();
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; items.length; i++) {
      <span class="hljs-keyword">var</span> item = items[i];
      <span class="hljs-keyword">var</span> t = item.getName();
      <span class="hljs-keyword">if</span> (filterMethod != <span class="hljs-literal">null</span> &amp;&amp; t != fValue) {
        <span class="hljs-keyword">if</span> (filterMethod(leftOperandElement, item,
            <span class="hljs-keyword">this</span>.isRightOperandShowingRelatedFields) == <span class="hljs-literal">true</span>) {
          <span class="hljs-keyword">continue</span>;
        }
      }
      <span class="hljs-keyword">var</span> t = item.getName();
      <span class="hljs-keyword">if</span> (prefix != <span class="hljs-string">''</span>)
        t = prefix + <span class="hljs-string">'.'</span> + t;
      <span class="hljs-keyword">if</span> (!noOps &amp;&amp; item.getAttribute(<span class="hljs-string">"filterable"</span>) == <span class="hljs-string">"no"</span> &amp;&amp; !allowConditionsForJournal(item.getAttribute(<span class="hljs-string">"type"</span>), filter))
        <span class="hljs-keyword">continue</span>;
      <span class="hljs-keyword">if</span> (!item.canRead()) {
        <span class="hljs-keyword">if</span> (t != fValue) {
          <span class="hljs-keyword">continue</span>;
        } <span class="hljs-keyword">else</span> {
          item.setCanRead(<span class="hljs-string">'yes'</span>);
        }
      }
      <span class="hljs-keyword">if</span> (!item.isActive()) {
        <span class="hljs-keyword">if</span> (t != fValue) {
          <span class="hljs-keyword">continue</span>;
        } <span class="hljs-keyword">else</span> {
          item.setActive(<span class="hljs-string">'yes'</span>);
        }
      }
      <span class="hljs-keyword">var</span> label = item.getLabel();
      <span class="hljs-keyword">if</span> ((!elementDef || elementDef.getType() != <span class="hljs-string">"glide_var"</span>) &amp;&amp;
        !item.isReference()) {
        savedItems[label] = t;
        savedLabels[savedLabels.length] = label;
      }
      <span class="hljs-keyword">if</span> (item.isReference() &amp;&amp; leftOperandElement.isReference()) {
        <span class="hljs-keyword">if</span> (item.getReference() == leftOperandElement.getReference()) {
          savedItems[label] = t;
          savedLabels[savedLabels.length] = label;
        }
      }
      <span class="hljs-keyword">if</span> (item.isReference() &amp;&amp; !item.isRefRotated() &amp;&amp;
        item.getType() != <span class="hljs-string">'glide_list'</span> &amp;&amp; filterExpanded &amp;&amp;
        showRelated == <span class="hljs-string">'yes'</span>) {
        label += <span class="hljs-string">"--&gt;"</span> + item.getRefLabel();
        label += <span class="hljs-string">" "</span> + messages[<span class="hljs-string">'lowercase_fields'</span>];
        t += <span class="hljs-string">"..."</span>;
        savedItems[label] = t;
        savedLabels[savedLabels.length] = label;
      }
    }
    items = tableDef.getExtensions();
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; items.length; i++) {
      <span class="hljs-keyword">var</span> item = items[i];
      <span class="hljs-keyword">var</span> label = item.getLabel() + <span class="hljs-string">" (+)"</span>;
      t = item.getExtName() + <span class="hljs-string">"..."</span>;
      <span class="hljs-keyword">if</span> (prefix != <span class="hljs-string">''</span>)
        t = prefix + <span class="hljs-string">'.'</span> + t;
      savedItems[label] = t;
      savedLabels[savedLabels.length] = label;
    }
    <span class="hljs-keyword">if</span> (!onlyRestrictedFields &amp;&amp;
      ((fValue == TEXTQUERY || textIndex) &amp;&amp;
        filterMethod == <span class="hljs-literal">null</span> || forFilter)) {
      o = addOption(s, TEXTQUERY, messages[<span class="hljs-string">'Keywords'</span>], (fValue == TEXTQUERY));
      o.fullLabel = messages[<span class="hljs-string">'Keywords'</span>];
    }
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; savedLabels.length; i++) {
      <span class="hljs-keyword">var</span> sname = savedLabels[i];
      <span class="hljs-keyword">var</span> o = addOption(s, savedItems[sname], sname, savedItems[sname] == fValue);
      o.tableName = tableDef.getName();
      <span class="hljs-keyword">if</span> (labelPrefix != <span class="hljs-string">''</span>)
        o.fullLabel = labelPrefix + <span class="hljs-string">"."</span> + sname;
      <span class="hljs-keyword">else</span>
        o.fullLabel = sname;
      <span class="hljs-keyword">if</span> (indentLabel) {
        <span class="hljs-keyword">var</span> yyy = o.innerHTML;
        o.innerHTML = <span class="hljs-string">"&amp;nbsp;&amp;nbsp;&amp;nbsp;"</span> + yyy;
      }
      <span class="hljs-keyword">var</span> v = o.value;
      <span class="hljs-keyword">if</span> (v.indexOf(<span class="hljs-string">"..."</span>) != <span class="hljs-number">-1</span>)
        <span class="hljs-keyword">if</span> (o.fullLabel.indexOf(<span class="hljs-string">"(+)"</span>) == <span class="hljs-number">-1</span>)
          o.style.color = <span class="hljs-string">'blue'</span>;
        <span class="hljs-keyword">else</span>
          o.style.color = <span class="hljs-string">'darkred'</span>;
    }
    <span class="hljs-keyword">if</span> (filterExpanded &amp;&amp; !onlyRestrictedFields) {
      <span class="hljs-keyword">if</span> (showRelated != <span class="hljs-string">'yes'</span>) {
        <span class="hljs-keyword">var</span> o = addOption(s, <span class="hljs-string">"...Show Related Fields..."</span>, messages[<span class="hljs-string">'Show Related Fields'</span>], <span class="hljs-literal">false</span>);
        o.style.color = <span class="hljs-string">'blue'</span>;
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">var</span> o = addOption(s, <span class="hljs-string">"...Remove Related Fields..."</span>, messages[<span class="hljs-string">'Remove Related Fields'</span>], <span class="hljs-literal">false</span>);
        o.style.color = <span class="hljs-string">'blue'</span>;
      }
    }
    <span class="hljs-keyword">if</span> (!placeholder &amp;&amp; (s.selectedIndex == <span class="hljs-number">0</span> &amp;&amp; ((textIndex &amp;&amp; fValue != TEXTQUERY) || headersAdded)))
      s.selectedIndex = selindex;
    <span class="hljs-keyword">if</span> (s.selectedIndex &gt;= <span class="hljs-number">0</span>) {
      fValue = getSelectedOption(s).value;
    }
    <span class="hljs-keyword">return</span> s;
  },
  <span class="hljs-attr">_filterRightOperand</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">leftOperandElement, rightOperandElement, isRightOperandShowingRelatedFields</span>) </span>{
    <span class="hljs-keyword">var</span> filterOut = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-literal">null</span> != leftOperandElement &amp;&amp; <span class="hljs-literal">null</span> != rightOperandElement) {
      <span class="hljs-keyword">var</span> leftType = leftOperandElement.getType();
      <span class="hljs-keyword">var</span> rightType = rightOperandElement.getType();
      <span class="hljs-keyword">if</span> (<span class="hljs-string">'reference'</span> != leftType) {
        <span class="hljs-keyword">if</span> (<span class="hljs-string">'reference'</span> == rightType &amp;&amp; isRightOperandShowingRelatedFields)
          filterOut = <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">if</span> (leftType == rightType)
          filterOut = <span class="hljs-literal">false</span>;
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">if</span> (<span class="hljs-string">'reference'</span> == rightType)
          filterOut = <span class="hljs-literal">false</span>;
      }
    }
    <span class="hljs-keyword">return</span> filterOut;
  },
  <span class="hljs-attr">_renderRightOperandAsFieldList</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">operation</span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-string">"SAMEAS"</span> == operation || <span class="hljs-string">"NSAMEAS"</span> == operation ||
      <span class="hljs-string">"GT_FIELD"</span> == operation || <span class="hljs-string">"LT_FIELD"</span> == operation ||
      <span class="hljs-string">"GT_OR_EQUALS_FIELD"</span> == operation ||
      <span class="hljs-string">"LT_OR_EQUALS_FIELD"</span> == operation)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  },
  <span class="hljs-attr">_addSameAsLabels</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">t, op</span>) </span>{
    <span class="hljs-keyword">if</span> (op == <span class="hljs-string">'SAMEAS'</span> || op == <span class="hljs-string">'NSAMEAS'</span>) {
      <span class="hljs-keyword">var</span> ASMSG = getMessage(<span class="hljs-string">'as'</span>);
      <span class="hljs-keyword">var</span> FROMMSG = getMessage(<span class="hljs-string">'from'</span>);
      <span class="hljs-keyword">var</span> span = cel(<span class="hljs-string">"span"</span>, t.tr.tdValue);
      span.style.marginLeft = <span class="hljs-string">"3px"</span>;
      span.style.marginRight = <span class="hljs-string">"5px"</span>;
      <span class="hljs-keyword">if</span> (op == <span class="hljs-string">'SAMEAS'</span>)
        span.innerHTML = ASMSG;
      <span class="hljs-keyword">else</span>
        span.innerHTML = FROMMSG;
    }
  },
  <span class="hljs-attr">_parseValues</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value, delimiter</span>) </span>{
    <span class="hljs-keyword">var</span> sb = <span class="hljs-string">""</span>;
    <span class="hljs-keyword">var</span> parts = [];
    <span class="hljs-keyword">if</span> (value == <span class="hljs-literal">null</span>)
      value = <span class="hljs-string">""</span>
    <span class="hljs-keyword">var</span> escapeChar = <span class="hljs-string">'\\'</span>;
    <span class="hljs-keyword">var</span> escaped = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; value.length; i++) {
      <span class="hljs-keyword">var</span> checkChar = value.substr(i, <span class="hljs-number">1</span>);
      <span class="hljs-keyword">if</span> (!escaped) {
        <span class="hljs-keyword">if</span> (checkChar == escapeChar) {
          escaped = <span class="hljs-literal">true</span>;
          <span class="hljs-keyword">continue</span>;
        }
        <span class="hljs-keyword">if</span> (checkChar == delimiter) {
          parts.push(sb);
          sb = <span class="hljs-string">""</span>;
          <span class="hljs-keyword">continue</span>;
        }
      } <span class="hljs-keyword">else</span>
        escaped = <span class="hljs-literal">false</span>;
      sb += checkChar;
    }
    parts.push(sb);
    <span class="hljs-keyword">return</span> parts;
  },
  <span class="hljs-attr">setFilterClass</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">filterClass</span>) </span>{
    <span class="hljs-keyword">this</span>.filterClass = filterClass;
  },
  <span class="hljs-attr">getFilterClass</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.filterClass;
  }
});
<span class="hljs-keyword">var</span> GlideFilterString = Class.create(GlideFilterHandler, {
  <span class="hljs-attr">_setup</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">values</span>) </span>{
    <span class="hljs-keyword">this</span>.maxValues = <span class="hljs-number">2</span>;
    <span class="hljs-keyword">this</span>.listenForOperChange = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">this</span>.rightOperand = values;
  },
  <span class="hljs-attr">_build</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    clearNodes(<span class="hljs-keyword">this</span>.tr.tdValue);
    <span class="hljs-keyword">this</span>.inputCnt = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._isEmptyOper())
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">var</span> op = <span class="hljs-keyword">this</span>._getOperator();
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._renderDynamicOperandInput(op))
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._renderRightOperandAsFieldList(op)) {
      <span class="hljs-keyword">this</span>._addSameAsLabels(<span class="hljs-keyword">this</span>, op);
      <span class="hljs-keyword">this</span>._populateRightOperandChoices();
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (op == <span class="hljs-string">'IN'</span>) {
      <span class="hljs-keyword">var</span> saveMe = useTextareas;
      useTextareas = <span class="hljs-literal">true</span>;
      <span class="hljs-keyword">var</span> inp = <span class="hljs-keyword">this</span>._addTextArea();
      inp.style.width = <span class="hljs-string">'20em'</span>;
      <span class="hljs-keyword">var</span> v = <span class="hljs-keyword">this</span>.values[<span class="hljs-keyword">this</span>.inputCnt - <span class="hljs-number">1</span>];
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._isTemplate()) {
        inp.value = v;
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">if</span> (v) {
          <span class="hljs-keyword">if</span> (isMSIE)
            v = v.replace(<span class="hljs-regexp">/,/g</span>, <span class="hljs-string">'\n\r'</span>);
          <span class="hljs-keyword">else</span>
            v = v.replace(<span class="hljs-regexp">/,/g</span>, <span class="hljs-string">'\n'</span>);
          inp.value = v;
        }
      }
      useTextareas = saveMe;
    } <span class="hljs-keyword">else</span>
      <span class="hljs-keyword">this</span>._addTextInput();
    <span class="hljs-keyword">if</span> (op == <span class="hljs-string">"BETWEEN"</span>) {
      <span class="hljs-keyword">var</span> txt = <span class="hljs-built_in">document</span>.createTextNode(<span class="hljs-string">" "</span> + getMessage(<span class="hljs-string">'and'</span>) + <span class="hljs-string">" "</span>);
      <span class="hljs-keyword">this</span>.tr.tdValue.appendChild(txt);
      <span class="hljs-keyword">this</span>._addTextInput();
    }
  },
  <span class="hljs-attr">_getInputValue</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">el</span>) </span>{
    <span class="hljs-keyword">if</span> (el == <span class="hljs-literal">null</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>;
    <span class="hljs-keyword">if</span> (!(el.tagName.toUpperCase() == <span class="hljs-string">"TEXTAREA"</span>))
      <span class="hljs-keyword">return</span> GlideFilterHandler.prototype._getInputValue.call(<span class="hljs-keyword">this</span>, el);
    <span class="hljs-keyword">var</span> value = el.value + <span class="hljs-string">''</span>;
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>._isTemplate()) {
      value = value.replace(<span class="hljs-regexp">/[\n\t]/g</span>, <span class="hljs-string">','</span>);
      value = value.replace(<span class="hljs-regexp">/\r/g</span>, <span class="hljs-string">''</span>);
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._escapeIfRequired(value);
  },
  <span class="hljs-attr">getValues</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>._clearValues();
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.inputCnt == <span class="hljs-number">0</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-string">""</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-keyword">this</span>.maxValues; i++)
      <span class="hljs-keyword">this</span>.values[i] = <span class="hljs-keyword">this</span>._getInputValue(<span class="hljs-keyword">this</span>.inputs[i]);
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.inputCnt == <span class="hljs-number">1</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>];
    <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">this</span>._escapeIfRequired();
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.values.join(<span class="hljs-string">"@"</span>);
    }
  },
  <span class="hljs-attr">_initInputs</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._getOperator() == <span class="hljs-string">"DYNAMIC"</span>) {
      <span class="hljs-keyword">this</span>.inputCnt = <span class="hljs-number">1</span>;
      <span class="hljs-keyword">this</span>.maxValues = <span class="hljs-number">1</span>;
    } <span class="hljs-keyword">else</span>
      <span class="hljs-keyword">this</span>.inputCnt = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">this</span>.inputs = [];
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-keyword">this</span>.maxValues; i++)
      <span class="hljs-keyword">this</span>.inputs[i] = <span class="hljs-literal">null</span>;
  },
  <span class="hljs-attr">_initValues</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">values</span>) </span>{
    <span class="hljs-keyword">var</span> op = <span class="hljs-keyword">this</span>._getOperator();
    <span class="hljs-keyword">if</span> (op == <span class="hljs-string">"BETWEEN"</span>) {
      <span class="hljs-keyword">if</span> (!values)
        <span class="hljs-keyword">this</span>.values = [];
      <span class="hljs-keyword">else</span>
        <span class="hljs-keyword">this</span>.values = <span class="hljs-keyword">this</span>._parseValues(values, <span class="hljs-string">"@"</span>);
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-keyword">this</span>.values.length; i &lt; <span class="hljs-keyword">this</span>.maxValues; i++)
        <span class="hljs-keyword">this</span>.values[i] = <span class="hljs-string">""</span>;
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">this</span>.values = [];
      <span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>] = values;
    }
  }
});
<span class="hljs-keyword">var</span> GlideFilterNumber = Class.create(GlideFilterString, {
  <span class="hljs-attr">_initValues</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">values</span>) </span>{
    <span class="hljs-keyword">var</span> op = <span class="hljs-keyword">this</span>._getOperator();
    <span class="hljs-keyword">if</span> (op == <span class="hljs-string">"BETWEEN"</span>) {
      <span class="hljs-keyword">if</span> (!values)
        <span class="hljs-keyword">this</span>.values = [];
      <span class="hljs-keyword">else</span>
        <span class="hljs-keyword">this</span>.values = values.split(<span class="hljs-string">"@"</span>);
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-keyword">this</span>.values.length; i &lt; <span class="hljs-keyword">this</span>.maxValues; i++)
        <span class="hljs-keyword">this</span>.values[i] = <span class="hljs-string">""</span>;
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">this</span>.values = [];
      <span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>] = values;
    }
  }
});
<span class="hljs-keyword">var</span> GlideFilterDuration = Class.create(GlideFilterHandler, {
  <span class="hljs-attr">_setup</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">values</span>) </span>{
    <span class="hljs-keyword">this</span>.maxValues = <span class="hljs-number">2</span>;
    <span class="hljs-keyword">var</span> valueArray = <span class="hljs-keyword">this</span>._parseValues(values, <span class="hljs-string">"@"</span>);
    <span class="hljs-keyword">this</span>.duration = <span class="hljs-keyword">new</span> GlideDuration(valueArray[<span class="hljs-number">0</span>], <span class="hljs-keyword">this</span>.item);
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._getOperator() == <span class="hljs-string">"BETWEEN"</span>) {
      <span class="hljs-keyword">this</span>.maxValues = <span class="hljs-number">2</span>;
      <span class="hljs-keyword">if</span> (valueArray.length &gt; <span class="hljs-number">1</span>)
        <span class="hljs-keyword">this</span>.durationTo = <span class="hljs-keyword">new</span> GlideDuration(valueArray[<span class="hljs-number">1</span>], <span class="hljs-keyword">this</span>.item);
      <span class="hljs-keyword">else</span>
        <span class="hljs-keyword">this</span>.durationTo = <span class="hljs-keyword">new</span> GlideDuration(valueArray[<span class="hljs-number">0</span>], <span class="hljs-keyword">this</span>.item);
    }
    <span class="hljs-keyword">this</span>.listenForOperChange = <span class="hljs-literal">true</span>;
  },
  <span class="hljs-attr">destroy</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.tr)
      <span class="hljs-keyword">this</span>.tr.tdValue.innerHTML = <span class="hljs-string">""</span>;
    <span class="hljs-keyword">this</span>.inputCnt = <span class="hljs-number">0</span>;
    GlideFilterHandler.prototype.destroy.call(<span class="hljs-keyword">this</span>);
  },
  <span class="hljs-attr">_initValues</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">values</span>) </span>{
    <span class="hljs-keyword">this</span>.values = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>();
    <span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>] = <span class="hljs-keyword">this</span>.duration.getDays();
    <span class="hljs-keyword">this</span>.values[<span class="hljs-number">1</span>] = <span class="hljs-keyword">this</span>.duration.getHours();
    <span class="hljs-keyword">this</span>.values[<span class="hljs-number">2</span>] = <span class="hljs-keyword">this</span>.duration.getMinutes();
    <span class="hljs-keyword">this</span>.values[<span class="hljs-number">3</span>] = <span class="hljs-keyword">this</span>.duration.getSeconds();
    <span class="hljs-keyword">this</span>.inputCnt = <span class="hljs-number">4</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._getOperator() == <span class="hljs-string">"BETWEEN"</span>) {
      <span class="hljs-keyword">this</span>.values[<span class="hljs-number">4</span>] = <span class="hljs-keyword">this</span>.duration.getDays();
      <span class="hljs-keyword">this</span>.values[<span class="hljs-number">5</span>] = <span class="hljs-keyword">this</span>.duration.getHours();
      <span class="hljs-keyword">this</span>.values[<span class="hljs-number">6</span>] = <span class="hljs-keyword">this</span>.duration.getMinutes();
      <span class="hljs-keyword">this</span>.values[<span class="hljs-number">7</span>] = <span class="hljs-keyword">this</span>.duration.getSeconds();
      <span class="hljs-keyword">this</span>.inputCnt = <span class="hljs-number">8</span>;
    }
  },
  <span class="hljs-attr">getValues</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>._clearValues();
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.inputCnt == <span class="hljs-number">0</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-string">""</span>;
    <span class="hljs-keyword">var</span> answer = <span class="hljs-keyword">this</span>.duration.getValue();
    <span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>] = <span class="hljs-keyword">this</span>.duration.getDays();
    <span class="hljs-keyword">this</span>.values[<span class="hljs-number">1</span>] = <span class="hljs-keyword">this</span>.duration.getHours();
    <span class="hljs-keyword">this</span>.values[<span class="hljs-number">2</span>] = <span class="hljs-keyword">this</span>.duration.getMinutes();
    <span class="hljs-keyword">this</span>.values[<span class="hljs-number">3</span>] = <span class="hljs-keyword">this</span>.duration.getSeconds();
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._getOperator() == <span class="hljs-string">"BETWEEN"</span>) {
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.durationTo) {
        <span class="hljs-keyword">var</span> answer1 = <span class="hljs-keyword">this</span>.durationTo.getValue();
        <span class="hljs-keyword">this</span>.values[<span class="hljs-number">4</span>] = <span class="hljs-keyword">this</span>.durationTo.getDays();
        <span class="hljs-keyword">this</span>.values[<span class="hljs-number">5</span>] = <span class="hljs-keyword">this</span>.durationTo.getHours();
        <span class="hljs-keyword">this</span>.values[<span class="hljs-number">6</span>] = <span class="hljs-keyword">this</span>.durationTo.getMinutes();
        <span class="hljs-keyword">this</span>.values[<span class="hljs-number">7</span>] = <span class="hljs-keyword">this</span>.durationTo.getSeconds();
        <span class="hljs-keyword">return</span> <span class="hljs-string">"javascript:gs.getDurationDate('"</span> + answer + <span class="hljs-string">"')@javascript:gs.getDurationDate('"</span> + answer1 + <span class="hljs-string">"')"</span>;
      }
    }
    <span class="hljs-keyword">return</span> <span class="hljs-string">"javascript:gs.getDurationDate('"</span> + answer + <span class="hljs-string">"')"</span>;
  },
  <span class="hljs-attr">_build</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    clearNodes(<span class="hljs-keyword">this</span>.tr.tdValue);
    <span class="hljs-keyword">this</span>.inputCnt = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._isEmptyOper())
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._renderRightOperandAsFieldList(<span class="hljs-keyword">this</span>._getOperator())) {
      <span class="hljs-keyword">this</span>._addSameAsLabels(<span class="hljs-keyword">this</span>, <span class="hljs-keyword">this</span>._getOperator());
      <span class="hljs-keyword">this</span>._populateRightOperandChoices();
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">this</span>.inputCnt = <span class="hljs-number">1</span>;
      <span class="hljs-keyword">this</span>.duration.buildHTML(<span class="hljs-keyword">this</span>.tr.tdValue);
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._getOperator() == <span class="hljs-string">"BETWEEN"</span> &amp;&amp; <span class="hljs-keyword">this</span>.maxValues == <span class="hljs-number">2</span>) {
        <span class="hljs-keyword">var</span> txt = <span class="hljs-built_in">document</span>.createTextNode(<span class="hljs-string">" "</span> + getMessage(<span class="hljs-string">'and'</span>) + <span class="hljs-string">" "</span>);
        <span class="hljs-keyword">this</span>.tr.tdValue.appendChild(txt);
        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.durationTo)
          <span class="hljs-keyword">this</span>.durationTo = <span class="hljs-keyword">new</span> GlideDuration();
        <span class="hljs-keyword">this</span>.durationTo.buildHTML(<span class="hljs-keyword">this</span>.tr.tdValue);
      }
    }
  }
});
<span class="hljs-keyword">var</span> GlideFilterStringMulti = Class.create(GlideFilterString, {
  <span class="hljs-attr">_setup</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">values</span>) </span>{
    <span class="hljs-keyword">this</span>.maxValues = <span class="hljs-number">1</span>;
    <span class="hljs-keyword">this</span>.listenForOperChange = <span class="hljs-literal">true</span>;
  },
  <span class="hljs-attr">_build</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    clearNodes(<span class="hljs-keyword">this</span>.tr.tdValue);
    <span class="hljs-keyword">this</span>.inputCnt = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._isEmptyOper())
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._renderDynamicOperandInput(<span class="hljs-keyword">this</span>._getOperator()))
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._renderRightOperandAsFieldList(<span class="hljs-keyword">this</span>._getOperator())) {
      <span class="hljs-keyword">this</span>._addSameAsLabels(<span class="hljs-keyword">this</span>, <span class="hljs-keyword">this</span>._getOperator());
      <span class="hljs-keyword">this</span>._populateRightOperandChoices();
    } <span class="hljs-keyword">else</span>
      <span class="hljs-keyword">this</span>._addTextArea();
  }
});
<span class="hljs-keyword">var</span> GlideFilterChoice = Class.create(GlideFilterHandler, {
  <span class="hljs-attr">_setup</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">values</span>) </span>{
    <span class="hljs-keyword">this</span>.maxValues = <span class="hljs-number">2</span>;
    <span class="hljs-keyword">this</span>.listenForOperChange = <span class="hljs-literal">true</span>;
  },
  <span class="hljs-attr">setChoices</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">choices</span>) </span>{
    <span class="hljs-keyword">this</span>.choices = choices;
  },
  <span class="hljs-attr">setWidth</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">width</span>) </span>{
    <span class="hljs-keyword">this</span>.width = width;
  },
  <span class="hljs-attr">setMulti</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">multi</span>) </span>{
    <span class="hljs-keyword">this</span>.multi = multi;
  },
  <span class="hljs-attr">setSize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">size</span>) </span>{
    <span class="hljs-keyword">this</span>.size = size;
  },
  <span class="hljs-attr">_build</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    clearNodes(<span class="hljs-keyword">this</span>.tr.tdValue);
    <span class="hljs-keyword">this</span>.inputCnt = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._isEmptyOper())
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._renderRightOperandAsFieldList(<span class="hljs-keyword">this</span>._getOperator())) {
      <span class="hljs-keyword">this</span>._addSameAsLabels(<span class="hljs-keyword">this</span>, <span class="hljs-keyword">this</span>._getOperator());
      <span class="hljs-keyword">this</span>._populateRightOperandChoices();
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">var</span> s = <span class="hljs-keyword">this</span>._addSelect(<span class="hljs-keyword">this</span>.width, <span class="hljs-keyword">this</span>.multi, <span class="hljs-keyword">this</span>.size);
      <span class="hljs-keyword">this</span>._fillSelect();
    }
  },
  <span class="hljs-attr">_fillSelect</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">inputIndex</span>) </span>{
    <span class="hljs-keyword">if</span> (inputIndex == <span class="hljs-literal">null</span>)
      inputIndex = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">var</span> vars = {};
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.values[inputIndex]) {
      <span class="hljs-keyword">var</span> valSplit = <span class="hljs-keyword">this</span>.values[inputIndex].split(<span class="hljs-string">','</span>);
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; valSplit.length; i++) {
        vars[valSplit[i]] = <span class="hljs-literal">true</span>;
      }
    }
    <span class="hljs-keyword">var</span> removeNone = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">var</span> oper = <span class="hljs-keyword">this</span>._getOperator();
    <span class="hljs-keyword">if</span> ((oper == <span class="hljs-string">'IN'</span>) || (oper == <span class="hljs-string">'NOT IN'</span>))
      removeNone = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">if</span> (isMSIE &amp;&amp; <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">0</span>].multiple) {
      <span class="hljs-keyword">var</span> isIE6 = <span class="hljs-regexp">/MSIE 6/</span>.test(navigator.userAgent);
      <span class="hljs-keyword">if</span> (isIE6)
        <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">0</span>].focus();
    }
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-keyword">this</span>.choices.length; i++) {
      <span class="hljs-keyword">var</span> option = <span class="hljs-keyword">this</span>.choices[i];
      <span class="hljs-keyword">if</span> (option[<span class="hljs-number">0</span>] == <span class="hljs-string">''</span> &amp;&amp; removeNone)
        <span class="hljs-keyword">continue</span>;
      <span class="hljs-keyword">var</span> selected = (vars[option[<span class="hljs-number">0</span>]] != <span class="hljs-literal">null</span> || <span class="hljs-keyword">this</span>.values[inputIndex] == option[<span class="hljs-number">0</span>]);
      addOption(<span class="hljs-keyword">this</span>.inputs[inputIndex], option[<span class="hljs-number">0</span>], option[<span class="hljs-number">1</span>], selected);
    }
  }
});
<span class="hljs-keyword">var</span> GlideFilterChoiceDynamic = Class.create(GlideFilterChoice, {
  <span class="hljs-attr">_setup</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">values</span>) </span>{
    <span class="hljs-keyword">this</span>.size = <span class="hljs-number">4</span>;
    <span class="hljs-keyword">this</span>.maxValues = <span class="hljs-number">2</span>;
    <span class="hljs-keyword">this</span>.listenForOperChange = <span class="hljs-literal">true</span>;
  },
  <span class="hljs-attr">setChoices</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">choices</span>) </span>{
    <span class="hljs-keyword">this</span>.choices = choices;
  },
  <span class="hljs-attr">_build</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    clearNodes(<span class="hljs-keyword">this</span>.tr.tdValue);
    <span class="hljs-keyword">this</span>.inputCnt = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._isEmptyOper())
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">var</span> oper = <span class="hljs-keyword">this</span>._getOperator();
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._renderRightOperandAsFieldList(oper)) {
      <span class="hljs-keyword">this</span>._addSameAsLabels(<span class="hljs-keyword">this</span>, oper);
      <span class="hljs-keyword">this</span>._populateRightOperandChoices();
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ((oper == <span class="hljs-string">'LIKE'</span>) || (oper == <span class="hljs-string">'STARTSWITH'</span>) || (oper == <span class="hljs-string">'ENDSWITH'</span>) || (oper == <span class="hljs-string">'NOT LIKE'</span>)) {
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.prevOper &amp;&amp; (<span class="hljs-keyword">this</span>.prevOper != <span class="hljs-string">'LIKE'</span>) &amp;&amp; (<span class="hljs-keyword">this</span>.prevOper != <span class="hljs-string">'STARTSWITH'</span>) &amp;&amp; (<span class="hljs-keyword">this</span>.prevOper != <span class="hljs-string">'ENDSWITH'</span>))
        <span class="hljs-keyword">this</span>._clearValues();
      <span class="hljs-keyword">this</span>._addTextInput();
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ((oper == <span class="hljs-string">'IN'</span>) || (oper == <span class="hljs-string">'NOT IN'</span>)) {
      <span class="hljs-keyword">this</span>.multi = <span class="hljs-literal">true</span>;
      <span class="hljs-keyword">var</span> s = <span class="hljs-keyword">this</span>._addSelect(<span class="hljs-keyword">this</span>.width, <span class="hljs-keyword">this</span>.multi, <span class="hljs-keyword">this</span>.size);
      <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.hasChoices) {
        s.disabled = <span class="hljs-literal">true</span>;
        <span class="hljs-keyword">this</span>._getChoices();
      } <span class="hljs-keyword">else</span>
        <span class="hljs-keyword">this</span>._fillSelect();
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (oper == <span class="hljs-string">'BETWEEN'</span>) {
      <span class="hljs-keyword">this</span>.multi = <span class="hljs-literal">false</span>;
      <span class="hljs-keyword">var</span> s = <span class="hljs-keyword">this</span>._addSelect(<span class="hljs-keyword">this</span>.width, <span class="hljs-keyword">this</span>.multi, <span class="hljs-number">1</span>);
      <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.hasChoices) {
        s.disabled = <span class="hljs-literal">true</span>;
        <span class="hljs-keyword">this</span>._getChoices();
      } <span class="hljs-keyword">else</span>
        <span class="hljs-keyword">this</span>._fillSelect();
      <span class="hljs-keyword">var</span> txt = <span class="hljs-built_in">document</span>.createTextNode(<span class="hljs-string">" "</span> + getMessage(<span class="hljs-string">'and'</span>) + <span class="hljs-string">" "</span>);
      <span class="hljs-keyword">this</span>.tr.tdValue.appendChild(txt);
      <span class="hljs-keyword">this</span>.multi = <span class="hljs-literal">false</span>;
      <span class="hljs-keyword">var</span> s = <span class="hljs-keyword">this</span>._addSelect(<span class="hljs-keyword">this</span>.width, <span class="hljs-keyword">this</span>.multi, <span class="hljs-number">1</span>);
      <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.hasChoices) {
        s.disabled = <span class="hljs-literal">true</span>;
        <span class="hljs-keyword">this</span>._getChoices();
      } <span class="hljs-keyword">else</span>
        <span class="hljs-keyword">this</span>._fillSelect(<span class="hljs-number">1</span>);
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">this</span>.multi = <span class="hljs-literal">false</span>;
      <span class="hljs-keyword">var</span> s = <span class="hljs-keyword">this</span>._addSelect(<span class="hljs-keyword">this</span>.width, <span class="hljs-keyword">this</span>.multi, <span class="hljs-number">1</span>);
      <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.hasChoices) {
        s.disabled = <span class="hljs-literal">true</span>;
        <span class="hljs-keyword">this</span>._getChoices();
      } <span class="hljs-keyword">else</span>
        <span class="hljs-keyword">this</span>._fillSelect();
    }
    <span class="hljs-keyword">this</span>.prevOper = oper;
  },
  <span class="hljs-attr">_getChoices</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> g_filter_description != <span class="hljs-string">'undefined'</span> &amp;&amp; g_filter_description.getChoiceList(<span class="hljs-keyword">this</span>.tr.tableField) != <span class="hljs-literal">null</span>) {
      <span class="hljs-keyword">var</span> response = loadXML(g_filter_description.getChoiceList(<span class="hljs-keyword">this</span>.tr.tableField));
      <span class="hljs-keyword">this</span>._addChoices(response);
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">var</span> ajax = <span class="hljs-keyword">new</span> GlideAjax(<span class="hljs-string">'PickList'</span>);
      ajax.addParam(<span class="hljs-string">'sysparm_chars'</span>, <span class="hljs-string">'*'</span>);
      ajax.addParam(<span class="hljs-string">'sysparm_nomax'</span>, <span class="hljs-string">'true'</span>);
      ajax.addParam(<span class="hljs-string">'sysparm_name'</span>, <span class="hljs-keyword">this</span>.tr.tableField);
      <span class="hljs-keyword">var</span> response = ajax.getXMLWait();
      <span class="hljs-keyword">this</span>._addChoices(response);
    }
  },
  <span class="hljs-attr">_addChoices</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">xml</span>) </span>{
    <span class="hljs-keyword">if</span> (!xml)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">var</span> msg = <span class="hljs-keyword">new</span> GwtMessage();
    <span class="hljs-keyword">var</span> select = <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">0</span>];
    select.disabled = <span class="hljs-literal">false</span>;
    select.options.length = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">this</span>.choices = [];
    <span class="hljs-keyword">this</span>.hasChoices = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">var</span> root = xml.documentElement;
    <span class="hljs-keyword">var</span> dep = root.getAttribute(<span class="hljs-string">"dependent"</span>);
    <span class="hljs-keyword">var</span> items = xml.getElementsByTagName(<span class="hljs-string">"item"</span>);
    <span class="hljs-keyword">var</span> addNone = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; items.length; i++) {
      <span class="hljs-keyword">var</span> item = items[i];
      <span class="hljs-keyword">if</span> (item.getAttribute(<span class="hljs-string">"value"</span>) == <span class="hljs-string">''</span>)
        addNone = <span class="hljs-literal">false</span>;
    }
    <span class="hljs-keyword">if</span> (addNone)
      <span class="hljs-keyword">this</span>.choices[<span class="hljs-number">0</span>] = [<span class="hljs-string">''</span>, msg.getMessage(<span class="hljs-string">'-- None --'</span>)];
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; items.length; i++) {
      <span class="hljs-keyword">var</span> item = items[i];
      <span class="hljs-keyword">var</span> v = item.getAttribute(<span class="hljs-string">"value"</span>);
      <span class="hljs-keyword">var</span> l = item.getAttribute(<span class="hljs-string">"label"</span>);
      <span class="hljs-keyword">var</span> option = [v, l];
      <span class="hljs-keyword">this</span>.choices.push(option);
    }
    <span class="hljs-keyword">if</span> (dep != <span class="hljs-literal">null</span>) {
      <span class="hljs-keyword">this</span>.choices = <span class="hljs-keyword">this</span>.choices
        .sort(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a, b</span>) </span>{
          <span class="hljs-keyword">if</span> ((a[<span class="hljs-number">1</span>].toLowerCase() + <span class="hljs-string">""</span>) &lt; (b[<span class="hljs-number">1</span>]
              .toLowerCase() + <span class="hljs-string">""</span>)) {
            <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;
          }
          <span class="hljs-keyword">if</span> ((a[<span class="hljs-number">1</span>].toLowerCase() + <span class="hljs-string">""</span>) &gt; (b[<span class="hljs-number">1</span>]
              .toLowerCase() + <span class="hljs-string">""</span>)) {
            <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
          }
          <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
        });
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-keyword">this</span>.choices.length - <span class="hljs-number">1</span>; i++) {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.choices[i][<span class="hljs-number">1</span>] == <span class="hljs-keyword">this</span>.choices[i + <span class="hljs-number">1</span>][<span class="hljs-number">1</span>])
          i = <span class="hljs-keyword">this</span>.amendLabel(i);
      }
    }
    <span class="hljs-keyword">this</span>._fillSelect();
  },
  <span class="hljs-attr">amendLabel</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">i</span>) </span>{
    <span class="hljs-keyword">var</span> dupe = <span class="hljs-keyword">this</span>.choices[i][<span class="hljs-number">1</span>];
    <span class="hljs-keyword">while</span> (i &lt; <span class="hljs-keyword">this</span>.choices.length &amp;&amp; <span class="hljs-keyword">this</span>.choices[i][<span class="hljs-number">1</span>] == dupe) {
      <span class="hljs-keyword">var</span> c = <span class="hljs-keyword">this</span>.choices[i];
      c[<span class="hljs-number">1</span>] = c[<span class="hljs-number">1</span>] + <span class="hljs-string">" - "</span> + c[<span class="hljs-number">0</span>];
      i++;
    }
    <span class="hljs-keyword">return</span> i - <span class="hljs-number">1</span>;
  }
});
<span class="hljs-keyword">var</span> GlideFilterCurrency = Class.create(GlideFilterString, {
  <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">tableName, item</span>) </span>{
    GlideFilterHandler.prototype.initialize.call(<span class="hljs-keyword">this</span>, tableName, item);
  },
  <span class="hljs-attr">_operOnChange</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> lastOp = <span class="hljs-keyword">this</span>.lastOperator;
    <span class="hljs-keyword">this</span>.lastOperator = <span class="hljs-keyword">this</span>._getOperator();
    <span class="hljs-keyword">if</span> ((fieldComparisonOperators.indexOf(lastOp) &gt;= <span class="hljs-number">0</span>) != (fieldComparisonOperators.indexOf(<span class="hljs-keyword">this</span>.lastOperator) &gt;= <span class="hljs-number">0</span>)) {
      <span class="hljs-keyword">this</span>.inputCnt = <span class="hljs-number">0</span>;
      <span class="hljs-keyword">this</span>.input = [];
    }
    <span class="hljs-keyword">this</span>.getValues();
    <span class="hljs-keyword">if</span> (lastOp != <span class="hljs-string">'BETWEEN'</span> &amp;&amp; <span class="hljs-keyword">this</span>._getOperator() == <span class="hljs-string">'BETWEEN'</span>) {
      <span class="hljs-keyword">this</span>.values[<span class="hljs-number">2</span>] = <span class="hljs-keyword">this</span>.values[<span class="hljs-number">1</span>];
      <span class="hljs-keyword">this</span>.values[<span class="hljs-number">1</span>] = <span class="hljs-string">''</span>;
    }
    <span class="hljs-keyword">this</span>._unescapeIfRequired();
    <span class="hljs-keyword">this</span>._build();
  },
  <span class="hljs-attr">_setup</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">values</span>) </span>{
    <span class="hljs-keyword">this</span>.maxValues = <span class="hljs-number">2</span>;
    <span class="hljs-keyword">this</span>.id = <span class="hljs-keyword">this</span>.tr.tableField + <span class="hljs-string">"."</span> + guid();
    <span class="hljs-keyword">this</span>.listenForOperChange = <span class="hljs-literal">true</span>;
  },
  <span class="hljs-attr">_build</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    GlideFilterString.prototype._build.call(<span class="hljs-keyword">this</span>);
    <span class="hljs-keyword">var</span> s = <span class="hljs-keyword">this</span>._addSelect(<span class="hljs-number">60</span>, <span class="hljs-literal">false</span>, <span class="hljs-number">1</span>);
    <span class="hljs-keyword">this</span>._getCurrencies(s);
  },
  <span class="hljs-attr">_getCurrencies</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">s</span>) </span>{
    <span class="hljs-keyword">var</span> currencies = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>();
    <span class="hljs-keyword">if</span> (currencies.length != <span class="hljs-number">0</span>)
      <span class="hljs-keyword">return</span> currencies;
    <span class="hljs-keyword">var</span> ajax = <span class="hljs-keyword">new</span> GlideAjax(<span class="hljs-string">"CurrencyConverter"</span>);
    ajax.addParam(<span class="hljs-string">"sysparm_name"</span>, <span class="hljs-string">"getCurrencies"</span>);
    ajax.getXMLAnswer(<span class="hljs-keyword">this</span>._getCurrenciesResponse.bind(<span class="hljs-keyword">this</span>), <span class="hljs-literal">null</span>, s);
  },
  <span class="hljs-attr">_getCurrenciesResponse</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">answer, s</span>) </span>{
    <span class="hljs-keyword">var</span> values = answer;
    <span class="hljs-keyword">var</span> currencies = values.split(<span class="hljs-string">","</span>);
    <span class="hljs-keyword">var</span> cache = <span class="hljs-keyword">this</span>._getCache();
    cache.put(<span class="hljs-string">"currencies"</span>, values);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; currencies.length; i++)
      addOption(s, currencies[i], currencies[i]);
    <span class="hljs-keyword">this</span>.currency_widget = s;
    <span class="hljs-keyword">this</span>._parseValue();
  },
  <span class="hljs-attr">_resolveFromCache</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> cache = <span class="hljs-keyword">this</span>._getCache();
    <span class="hljs-keyword">var</span> value = cache.get(<span class="hljs-string">"currencies"</span>);
    <span class="hljs-keyword">if</span> (value)
      <span class="hljs-keyword">return</span> value.split(<span class="hljs-string">","</span>);
    <span class="hljs-keyword">return</span> [];
  },
  <span class="hljs-attr">_getCache</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span>(g_cache_currency) != <span class="hljs-string">"undefined"</span>)
      <span class="hljs-keyword">return</span> g_cache_currency;
    g_cache_currency = <span class="hljs-keyword">new</span> GlideClientCache(<span class="hljs-number">1</span>);
    <span class="hljs-keyword">return</span> g_cache_currency;
  },
  <span class="hljs-attr">_parseValue</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.inputs.length == <span class="hljs-number">0</span>)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">var</span> processSelect = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-keyword">this</span>.inputs.length; i++) {
      <span class="hljs-keyword">var</span> v = <span class="hljs-keyword">this</span>.inputs[i].value;
      <span class="hljs-keyword">if</span> (!v)
        <span class="hljs-keyword">continue</span>;
      <span class="hljs-keyword">if</span> (v.indexOf(<span class="hljs-string">'javascript'</span>) &lt; <span class="hljs-number">0</span>)
        <span class="hljs-keyword">continue</span>;
      processSelect = <span class="hljs-literal">true</span>;
      <span class="hljs-keyword">var</span> sa = v.split(<span class="hljs-string">';'</span>);
      <span class="hljs-keyword">var</span> first = sa[<span class="hljs-number">0</span>].split(<span class="hljs-string">'\''</span>);
      <span class="hljs-keyword">var</span> currency = first[first.length - <span class="hljs-number">1</span>];
      <span class="hljs-keyword">var</span> price = sa[sa.length - <span class="hljs-number">1</span>];
      <span class="hljs-keyword">var</span> priceIndex = price.indexOf(<span class="hljs-string">'\''</span>);
      price = price.substring(<span class="hljs-number">0</span>, priceIndex);
      <span class="hljs-keyword">this</span>.inputs[i].value = price;
    }
    <span class="hljs-keyword">if</span> (!processSelect)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">var</span> sel = <span class="hljs-keyword">new</span> Select(<span class="hljs-keyword">this</span>.currency_widget);
    sel.selectValue(currency);
  },
  <span class="hljs-attr">getValues</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.currency_widget)
      <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>;
    <span class="hljs-keyword">var</span> v = GlideFilterString.prototype.getValues.call(<span class="hljs-keyword">this</span>);
    <span class="hljs-keyword">var</span> tn = <span class="hljs-keyword">this</span>.item.table.tableName;
    <span class="hljs-keyword">var</span> fn = <span class="hljs-keyword">this</span>.item.name;
    <span class="hljs-keyword">var</span> valList = v.split(<span class="hljs-string">'@'</span>);
    <span class="hljs-keyword">var</span> fromVal = <span class="hljs-string">'javascript:getCurrencyFilter(\''</span> + tn + <span class="hljs-string">'\',\''</span> + fn + <span class="hljs-string">'\', \''</span> + <span class="hljs-keyword">this</span>.currency_widget.value + <span class="hljs-string">';'</span> + valList[<span class="hljs-number">0</span>] + <span class="hljs-string">'\')'</span>
    <span class="hljs-keyword">if</span> ((valList.length &gt; <span class="hljs-number">1</span> &amp;&amp; <span class="hljs-keyword">this</span>._getOperator() == <span class="hljs-string">'BETWEEN'</span>) || (valList.length &gt; <span class="hljs-number">2</span>))
      <span class="hljs-keyword">return</span> fromVal + <span class="hljs-string">'@javascript:getCurrencyFilter(\''</span> + tn + <span class="hljs-string">'\',\''</span> + fn + <span class="hljs-string">'\', \''</span> + <span class="hljs-keyword">this</span>.currency_widget.value + <span class="hljs-string">';'</span> + valList[<span class="hljs-number">1</span>] + <span class="hljs-string">'\')'</span>
    <span class="hljs-keyword">return</span> fromVal;
  },
  <span class="hljs-attr">destroy</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    GlideFilterString.prototype.destroy.call(<span class="hljs-keyword">this</span>);
    <span class="hljs-keyword">this</span>.currency_widget = <span class="hljs-literal">null</span>;
  },
  <span class="hljs-attr">z</span>: <span class="hljs-literal">null</span>
});;
<span class="hljs-comment">/*! RESOURCE: /scripts/classes/GlideDuration.js */</span>
<span class="hljs-keyword">var</span> GlideDuration = Class.create({
  <span class="hljs-attr">MS_IN_DAY</span>: <span class="hljs-number">86400000</span>,
  <span class="hljs-attr">MAX_UNIT_DAYS</span>: <span class="hljs-number">4</span>,
  <span class="hljs-attr">MAX_UNIT_HOURS</span>: <span class="hljs-number">3</span>,
  <span class="hljs-attr">MAX_UNIT_MINUTES</span>: <span class="hljs-number">2</span>,
  <span class="hljs-attr">MAX_UNIT_SECONDS</span>: <span class="hljs-number">1</span>,
  <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value, item</span>) </span>{
    <span class="hljs-keyword">this</span>.values = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>();
    <span class="hljs-keyword">var</span> gMessage = <span class="hljs-keyword">new</span> GwtMessage();
    <span class="hljs-keyword">var</span> values = [<span class="hljs-string">"Days"</span>, <span class="hljs-string">"Hours"</span>, <span class="hljs-string">"Minutes"</span>, <span class="hljs-string">"Seconds"</span>];
    <span class="hljs-keyword">var</span> answer = gMessage.getMessages(values);
    <span class="hljs-keyword">this</span>.daysMessage = answer[<span class="hljs-string">"Days"</span>];
    <span class="hljs-keyword">this</span>.hourMessage = answer[<span class="hljs-string">"Hours"</span>];
    <span class="hljs-keyword">this</span>.minutesMessage = answer[<span class="hljs-string">"Minutes"</span>];
    <span class="hljs-keyword">this</span>.secondsMessage = answer[<span class="hljs-string">"Seconds"</span>];
    <span class="hljs-keyword">this</span>.maxLevel = <span class="hljs-keyword">this</span>.MAX_UNIT_DAYS;
    <span class="hljs-keyword">if</span> (item) {
      <span class="hljs-keyword">this</span>.item = item;
      <span class="hljs-keyword">this</span>.maxLevel = <span class="hljs-keyword">this</span>._parseMaxUnit(<span class="hljs-keyword">this</span>.item.getNamedAttribute(<span class="hljs-string">'max_unit'</span>));
    }
    <span class="hljs-keyword">if</span> (value) {
      <span class="hljs-keyword">if</span> (value.indexOf(<span class="hljs-string">"javascript:"</span>) == <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">var</span> s = value.split(<span class="hljs-string">"'"</span>);
        value = s[<span class="hljs-number">1</span>];
      }
      <span class="hljs-keyword">this</span>.values = value.split(<span class="hljs-string">" "</span>);
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.values.length == <span class="hljs-number">2</span>) {
        <span class="hljs-keyword">var</span> times = <span class="hljs-keyword">this</span>.values[<span class="hljs-number">1</span>].split(<span class="hljs-string">":"</span>);
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; times.length; i++)
          <span class="hljs-keyword">this</span>.values[<span class="hljs-number">1</span> + i] = times[i];
        <span class="hljs-keyword">var</span> dateParts = <span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>].split(<span class="hljs-string">"-"</span>);
        <span class="hljs-keyword">if</span> (dateParts.length == <span class="hljs-number">3</span>)
          <span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>] = <span class="hljs-built_in">parseInt</span>(<span class="hljs-built_in">Date</span>.parse(dateParts[<span class="hljs-number">1</span>] + <span class="hljs-string">'/'</span> + dateParts[<span class="hljs-number">2</span>] + <span class="hljs-string">'/'</span> + dateParts[<span class="hljs-number">0</span>] + <span class="hljs-string">' 00:00:00 UTC'</span>)) / <span class="hljs-keyword">this</span>.MS_IN_DAY;
      }
    }
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-keyword">this</span>.values.length; i &lt; <span class="hljs-number">4</span>; i++)
      <span class="hljs-keyword">this</span>.values[i] = <span class="hljs-string">"0"</span>;
  },
  <span class="hljs-attr">buildHTML</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">parent</span>) </span>{
    <span class="hljs-keyword">this</span>.parent = parent;
    <span class="hljs-keyword">this</span>.days = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">this</span>.hour = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">this</span>.minute = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">this</span>.second = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.maxLevel == <span class="hljs-keyword">this</span>.MAX_UNIT_DAYS) {
      <span class="hljs-keyword">this</span>._addSpan(<span class="hljs-keyword">this</span>.daysMessage);
      <span class="hljs-keyword">this</span>.days = <span class="hljs-keyword">this</span>._addInput(<span class="hljs-string">"dur_day"</span>, <span class="hljs-keyword">this</span>.getDays());
      <span class="hljs-keyword">this</span>.days.maxLength = <span class="hljs-string">"5"</span>;
      <span class="hljs-keyword">this</span>.days.style.marginRight = <span class="hljs-string">"5px"</span>;
    } <span class="hljs-keyword">else</span>
      <span class="hljs-keyword">this</span>.hour = (<span class="hljs-keyword">this</span>.getDays() * <span class="hljs-number">24</span>);
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.maxLevel &gt;= <span class="hljs-keyword">this</span>.MAX_UNIT_HOURS) {
      <span class="hljs-keyword">this</span>._addSpan(<span class="hljs-keyword">this</span>.hourMessage);
      <span class="hljs-keyword">this</span>.hour = <span class="hljs-keyword">this</span>._addInput(<span class="hljs-string">"dur_hour"</span>, <span class="hljs-keyword">this</span>.hour + <span class="hljs-built_in">parseInt</span>(<span class="hljs-keyword">this</span>.getHours(), <span class="hljs-number">10</span>));
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.maxLevel == <span class="hljs-keyword">this</span>.MAX_UNIT_HOURS)
        <span class="hljs-keyword">this</span>.hour.maxLength = <span class="hljs-string">"7"</span>;
      <span class="hljs-keyword">this</span>._addSpan(<span class="hljs-string">":"</span>);
    } <span class="hljs-keyword">else</span>
      <span class="hljs-keyword">this</span>.minute = ((<span class="hljs-keyword">this</span>.hour + <span class="hljs-built_in">parseInt</span>(<span class="hljs-keyword">this</span>.getHours(), <span class="hljs-number">10</span>)) * <span class="hljs-number">60</span>);
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.maxLevel == <span class="hljs-keyword">this</span>.MAX_UNIT_MINUTES)
      <span class="hljs-keyword">this</span>._addSpan(<span class="hljs-keyword">this</span>.minutesMessage);
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.maxLevel &gt;= <span class="hljs-keyword">this</span>.MAX_UNIT_MINUTES) {
      <span class="hljs-keyword">this</span>.minute = <span class="hljs-keyword">this</span>._addInput(<span class="hljs-string">"dur_min"</span>, <span class="hljs-keyword">this</span>.minute + <span class="hljs-built_in">parseInt</span>(<span class="hljs-keyword">this</span>.getMinutes(), <span class="hljs-number">10</span>));
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.maxLevel == <span class="hljs-keyword">this</span>.MAX_UNIT_MINUTES)
        <span class="hljs-keyword">this</span>.minute.maxLength = <span class="hljs-string">"9"</span>;
      <span class="hljs-keyword">this</span>._addSpan(<span class="hljs-string">":"</span>);
    } <span class="hljs-keyword">else</span>
      <span class="hljs-keyword">this</span>.second = ((<span class="hljs-keyword">this</span>.minute + <span class="hljs-built_in">parseInt</span>(<span class="hljs-keyword">this</span>.getMinutes(), <span class="hljs-number">10</span>)) * <span class="hljs-number">60</span>);
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.maxLevel == <span class="hljs-keyword">this</span>.MAX_UNIT_SECONDS)
      <span class="hljs-keyword">this</span>._addSpan(<span class="hljs-keyword">this</span>.secondsMessage);
    <span class="hljs-keyword">this</span>.second = <span class="hljs-keyword">this</span>._addInput(<span class="hljs-string">"dur_sec"</span>, <span class="hljs-keyword">this</span>.second + <span class="hljs-built_in">parseInt</span>(<span class="hljs-keyword">this</span>.getSeconds(), <span class="hljs-number">10</span>));
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.maxLevel == <span class="hljs-keyword">this</span>.MAX_UNIT_SECONDS)
      <span class="hljs-keyword">this</span>.second.maxLength = <span class="hljs-string">"10"</span>;
  },
  <span class="hljs-attr">_addInput</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">id, value</span>) </span>{
    <span class="hljs-keyword">var</span> ic = cel(<span class="hljs-string">"input"</span>, <span class="hljs-keyword">this</span>.parent);
    ic.className = <span class="hljs-string">'filerTableInput form-control'</span>;
    ic.id = id;
    ic.size = <span class="hljs-string">"2"</span>;
    ic.maxLength = <span class="hljs-string">"2"</span>;
    ic.value = value;
    <span class="hljs-keyword">return</span> ic;
  },
  <span class="hljs-attr">_addSpan</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">text</span>) </span>{
    <span class="hljs-keyword">var</span> sp = cel(<span class="hljs-string">"label"</span>, <span class="hljs-keyword">this</span>.parent);
    sp.className = <span class="hljs-string">'condition'</span>;
    sp.innerHTML = text;
  },
  <span class="hljs-attr">getDays</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>];
  },
  <span class="hljs-attr">getHours</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.values[<span class="hljs-number">1</span>];
  },
  <span class="hljs-attr">getMinutes</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.values[<span class="hljs-number">2</span>];
  },
  <span class="hljs-attr">getSeconds</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.values[<span class="hljs-number">3</span>];
  },
  <span class="hljs-attr">getValue</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> day = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">var</span> hour = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">var</span> min = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">var</span> sec = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.maxLevel == <span class="hljs-keyword">this</span>.MAX_UNIT_DAYS)
      day = <span class="hljs-built_in">parseInt</span>(<span class="hljs-keyword">this</span>.days.value, <span class="hljs-number">10</span>);
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.maxLevel &gt;= <span class="hljs-keyword">this</span>.MAX_UNIT_HOURS)
      hour = <span class="hljs-built_in">parseInt</span>(<span class="hljs-keyword">this</span>.hour.value, <span class="hljs-number">10</span>);
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.maxLevel &gt;= <span class="hljs-keyword">this</span>.MAX_UNIT_MINUTES)
      min = <span class="hljs-built_in">parseInt</span>(<span class="hljs-keyword">this</span>.minute.value, <span class="hljs-number">10</span>);
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.maxLevel &gt;= <span class="hljs-keyword">this</span>.MAX_UNIT_SECONDS)
      sec = <span class="hljs-built_in">parseInt</span>(<span class="hljs-keyword">this</span>.second.value, <span class="hljs-number">10</span>);
    <span class="hljs-keyword">if</span> (sec &gt;= <span class="hljs-number">60</span>) {
      min += <span class="hljs-built_in">Math</span>.floor(sec / <span class="hljs-number">60</span>);
      sec = sec % <span class="hljs-number">60</span>;
    }
    <span class="hljs-keyword">if</span> (min &gt;= <span class="hljs-number">60</span>) {
      hour += <span class="hljs-built_in">Math</span>.floor(min / <span class="hljs-number">60</span>);
      min = min % <span class="hljs-number">60</span>;
    }
    <span class="hljs-keyword">if</span> (hour &gt;= <span class="hljs-number">24</span>) {
      day += <span class="hljs-built_in">Math</span>.floor(hour / <span class="hljs-number">24</span>);
      hour = hour % <span class="hljs-number">24</span>;
    }
    <span class="hljs-keyword">if</span> (!day || day == <span class="hljs-literal">null</span>)
      day = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">if</span> (!hour || hour == <span class="hljs-literal">null</span>)
      hour = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">if</span> (!min || min == <span class="hljs-literal">null</span>)
      min = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">if</span> (!sec || sec == <span class="hljs-literal">null</span>)
      sec = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>] = day + <span class="hljs-string">''</span>;
    <span class="hljs-keyword">this</span>.values[<span class="hljs-number">1</span>] = hour + <span class="hljs-string">''</span>;
    <span class="hljs-keyword">this</span>.values[<span class="hljs-number">2</span>] = min + <span class="hljs-string">''</span>;
    <span class="hljs-keyword">this</span>.values[<span class="hljs-number">3</span>] = sec + <span class="hljs-string">''</span>;
    <span class="hljs-keyword">return</span> day + <span class="hljs-string">" "</span> + hour + <span class="hljs-string">":"</span> + min + <span class="hljs-string">":"</span> + sec;
  },
  <span class="hljs-attr">_parseMaxUnit</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">max_unit</span>) </span>{
    <span class="hljs-keyword">switch</span> (max_unit) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">'hours'</span>:
        maxLevel = <span class="hljs-keyword">this</span>.MAX_UNIT_HOURS;
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">'minutes'</span>:
        maxLevel = <span class="hljs-keyword">this</span>.MAX_UNIT_MINUTES;
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">'seconds'</span>:
        maxLevel = <span class="hljs-keyword">this</span>.MAX_UNIT_SECONDS;
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">default</span>:
        maxLevel = <span class="hljs-keyword">this</span>.MAX_UNIT_DAYS;
    }
    <span class="hljs-keyword">return</span> maxLevel;
  }
});;
<span class="hljs-comment">/*! RESOURCE: /scripts/classes/GlideFilterReference.js */</span>
<span class="hljs-keyword">var</span> GlideFilterReference = Class.create(GlideFilterHandler, {
  <span class="hljs-attr">_setup</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">values</span>) </span>{
    <span class="hljs-keyword">this</span>.maxValues = <span class="hljs-number">1</span>;
    <span class="hljs-keyword">this</span>.tableField = <span class="hljs-keyword">this</span>.tr.tableField;
    <span class="hljs-keyword">this</span>.id = <span class="hljs-keyword">this</span>.tableField + <span class="hljs-string">"."</span> + guid();
    <span class="hljs-keyword">this</span>.listenForOperChange = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">this</span>.rightOperand = values;
  },
  <span class="hljs-attr">_initValues</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">values</span>) </span>{
    <span class="hljs-keyword">this</span>.values = [];
    <span class="hljs-keyword">if</span> (values)
      <span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>] = values;
  },
  <span class="hljs-attr">_build</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    clearNodes(<span class="hljs-keyword">this</span>.tr.tdValue);
    <span class="hljs-keyword">var</span> inDoctypeMode = (<span class="hljs-built_in">document</span>.documentElement.getAttribute(<span class="hljs-string">'data-doctype'</span>) == <span class="hljs-string">'true'</span>);
    <span class="hljs-keyword">this</span>.inputCnt = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._isEmptyOper())
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">var</span> op = <span class="hljs-keyword">this</span>._getOperator();
    <span class="hljs-keyword">var</span> input = <span class="hljs-keyword">this</span>._addTextInput(<span class="hljs-string">"hidden"</span>);
    input.id = <span class="hljs-keyword">this</span>.id;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._renderRightOperandAsFieldList(op)) {
      <span class="hljs-keyword">this</span>._addSameAsLabels(<span class="hljs-keyword">this</span>, op);
      <span class="hljs-keyword">this</span>._populateRightOperandChoices();
      <span class="hljs-keyword">return</span>;
    }
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._renderDynamicOperandInput(op))
      <span class="hljs-keyword">return</span>;
    input = <span class="hljs-keyword">this</span>._addTextInput();
    input.id = <span class="hljs-string">"sys_display."</span> + <span class="hljs-keyword">this</span>.id;
    input.onfocus = <span class="hljs-keyword">this</span>._onFocus.bind(<span class="hljs-keyword">this</span>);
    input.onkeydown = <span class="hljs-keyword">this</span>._onKeyDown.bindAsEventListener(<span class="hljs-keyword">this</span>);
    input.onkeypress = <span class="hljs-keyword">this</span>._onKeyPress.bindAsEventListener(<span class="hljs-keyword">this</span>);
    input.onkeyup = <span class="hljs-keyword">this</span>._onKeyUp.bindAsEventListener(<span class="hljs-keyword">this</span>);
    input.autocomplete = <span class="hljs-string">"off"</span>;
    input.ac_columns = <span class="hljs-string">""</span>;
    input.ac_order_by = <span class="hljs-string">""</span>;
    <span class="hljs-keyword">if</span> (inDoctypeMode) {
      input.setAttribute(<span class="hljs-string">"class"</span>, <span class="hljs-string">"pull-left form-control filter-reference-input"</span>);
    }
    setAttributeValue(input, <span class="hljs-string">'autocomplete'</span>, <span class="hljs-string">'off'</span>);
    <span class="hljs-keyword">var</span> displayValue = gel(<span class="hljs-string">'fancy.'</span> + <span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>]);
    <span class="hljs-keyword">if</span> (displayValue &amp;&amp; displayValue.value != <span class="hljs-string">''</span>)
      <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>].value = displayValue.value;
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.values) {
      <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>].value = <span class="hljs-keyword">this</span>.values;
      <span class="hljs-keyword">this</span>._resolveReference();
    }
    <span class="hljs-keyword">var</span> view = $$(<span class="hljs-string">"[name='sysparm_view']"</span>)[<span class="hljs-number">0</span>];
    <span class="hljs-keyword">if</span> (view &amp;&amp; (view.value == <span class="hljs-string">"sys_ref_list"</span>))
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">if</span> (inDoctypeMode) {
      <span class="hljs-keyword">var</span> btn = cel(<span class="hljs-string">"button"</span>);
      btn.setAttribute(<span class="hljs-string">"class"</span>, <span class="hljs-string">"icon-search btn btn-default filerTableAction"</span>);
      btn.setAttribute(<span class="hljs-string">"style"</span>, <span class="hljs-string">"margin-left: 2px"</span>);
      btn.onclick = <span class="hljs-keyword">this</span>._refListOpen.bindAsEventListener(<span class="hljs-keyword">this</span>);
      <span class="hljs-keyword">this</span>.tr.tdValue.style.minWidth = <span class="hljs-string">"200px"</span>;
      <span class="hljs-keyword">this</span>.tr.tdValue.appendChild(btn);
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">var</span> image = createImage(<span class="hljs-string">"images/reference_list.gifx"</span>, <span class="hljs-string">"Lookup using list"</span>, <span class="hljs-keyword">this</span>, <span class="hljs-keyword">this</span>._refListOpen);
      image.setAttribute(<span class="hljs-string">"class"</span>, <span class="hljs-string">"filerTableAction"</span>);
      <span class="hljs-keyword">this</span>.tr.tdValue.appendChild(image);
    }
  },
  <span class="hljs-attr">_refListOpen</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    reflistOpen(<span class="hljs-keyword">this</span>.id, <span class="hljs-keyword">this</span>.item.getName(), <span class="hljs-keyword">this</span>.item.getReference());
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  },
  <span class="hljs-attr">getValues</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>._clearValues();
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._isEmptyOper())
      <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>;
    <span class="hljs-keyword">var</span> oper = <span class="hljs-keyword">this</span>._getOperator();
    <span class="hljs-keyword">var</span> input = <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">0</span>];
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.inputCnt == <span class="hljs-number">2</span>) {
      <span class="hljs-keyword">var</span> userInput = <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>];
      <span class="hljs-keyword">var</span> userInputVal = userInput.value;
      <span class="hljs-keyword">if</span> (userInputVal != <span class="hljs-literal">null</span> &amp;&amp; (userInputVal.indexOf(<span class="hljs-string">"javascript:"</span>) &gt; <span class="hljs-number">-1</span>))
        input = userInput;
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._useDisplayValue(oper)) {
        input = userInput;
      }
    }
    <span class="hljs-keyword">if</span> (input) {
      <span class="hljs-keyword">return</span> input.value;
    } <span class="hljs-keyword">else</span>
      <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>;
  },
  <span class="hljs-attr">_useDisplayValue</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">oper</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.item.getType() != <span class="hljs-string">'glide_list'</span> &amp;&amp; oper != <span class="hljs-string">'='</span> &amp;&amp; oper != <span class="hljs-string">'!='</span> &amp;&amp; oper != <span class="hljs-string">"CHANGESFROM"</span> &amp;&amp; oper != <span class="hljs-string">"CHANGESTO"</span>;
  },
  <span class="hljs-attr">_resolveReference</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>]) {
      <span class="hljs-keyword">var</span> ajax = <span class="hljs-keyword">new</span> GlideAjax(<span class="hljs-string">"ResolveRef"</span>);
      ajax.addParam(<span class="hljs-string">"sysparm_name"</span>, <span class="hljs-keyword">this</span>.tableField);
      ajax.addParam(<span class="hljs-string">"sysparm_value"</span>, <span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>]);
      ajax.getXML(<span class="hljs-keyword">this</span>._resolveReferenceResponse.bind(<span class="hljs-keyword">this</span>));
    }
  },
  <span class="hljs-attr">_resolveReferenceResponse</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">request</span>) </span>{
    <span class="hljs-keyword">if</span> (!request)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">var</span> xml = request.responseXML;
    <span class="hljs-keyword">if</span> (!xml)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">if</span> (xml) {
      <span class="hljs-keyword">var</span> items = xml.getElementsByTagName(<span class="hljs-string">"item"</span>);
      <span class="hljs-keyword">if</span> (items &amp;&amp; items.length &gt; <span class="hljs-number">0</span> &amp;&amp; items[<span class="hljs-number">0</span>] &amp;&amp; <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>])
        <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>].value = items[<span class="hljs-number">0</span>].getAttribute(<span class="hljs-string">"label"</span>);
    }
  },
  <span class="hljs-attr">_onFocus</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">evt</span>) </span>{
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>].ac) {
      <span class="hljs-keyword">var</span> partialSearchFilterTypes = <span class="hljs-string">',STARTSWITH,ENDSWITH,LIKE,NOT LIKE,'</span>;
      <span class="hljs-keyword">var</span> tdOper = <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>].up(<span class="hljs-number">1</span>).tdOper;
      <span class="hljs-keyword">var</span> currentFilterType = (tdOper.firstElementChild || tdOper.children[<span class="hljs-number">0</span>] || {}).value;
      <span class="hljs-keyword">if</span> (partialSearchFilterTypes.indexOf(<span class="hljs-string">','</span> + currentFilterType + <span class="hljs-string">','</span>) &gt; <span class="hljs-number">-1</span>)
        <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>].setAttribute(<span class="hljs-string">'is_filter_using_contains'</span>, <span class="hljs-string">'true'</span>);
      <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>].ac = <span class="hljs-keyword">new</span> AJAXReferenceCompleter(<span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>], <span class="hljs-keyword">this</span>.id, <span class="hljs-string">''</span>);
      <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>].ac.elementName = <span class="hljs-keyword">this</span>.tableField;
      <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>].ac.clearDerivedFields = <span class="hljs-literal">true</span>;
      <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>].ac.setIgnoreRefQual(<span class="hljs-literal">true</span>);
    }
  },
  <span class="hljs-attr">_onKeyDown</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">evt</span>) </span>{
    <span class="hljs-keyword">return</span> acReferenceKeyDown(<span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>], evt);
  },
  <span class="hljs-attr">_onKeyPress</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">evt</span>) </span>{
    <span class="hljs-keyword">return</span> acReferenceKeyPress(<span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>], evt);
  },
  <span class="hljs-attr">_onKeyUp</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">evt</span>) </span>{
    <span class="hljs-keyword">return</span> acReferenceKeyUp(<span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>], evt);
  },
  <span class="hljs-attr">z</span>: <span class="hljs-literal">null</span>
});;
<span class="hljs-comment">/*! RESOURCE: /scripts/classes/GlideFilterVariables.js */</span>
<span class="hljs-keyword">var</span> GlideFilterVariables = Class.create(GlideFilterHandler, {
  <span class="hljs-attr">_setup</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">values</span>) </span>{
    <span class="hljs-keyword">this</span>.maxValues = <span class="hljs-number">1</span>;
    <span class="hljs-keyword">this</span>.id = <span class="hljs-keyword">this</span>.tr.tableField + <span class="hljs-string">"."</span> + guid();
    <span class="hljs-keyword">this</span>.catID = <span class="hljs-string">"item_option_new.cat_item."</span> + guid();
    <span class="hljs-keyword">this</span>.listenForOperChange = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">this</span>.rightOperand = values;
  },
  <span class="hljs-attr">_initValues</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">values</span>) </span>{
    <span class="hljs-keyword">this</span>.values = [];
    <span class="hljs-keyword">this</span>.varValue = <span class="hljs-string">''</span>;
    <span class="hljs-keyword">if</span> (values) {
      <span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>] = values.substring(<span class="hljs-number">0</span>, <span class="hljs-number">32</span>);
      <span class="hljs-keyword">this</span>.refQuery = values.substring(<span class="hljs-number">32</span>);
      <span class="hljs-keyword">var</span> query = <span class="hljs-keyword">new</span> GlideEncodedQuery(<span class="hljs-keyword">this</span>.tableName, <span class="hljs-string">"IO:"</span> + <span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>] + <span class="hljs-keyword">this</span>.refQuery, <span class="hljs-literal">null</span>);
      query.parse();
      <span class="hljs-keyword">var</span> terms = query.getTerms();
      <span class="hljs-keyword">var</span> term = terms[<span class="hljs-number">0</span>];
      <span class="hljs-keyword">this</span>.varOp = term.getOperator();
      <span class="hljs-keyword">this</span>.varValue = term.getValue();
    }
  },
  <span class="hljs-attr">_build</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>.queryID = <span class="hljs-keyword">this</span>.tr.tdValue.queryID;
    clearNodes(<span class="hljs-keyword">this</span>.tr.tdValue);
    <span class="hljs-keyword">this</span>.inputCnt = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._isEmptyOper())
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">this</span>._hideOperators();
    <span class="hljs-keyword">var</span> input = <span class="hljs-keyword">this</span>._addTextInput(<span class="hljs-string">"hidden"</span>);
    input.id = <span class="hljs-keyword">this</span>.id;
    input = <span class="hljs-keyword">this</span>._addTextInput();
    input.id = <span class="hljs-string">"sys_display."</span> + <span class="hljs-keyword">this</span>.id;
    input.onfocus = <span class="hljs-keyword">this</span>._onFocus.bind(<span class="hljs-keyword">this</span>);
    input.onRefPick = <span class="hljs-keyword">this</span>._onFocus.bind(<span class="hljs-keyword">this</span>);
    input.onkeydown = <span class="hljs-keyword">this</span>._onKeyDown.bindAsEventListener(<span class="hljs-keyword">this</span>);
    input.onkeypress = <span class="hljs-keyword">this</span>._onKeyPress.bindAsEventListener(<span class="hljs-keyword">this</span>);
    input.onkeyup = <span class="hljs-keyword">this</span>._onKeyUp.bindAsEventListener(<span class="hljs-keyword">this</span>);
    input.autocomplete = <span class="hljs-string">"off"</span>;
    input.data_completer = <span class="hljs-string">"AJAXTableCompleter"</span>;
    input.ac_columns = <span class="hljs-string">"cat_item;category"</span>;
    input.ac_order_by = <span class="hljs-string">""</span>;
    input.placeholder = getMessage(<span class="hljs-string">"Select Variable"</span>);
    setAttributeValue(input, <span class="hljs-string">'autocomplete'</span>, <span class="hljs-string">'off'</span>);
    <span class="hljs-keyword">var</span> displayValue = gel(<span class="hljs-string">'fancy.'</span> + <span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>]);
    <span class="hljs-keyword">if</span> (displayValue &amp;&amp; displayValue.value != <span class="hljs-string">''</span>)
      <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>].value = displayValue.value;
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.values) {
      <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>].value = <span class="hljs-keyword">this</span>.values;
      <span class="hljs-keyword">this</span>._resolveReference();
    }
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">document</span>.documentElement.getAttribute(<span class="hljs-string">'data-doctype'</span>) == <span class="hljs-string">'true'</span>) {
      <span class="hljs-keyword">var</span> btn = cel(<span class="hljs-string">"button"</span>);
      btn.setAttribute(<span class="hljs-string">"class"</span>, <span class="hljs-string">"icon-search btn btn-default filerTableAction"</span>);
      btn.onclick = <span class="hljs-keyword">this</span>._refListOpen.bindAsEventListener(<span class="hljs-keyword">this</span>);
      <span class="hljs-keyword">this</span>.tr.tdValue.appendChild(btn);
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">var</span> image = createImage(<span class="hljs-string">"images/reference_list.gifx"</span>, <span class="hljs-string">"Lookup using list"</span>, <span class="hljs-keyword">this</span>, <span class="hljs-keyword">this</span>._refListOpen);
      image.setAttribute(<span class="hljs-string">"class"</span>, <span class="hljs-string">"filerTableAction"</span>)
      <span class="hljs-keyword">this</span>.tr.tdValue.appendChild(image);
    }
    <span class="hljs-keyword">this</span>._buildCatItemReference();
    <span class="hljs-keyword">this</span>._makeCatItemFirst();
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>])
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">this</span>._getVariableType(<span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>]);
  },
  <span class="hljs-attr">_buildCatItemReference</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> queryID = <span class="hljs-keyword">this</span>.queryID;
    td = <span class="hljs-keyword">this</span>.tr.conditionRow.addTD(<span class="hljs-keyword">this</span>.tr, queryID);
    td.nowrap = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">this</span>.tr.catTD = td;
    <span class="hljs-keyword">var</span> input = <span class="hljs-keyword">this</span>._addTextInput(<span class="hljs-string">"hidden"</span>, td);
    input.id = <span class="hljs-keyword">this</span>.catID;
    input = <span class="hljs-keyword">this</span>._addTextInput(<span class="hljs-string">""</span>, td);
    input.id = <span class="hljs-string">"sys_display."</span> + <span class="hljs-keyword">this</span>.catID;
    input.onfocus = <span class="hljs-keyword">this</span>._onFocusCat.bind(<span class="hljs-keyword">this</span>);
    input.onRefPick = <span class="hljs-keyword">this</span>._onFocusCat.bind(<span class="hljs-keyword">this</span>);
    input.onkeydown = <span class="hljs-keyword">this</span>._onKeyDownCat.bindAsEventListener(<span class="hljs-keyword">this</span>);
    input.onkeypress = <span class="hljs-keyword">this</span>._onKeyPressCat.bindAsEventListener(<span class="hljs-keyword">this</span>);
    input.onkeyup = <span class="hljs-keyword">this</span>._onKeyUpCat.bindAsEventListener(<span class="hljs-keyword">this</span>);
    input.autocomplete = <span class="hljs-string">"off"</span>;
    input.data_completer = <span class="hljs-string">"AJAXTableCompleter"</span>;
    input.ac_columns = <span class="hljs-string">"cat_item;category"</span>;
    input.ac_order_by = <span class="hljs-string">""</span>;
    input.placeholder = getMessage(<span class="hljs-string">"Select Item"</span>);
    setAttributeValue(input, <span class="hljs-string">'autocomplete'</span>, <span class="hljs-string">'off'</span>);
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">document</span>.documentElement.getAttribute(<span class="hljs-string">'data-doctype'</span>) == <span class="hljs-string">'true'</span>) {
      <span class="hljs-keyword">var</span> btn = cel(<span class="hljs-string">"button"</span>);
      btn.setAttribute(<span class="hljs-string">"class"</span>, <span class="hljs-string">"icon-search btn btn-default filerTableAction"</span>);
      btn.onclick = <span class="hljs-keyword">this</span>._refListOpenCat.bindAsEventListener(<span class="hljs-keyword">this</span>);
      td.addClassName(<span class="hljs-string">"form-inline"</span>);
      td.appendChild(btn);
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">var</span> image = createImage(<span class="hljs-string">"images/reference_list.gifx"</span>, <span class="hljs-string">"Lookup using list"</span>, <span class="hljs-keyword">this</span>, <span class="hljs-keyword">this</span>._refListOpenCat);
      image.setAttribute(<span class="hljs-string">"class"</span>, <span class="hljs-string">"filerTableAction"</span>);
      td.appendChild(image);
    }
  },
  <span class="hljs-attr">destroy</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>.inputCnt = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.tr) {
      <span class="hljs-keyword">this</span>.tr.tdValue.innerHTML = <span class="hljs-string">""</span>;
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.tr.variableID) {
        <span class="hljs-keyword">this</span>.tr.removeChild(<span class="hljs-keyword">this</span>.tr.variableID);
        <span class="hljs-keyword">this</span>.tr.variableID = <span class="hljs-literal">null</span>;
      }
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.tr.catTD) {
        <span class="hljs-keyword">this</span>.tr.removeChild(<span class="hljs-keyword">this</span>.tr.catTD);
        <span class="hljs-keyword">this</span>.tr.catTD = <span class="hljs-literal">null</span>;
      }
      <span class="hljs-keyword">var</span> td = <span class="hljs-keyword">this</span>.tr.tdOper;
      <span class="hljs-keyword">if</span> (td)
        td.style.display = <span class="hljs-string">"inline"</span>;
    }
    GlideFilterHandler.prototype.destroy.call(<span class="hljs-keyword">this</span>);
  },
  <span class="hljs-attr">setOriginalTable</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">tableName</span>) </span>{
    <span class="hljs-keyword">this</span>.originalTableName = tableName;
  },
  <span class="hljs-attr">_hideOperators</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.tr.tdOper)
      <span class="hljs-keyword">this</span>.tr.tdOper.style.display = <span class="hljs-string">"none"</span>;
  },
  <span class="hljs-attr">_refListOpen</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.values[<span class="hljs-number">2</span>])
      reflistOpen(<span class="hljs-keyword">this</span>.id, <span class="hljs-keyword">this</span>.item.getName(), <span class="hljs-keyword">this</span>.item.getReference(), <span class="hljs-string">""</span>, <span class="hljs-literal">false</span>, <span class="hljs-string">""</span>, <span class="hljs-string">"cat_item="</span> + <span class="hljs-keyword">this</span>.variableRefQual);
    <span class="hljs-keyword">else</span>
      reflistOpen(<span class="hljs-keyword">this</span>.id, <span class="hljs-keyword">this</span>.item.getName(), <span class="hljs-keyword">this</span>.item.getReference());
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  },
  <span class="hljs-attr">_refListOpenCat</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    reflistOpen(<span class="hljs-keyword">this</span>.catID, <span class="hljs-string">"cat_item"</span>, <span class="hljs-string">"sc_cat_item"</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  },
  <span class="hljs-attr">getValues</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>._clearValues();
    <span class="hljs-keyword">var</span> oper = <span class="hljs-keyword">this</span>._getOperator();
    <span class="hljs-keyword">var</span> input = <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">0</span>];
    <span class="hljs-keyword">if</span> (input) {
      <span class="hljs-keyword">return</span> input.value;
    } <span class="hljs-keyword">else</span>
      <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>;
  },
  <span class="hljs-attr">getFilterText</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">oper</span>) </span>{
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.variableFilter)
      <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-string">"variables."</span> + <span class="hljs-keyword">this</span>.getValues() + oper + <span class="hljs-keyword">this</span>.variableFilter.getValues();
  },
  <span class="hljs-attr">_useDisplayValue</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">oper</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.item.getType() != <span class="hljs-string">'glide_list'</span> &amp;&amp; oper != <span class="hljs-string">'='</span> &amp;&amp; oper != <span class="hljs-string">'!='</span> &amp;&amp; oper != <span class="hljs-string">"CHANGESFROM"</span> &amp;&amp; oper != <span class="hljs-string">"CHANGESTO"</span>;
  },
  <span class="hljs-attr">_resolveReference</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>]) {
      <span class="hljs-keyword">var</span> ajax = <span class="hljs-keyword">new</span> GlideAjax(<span class="hljs-string">"ResolveRef"</span>);
      ajax.addParam(<span class="hljs-string">"sysparm_name"</span>, <span class="hljs-keyword">this</span>.tr.tableField);
      ajax.addParam(<span class="hljs-string">"sysparm_value"</span>, <span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>]);
      ajax.getXML(<span class="hljs-keyword">this</span>._resolveReferenceResponse.bind(<span class="hljs-keyword">this</span>));
    }
  },
  <span class="hljs-attr">_resolveReferenceResponse</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">request</span>) </span>{
    <span class="hljs-keyword">if</span> (!request)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">var</span> xml = request.responseXML;
    <span class="hljs-keyword">if</span> (!xml)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">if</span> (xml) {
      <span class="hljs-keyword">var</span> items = xml.getElementsByTagName(<span class="hljs-string">"item"</span>);
      <span class="hljs-keyword">if</span> (items &amp;&amp; items.length &gt; <span class="hljs-number">0</span> &amp;&amp; items[<span class="hljs-number">0</span>] &amp;&amp; <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>])
        <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>].value = items[<span class="hljs-number">0</span>].getAttribute(<span class="hljs-string">"label"</span>);
    }
  },
  <span class="hljs-attr">_resolveReferenceCat</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.values[<span class="hljs-number">2</span>]) {
      <span class="hljs-keyword">var</span> ajax = <span class="hljs-keyword">new</span> GlideAjax(<span class="hljs-string">"ResolveRef"</span>);
      ajax.addParam(<span class="hljs-string">"sysparm_name"</span>, <span class="hljs-string">"item_option_new.cat_item"</span>);
      ajax.addParam(<span class="hljs-string">"sysparm_value"</span>, <span class="hljs-keyword">this</span>.values[<span class="hljs-number">2</span>]);
      ajax.getXML(<span class="hljs-keyword">this</span>._resolveReferenceResponseCat.bind(<span class="hljs-keyword">this</span>));
    }
  },
  <span class="hljs-attr">_resolveReferenceResponseCat</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">request</span>) </span>{
    <span class="hljs-keyword">if</span> (!request)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">var</span> xml = request.responseXML;
    <span class="hljs-keyword">if</span> (!xml)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">if</span> (xml) {
      <span class="hljs-keyword">var</span> items = xml.getElementsByTagName(<span class="hljs-string">"item"</span>);
      <span class="hljs-keyword">if</span> (items &amp;&amp; items.length &gt; <span class="hljs-number">0</span> &amp;&amp; items[<span class="hljs-number">0</span>]) {
        <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">3</span>].value = items[<span class="hljs-number">0</span>].getAttribute(<span class="hljs-string">"label"</span>);
        <span class="hljs-keyword">this</span>.values[<span class="hljs-number">3</span>] = <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">3</span>].value;
      }
    }
  },
  <span class="hljs-attr">_onFocus</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">evt</span>) </span>{
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>].ac) {
      <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>].ac = <span class="hljs-keyword">new</span> AJAXTableCompleter(<span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>], <span class="hljs-keyword">this</span>.id, <span class="hljs-string">''</span>);
      <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>].ac.setFilterCallBack(<span class="hljs-keyword">this</span>._refValueChange.bind(<span class="hljs-keyword">this</span>));
      <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>].ac.elementName = <span class="hljs-keyword">this</span>.tr.tableField;
      <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>].ac.setAdditionalValue(<span class="hljs-string">"ac_columns"</span>, <span class="hljs-string">"cat_item;category"</span>);
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.values[<span class="hljs-number">2</span>])
        <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>].ac.setAdditionalValue(<span class="hljs-string">"sysparm_ref_qual"</span>, <span class="hljs-string">"cat_item="</span> + <span class="hljs-keyword">this</span>.variableRefQual);
      <span class="hljs-keyword">else</span>
        <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>].ac.setAdditionalValue(<span class="hljs-string">"sysparm_ref_qual"</span>, <span class="hljs-string">""</span>);
      <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>].ac.clearDerivedFields = <span class="hljs-literal">true</span>;
    }
  },
  <span class="hljs-attr">_refValueChange</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> ref = <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>].ac;
    <span class="hljs-keyword">var</span> e = ref.getKeyElement();
    <span class="hljs-keyword">var</span> id = e.value;
    <span class="hljs-keyword">this</span>._clearQuery();
    <span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>] = id;
    <span class="hljs-keyword">if</span> (id)
      <span class="hljs-keyword">this</span>._getVariableType(id);
  },
  <span class="hljs-attr">_catValueSet</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">catValue</span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.values[<span class="hljs-number">2</span>] == catValue)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">this</span>.values[<span class="hljs-number">2</span>] = catValue;
    <span class="hljs-keyword">this</span>.variableRefQual = catValue;
    <span class="hljs-keyword">this</span>.values[<span class="hljs-number">3</span>] = catValue;
    <span class="hljs-keyword">this</span>._resolveReferenceCat();
    <span class="hljs-keyword">this</span>._setQualifier(<span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>].ac, <span class="hljs-keyword">this</span>.values[<span class="hljs-number">2</span>]);
  },
  <span class="hljs-attr">_refValueChangeCat</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> ref = <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">3</span>].ac;
    <span class="hljs-keyword">var</span> e = ref.getKeyElement();
    <span class="hljs-keyword">var</span> id = e.value;
    <span class="hljs-keyword">this</span>.values[<span class="hljs-number">2</span>] = id;
    <span class="hljs-keyword">this</span>.variableRefQual = id;
    <span class="hljs-keyword">this</span>._clearVariable();
    <span class="hljs-keyword">this</span>._hideOperators();
    <span class="hljs-keyword">this</span>._clearHandler();
    <span class="hljs-keyword">this</span>._filterVariableReference();
  },
  <span class="hljs-attr">_clearVariable</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> e = gel(<span class="hljs-keyword">this</span>.id);
    <span class="hljs-keyword">if</span> (e)
      e.value = <span class="hljs-string">''</span>;
    e = gel(<span class="hljs-string">"sys_display."</span> + <span class="hljs-keyword">this</span>.id);
    <span class="hljs-keyword">if</span> (e)
      e.value = <span class="hljs-string">''</span>;
  },
  <span class="hljs-attr">_clearHandler</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.vType)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">this</span>.variableFilter = <span class="hljs-keyword">this</span>._getHandler();
    <span class="hljs-keyword">var</span> conditionRow = <span class="hljs-keyword">this</span>.tr.conditionRow;
    <span class="hljs-keyword">var</span> td = <span class="hljs-keyword">this</span>.tr.tdOper;
    <span class="hljs-keyword">if</span> (td)
      <span class="hljs-keyword">this</span>.tr.removeChild(td);
    <span class="hljs-keyword">this</span>.tr.tdOper = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.tr.tdValue &amp;&amp; <span class="hljs-keyword">this</span>.tr.variableID) {
      <span class="hljs-keyword">this</span>.tr.removeChild(<span class="hljs-keyword">this</span>.tr.tdValue);
      <span class="hljs-keyword">this</span>.tr.tdValue = <span class="hljs-literal">null</span>;
    }
  },
  <span class="hljs-attr">_filterVariableReference</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>._onFocus();
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.values[<span class="hljs-number">2</span>])
      <span class="hljs-keyword">this</span>._setQualifier(<span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>].ac, <span class="hljs-keyword">this</span>.values[<span class="hljs-number">2</span>]);
    <span class="hljs-keyword">else</span>
      <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>].ac.setAdditionalValue(<span class="hljs-string">"sysparm_ref_qual"</span>, <span class="hljs-string">""</span>);
    <span class="hljs-keyword">this</span>._clearQuery();
  },
  <span class="hljs-attr">_setQualifier</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">ac, catItem</span>) </span>{
    <span class="hljs-keyword">if</span> (ac)
      ac.setAdditionalValue(<span class="hljs-string">"sysparm_ref_qual"</span>, <span class="hljs-string">"cat_item="</span> + catItem);
    <span class="hljs-keyword">this</span>._addVariableSets(ac, catItem);
  },
  <span class="hljs-attr">_addVariableSets</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">ac, catItem</span>) </span>{
    <span class="hljs-keyword">var</span> sets = <span class="hljs-keyword">new</span> GlideRecord(<span class="hljs-string">'io_set_item'</span>);
    <span class="hljs-keyword">var</span> callback = <span class="hljs-keyword">this</span>._getSetResponse.bind(<span class="hljs-keyword">this</span>, ac, catItem, sets)
    <span class="hljs-keyword">var</span> fn = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">gr</span>) </span>{
      callback(ac, catItem, sets);
    };
    sets.query(<span class="hljs-string">'sc_cat_item'</span>, catItem, fn);
  },
  <span class="hljs-attr">_getSetResponse</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">ac, catItem, sets</span>) </span>{
    <span class="hljs-keyword">if</span> (!sets.hasNext())
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">var</span> setList = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>();
    <span class="hljs-keyword">while</span> (sets.next())
      setList.push(sets.variable_set + <span class="hljs-string">''</span>);
    <span class="hljs-keyword">this</span>.variableRefQual = catItem + <span class="hljs-string">"^OR"</span> + <span class="hljs-string">"variable_setIN"</span> + setList.join(<span class="hljs-string">","</span>);
    <span class="hljs-keyword">if</span> (ac)
      ac.setAdditionalValue(<span class="hljs-string">"sysparm_ref_qual"</span>, <span class="hljs-string">"cat_item="</span> + <span class="hljs-keyword">this</span>.variableRefQual);
  },
  <span class="hljs-attr">_clearQuery</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>] = <span class="hljs-string">""</span>;
    <span class="hljs-keyword">this</span>.refQuery = <span class="hljs-string">""</span>
    <span class="hljs-keyword">this</span>.varOp = <span class="hljs-string">""</span>
    <span class="hljs-keyword">this</span>.varValue = <span class="hljs-string">""</span>
  },
  <span class="hljs-attr">_getVariableType</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">id</span>) </span>{
    <span class="hljs-keyword">this</span>.grVariable = <span class="hljs-keyword">new</span> GlideRecord(<span class="hljs-string">'item_option_new'</span>);
    <span class="hljs-keyword">var</span> callback = <span class="hljs-keyword">this</span>._getVariableResponse.bind(<span class="hljs-keyword">this</span>)
    <span class="hljs-keyword">var</span> fn = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">gr</span>) </span>{
      callback();
    };
    <span class="hljs-keyword">this</span>.grVariable.query(<span class="hljs-string">'sys_id'</span>, id, fn);
  },
  <span class="hljs-attr">_getVariableResponse</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.grVariable.next()) {
      <span class="hljs-keyword">this</span>.grVariable = <span class="hljs-literal">null</span>;
      <span class="hljs-keyword">this</span>._buildStringType();
    } <span class="hljs-keyword">else</span>
      <span class="hljs-keyword">this</span>._buildType(<span class="hljs-keyword">this</span>.grVariable);
    <span class="hljs-keyword">this</span>._setFilterBasedOnType();
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.grVariable &amp;&amp; <span class="hljs-keyword">this</span>.grVariable.cat_item)
      <span class="hljs-keyword">this</span>._catValueSet(<span class="hljs-keyword">this</span>.grVariable.cat_item);
  },
  <span class="hljs-attr">_buildStringType</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>.vItem = <span class="hljs-keyword">new</span> TableElement(<span class="hljs-string">"string"</span>, <span class="hljs-string">"String"</span>);
    <span class="hljs-keyword">this</span>.vItem.setType(<span class="hljs-string">"string"</span>);
  },
  <span class="hljs-attr">_setFilterBasedOnType</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>.variableFilter = <span class="hljs-keyword">this</span>._getHandler();
    <span class="hljs-keyword">var</span> conditionRow = <span class="hljs-keyword">this</span>.tr.conditionRow;
    <span class="hljs-keyword">var</span> td = <span class="hljs-keyword">this</span>.tr.tdOper;
    <span class="hljs-keyword">if</span> (td)
      <span class="hljs-keyword">this</span>.tr.removeChild(td);
    td = conditionRow.addTD(<span class="hljs-keyword">this</span>.tr, <span class="hljs-keyword">this</span>.queryID);
    conditionRow.tdOper = td;
    td.id = <span class="hljs-string">"oper"</span>;
    <span class="hljs-keyword">this</span>.tr.tdOper = td;
    td.style.width = <span class="hljs-string">"99px"</span>;
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.tr.variableID) {
      <span class="hljs-keyword">this</span>.tr.tdValue.id = <span class="hljs-string">"variableid"</span>;
      <span class="hljs-keyword">this</span>.tr.variableID = <span class="hljs-keyword">this</span>.tr.tdValue;
      <span class="hljs-keyword">this</span>.tr.tdValue = <span class="hljs-literal">null</span>;
    }
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.tr.tdValue)
      <span class="hljs-keyword">this</span>.tr.removeChild(<span class="hljs-keyword">this</span>.tr.tdValue);
    td = conditionRow.addTD(<span class="hljs-keyword">this</span>.tr, <span class="hljs-keyword">this</span>.queryID);
    conditionRow.tdValue = td;
    td.id = <span class="hljs-string">"value"</span>;
    td.noWrap = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">this</span>.tr.tdValue = td;
    <span class="hljs-keyword">this</span>._moveButtons();
    <span class="hljs-keyword">var</span> operSel = addOperators(<span class="hljs-keyword">this</span>.tr.tdOper, <span class="hljs-keyword">this</span>.vType, <span class="hljs-keyword">this</span>.varOp, <span class="hljs-keyword">this</span>.isChoice, <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>);
    <span class="hljs-keyword">this</span>.tr.operSel = operSel;
    <span class="hljs-keyword">var</span> tid = <span class="hljs-keyword">this</span>.tr.tableField;
    <span class="hljs-keyword">this</span>.tr.tableField = <span class="hljs-string">"IO:"</span> + <span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>];
    <span class="hljs-keyword">this</span>.variableFilter.create(<span class="hljs-keyword">this</span>.tr, <span class="hljs-keyword">this</span>.varValue);
    <span class="hljs-keyword">this</span>.tr.tableField = tid;
  },
  <span class="hljs-attr">_makeCatItemFirst</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> td = <span class="hljs-keyword">this</span>.tr.tdValue;
    <span class="hljs-keyword">this</span>.tr.removeChild(td);
    <span class="hljs-keyword">this</span>.tr.appendChild(td);
    <span class="hljs-keyword">this</span>._moveButtons();
  },
  <span class="hljs-attr">_moveButtons</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> td = <span class="hljs-keyword">this</span>.tr.tdOrButton;
    <span class="hljs-keyword">this</span>.tr.removeChild(td);
    <span class="hljs-keyword">this</span>.tr.appendChild(td);
    td = <span class="hljs-keyword">this</span>.tr.tdRemoveButton;
    <span class="hljs-keyword">this</span>.tr.removeChild(td);
    <span class="hljs-keyword">this</span>.tr.appendChild(td);
  },
  <span class="hljs-attr">_buildType</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">gr</span>) </span>{
    <span class="hljs-keyword">this</span>.vItem = <span class="hljs-keyword">new</span> TableElement(gr.type, gr.type);
    <span class="hljs-keyword">if</span> (gr.type == <span class="hljs-string">"1"</span>)
      <span class="hljs-keyword">this</span>.vItem.setType(<span class="hljs-string">"boolean"</span>);
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (gr.type == <span class="hljs-string">"8"</span>) {
      <span class="hljs-keyword">this</span>.vItem.setType(<span class="hljs-string">"reference"</span>);
      <span class="hljs-keyword">this</span>.vItem.setReference(gr.reference);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (gr.type == <span class="hljs-string">"10"</span>) {
      <span class="hljs-keyword">this</span>.vItem.setType(<span class="hljs-string">"calendar"</span>);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (gr.type == <span class="hljs-string">"7"</span>) {
      <span class="hljs-keyword">this</span>.vItem.setType(<span class="hljs-string">"checkbox"</span>);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (gr.type == <span class="hljs-string">"18"</span> || gr.type == <span class="hljs-string">"22"</span> || gr.type == <span class="hljs-string">"3"</span>) {
      <span class="hljs-keyword">this</span>.vItem.setType(<span class="hljs-string">"multiple_choice"</span>);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (gr.type == <span class="hljs-string">"5"</span>) {
      <span class="hljs-keyword">this</span>.vItem.setType(<span class="hljs-string">"select"</span>);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (gr.type == <span class="hljs-string">"4"</span>) {
      <span class="hljs-keyword">this</span>.vItem.setType(<span class="hljs-string">"numeric_scale"</span>);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (gr.type == <span class="hljs-string">"9"</span>) {
      <span class="hljs-keyword">this</span>.vItem.setType(<span class="hljs-string">"calendar"</span>);
    } <span class="hljs-keyword">else</span>
      <span class="hljs-keyword">this</span>._buildStringType();
  },
  <span class="hljs-attr">_getHandler</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.vItem.type == <span class="hljs-string">"boolean"</span>) {
      <span class="hljs-keyword">this</span>.vType = <span class="hljs-string">"boolean"</span>;
      <span class="hljs-keyword">var</span> handler = <span class="hljs-keyword">new</span> GlideFilterChoice(<span class="hljs-keyword">this</span>.tableName, <span class="hljs-keyword">this</span>.item);
      handler.setChoices(sysvalues[<span class="hljs-string">"catalog_boolean"</span>]);
      <span class="hljs-keyword">return</span> handler;
    }
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.vItem.type == <span class="hljs-string">"checkbox"</span>) {
      <span class="hljs-keyword">this</span>.vType = <span class="hljs-string">"boolean"</span>;
      <span class="hljs-keyword">var</span> handler = <span class="hljs-keyword">new</span> GlideFilterChoice(<span class="hljs-keyword">this</span>.tableName, <span class="hljs-keyword">this</span>.item);
      handler.setChoices(sysvalues[<span class="hljs-string">"boolean"</span>]);
      <span class="hljs-keyword">return</span> handler;
    }
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.vItem.type == <span class="hljs-string">"multiple_choice"</span>) {
      <span class="hljs-keyword">this</span>.vType = <span class="hljs-string">"referencechoice"</span>;
      <span class="hljs-keyword">var</span> handler = <span class="hljs-keyword">new</span> GlideFilterVariablesChoiceDynamic(<span class="hljs-string">"var.IO:"</span> + <span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>], <span class="hljs-keyword">this</span>.item);
      <span class="hljs-keyword">return</span> handler;
    }
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.vItem.type == <span class="hljs-string">"select"</span>) {
      <span class="hljs-keyword">this</span>.vType = <span class="hljs-string">"referencechoice"</span>;
      <span class="hljs-keyword">var</span> handler = <span class="hljs-keyword">new</span> GlideFilterVariablesChoiceDynamic(<span class="hljs-string">"var.IO:"</span> + <span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>], <span class="hljs-keyword">this</span>.item);
      <span class="hljs-keyword">return</span> handler;
    }
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.vItem.type == <span class="hljs-string">"numeric_scale"</span>) {
      <span class="hljs-keyword">this</span>.vType = <span class="hljs-string">"integer"</span>;
      <span class="hljs-keyword">this</span>.isChoice = <span class="hljs-literal">true</span>;
      <span class="hljs-keyword">var</span> handler = <span class="hljs-keyword">new</span> GlideFilterVariablesChoiceDynamic(<span class="hljs-string">"var.IO:"</span> + <span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>], <span class="hljs-keyword">this</span>.item);
      <span class="hljs-keyword">return</span> handler;
    }
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.vItem.type == <span class="hljs-string">"reference"</span>) {
      <span class="hljs-keyword">this</span>.vType = <span class="hljs-string">"referencevariable"</span>;
      <span class="hljs-keyword">var</span> handler = <span class="hljs-keyword">new</span> GlideFilterReference(<span class="hljs-string">"var.IO:"</span> + <span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>], <span class="hljs-keyword">this</span>.vItem);
      <span class="hljs-keyword">return</span> handler;
    }
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.vItem.type == <span class="hljs-string">"calendar"</span>) {
      <span class="hljs-keyword">this</span>.vType = <span class="hljs-string">"calendar"</span>;
      <span class="hljs-keyword">var</span> handler = <span class="hljs-keyword">new</span> GlideFilterDate(<span class="hljs-keyword">this</span>.tableName, <span class="hljs-keyword">this</span>.vItem);
      <span class="hljs-keyword">return</span> handler;
    }
    <span class="hljs-keyword">this</span>.vType = <span class="hljs-string">"string"</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> GlideFilterString(<span class="hljs-keyword">this</span>.tableName, <span class="hljs-keyword">this</span>.item);
  },
  <span class="hljs-attr">_onKeyDown</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">evt</span>) </span>{
    <span class="hljs-keyword">return</span> acReferenceKeyDown(<span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>], evt);
  },
  <span class="hljs-attr">_onKeyPress</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">evt</span>) </span>{
    <span class="hljs-keyword">return</span> acReferenceKeyPress(<span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>], evt);
  },
  <span class="hljs-attr">_onKeyUp</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">evt</span>) </span>{
    <span class="hljs-keyword">return</span> acReferenceKeyUp(<span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>], evt);
  },
  <span class="hljs-attr">_onKeyDownCat</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">evt</span>) </span>{
    <span class="hljs-keyword">return</span> acReferenceKeyDown(<span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">3</span>], evt);
  },
  <span class="hljs-attr">_onKeyPressCat</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">evt</span>) </span>{
    <span class="hljs-keyword">return</span> acReferenceKeyPress(<span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">3</span>], evt);
  },
  <span class="hljs-attr">_onKeyUpCat</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">evt</span>) </span>{
    <span class="hljs-keyword">return</span> acReferenceKeyUp(<span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">3</span>], evt);
  },
  <span class="hljs-attr">_onFocusCat</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">evt</span>) </span>{
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">3</span>].ac) {
      <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">3</span>].ac = <span class="hljs-keyword">new</span> AJAXTableCompleter(<span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">3</span>], <span class="hljs-keyword">this</span>.catID, <span class="hljs-string">''</span>);
      <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">3</span>].ac.setFilterCallBack(<span class="hljs-keyword">this</span>._refValueChangeCat.bind(<span class="hljs-keyword">this</span>));
      <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">3</span>].ac.elementName = <span class="hljs-string">"item_option_new.cat_item"</span>;
      <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">3</span>].ac.setAdditionalValue(<span class="hljs-string">"ac_columns"</span>, <span class="hljs-string">"short_description;category"</span>);
      <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">3</span>].ac.setAdditionalValue(<span class="hljs-string">"sysparm_ref_qual"</span>, <span class="hljs-string">"active=true"</span>);
      <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">3</span>].ac.clearDerivedFields = <span class="hljs-literal">true</span>;
    }
  },
  <span class="hljs-attr">z</span>: <span class="hljs-literal">null</span>
});
<span class="hljs-keyword">var</span> GlideFilterVariablesChoiceDynamic = Class.create(GlideFilterChoiceDynamic, {
  <span class="hljs-attr">_getChoices</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> ajax = <span class="hljs-keyword">new</span> GlideAjax(<span class="hljs-string">'PickList'</span>);
    ajax.addParam(<span class="hljs-string">'sysparm_chars'</span>, <span class="hljs-string">'*'</span>);
    ajax.addParam(<span class="hljs-string">'sysparm_nomax'</span>, <span class="hljs-string">'true'</span>);
    ajax.addParam(<span class="hljs-string">'sysparm_name'</span>, <span class="hljs-keyword">this</span>.tableName);
    <span class="hljs-keyword">var</span> response = ajax.getXMLWait();
    <span class="hljs-keyword">this</span>._addChoices(response);
  }
});;
<span class="hljs-comment">/*! RESOURCE: /scripts/classes/GlideFilterQuestions.js */</span>
<span class="hljs-keyword">var</span> GlideFilterQuestions = Class.create(GlideFilterVariables, {
  <span class="hljs-attr">getFilterText</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">oper</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-string">"variablesHASQUESTION:"</span> + <span class="hljs-keyword">this</span>.getValues() + oper + <span class="hljs-keyword">this</span>.variableFilter.getValues();
  },
  <span class="hljs-attr">_refListOpenCat</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    reflistOpen(<span class="hljs-keyword">this</span>.catID, <span class="hljs-string">"cat_item"</span>, <span class="hljs-string">"sc_cat_item_producer"</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  },
  <span class="hljs-attr">_onFocusCat</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">evt</span>) </span>{
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">3</span>].ac) {
      <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">3</span>].ac = <span class="hljs-keyword">new</span> AJAXTableCompleter(<span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">3</span>], <span class="hljs-keyword">this</span>.catID, <span class="hljs-string">''</span>);
      <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">3</span>].ac.setFilterCallBack(<span class="hljs-keyword">this</span>._refValueChangeCat.bind(<span class="hljs-keyword">this</span>));
      <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">3</span>].ac.elementName = <span class="hljs-string">"item_option_new.cat_item"</span>;
      <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">3</span>].ac.setAdditionalValue(<span class="hljs-string">"ac_columns"</span>, <span class="hljs-string">"short_description;category"</span>);
      <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">3</span>].ac.setAdditionalValue(<span class="hljs-string">"sysparm_ref_qual"</span>, <span class="hljs-string">"active=true^sys_class_name=sc_cat_item_producer"</span>);
      <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">3</span>].ac.clearDerivedFields = <span class="hljs-literal">true</span>;
    }
  },
  <span class="hljs-attr">z</span>: <span class="hljs-literal">null</span>
});;
<span class="hljs-comment">/*! RESOURCE: /scripts/classes/GlideFilterItemVariables.js */</span>
<span class="hljs-keyword">var</span> GlideFilterItemVariables = Class.create(GlideFilterVariables, {
  <span class="hljs-attr">getFilterText</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">oper</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-string">"variablesHASITEMVARIABLE:"</span> + <span class="hljs-keyword">this</span>.getValues() + oper + <span class="hljs-keyword">this</span>.variableFilter.getValues();
  },
  <span class="hljs-attr">z</span>: <span class="hljs-literal">null</span>
});;
<span class="hljs-comment">/*! RESOURCE: /scripts/classes/GlideFilterLabels.js */</span>
<span class="hljs-keyword">var</span> GlideFilterLabels = Class.create(GlideFilterHandler, {
  <span class="hljs-attr">_setup</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">values</span>) </span>{
    <span class="hljs-keyword">this</span>.maxValues = <span class="hljs-number">1</span>;
    <span class="hljs-keyword">this</span>.id = <span class="hljs-keyword">this</span>.tr.tableField + <span class="hljs-string">"."</span> + guid();
    <span class="hljs-keyword">this</span>.labID = <span class="hljs-string">"label_entry.label."</span> + guid();
    <span class="hljs-keyword">this</span>.listenForOperChange = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">this</span>.rightOperand = values;
  },
  <span class="hljs-attr">_initValues</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">values</span>) </span>{
    <span class="hljs-keyword">this</span>.values = [];
    <span class="hljs-keyword">this</span>.varValue = <span class="hljs-string">''</span>;
    <span class="hljs-keyword">if</span> (values) {
      <span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>] = values.substring(<span class="hljs-number">0</span>, <span class="hljs-number">32</span>);
      <span class="hljs-keyword">this</span>.refQuery = values.substring(<span class="hljs-number">32</span>);
      <span class="hljs-keyword">this</span>.varValue = <span class="hljs-keyword">this</span>.refQuery;
    }
  },
  <span class="hljs-attr">_build</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>.queryID = <span class="hljs-keyword">this</span>.tr.tdValue.queryID;
    clearNodes(<span class="hljs-keyword">this</span>.tr.tdValue);
    <span class="hljs-keyword">this</span>.inputCnt = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._isEmptyOper())
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">this</span>._hideOperators();
    <span class="hljs-keyword">var</span> inDoctypeMode = (<span class="hljs-built_in">document</span>.documentElement.getAttribute(<span class="hljs-string">'data-doctype'</span>) == <span class="hljs-string">'true'</span>);
    <span class="hljs-keyword">var</span> input = <span class="hljs-keyword">this</span>._addTextInput(<span class="hljs-string">"hidden"</span>);
    input.id = <span class="hljs-keyword">this</span>.labID;
    input = <span class="hljs-keyword">this</span>._addTextInput();
    input.id = <span class="hljs-string">"sys_display."</span> + <span class="hljs-keyword">this</span>.labID;
    input.onfocus = <span class="hljs-keyword">this</span>._onFocus.bind(<span class="hljs-keyword">this</span>);
    input.onRefPick = <span class="hljs-keyword">this</span>._onFocus.bind(<span class="hljs-keyword">this</span>);
    input.onkeydown = <span class="hljs-keyword">this</span>._onKeyDown.bindAsEventListener(<span class="hljs-keyword">this</span>);
    input.onkeypress = <span class="hljs-keyword">this</span>._onKeyPress.bindAsEventListener(<span class="hljs-keyword">this</span>);
    input.onkeyup = <span class="hljs-keyword">this</span>._onKeyUp.bindAsEventListener(<span class="hljs-keyword">this</span>);
    input.autocomplete = <span class="hljs-string">"off"</span>;
    input.data_completer = <span class="hljs-string">"AJAXTableCompleter"</span>;
    input.ac_columns = <span class="hljs-string">"short_description"</span>;
    input.ac_order_by = <span class="hljs-string">""</span>;
    input.placeholder = getMessage(<span class="hljs-string">"Select Label"</span>);
    setAttributeValue(input, <span class="hljs-string">'autocomplete'</span>, <span class="hljs-string">'off'</span>);
    <span class="hljs-keyword">var</span> displayValue = gel(<span class="hljs-string">'fancy.'</span> + <span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>]);
    <span class="hljs-keyword">if</span> (displayValue &amp;&amp; displayValue.value != <span class="hljs-string">''</span>)
      <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>].value = displayValue.value;
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.values) {
      <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>].value = <span class="hljs-keyword">this</span>.values;
      <span class="hljs-keyword">this</span>._resolveReference();
    }
    <span class="hljs-keyword">if</span> (inDoctypeMode) {
      <span class="hljs-keyword">var</span> btn = cel(<span class="hljs-string">"button"</span>);
      btn.setAttribute(<span class="hljs-string">"class"</span>, <span class="hljs-string">"icon-search btn btn-default filerTableAction"</span>);
      btn.setAttribute(<span class="hljs-string">"style"</span>, <span class="hljs-string">"margin-left: 2px"</span>);
      btn.onclick = <span class="hljs-keyword">this</span>._refListOpen.bindAsEventListener(<span class="hljs-keyword">this</span>);
      <span class="hljs-keyword">this</span>.tr.tdValue.appendChild(btn);
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">var</span> image = createImage(<span class="hljs-string">"images/reference_list.gifx"</span>, <span class="hljs-string">"Lookup using list"</span>, <span class="hljs-keyword">this</span>, <span class="hljs-keyword">this</span>._refListOpen);
      image.setAttribute(<span class="hljs-string">"class"</span>, <span class="hljs-string">"filerTableAction"</span>)
      <span class="hljs-keyword">this</span>.tr.tdValue.appendChild(image);
    }
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.varValue)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">this</span>._getVariableType(<span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>]);
  },
  <span class="hljs-attr">destroy</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>.inputCnt = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.tr) {
      <span class="hljs-keyword">this</span>.tr.tdValue.innerHTML = <span class="hljs-string">""</span>;
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.tr.variableID) {
        <span class="hljs-keyword">this</span>.tr.removeChild(<span class="hljs-keyword">this</span>.tr.variableID);
        <span class="hljs-keyword">this</span>.tr.variableID = <span class="hljs-literal">null</span>;
      }
      <span class="hljs-keyword">var</span> td = <span class="hljs-keyword">this</span>.tr.tdOper;
      <span class="hljs-keyword">if</span> (td)
        td.style.display = <span class="hljs-string">"block"</span>;
    }
    GlideFilterHandler.prototype.destroy.call(<span class="hljs-keyword">this</span>);
  },
  <span class="hljs-attr">setOriginalTable</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">tableName</span>) </span>{
    <span class="hljs-keyword">this</span>.originalTableName = tableName;
  },
  <span class="hljs-attr">_hideOperators</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.tr.tdOper)
      <span class="hljs-keyword">this</span>.tr.tdOper.style.display = <span class="hljs-string">"none"</span>;
  },
  <span class="hljs-attr">_refListOpen</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    reflistOpen(<span class="hljs-keyword">this</span>.labID, <span class="hljs-keyword">this</span>.item.getName(), <span class="hljs-string">"label"</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  },
  <span class="hljs-attr">getValues</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>._clearValues();
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._isEmptyOper())
      <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>;
    <span class="hljs-keyword">var</span> oper = <span class="hljs-keyword">this</span>._getOperator();
    <span class="hljs-keyword">var</span> input = <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">0</span>];
    <span class="hljs-keyword">if</span> (input) {
      <span class="hljs-keyword">return</span> input.value;
    } <span class="hljs-keyword">else</span>
      <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>;
  },
  <span class="hljs-attr">getFilterText</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">oper</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-string">"sys_tags."</span> + <span class="hljs-keyword">this</span>.getValues() + <span class="hljs-string">'='</span> + <span class="hljs-keyword">this</span>.getValues();
  },
  <span class="hljs-attr">_useDisplayValue</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">oper</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.item.getType() != <span class="hljs-string">'glide_list'</span> &amp;&amp; oper != <span class="hljs-string">'='</span> &amp;&amp; oper != <span class="hljs-string">'!='</span> &amp;&amp; oper != <span class="hljs-string">"CHANGESFROM"</span> &amp;&amp; oper != <span class="hljs-string">"CHANGESTO"</span>;
  },
  <span class="hljs-attr">_resolveReference</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>]) {
      <span class="hljs-keyword">var</span> ajax = <span class="hljs-keyword">new</span> GlideAjax(<span class="hljs-string">"ResolveRef"</span>);
      ajax.addParam(<span class="hljs-string">"sysparm_name"</span>, <span class="hljs-string">"label_entry.label"</span>);
      ajax.addParam(<span class="hljs-string">"sysparm_value"</span>, <span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>]);
      ajax.getXML(<span class="hljs-keyword">this</span>._resolveReferenceResponse.bind(<span class="hljs-keyword">this</span>));
    }
  },
  <span class="hljs-attr">_resolveReferenceResponse</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">request</span>) </span>{
    <span class="hljs-keyword">if</span> (!request)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">var</span> xml = request.responseXML;
    <span class="hljs-keyword">if</span> (!xml)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">if</span> (xml) {
      <span class="hljs-keyword">var</span> items = xml.getElementsByTagName(<span class="hljs-string">"item"</span>);
      <span class="hljs-keyword">if</span> (items &amp;&amp; items.length &gt; <span class="hljs-number">0</span> &amp;&amp; items[<span class="hljs-number">0</span>] &amp;&amp; <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>])
        <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>].value = items[<span class="hljs-number">0</span>].getAttribute(<span class="hljs-string">"label"</span>);
    }
  },
  <span class="hljs-attr">_onFocus</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">evt</span>) </span>{
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>].ac) {
      <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>].ac = <span class="hljs-keyword">new</span> AJAXTableCompleter(<span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>], <span class="hljs-keyword">this</span>.labID, <span class="hljs-string">''</span>);
      <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>].ac.setFilterCallBack(<span class="hljs-keyword">this</span>._refValueChange.bind(<span class="hljs-keyword">this</span>));
      <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>].ac.elementName = <span class="hljs-string">"label_entry.label"</span>;
      <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>].ac.setAdditionalValue(<span class="hljs-string">"ac_columns"</span>, <span class="hljs-string">"short_description"</span>);
      <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>].ac.clearDerivedFields = <span class="hljs-literal">true</span>;
    }
  },
  <span class="hljs-attr">_refValueChange</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> ref = <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>].ac;
    <span class="hljs-keyword">var</span> e = ref.getKeyElement();
    <span class="hljs-keyword">var</span> id = e.value;
    <span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>] = id;
  },
  <span class="hljs-attr">_moveButtons</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> td = <span class="hljs-keyword">this</span>.tr.tdOrButton;
    <span class="hljs-keyword">this</span>.tr.removeChild(td);
    <span class="hljs-keyword">this</span>.tr.appendChild(td);
    td = <span class="hljs-keyword">this</span>.tr.tdRemoveButton;
    <span class="hljs-keyword">this</span>.tr.removeChild(td);
    <span class="hljs-keyword">this</span>.tr.appendChild(td);
  },
  <span class="hljs-attr">_onKeyDown</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">evt</span>) </span>{
    <span class="hljs-keyword">return</span> acReferenceKeyDown(<span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>], evt);
  },
  <span class="hljs-attr">_onKeyPress</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">evt</span>) </span>{
    <span class="hljs-keyword">return</span> acReferenceKeyPress(<span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>], evt);
  },
  <span class="hljs-attr">_onKeyUp</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">evt</span>) </span>{
    <span class="hljs-keyword">return</span> acReferenceKeyUp(<span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>], evt);
  },
  <span class="hljs-attr">_onKeyDownCat</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">evt</span>) </span>{
    <span class="hljs-keyword">return</span> acReferenceKeyDown(<span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">3</span>], evt);
  },
  <span class="hljs-attr">z</span>: <span class="hljs-literal">null</span>
});;
<span class="hljs-comment">/*! RESOURCE: /scripts/classes/GlideFilterReferenceMulti.js */</span>
<span class="hljs-keyword">var</span> GlideFilterReferenceMulti = Class.create(GlideFilterReference, {
  <span class="hljs-attr">_setup</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">values</span>) </span>{
    <span class="hljs-keyword">this</span>.maxValues = <span class="hljs-number">20</span>;
    <span class="hljs-keyword">this</span>.id = <span class="hljs-keyword">this</span>.tr.tableField + <span class="hljs-string">"."</span> + guid();
    <span class="hljs-keyword">this</span>.listenForOperChange = <span class="hljs-literal">true</span>;
  },
  <span class="hljs-attr">_initAutoCompleter</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>].ac) {
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.item.getReference(<span class="hljs-string">"reference"</span>) == <span class="hljs-string">"sys_user"</span>) {
        $(<span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>]).setAttribute(<span class="hljs-string">'allow_invalid'</span>, <span class="hljs-literal">true</span>)
        $(<span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>]).setAttribute(<span class="hljs-string">'reference'</span>, <span class="hljs-string">"sys_user"</span>);
      }
      <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>].ac = <span class="hljs-keyword">new</span> AJAXReferenceCompleterMulti(<span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>], <span class="hljs-keyword">this</span>.id, <span class="hljs-string">''</span>);
      <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>].ac.elementName = <span class="hljs-keyword">this</span>.tr.tableField;
      <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>].ac.clearDerivedFields = <span class="hljs-literal">true</span>;
    }
  },
  <span class="hljs-attr">_onFocus</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">evt</span>) </span>{
    <span class="hljs-keyword">this</span>._initAutoCompleter();
  },
  <span class="hljs-attr">_resolveReference</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.values) {
      <span class="hljs-keyword">var</span> ajax = <span class="hljs-keyword">new</span> GlideAjax(<span class="hljs-string">"ResolveRefMulti"</span>);
      ajax.addParam(<span class="hljs-string">"sysparm_name"</span>, <span class="hljs-keyword">this</span>.tr.tableField);
      ajax.addParam(<span class="hljs-string">"sysparm_value"</span>, <span class="hljs-keyword">this</span>.values);
      ajax.getXML(<span class="hljs-keyword">this</span>._resolveReferenceResponse.bind(<span class="hljs-keyword">this</span>));
    }
  },
  <span class="hljs-attr">_resolveReferenceResponse</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">request</span>) </span>{
    <span class="hljs-keyword">if</span> (!request)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">var</span> xml = request.responseXML;
    <span class="hljs-keyword">if</span> (!xml)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">if</span> (xml) {
      <span class="hljs-keyword">var</span> items = xml.getElementsByTagName(<span class="hljs-string">"item"</span>);
      <span class="hljs-keyword">if</span> (items &amp;&amp; items.length &gt; <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">this</span>._initAutoCompleter();
        <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>].ac._hash = <span class="hljs-keyword">new</span> Hash();
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; items.length; i++) {
          <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>].ac._hash.set(items[i].getAttribute(<span class="hljs-string">"label"</span>), items[i].getAttribute(<span class="hljs-string">"name"</span>));
        }
        <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>].ac._setFormValues();
      }
    }
  },
  <span class="hljs-attr">getValues</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>._initAutoCompleter();
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.inputs[<span class="hljs-number">1</span>].ac.getKeyValue();
  },
  <span class="hljs-attr">_initValues</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">values</span>) </span>{
    <span class="hljs-keyword">if</span> (!values)
      <span class="hljs-keyword">this</span>.values = [];
    <span class="hljs-keyword">else</span>
      <span class="hljs-keyword">this</span>.values = values;
  }
});;
<span class="hljs-comment">/*! RESOURCE: /scripts/classes/GlideFilterDate.js */</span>
<span class="hljs-keyword">var</span> GlideFilterDate = Class.create(GlideFilterHandler, {
  <span class="hljs-attr">SYS_DATE_FORMAT</span>: <span class="hljs-string">"yyyy-MM-dd"</span>,
  <span class="hljs-attr">SYS_TIME_FORMAT</span>: <span class="hljs-string">"HH:mm:ss"</span>,
  <span class="hljs-attr">SYS_DATE_TIME_FORMAT</span>: <span class="hljs-string">"yyyy-MM-dd HH:mm:ss"</span>,
  <span class="hljs-attr">_setup</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">values</span>) </span>{
    <span class="hljs-keyword">this</span>.maxValues = <span class="hljs-number">4</span>;
    <span class="hljs-keyword">this</span>.listenForOperChange = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">this</span>.userDateFormat = g_user_date_format;
    <span class="hljs-keyword">this</span>.userTimeFormat = g_user_date_time_format.substring(g_user_date_format.length + <span class="hljs-number">1</span>);
    <span class="hljs-keyword">this</span>.userDateTimeFormat = g_user_date_time_format;
    <span class="hljs-keyword">this</span>.id = <span class="hljs-string">"GwtGFD_"</span> + guid();
    <span class="hljs-keyword">this</span>.allowTime = <span class="hljs-keyword">this</span>.item.isDateTime();
  },
  <span class="hljs-attr">_build</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>.ANDMSG = getMessage(<span class="hljs-string">'and'</span>);
    <span class="hljs-keyword">this</span>.FROMMSG = getMessage(<span class="hljs-string">'from'</span>);
    <span class="hljs-keyword">this</span>.ASMSG = getMessage(<span class="hljs-string">'as'</span>);
    clearNodes(<span class="hljs-keyword">this</span>.tr.tdValue);
    <span class="hljs-keyword">this</span>.inputCnt = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._isEmptyOper())
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">var</span> oper = <span class="hljs-keyword">this</span>._getOperator();
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.prevOper &amp;&amp; (<span class="hljs-keyword">this</span>.prevOper != oper))
      <span class="hljs-keyword">this</span>._clearValues();
    <span class="hljs-keyword">switch</span> (oper) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">'SAMEAS'</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-string">'NSAMEAS'</span>:
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.getFilterClass() != <span class="hljs-string">"GlideTemplateFilter"</span>) {
          <span class="hljs-keyword">this</span>._addDateSelect(<span class="hljs-string">"1"</span>, sysvalues[<span class="hljs-string">'calendar'</span>][<span class="hljs-string">'TRENDVALUES_WITH_FIELDS'</span>], <span class="hljs-keyword">this</span>.values[<span class="hljs-number">1</span>], [<span class="hljs-number">1</span>]);
          <span class="hljs-keyword">var</span> span = cel(<span class="hljs-string">"span"</span>, <span class="hljs-keyword">this</span>.tr.tdValue);
          span.style.marginLeft = <span class="hljs-string">"3px"</span>;
          span.style.marginRight = <span class="hljs-string">"5px"</span>;
          <span class="hljs-keyword">if</span> (oper == <span class="hljs-string">'SAMEAS'</span>)
            span.innerHTML = <span class="hljs-keyword">this</span>.ASMSG;
          <span class="hljs-keyword">else</span>
            span.innerHTML = <span class="hljs-keyword">this</span>.FROMMSG;
        }
        <span class="hljs-keyword">this</span>._populateRightOperandChoices();
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">'ON'</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-string">'NOTON'</span>:
        <span class="hljs-keyword">var</span> val = <span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>];
        <span class="hljs-keyword">if</span> (val)
          val += <span class="hljs-string">"@"</span> + <span class="hljs-keyword">this</span>.values[<span class="hljs-number">1</span>] + <span class="hljs-string">"@"</span> + <span class="hljs-keyword">this</span>.values[<span class="hljs-number">2</span>];
        <span class="hljs-keyword">this</span>._addDateChoices(<span class="hljs-string">"1"</span>, val, [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>], <span class="hljs-literal">false</span>);
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">'&lt;'</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-string">'&gt;='</span>:
        <span class="hljs-keyword">var</span> pos = <span class="hljs-number">1</span>;
        <span class="hljs-keyword">this</span>._addDateChoices(<span class="hljs-string">"1"</span>, <span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>], [pos], <span class="hljs-keyword">this</span>.allowTime, <span class="hljs-string">'start'</span>);
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">'&gt;'</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-string">'&lt;='</span>:
        <span class="hljs-keyword">var</span> pos = <span class="hljs-number">3</span>;
        <span class="hljs-keyword">this</span>._addDateChoices(<span class="hljs-string">"1"</span>, <span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>], [pos], <span class="hljs-keyword">this</span>.allowTime, <span class="hljs-string">'end'</span>);
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">'BETWEEN'</span>:
        <span class="hljs-keyword">this</span>._addDateChoices(<span class="hljs-string">"1"</span>, <span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>], [<span class="hljs-number">1</span>], <span class="hljs-keyword">this</span>.allowTime, <span class="hljs-string">'start'</span>);
        <span class="hljs-keyword">var</span> span = cel(<span class="hljs-string">"span"</span>, <span class="hljs-keyword">this</span>.tr.tdValue);
        span.style.marginLeft = <span class="hljs-string">"3px"</span>;
        span.style.marginRight = <span class="hljs-string">"5px"</span>;
        span.className = <span class="hljs-string">"filter-inline-label"</span>;
        span.innerHTML = <span class="hljs-keyword">this</span>.ANDMSG;
        <span class="hljs-keyword">this</span>._addDateChoices(<span class="hljs-string">"2"</span>, <span class="hljs-keyword">this</span>.values[<span class="hljs-number">1</span>], [<span class="hljs-number">3</span>], <span class="hljs-keyword">this</span>.allowTime, <span class="hljs-string">'end'</span>);
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">'DATEPART'</span>:
        <span class="hljs-keyword">var</span> trendOper = <span class="hljs-string">"EE"</span>;
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.values[<span class="hljs-number">1</span>]) {
          <span class="hljs-keyword">var</span> parts = <span class="hljs-keyword">this</span>.values[<span class="hljs-number">1</span>].split(<span class="hljs-string">","</span>);
          <span class="hljs-keyword">if</span> (parts.length == <span class="hljs-number">3</span>)
            trendOper = parts[<span class="hljs-number">2</span>].substring(<span class="hljs-number">1</span>, <span class="hljs-number">3</span>);
        }
        <span class="hljs-keyword">this</span>._addDateSelect(<span class="hljs-string">"1"</span>, sysvalues[<span class="hljs-string">'calendar'</span>][<span class="hljs-string">'RELATIVE'</span>], trendOper, [<span class="hljs-number">1</span>]);
        <span class="hljs-keyword">this</span>._addDateSelect(<span class="hljs-string">"2"</span>, sysvalues[<span class="hljs-string">'calendar'</span>][<span class="hljs-string">'DATEPART'</span>], <span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>], [<span class="hljs-number">0</span>]);
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">'='</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-string">'!='</span>:
        <span class="hljs-keyword">this</span>._addTextInput();
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">'RELATIVE'</span>:
        <span class="hljs-keyword">this</span>._addDateSelect(<span class="hljs-string">"1"</span>, sysvalues[<span class="hljs-string">'calendar'</span>][<span class="hljs-string">'RELATIVE'</span>], <span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>], [<span class="hljs-number">1</span>]);
        <span class="hljs-keyword">var</span> input = <span class="hljs-keyword">this</span>._addTextInput();
        input.value = <span class="hljs-keyword">this</span>.values[<span class="hljs-number">3</span>];
        input.style.width = <span class="hljs-string">"30px"</span>;
        input.maxLength = <span class="hljs-number">5</span>;
        <span class="hljs-keyword">this</span>._addDateSelect(<span class="hljs-string">"2"</span>, sysvalues[<span class="hljs-string">'calendar'</span>][<span class="hljs-string">'TRENDVALUES'</span>], <span class="hljs-keyword">this</span>.values[<span class="hljs-number">1</span>], [<span class="hljs-number">1</span>]);
        <span class="hljs-keyword">this</span>._addDateSelect(<span class="hljs-string">"3"</span>, sysvalues[<span class="hljs-string">'calendar'</span>][<span class="hljs-string">'WHEN'</span>], <span class="hljs-keyword">this</span>.values[<span class="hljs-number">2</span>], [<span class="hljs-number">1</span>]);
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">'MORETHAN'</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-string">'LESSTHAN'</span>:
        <span class="hljs-keyword">var</span> input = <span class="hljs-keyword">this</span>._addTextInput();
        <span class="hljs-keyword">if</span> (<span class="hljs-literal">null</span> == <span class="hljs-keyword">this</span>.values[<span class="hljs-number">3</span>] || <span class="hljs-string">""</span> == <span class="hljs-keyword">this</span>.values[<span class="hljs-number">3</span>])
          <span class="hljs-keyword">this</span>.values[<span class="hljs-number">3</span>] = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">if</span> (isMSIE)
          input.style.marginTop = <span class="hljs-string">"-1px"</span>;
        input.value = <span class="hljs-keyword">this</span>.values[<span class="hljs-number">3</span>];
        input.style.width = <span class="hljs-string">"30px"</span>;
        input.style.marginRight = <span class="hljs-string">"2px"</span>;
        input.maxLength = <span class="hljs-number">2</span>;
        <span class="hljs-keyword">this</span>._addDateSelect(<span class="hljs-string">"2"</span>, sysvalues[<span class="hljs-string">'calendar'</span>][<span class="hljs-string">'TRENDVALUES_WITH_FIELDS_PLURIAL'</span>], <span class="hljs-keyword">this</span>.values[<span class="hljs-number">1</span>], [<span class="hljs-number">1</span>]);
        <span class="hljs-keyword">this</span>._addDateSelect(<span class="hljs-string">"3"</span>, sysvalues[<span class="hljs-string">'calendar'</span>][<span class="hljs-string">'WHEN_WITH_FIELDS'</span>], <span class="hljs-keyword">this</span>.values[<span class="hljs-number">2</span>], [<span class="hljs-number">1</span>]);
        <span class="hljs-keyword">this</span>._populateRightOperandChoices();
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">'SINCE'</span>:
        <span class="hljs-keyword">var</span> s = <span class="hljs-keyword">this</span>._addSelect(<span class="hljs-keyword">this</span>.width, <span class="hljs-keyword">this</span>.multi, <span class="hljs-keyword">this</span>.size);
        s.style.marginRight = <span class="hljs-string">"3px"</span>;
        s.id = <span class="hljs-keyword">this</span>.id + <span class="hljs-string">"_select_1"</span>;
        <span class="hljs-keyword">var</span> base = <span class="hljs-keyword">new</span> GlideRecord(<span class="hljs-string">'cmdb_baseline'</span>);
        base.addOrderBy(<span class="hljs-string">'name'</span>);
        base.query();
        <span class="hljs-keyword">while</span> (base.next()) {
          <span class="hljs-keyword">var</span> selected = <span class="hljs-literal">false</span>;
          <span class="hljs-keyword">var</span> value = <span class="hljs-string">"javascript:getBaseFilter('"</span> + base.name + <span class="hljs-string">"')"</span>;
          <span class="hljs-keyword">if</span> (value == <span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>])
            selected = <span class="hljs-literal">true</span>;
          <span class="hljs-keyword">var</span> o = addOption(s, value, base.name, selected);
        }
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">'ANYTHING'</span>:
        <span class="hljs-keyword">break</span>;
    }
    <span class="hljs-keyword">this</span>.prevOper = oper;
  },
  <span class="hljs-attr">getValues</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.inputCnt == <span class="hljs-number">0</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-string">""</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-keyword">this</span>.maxValues; i++)
      <span class="hljs-keyword">this</span>.values[i] = <span class="hljs-keyword">this</span>._getInputValue(<span class="hljs-keyword">this</span>.inputs[i]);
    <span class="hljs-keyword">switch</span> (<span class="hljs-keyword">this</span>._getOperator()) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">'ON'</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-string">'NOTON'</span>:
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>].indexOf(<span class="hljs-string">'@'</span>) != <span class="hljs-number">-1</span>)
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>];
        <span class="hljs-keyword">var</span> value = <span class="hljs-keyword">this</span>._convertDate(<span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>]);
        <span class="hljs-keyword">return</span> value + <span class="hljs-string">"@"</span> + <span class="hljs-keyword">this</span>._getDateGenerate(value, <span class="hljs-string">'start'</span>) + <span class="hljs-string">"@"</span> + <span class="hljs-keyword">this</span>._getDateGenerate(value, <span class="hljs-string">'end'</span>);
      <span class="hljs-keyword">case</span> <span class="hljs-string">'&lt;'</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-string">'&lt;='</span>:
        <span class="hljs-keyword">var</span> value = <span class="hljs-keyword">this</span>._convertDate(<span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>]);
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._getDateGenerate(value, <span class="hljs-string">'start'</span>);
      <span class="hljs-keyword">case</span> <span class="hljs-string">'&gt;'</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-string">'&gt;='</span>:
        <span class="hljs-keyword">var</span> value = <span class="hljs-keyword">this</span>._convertDate(<span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>]);
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._getDateGenerate(value, <span class="hljs-string">'end'</span>);
      <span class="hljs-keyword">case</span> <span class="hljs-string">'BETWEEN'</span>:
        <span class="hljs-keyword">var</span> start = <span class="hljs-keyword">this</span>._convertDate(<span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>]);
        start = <span class="hljs-keyword">this</span>._getDateGenerate(start, <span class="hljs-string">'start'</span>);
        <span class="hljs-keyword">var</span> end = <span class="hljs-keyword">this</span>._convertDate(<span class="hljs-keyword">this</span>.values[<span class="hljs-number">1</span>]);
        end = <span class="hljs-keyword">this</span>._getDateGenerate(end, <span class="hljs-string">'end'</span>);
        <span class="hljs-keyword">return</span> start + <span class="hljs-string">"@"</span> + end;
      <span class="hljs-keyword">case</span> <span class="hljs-string">'DATEPART'</span>:
        <span class="hljs-keyword">var</span> trendOper = <span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>];
        <span class="hljs-keyword">var</span> datePart = <span class="hljs-keyword">this</span>.values[<span class="hljs-number">1</span>];
        <span class="hljs-keyword">var</span> values = sysvalues[<span class="hljs-string">'calendar'</span>][<span class="hljs-string">'DATEPART'</span>];
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; values.length; i++) {
          <span class="hljs-keyword">if</span> (datePart == values[i][<span class="hljs-number">0</span>]) {
            datePart = values[i][<span class="hljs-number">1</span>];
            <span class="hljs-keyword">break</span>;
          }
        }
        datePart = datePart.split(<span class="hljs-string">")"</span>)[<span class="hljs-number">0</span>] + <span class="hljs-string">",'"</span> + trendOper + <span class="hljs-string">"')"</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.values[<span class="hljs-number">1</span>] + <span class="hljs-string">"@"</span> + datePart;
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">'='</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-string">'!='</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>];
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">'RELATIVE'</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>] + <span class="hljs-string">"@"</span> + <span class="hljs-keyword">this</span>.values[<span class="hljs-number">2</span>] + <span class="hljs-string">"@"</span> + <span class="hljs-keyword">this</span>.values[<span class="hljs-number">3</span>] + <span class="hljs-string">"@"</span> + <span class="hljs-keyword">this</span>.values[<span class="hljs-number">1</span>];
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">'SAMEAS'</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-string">'NSAMEAS'</span>:
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.values[<span class="hljs-number">1</span>] == <span class="hljs-string">""</span>)
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>];
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.values[<span class="hljs-number">1</span>] + <span class="hljs-string">"@"</span> + <span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>];
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">'MORETHAN'</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-string">'LESSTHAN'</span>:
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">isNaN</span>(<span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>]))
          <span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.values[<span class="hljs-number">3</span>] + <span class="hljs-string">"@"</span> + <span class="hljs-keyword">this</span>.values[<span class="hljs-number">1</span>] + <span class="hljs-string">"@"</span> + <span class="hljs-keyword">this</span>.values[<span class="hljs-number">2</span>] + <span class="hljs-string">"@"</span> + <span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>];
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">'SINCE'</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>];
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">'ANYTHING'</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-string">""</span>;
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">default</span>:
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.inputCnt == <span class="hljs-number">1</span>)
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>];
        <span class="hljs-keyword">else</span>
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.values.join(<span class="hljs-string">"@"</span>);
    }
  },
  <span class="hljs-attr">_addDateSelect</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">id, values, matchValue, positions, dynamicOptions</span>) </span>{
    <span class="hljs-keyword">var</span> s = <span class="hljs-keyword">this</span>._addSelect(<span class="hljs-keyword">this</span>.width, <span class="hljs-keyword">this</span>.multi, <span class="hljs-keyword">this</span>.size);
    s.style.marginRight = <span class="hljs-string">"3px"</span>;
    s.id = <span class="hljs-keyword">this</span>.id + <span class="hljs-string">"_select_"</span> + id;
    <span class="hljs-keyword">this</span>._addDateSelectOptions(s, values, matchValue, positions);
    <span class="hljs-keyword">if</span> (dynamicOptions)
      <span class="hljs-keyword">this</span>._addDateSelectOptions(s, dynamicOptions, matchValue, positions);
    <span class="hljs-keyword">return</span> s;
  },
  <span class="hljs-attr">_addDateSelectOptions</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">select, values, matchValue, positions</span>) </span>{
    <span class="hljs-keyword">if</span> (!values)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">var</span> map = getMessages(buildMap(values, <span class="hljs-number">0</span>));
    <span class="hljs-keyword">var</span> previousValue = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; values.length; i++) {
      <span class="hljs-keyword">var</span> option = values[i];
      <span class="hljs-keyword">var</span> value = <span class="hljs-string">""</span>;
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> pos = <span class="hljs-number">0</span>; pos &lt; positions.length; pos++) {
        <span class="hljs-keyword">if</span> (pos &gt; <span class="hljs-number">0</span>)
          value += <span class="hljs-string">"@"</span>;
        value += option[positions[pos]];
      }
      <span class="hljs-keyword">if</span> (previousValue == <span class="hljs-literal">null</span> || previousValue != value)
        addOption(select, value, map[option[<span class="hljs-number">0</span>]], value == matchValue);
      previousValue = value;
    }
  },
  <span class="hljs-attr">_addDateChoices</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">id, matchValue, positions, allowTime, defaultTime</span>) </span>{
    <span class="hljs-keyword">var</span> dynamicOptions = <span class="hljs-keyword">this</span>._getDynamicCalendarOption();
    <span class="hljs-keyword">var</span> select = <span class="hljs-keyword">this</span>._addDateSelect(id, sysvalues[<span class="hljs-string">'calendar'</span>], matchValue, positions, dynamicOptions);
    <span class="hljs-keyword">this</span>._addDatePicker(id, select, matchValue, allowTime, defaultTime);
  },
  <span class="hljs-attr">_getDynamicCalendarOption</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> g_dynamic_filter_options_calendar == <span class="hljs-string">'undefined'</span> || g_dynamic_filter_options_calendar == <span class="hljs-string">''</span>)
      <span class="hljs-keyword">return</span> [];
    <span class="hljs-keyword">var</span> dynamicOptions = [];
    <span class="hljs-keyword">var</span> items = g_dynamic_filter_options_calendar.split(<span class="hljs-string">'##'</span>);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; items.length; i++) {
      <span class="hljs-keyword">if</span> (items[i].length &lt;= <span class="hljs-number">0</span>)
        <span class="hljs-keyword">continue</span>;
      <span class="hljs-keyword">var</span> option = items[i].split(<span class="hljs-string">'::'</span>);
      dynamicOptions.push(option);
    }
    <span class="hljs-keyword">return</span> dynamicOptions;
  },
  <span class="hljs-attr">_addDatePicker</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">id, select, value, allowTime, defaultTime</span>) </span>{
    <span class="hljs-keyword">var</span> found = (select.selectedIndex != <span class="hljs-number">-1</span>);
    <span class="hljs-keyword">if</span> ((select.selectedIndex == <span class="hljs-number">0</span>) &amp;&amp; (value) &amp;&amp; (value != select.options[<span class="hljs-number">0</span>].value))
      found = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">if</span> (!found) {
      value = <span class="hljs-keyword">this</span>._getDateFromValue(value);
      addOption(select, value, value, <span class="hljs-literal">true</span>);
    }
    select.allowTime = allowTime;
    select.defaultTime = defaultTime;
    <span class="hljs-keyword">this</span>._addCalendar(id);
  },
  <span class="hljs-attr">_addCalendar</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">id</span>) </span>{
    <span class="hljs-keyword">var</span> chooseDate = getMessage(<span class="hljs-string">'Choose date...'</span>);
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">document</span>.documentElement.getAttribute(<span class="hljs-string">'data-doctype'</span>) == <span class="hljs-string">'true'</span>) {
      <span class="hljs-keyword">var</span> cal = cel(<span class="hljs-string">"button"</span>, <span class="hljs-keyword">this</span>.tr.tdValue);
      cal.id = <span class="hljs-string">"cal_"</span> + id;
      cal.name = cal.id;
      cal.alt = chooseDate;
      cal.title = chooseDate;
      cal.onclick = <span class="hljs-keyword">this</span>._calendarPopup.bind(<span class="hljs-keyword">this</span>, id);
      cal.style.marginRight = <span class="hljs-string">"1px"</span>;
      cal.style.verticalAlign = <span class="hljs-string">"top"</span>;
      cal.className = <span class="hljs-string">"btn btn-default icon-calendar"</span>;
      <span class="hljs-keyword">var</span> input = addTextInput(<span class="hljs-keyword">this</span>.tr.tdValue, <span class="hljs-string">""</span>, <span class="hljs-string">"hidden"</span>);
      input.id = <span class="hljs-keyword">this</span>.id + <span class="hljs-string">"_input_"</span> + id;
      input.onchange = <span class="hljs-keyword">this</span>._dateTimeComplete.bind(<span class="hljs-keyword">this</span>, id);
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">var</span> cal = cel(<span class="hljs-string">"img"</span>, <span class="hljs-keyword">this</span>.tr.tdValue);
      cal.id = <span class="hljs-string">"cal_"</span> + id;
      cal.name = cal.id;
      cal.src = <span class="hljs-string">"images/small_calendar.gifx"</span>;
      cal.alt = chooseDate;
      cal.title = chooseDate;
      cal.onclick = <span class="hljs-keyword">this</span>._calendarPopup.bind(<span class="hljs-keyword">this</span>, id);
      cal.style.marginLeft = <span class="hljs-string">"2px"</span>;
      cal.className = <span class="hljs-string">"button"</span>;
      <span class="hljs-keyword">var</span> input = addTextInput(<span class="hljs-keyword">this</span>.tr.tdValue, <span class="hljs-string">""</span>, <span class="hljs-string">"hidden"</span>);
      input.id = <span class="hljs-keyword">this</span>.id + <span class="hljs-string">"_input_"</span> + id;
      input.onchange = <span class="hljs-keyword">this</span>._dateTimeComplete.bind(<span class="hljs-keyword">this</span>, id);
    }
  },
  <span class="hljs-attr">_getDateFromValue</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>) </span>{
    <span class="hljs-keyword">var</span> value = value.split(<span class="hljs-string">"@"</span>)[<span class="hljs-number">0</span>];
    <span class="hljs-keyword">var</span> prefixString = <span class="hljs-string">"javascript:gs.dateGenerate("</span>;
    <span class="hljs-keyword">if</span> (value.indexOf(prefixString) == <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">var</span> parts = value.split(<span class="hljs-string">"'"</span>);
      <span class="hljs-keyword">if</span> (parts.length == <span class="hljs-number">5</span>) {
        value = parts[<span class="hljs-number">1</span>];
        <span class="hljs-keyword">if</span> (isDate(parts[<span class="hljs-number">3</span>], <span class="hljs-keyword">this</span>.SYS_TIME_FORMAT)) {
          <span class="hljs-keyword">var</span> dt = getDateFromFormat(parts[<span class="hljs-number">3</span>], <span class="hljs-keyword">this</span>.SYS_TIME_FORMAT);
          value += <span class="hljs-string">" "</span> + formatDate(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(dt), <span class="hljs-keyword">this</span>.SYS_TIME_FORMAT);
        }
      }
    }
    <span class="hljs-keyword">if</span> (isDate(value, <span class="hljs-keyword">this</span>.SYS_DATE_TIME_FORMAT)) {
      <span class="hljs-keyword">var</span> dt = getDateFromFormat(value, <span class="hljs-keyword">this</span>.SYS_DATE_TIME_FORMAT);
      value = formatDate(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(dt), <span class="hljs-keyword">this</span>.userDateTimeFormat);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (isDate(value, <span class="hljs-keyword">this</span>.SYS_DATE_FORMAT)) {
      <span class="hljs-keyword">var</span> dt = getDateFromFormat(value, <span class="hljs-keyword">this</span>.SYS_DATE_FORMAT);
      value = formatDate(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(dt), <span class="hljs-keyword">this</span>.userDateFormat);
    }
    <span class="hljs-keyword">return</span> value;
  },
  <span class="hljs-attr">_getDateGenerate</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value, tag</span>) </span>{
    <span class="hljs-keyword">if</span> (value.indexOf(<span class="hljs-string">"javascript:"</span>) != <span class="hljs-number">-1</span>)
      <span class="hljs-keyword">return</span> value;
    <span class="hljs-keyword">if</span> (isDate(value, <span class="hljs-keyword">this</span>.SYS_DATE_TIME_FORMAT)) {
      <span class="hljs-keyword">var</span> dt = getDateFromFormat(value, <span class="hljs-keyword">this</span>.SYS_DATE_TIME_FORMAT);
      value = formatDate(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(dt), <span class="hljs-keyword">this</span>.SYS_DATE_FORMAT);
      tag = formatDate(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(dt), <span class="hljs-keyword">this</span>.SYS_TIME_FORMAT);
    }
    <span class="hljs-keyword">return</span> <span class="hljs-string">"javascript:gs.dateGenerate('"</span> + value + <span class="hljs-string">"','"</span> + tag + <span class="hljs-string">"')"</span>;
  },
  <span class="hljs-attr">_convertDate</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>) </span>{
    <span class="hljs-keyword">if</span> (value.indexOf(<span class="hljs-string">"javascript:"</span>) != <span class="hljs-number">-1</span>)
      <span class="hljs-keyword">return</span> value;
    <span class="hljs-keyword">if</span> (isDate(value, <span class="hljs-keyword">this</span>.userDateTimeFormat)) {
      <span class="hljs-keyword">var</span> dt = getDateFromFormat(value, <span class="hljs-keyword">this</span>.userDateTimeFormat);
      value = formatDate(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(dt), <span class="hljs-keyword">this</span>.SYS_DATE_TIME_FORMAT);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (isDate(value, <span class="hljs-keyword">this</span>.userDateFormat)) {
      <span class="hljs-keyword">var</span> dt = getDateFromFormat(value, <span class="hljs-keyword">this</span>.userDateFormat);
      value = formatDate(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(dt), <span class="hljs-keyword">this</span>.SYS_DATE_FORMAT);
    }
    <span class="hljs-keyword">return</span> value;
  },
  <span class="hljs-attr">_calendarPopup</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">id</span>) </span>{
    <span class="hljs-keyword">var</span> select = gel(<span class="hljs-keyword">this</span>.id + <span class="hljs-string">"_select_"</span> + id);
    <span class="hljs-keyword">var</span> currentDate = <span class="hljs-string">''</span>;
    <span class="hljs-keyword">if</span> (select.value.indexOf(<span class="hljs-string">'javascript'</span>) == <span class="hljs-number">-1</span>)
      currentDate = select.value;
    <span class="hljs-keyword">var</span> format;
    <span class="hljs-keyword">if</span> (select.allowTime) {
      format = <span class="hljs-keyword">this</span>.userDateTimeFormat;
      <span class="hljs-keyword">if</span> (!isDate(currentDate, format)) {
        <span class="hljs-keyword">var</span> dt = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>();
        <span class="hljs-keyword">if</span> (isDate(currentDate, <span class="hljs-keyword">this</span>.userDateFormat))
          dt = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(getDateFromFormat(currentDate, <span class="hljs-keyword">this</span>.userDateFormat));
        <span class="hljs-keyword">if</span> (select.defaultTime == <span class="hljs-string">'end'</span>)
          dt.setHours(<span class="hljs-number">23</span>, <span class="hljs-number">59</span>, <span class="hljs-number">59</span>);
        <span class="hljs-keyword">else</span>
          dt.setHours(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
        currentDate = formatDate(dt, <span class="hljs-keyword">this</span>.userDateTimeFormat);
      }
    } <span class="hljs-keyword">else</span>
      format = <span class="hljs-keyword">this</span>.userDateFormat;
    <span class="hljs-keyword">var</span> input = gel(<span class="hljs-keyword">this</span>.id + <span class="hljs-string">"_input_"</span> + id);
    input.value = currentDate;
    ScriptLoader.getScripts(<span class="hljs-string">'scripts/classes/GwtDateTimePicker.js'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">new</span> GwtDateTimePicker(input.id, format, select.allowTime, select);
    })
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  },
  <span class="hljs-attr">_dateTimeComplete</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">id</span>) </span>{
    <span class="hljs-keyword">var</span> select = gel(<span class="hljs-keyword">this</span>.id + <span class="hljs-string">"_select_"</span> + id);
    <span class="hljs-keyword">var</span> input = gel(<span class="hljs-keyword">this</span>.id + <span class="hljs-string">"_input_"</span> + id);
    <span class="hljs-keyword">var</span> option = select.options[select.selectedIndex];
    <span class="hljs-keyword">var</span> value = option.value;
    <span class="hljs-keyword">if</span> (isDate(value, <span class="hljs-keyword">this</span>.userDateFormat) || isDate(value, <span class="hljs-keyword">this</span>.userDateTimeFormat)) {
      option.value = input.value;
      option.text = input.value;
    } <span class="hljs-keyword">else</span>
      addOption(select, input.value, input.value, <span class="hljs-literal">true</span>);
  },
  <span class="hljs-attr">type</span>: <span class="hljs-string">'GlideFilterDate'</span>
});;
<span class="hljs-comment">/*! RESOURCE: /scripts/classes/GlideEventHandler.js */</span>
<span class="hljs-keyword">var</span> GlideEventHandler = Class.create({
  <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">handlerName, handler, fieldName</span>) </span>{
    <span class="hljs-keyword">this</span>.handlerName = handlerName;
    <span class="hljs-keyword">this</span>.handler = handler;
    <span class="hljs-keyword">this</span>.fieldName = fieldName;
  }
});;
<span class="hljs-comment">/*! RESOURCE: /scripts/classes/GlideUIElement.js */</span>
<span class="hljs-keyword">var</span> GlideUIElement = Class.create({
  <span class="hljs-attr">CACHE_ELEMENTS</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">ENABLE_CHILD_WALKING</span>: <span class="hljs-literal">false</span>,
  <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">tableName, fieldName, type, mandatory, reference, attributes, scope</span>) </span>{
    <span class="hljs-keyword">this</span>.tableName = tableName;
    <span class="hljs-keyword">this</span>.fieldName = fieldName;
    <span class="hljs-keyword">this</span>.type = type;
    <span class="hljs-keyword">this</span>.mandatory = mandatory;
    <span class="hljs-keyword">this</span>.reference = reference;
    <span class="hljs-keyword">this</span>.attributes = attributes;
    <span class="hljs-keyword">this</span>.elementFetched = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">this</span>.elementParentNode;
    <span class="hljs-keyword">this</span>.fetchedNodes = {};
    <span class="hljs-keyword">this</span>.scope = scope || <span class="hljs-string">"global"</span>;
  },
  <span class="hljs-attr">getType</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.type;
  },
  <span class="hljs-attr">getID</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.tableName + <span class="hljs-string">'.'</span> + <span class="hljs-keyword">this</span>.fieldName;
  },
  <span class="hljs-attr">getElementParentNode</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.elementFetched) {
      <span class="hljs-keyword">this</span>.elementParentNode = gel(<span class="hljs-string">'element.'</span> + <span class="hljs-keyword">this</span>.getID());
      <span class="hljs-keyword">this</span>.elementFetched = <span class="hljs-literal">true</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.elementParentNode;
  },
  <span class="hljs-attr">getElement</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.getChildElementById(<span class="hljs-keyword">this</span>.getID());
  },
  <span class="hljs-attr">getLabelElement</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> parentElementNode = <span class="hljs-keyword">this</span>.getElementParentNode();
    <span class="hljs-keyword">if</span> (!parentElementNode)
      parentElementNode = <span class="hljs-built_in">document</span>;
    <span class="hljs-keyword">var</span> labels = parentElementNode.getElementsByTagName(<span class="hljs-string">'label'</span>);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>;
      (label = labels[i]); i++) {
      <span class="hljs-keyword">if</span> (label.htmlFor == <span class="hljs-keyword">this</span>.getID())
        <span class="hljs-keyword">return</span> label;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.getStatusElement();
  },
  <span class="hljs-attr">getStatusElement</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.getChildElementById(<span class="hljs-string">'status.'</span> + <span class="hljs-keyword">this</span>.getID());
  },
  <span class="hljs-attr">getChildElementById</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">id</span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.fetchedNodes[id])
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.fetchedNodes[id];
    <span class="hljs-keyword">var</span> element = <span class="hljs-keyword">this</span>.getChildElementById0(id);
    <span class="hljs-keyword">if</span> (element)
      <span class="hljs-keyword">this</span>.fetchedNodes[id] = element;
    <span class="hljs-keyword">return</span> element;
  },
  <span class="hljs-attr">getChildElementById0</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">id</span>) </span>{
    <span class="hljs-keyword">var</span> element;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.ENABLE_CHILD_WALKING) {
      element = <span class="hljs-keyword">this</span>._findSubChild(<span class="hljs-keyword">this</span>.getElementParentNode(), id);
      <span class="hljs-keyword">if</span> (element)
        <span class="hljs-keyword">return</span> element;
    }
    <span class="hljs-keyword">return</span> gel(id);
  },
  <span class="hljs-attr">isMandatory</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.mandatory;
  },
  <span class="hljs-attr">isDerived</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.fieldName)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.fieldName.indexOf(<span class="hljs-string">'.'</span>) &gt; <span class="hljs-number">-1</span>;
  },
  <span class="hljs-attr">setMandatory</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">mandatory</span>) </span>{
    <span class="hljs-keyword">this</span>.mandatory = mandatory;
  },
  <span class="hljs-attr">getScope</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.scope;
  },
  <span class="hljs-attr">_findSubChild</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">startNode, id</span>) </span>{
    <span class="hljs-keyword">if</span> (!startNode || (startNode.id &amp;&amp; startNode.id == id))
      <span class="hljs-keyword">return</span> startNode;
    <span class="hljs-keyword">var</span> childNodes = startNode.children || startNode.childNodes;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; childNodes.length; i++) {
      <span class="hljs-keyword">var</span> foundNode = <span class="hljs-keyword">this</span>._findSubChild(childNodes[i], id);
      <span class="hljs-keyword">if</span> (foundNode)
        <span class="hljs-keyword">return</span> foundNode;
    }
    <span class="hljs-keyword">return</span>;
  },
  <span class="hljs-attr">type</span>: <span class="hljs-string">"GlideUIElement"</span>
});;
<span class="hljs-comment">/*! RESOURCE: /scripts/classes/GlideUser.js */</span>
<span class="hljs-keyword">var</span> GlideUser = Class.create({
  <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">userName, firstName, lastName, nonDefaultRoles, userID, departmentID</span>) </span>{
    <span class="hljs-keyword">this</span>.userName = userName;
    <span class="hljs-keyword">this</span>.firstName = firstName;
    <span class="hljs-keyword">this</span>.lastName = lastName;
    <span class="hljs-keyword">this</span>.setFullName(<span class="hljs-keyword">this</span>.firstName + <span class="hljs-string">" "</span> + <span class="hljs-keyword">this</span>.lastName);
    <span class="hljs-keyword">this</span>.setRoles(nonDefaultRoles);
    <span class="hljs-keyword">this</span>.userID = userID;
    <span class="hljs-keyword">this</span>.departmentID = departmentID;
    <span class="hljs-keyword">this</span>.preferences = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Object</span>();
    <span class="hljs-keyword">this</span>.clientData = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Object</span>();
  },
  <span class="hljs-attr">hasRoleExactly</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">role, includeDefaults</span>) </span>{
    <span class="hljs-keyword">if</span> (!role || <span class="hljs-keyword">typeof</span> role != <span class="hljs-string">'string'</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">var</span> rolesToCheck = <span class="hljs-keyword">this</span>.roles;
    <span class="hljs-keyword">if</span> (includeDefaults)
      rolesToCheck = <span class="hljs-keyword">this</span>.allRoles;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> x = <span class="hljs-number">0</span>, l = rolesToCheck.length; x &lt; l; x++) {
      <span class="hljs-keyword">if</span> (rolesToCheck[x].toLowerCase() == role.toLowerCase())
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  },
  <span class="hljs-attr">hasRoles</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">includeDefaults</span>) </span>{
    <span class="hljs-keyword">if</span> (includeDefaults)
      <span class="hljs-keyword">return</span> (<span class="hljs-keyword">this</span>.allRoles.length &gt; <span class="hljs-number">0</span>);
    <span class="hljs-keyword">else</span>
      <span class="hljs-keyword">return</span> (<span class="hljs-keyword">this</span>.roles.length &gt; <span class="hljs-number">0</span>);
  },
  <span class="hljs-attr">hasRole</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">role, includeDefaults</span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.hasRoleExactly(<span class="hljs-string">'maint'</span>, includeDefaults))
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.hasRoleExactly(role, includeDefaults))
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">if</span> (role == <span class="hljs-string">'maint'</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.hasRoleExactly(<span class="hljs-string">'admin'</span>, includeDefaults))
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  },
  <span class="hljs-attr">hasRoleFromList</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">roles, includeDefaults</span>) </span>{
    <span class="hljs-keyword">var</span> rolesToMatch = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>();
    <span class="hljs-keyword">if</span> (roles)
      rolesToMatch = roles.split(<span class="hljs-regexp">/\s*,\s*/</span>);
    <span class="hljs-keyword">if</span> (rolesToMatch.length == <span class="hljs-number">0</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; rolesToMatch.length; i++) {
      <span class="hljs-keyword">var</span> r = rolesToMatch[i];
      <span class="hljs-keyword">if</span> (r &amp;&amp; <span class="hljs-keyword">this</span>.hasRole(r, includeDefaults))
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  },
  <span class="hljs-attr">getFullName</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.fullName;
  },
  <span class="hljs-attr">getUserName</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.userName;
  },
  <span class="hljs-attr">getUserID</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.userID;
  },
  <span class="hljs-attr">getDepartmentID</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.departmentID;
  },
  <span class="hljs-attr">setFullName</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fn</span>) </span>{
    <span class="hljs-keyword">this</span>.fullName = fn;
  },
  <span class="hljs-attr">getRoles</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">includeDefaults</span>) </span>{
    <span class="hljs-keyword">if</span> (includeDefaults)
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.allRoles;
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.roles;
  },
  <span class="hljs-attr">getAvailableElevatedRoles</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.elevatedRoles;
  },
  <span class="hljs-attr">setRoles</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">r, includeDefaults</span>) </span>{
    <span class="hljs-keyword">if</span> (includeDefaults) {
      <span class="hljs-keyword">if</span> (r)
        <span class="hljs-keyword">this</span>.allRoles = r.split(<span class="hljs-regexp">/\s*,\s*/</span>);
      <span class="hljs-keyword">else</span>
        <span class="hljs-keyword">this</span>.allRoles = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>();
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">if</span> (r)
        <span class="hljs-keyword">this</span>.roles = r.split(<span class="hljs-regexp">/\s*,\s*/</span>);
      <span class="hljs-keyword">else</span>
        <span class="hljs-keyword">this</span>.roles = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>();
    }
  },
  <span class="hljs-attr">setElevatedRoles</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">r</span>) </span>{
    <span class="hljs-keyword">if</span> (r)
      <span class="hljs-keyword">this</span>.elevatedRoles = r.split(<span class="hljs-regexp">/\s*,\s*/</span>);
    <span class="hljs-keyword">else</span>
      <span class="hljs-keyword">this</span>.elevatedRoles = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>();
  },
  <span class="hljs-attr">setActiveElevatedRoles</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">r</span>) </span>{
    <span class="hljs-keyword">if</span> (r)
      <span class="hljs-keyword">this</span>.activeElevatedRoles = r.split(<span class="hljs-regexp">/\s*,\s*/</span>);
    <span class="hljs-keyword">else</span>
      <span class="hljs-keyword">this</span>.activeElevatedRoles = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>();
  },
  <span class="hljs-attr">getActiveElevatedRoles</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.activeElevatedRoles;
  },
  <span class="hljs-attr">setDomain</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">d</span>) </span>{
    <span class="hljs-keyword">this</span>.domain = d;
  },
  <span class="hljs-attr">getPreference</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">n</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.preferences[n];
  },
  <span class="hljs-attr">setPreference</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">n, v</span>) </span>{
    <span class="hljs-keyword">this</span>.preferences[n] = v;
  },
  <span class="hljs-attr">deletePreference</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">n</span>) </span>{
    <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.preferences[n];
  },
  <span class="hljs-attr">getClientData</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">n</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.clientData[n];
  },
  <span class="hljs-attr">setClientData</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">n, v</span>) </span>{
    <span class="hljs-keyword">this</span>.clientData[n] = v;
  },
  <span class="hljs-attr">setBannerImage</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">s</span>) </span>{
    <span class="hljs-keyword">this</span>.bannerImage = s;
  },
  <span class="hljs-attr">getBannerImage</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.bannerImage;
  },
  <span class="hljs-attr">setBannerText</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">s</span>) </span>{
    <span class="hljs-keyword">this</span>.bannerText = s;
  },
  <span class="hljs-attr">getBannerText</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.bannerText;
  },
  <span class="hljs-attr">setHomePages</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">s</span>) </span>{
    <span class="hljs-keyword">this</span>.homePages = s;
  },
  <span class="hljs-attr">getHomePages</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.homePages;
  },
  <span class="hljs-attr">type</span>: <span class="hljs-string">"GlideUser"</span>
});;
<span class="hljs-comment">/*! RESOURCE: /scripts/doctype/GlideForm14.js */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">default_on_submit</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">if</span> (!g_form)
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  <span class="hljs-keyword">return</span> g_form.onSubmit();
}
<span class="hljs-keyword">var</span> GlideForm = Class.create({
  <span class="hljs-attr">INFO_CLASS</span>: <span class="hljs-string">"fieldmsg notification notification-info"</span>,
  <span class="hljs-attr">ERROR_CLASS</span>: <span class="hljs-string">"fieldmsg notification notification-error"</span>,
  <span class="hljs-attr">WARNING_CLASS</span>: <span class="hljs-string">"fieldmsg notification notification-warning"</span>,
  <span class="hljs-attr">MSG_ROW</span>: <span class="hljs-string">"_message_row"</span>,
  <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">tableName, mandatory, checkMandatory, checkNumeric, checkInteger</span>) </span>{
    <span class="hljs-keyword">this</span>.tableName = tableName;
    <span class="hljs-keyword">this</span>.modified = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">this</span>.modifiedFields = {};
    <span class="hljs-keyword">this</span>.mandatoryOnlyIfModified = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">this</span>.elements = [];
    <span class="hljs-keyword">this</span>.mandatory = mandatory;
    <span class="hljs-keyword">this</span>.checkMandatory = checkMandatory;
    <span class="hljs-keyword">this</span>.checkNumeric = checkNumeric;
    <span class="hljs-keyword">this</span>.checkInteger = checkInteger;
    <span class="hljs-keyword">this</span>.nameMap = [];
    <span class="hljs-keyword">this</span>.attributes = [];
    <span class="hljs-keyword">this</span>.validators = [];
    <span class="hljs-keyword">this</span>.disabledFields = [];
    <span class="hljs-keyword">this</span>.securityReadOnlyFields = [];
    <span class="hljs-keyword">this</span>.elementHandlers = {};
    <span class="hljs-keyword">this</span>.prefixHandlers = {};
    <span class="hljs-keyword">this</span>.derivedWaiting = [];
    <span class="hljs-keyword">this</span>.newRecord = gel(<span class="hljs-string">'sys_row'</span>) &amp;&amp; gel(<span class="hljs-string">'sys_row'</span>).value == <span class="hljs-string">"-1"</span>;
    <span class="hljs-keyword">this</span>.personalizeHiddenFields = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">this</span>.personalizePrefKey = <span class="hljs-string">"personalize_"</span> + <span class="hljs-keyword">this</span>.tableName + <span class="hljs-string">"_"</span> + <span class="hljs-keyword">this</span>.getViewName();
    CachedEvent.emit(<span class="hljs-string">'glideform.initialized'</span>, <span class="hljs-keyword">this</span>);
    <span class="hljs-keyword">this</span>._isLiveUpdating = <span class="hljs-literal">false</span>;
  },
  <span class="hljs-attr">fieldChanged</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">elementName, changeFlag</span>) </span>{
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>._internalChange) {
      <span class="hljs-keyword">if</span> (changeFlag) {
        <span class="hljs-keyword">this</span>.modified = <span class="hljs-literal">true</span>;
        <span class="hljs-keyword">this</span>.modifiedFields[elementName] = <span class="hljs-literal">true</span>;
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.modifiedFields[elementName]) {
        <span class="hljs-keyword">this</span>.modifiedFields[elementName] = <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">this</span>._checkModified();
      }
    }
    <span class="hljs-keyword">var</span> uniqueValue = <span class="hljs-keyword">this</span>.getUniqueValue();
    CustomEvent.fireAll(<span class="hljs-string">'form.isModified'</span>, {
      <span class="hljs-attr">uniqueValue</span>: uniqueValue,
      <span class="hljs-attr">isModified</span>: <span class="hljs-keyword">this</span>.modified
    });
  },
  <span class="hljs-attr">_checkModified</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> n <span class="hljs-keyword">in</span> <span class="hljs-keyword">this</span>.modifiedFields) {
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.modifiedFields[n]) {
        <span class="hljs-keyword">this</span>.modified = <span class="hljs-literal">true</span>;
        <span class="hljs-keyword">return</span>;
      }
    }
    <span class="hljs-keyword">this</span>.modified = <span class="hljs-literal">false</span>;
  },
  <span class="hljs-attr">setMandatoryOnlyIfModified</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>.mandatoryOnlyIfModified = <span class="hljs-literal">true</span>;
  },
  <span class="hljs-attr">addNameMapEntry</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">entry</span>) </span>{
    <span class="hljs-keyword">this</span>.nameMap.push(entry);
  },
  <span class="hljs-attr">addGlideUIElement</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">ed</span>) </span>{
    <span class="hljs-keyword">this</span>.elements.push(ed);
  },
  <span class="hljs-attr">registerHandler</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">id, handler</span>) </span>{
    <span class="hljs-keyword">this</span>.elementHandlers[id] = handler;
  },
  <span class="hljs-attr">registerPrefixHandler</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">prefix, handlerObject</span>) </span>{
    <span class="hljs-keyword">var</span> handler = <span class="hljs-keyword">new</span> GlideFormPrefixHandler(handlerObject);
    <span class="hljs-keyword">this</span>.prefixHandlers[prefix] = handler;
  },
  <span class="hljs-attr">getPrefixHandler</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">id</span>) </span>{
    <span class="hljs-keyword">if</span> (!id)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">if</span> (id.indexOf(<span class="hljs-string">'.'</span>) &lt; <span class="hljs-number">0</span>)
      id = <span class="hljs-string">'variables.'</span> + id;
    <span class="hljs-keyword">var</span> idSplit = id.split(<span class="hljs-string">"."</span>);
    <span class="hljs-keyword">var</span> handler = <span class="hljs-keyword">this</span>.prefixHandlers[idSplit[<span class="hljs-number">0</span>]];
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> handler == <span class="hljs-string">"undefined"</span>)
      <span class="hljs-keyword">return</span>;
    handler.setFieldName(id);
    <span class="hljs-keyword">return</span> handler;
  },
  <span class="hljs-attr">getElement</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">id</span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.elementHandlers[id] &amp;&amp; (<span class="hljs-keyword">typeof</span> <span class="hljs-keyword">this</span>.elementHandlers[id].getElement == <span class="hljs-string">"function"</span>))
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.elementHandlers[id].getElement();
    <span class="hljs-keyword">else</span>
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.getControl(id);
  },
  <span class="hljs-attr">getParameter</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">parm</span>) </span>{
    <span class="hljs-keyword">if</span> (!(parm.substr(<span class="hljs-number">0</span>, <span class="hljs-number">8</span>) == <span class="hljs-string">'sysparm_'</span>))
      parm = <span class="hljs-string">'sysparm_'</span> + parm;
    <span class="hljs-keyword">var</span> pcel = gel(parm);
    <span class="hljs-keyword">if</span> (pcel)
      <span class="hljs-keyword">return</span> pcel.value;
    <span class="hljs-keyword">else</span>
      <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>;
  },
  <span class="hljs-attr">hasAttribute</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">s</span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.attributes[s])
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  },
  <span class="hljs-attr">addAttribute</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">s</span>) </span>{
    <span class="hljs-keyword">this</span>.attributes[s] = s;
  },
  <span class="hljs-attr">addValidator</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldType, validator</span>) </span>{
    <span class="hljs-keyword">this</span>.validators[fieldType] = validator;
  },
  <span class="hljs-attr">_getPersonalizeHiddenFields</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.personalizeHiddenFields == <span class="hljs-literal">null</span>) {
      <span class="hljs-keyword">var</span> prefVal = NOW[<span class="hljs-keyword">this</span>.personalizePrefKey] || getPreference(<span class="hljs-keyword">this</span>.personalizePrefKey);
      <span class="hljs-keyword">if</span> (<span class="hljs-string">'false'</span> == prefVal)
        <span class="hljs-keyword">this</span>.personalizeHiddenFields = [];
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (prefVal.length)
        <span class="hljs-keyword">this</span>.personalizeHiddenFields = prefVal.split(<span class="hljs-string">","</span>);
      <span class="hljs-keyword">else</span>
        <span class="hljs-keyword">this</span>.personalizeHiddenFields = [];
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.personalizeHiddenFields;
  },
  <span class="hljs-attr">resetPersonalizeHiddenFields</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>.personalizeHiddenFields = [];
    <span class="hljs-keyword">this</span>._savePersonalizeHiddenFields(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-built_in">window</span>.reloadWindow(<span class="hljs-built_in">window</span>);
    });
  },
  <span class="hljs-attr">_savePersonalizeHiddenFields</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">callback</span>) </span>{
    setPreference(<span class="hljs-keyword">this</span>.personalizePrefKey, <span class="hljs-keyword">this</span>.personalizeHiddenFields.join(<span class="hljs-string">","</span>), callback);
  },
  <span class="hljs-attr">isUserPersonalizedField</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName</span>) </span>{
    fieldName = <span class="hljs-keyword">this</span>.removeCurrentPrefix(fieldName);
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.personalizeHiddenFields === <span class="hljs-literal">null</span> ? <span class="hljs-literal">false</span> : <span class="hljs-keyword">this</span>.personalizeHiddenFields.indexOf(fieldName) != <span class="hljs-number">-1</span>;
  },
  <span class="hljs-attr">setUserDisplay</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName, display</span>) </span>{
    fieldName = <span class="hljs-keyword">this</span>.removeCurrentPrefix(fieldName);
    <span class="hljs-keyword">this</span>._getPersonalizeHiddenFields();
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-keyword">this</span>.personalizeHiddenFields.length - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) {
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.personalizeHiddenFields[i] === fieldName) {
        <span class="hljs-keyword">this</span>.personalizeHiddenFields.splice(i, <span class="hljs-number">1</span>);
      }
    }
    <span class="hljs-keyword">this</span>.setDisplay(fieldName, display);
    <span class="hljs-keyword">if</span> ((display === <span class="hljs-literal">false</span> || display === <span class="hljs-string">'false'</span>) &amp;&amp; !<span class="hljs-keyword">this</span>.isMandatory(fieldName))
      <span class="hljs-keyword">this</span>.personalizeHiddenFields.push(fieldName);
    <span class="hljs-keyword">this</span>._savePersonalizeHiddenFields();
  },
  <span class="hljs-attr">setDisplay</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName, display</span>) </span>{
    fieldName = <span class="hljs-keyword">this</span>.removeCurrentPrefix(fieldName);
    <span class="hljs-keyword">this</span>._setDisplay(fieldName, display, <span class="hljs-keyword">this</span>.isMandatory(fieldName), <span class="hljs-keyword">this</span>.getValue(fieldName));
  },
  <span class="hljs-attr">_setDisplay</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName, display, isMandatory, fieldValue</span>) </span>{
    <span class="hljs-keyword">var</span> s = <span class="hljs-keyword">this</span>.tableName + <span class="hljs-string">'.'</span> + fieldName;
    <span class="hljs-keyword">var</span> control = <span class="hljs-keyword">this</span>.getControl(fieldName);
    <span class="hljs-keyword">if</span> (!control) {
      <span class="hljs-keyword">var</span> handler = <span class="hljs-keyword">this</span>.getPrefixHandler(fieldName);
      <span class="hljs-keyword">if</span> (handler)
        handler.getObject().setDisplay(handler.getFieldName(), display);
      <span class="hljs-keyword">return</span>;
    }
    <span class="hljs-keyword">var</span> displayValue = <span class="hljs-string">'none'</span>;
    <span class="hljs-keyword">if</span> (display == <span class="hljs-string">'true'</span> || display == <span class="hljs-literal">true</span>) {
      display = <span class="hljs-literal">true</span>;
      displayValue = <span class="hljs-string">''</span>;
    }
    <span class="hljs-keyword">if</span> ((display != <span class="hljs-literal">true</span>) &amp;&amp; isMandatory &amp;&amp; fieldValue == <span class="hljs-string">''</span>)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">var</span> theElement = control;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.elementHandlers[control.id] &amp;&amp; (<span class="hljs-keyword">typeof</span> <span class="hljs-keyword">this</span>.elementHandlers[control.id].getElement == <span class="hljs-string">"function"</span>))
      theElement = <span class="hljs-keyword">this</span>.elementHandlers[control.id].getElement();
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.elementHandlers[control.id] &amp;&amp; (<span class="hljs-keyword">typeof</span> <span class="hljs-keyword">this</span>.elementHandlers[control.id].setDisplay == <span class="hljs-string">"function"</span>)) {
      <span class="hljs-keyword">this</span>.elementHandlers[control.id].setDisplay(display ? <span class="hljs-string">''</span> : <span class="hljs-string">'none'</span>);
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">this</span>.changeElementStyle(fieldName, <span class="hljs-string">'display'</span>, displayValue);
    }
    <span class="hljs-keyword">this</span>.setSensitiveDisplayValue(s + <span class="hljs-string">".ui_policy_sensitive"</span>, displayValue);
    <span class="hljs-keyword">var</span> glideElement = <span class="hljs-keyword">this</span>.getGlideUIElement(fieldName);
    <span class="hljs-keyword">if</span> (glideElement &amp;&amp; (glideElement.type == <span class="hljs-string">'script'</span> || glideElement.type == <span class="hljs-string">'script_plain'</span>))
      CustomEvent.fire(<span class="hljs-string">'element_script_display_'</span> + display, {
        <span class="hljs-string">'element'</span>: glideElement
      });
    _frameChanged();
  },
  <span class="hljs-attr">setSensitiveDisplayValue</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name, displayValue</span>) </span>{
    <span class="hljs-keyword">var</span> elements = <span class="hljs-built_in">document</span>.getElementsByName(name);
    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; elements.length; i++) {
      elements[i].style.display = displayValue;
    }
  },
  <span class="hljs-attr">setValidation</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName, validate</span>) </span>{
    fieldName = <span class="hljs-keyword">this</span>.removeCurrentPrefix(fieldName);
    <span class="hljs-keyword">var</span> control = <span class="hljs-keyword">this</span>.getControl(fieldName);
    <span class="hljs-keyword">if</span> (!control)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">if</span> (validate == <span class="hljs-string">'false'</span>)
      validate = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">if</span> (validate != <span class="hljs-literal">false</span>) {
      control.removeAttribute(<span class="hljs-string">'validate'</span>);
      <span class="hljs-keyword">return</span>;
    }
    control.setAttribute(<span class="hljs-string">'validate'</span>, <span class="hljs-string">'false'</span>);
  },
  <span class="hljs-attr">getViewName</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> sysparmView = gel(<span class="hljs-string">'sysparm_view'</span>);
    <span class="hljs-keyword">var</span> view = <span class="hljs-string">"default"</span>;
    <span class="hljs-keyword">if</span> (sysparmView &amp;&amp; sysparmView.value)
      view = sysparmView.value;
    <span class="hljs-keyword">return</span> view;
  },
  <span class="hljs-attr">setVisible</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName, visibility</span>) </span>{
    fieldName = <span class="hljs-keyword">this</span>.removeCurrentPrefix(fieldName);
    <span class="hljs-keyword">var</span> control = <span class="hljs-keyword">this</span>.getControl(fieldName);
    <span class="hljs-keyword">if</span> (!control) {
      <span class="hljs-keyword">var</span> handler = <span class="hljs-keyword">this</span>.getPrefixHandler(fieldName);
      <span class="hljs-keyword">if</span> (handler)
        handler.getObject().setVisible(handler.getFieldName(),
          visibility);
      <span class="hljs-keyword">return</span>;
    }
    <span class="hljs-keyword">var</span> v = <span class="hljs-string">'hidden'</span>;
    <span class="hljs-keyword">if</span> (visibility == <span class="hljs-string">'true'</span>)
      visibility = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">if</span> (visibility)
      v = <span class="hljs-string">'visible'</span>;
    <span class="hljs-keyword">if</span> ((visibility != <span class="hljs-literal">true</span>) &amp;&amp; <span class="hljs-keyword">this</span>.isMandatory(fieldName) &amp;&amp; (<span class="hljs-keyword">this</span>.getValue(fieldName) == <span class="hljs-string">''</span>))
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">this</span>.changeElementStyle(fieldName, <span class="hljs-string">'visibility'</span>, v);
  },
  <span class="hljs-attr">changeElementStyle</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName, name, value</span>) </span>{
    <span class="hljs-keyword">var</span> ge = <span class="hljs-keyword">this</span>.getGlideUIElement(fieldName);
    <span class="hljs-keyword">if</span> (!ge)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.changeElementParent(ge, name, value))
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">var</span> labelElement = ge.getLabelElement();
    <span class="hljs-keyword">if</span> (labelElement)
      labelElement.parentNode.parentNode.style[name] = value;
    <span class="hljs-keyword">var</span> parentTR = findParentByTag(ge.getElement(), <span class="hljs-string">"tr"</span>);
    <span class="hljs-keyword">if</span> (parentTR &amp;&amp; parentTR != labelElement)
      parentTR.style[name] = value;
  },
  <span class="hljs-attr">changeElementParent</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">ge, name, value</span>) </span>{
    <span class="hljs-keyword">var</span> element = ge.getElementParentNode();
    <span class="hljs-keyword">if</span> (element) {
      element.style[name] = value;
      <span class="hljs-keyword">var</span> decoration = $(element).select(<span class="hljs-string">".reference_decoration, .btn-ref"</span>);
      value = ge.type == <span class="hljs-string">'reference'</span> &amp;&amp; <span class="hljs-keyword">this</span>.getValue(ge.fieldName) == <span class="hljs-string">''</span> ? <span class="hljs-string">'none'</span> : value;
      <span class="hljs-keyword">if</span> (decoration &amp;&amp; decoration.length &gt; <span class="hljs-number">0</span>)
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; decoration.length; i++)
          decoration[i].style[name] = value;
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  },
  <span class="hljs-attr">getLabel</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">id</span>) </span>{
    id = <span class="hljs-keyword">this</span>.removeCurrentPrefix(id);
    <span class="hljs-keyword">var</span> label;
    <span class="hljs-keyword">var</span> labels = <span class="hljs-built_in">document</span>.getElementsByTagName(<span class="hljs-string">'label'</span>);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>;
      (label = labels[i]); i++) {
      <span class="hljs-keyword">if</span> (label.htmlFor.endsWith(id)) {
        <span class="hljs-keyword">return</span> label;
      }
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  },
  <span class="hljs-attr">isNewRecord</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.newRecord;
  },
  <span class="hljs-attr">isMandatory</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName</span>) </span>{
    fieldName = <span class="hljs-keyword">this</span>.removeCurrentPrefix(fieldName);
    <span class="hljs-keyword">var</span> thisElement = <span class="hljs-keyword">this</span>.getGlideUIElement(fieldName);
    <span class="hljs-keyword">if</span> (!thisElement)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">return</span> thisElement.isMandatory();
  },
  <span class="hljs-attr">addSecurityReadOnlyFields</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fields</span>) </span>{
    <span class="hljs-keyword">this</span>.securityReadOnlyFields = fields.split(<span class="hljs-string">','</span>);
  },
  <span class="hljs-attr">setMandatory</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName, mandatory</span>) </span>{
    <span class="hljs-keyword">var</span> thisElement = <span class="hljs-keyword">this</span>.getGlideUIElement(fieldName);
    <span class="hljs-keyword">if</span> (!thisElement) {
      <span class="hljs-keyword">var</span> handler = <span class="hljs-keyword">this</span>.getPrefixHandler(fieldName);
      <span class="hljs-keyword">if</span> (handler)
        handler.getObject().setMandatory(handler.getFieldName(), mandatory);
      <span class="hljs-keyword">return</span>;
    }
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.securityReadOnlyFields.indexOf(<span class="hljs-keyword">this</span>.tableName + <span class="hljs-string">"."</span> + fieldName) &gt;= <span class="hljs-number">0</span>)
      <span class="hljs-keyword">return</span>;
    thisElement.setMandatory(mandatory);
    <span class="hljs-keyword">var</span> e = thisElement.getElement();
    <span class="hljs-keyword">if</span> (e) {
      e.setAttribute(<span class="hljs-string">"mandatory"</span>, mandatory);
      onChangeLabelProcessByEl(e, thisElement.getStatusElement());
    }
    <span class="hljs-keyword">var</span> control = <span class="hljs-keyword">this</span>.getControl(fieldName);
    <span class="hljs-keyword">if</span> (control &amp;&amp; control.id &amp;&amp; <span class="hljs-keyword">this</span>.elementHandlers[control.id] &amp;&amp; (<span class="hljs-keyword">typeof</span> <span class="hljs-keyword">this</span>.elementHandlers[control.id].setMandatory == <span class="hljs-string">"function"</span>))
      <span class="hljs-keyword">this</span>.elementHandlers[control.id].setMandatory(mandatory);
    <span class="hljs-keyword">if</span> (mandatory) {
      setMandatoryExplained(<span class="hljs-literal">true</span>);
      <span class="hljs-keyword">var</span> value = <span class="hljs-keyword">this</span>.getValue(fieldName);
      <span class="hljs-keyword">if</span> (value == <span class="hljs-string">''</span>) {
        <span class="hljs-keyword">this</span>._setDisplay(fieldName, <span class="hljs-literal">true</span>, <span class="hljs-literal">true</span>, <span class="hljs-string">''</span>);
        <span class="hljs-keyword">this</span>._setReadonly(fieldName, <span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>, <span class="hljs-string">''</span>);
      }
    }
    opticsLog(<span class="hljs-keyword">this</span>.getTableName(), fieldName, <span class="hljs-string">"Mandatory set to "</span> + mandatory);
  },
  <span class="hljs-attr">setDisabled</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName, disabled</span>) </span>{
    <span class="hljs-keyword">this</span>.setReadonly(fieldName, disabled);
    opticsLog(<span class="hljs-keyword">this</span>.getTableName(), fieldName, <span class="hljs-string">"Disabled set to "</span> + disabled);
  },
  <span class="hljs-attr">setReadOnly</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName, disabled</span>) </span>{
    <span class="hljs-keyword">this</span>.setReadonly(fieldName, disabled);
  },
  <span class="hljs-attr">setReadonly</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName, disabled</span>) </span>{
    fieldName = <span class="hljs-keyword">this</span>.removeCurrentPrefix(fieldName);
    <span class="hljs-keyword">this</span>._setReadonly(fieldName, disabled, <span class="hljs-keyword">this</span>.isMandatory(fieldName), <span class="hljs-keyword">this</span>.getValue(fieldName));
    opticsLog(<span class="hljs-keyword">this</span>.getTableName(), fieldName, <span class="hljs-string">"ReadOnly set to "</span> + disabled);
  },
  <span class="hljs-attr">_setReadonly</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName, disabled, isMandatory, fieldValue</span>) </span>{
    <span class="hljs-keyword">var</span> s = <span class="hljs-keyword">this</span>.tableName + <span class="hljs-string">'.'</span> + fieldName;
    <span class="hljs-keyword">var</span> control = <span class="hljs-keyword">this</span>.getControl(fieldName);
    <span class="hljs-keyword">if</span> (!control) {
      <span class="hljs-keyword">var</span> handler = <span class="hljs-keyword">this</span>.getPrefixHandler(fieldName);
      <span class="hljs-keyword">if</span> (handler)
        handler.getObject()._setReadonly(
          handler.getFieldName(), disabled, isMandatory,
          fieldValue);
      <span class="hljs-keyword">return</span>;
    }
    <span class="hljs-keyword">var</span> ge = <span class="hljs-keyword">this</span>.getGlideUIElement(fieldName);
    <span class="hljs-keyword">if</span> (!ge)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">this</span>._setReadonly0(ge, control, s, fieldName, disabled, isMandatory, fieldValue);
  },
  <span class="hljs-attr">_setReadonly0</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">ge, control, s, fieldName, disabled, isMandatory, fieldValue</span>) </span>{
    <span class="hljs-keyword">if</span> (disabled &amp;&amp; isMandatory &amp;&amp; fieldValue == <span class="hljs-string">''</span>)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">if</span> (control.getAttribute(<span class="hljs-string">'gsftlocked'</span>) == <span class="hljs-string">'true'</span>)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.elementHandlers[control.id] &amp;&amp; (<span class="hljs-keyword">typeof</span> <span class="hljs-keyword">this</span>.elementHandlers[control.id].setReadOnly == <span class="hljs-string">"function"</span>)) {
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.elementHandlers[control.id].setReadOnly(disabled) == <span class="hljs-literal">true</span>)
        <span class="hljs-keyword">return</span>;
    } <span class="hljs-keyword">else</span>
      <span class="hljs-keyword">this</span>.setDisabledControl(control, disabled);
    <span class="hljs-keyword">this</span>._setDisabledField(control, disabled);
    onChangeLabelProcessByEl(control, ge.getStatusElement());
    <span class="hljs-keyword">this</span>._setFieldReadOnly(ge, <span class="hljs-string">"sys_display."</span> + s, disabled);
    <span class="hljs-keyword">this</span>._setFieldReadOnly(ge, <span class="hljs-string">"sys_select."</span> + s, disabled);
    <span class="hljs-keyword">var</span> $inputGroup = $j(ge.getElementParentNode()).find(<span class="hljs-string">".input-group"</span>);
    <span class="hljs-keyword">if</span> ($inputGroup.length) {
      <span class="hljs-keyword">if</span> (disabled)
        $inputGroup.addClass(<span class="hljs-string">'input-group-disabled'</span>);
      <span class="hljs-keyword">else</span>
        $inputGroup.removeClass(<span class="hljs-string">'input-group-disabled'</span>);
    }
    <span class="hljs-keyword">this</span>.setSensitiveDisplayValue(s + <span class="hljs-string">".ui_policy_sensitive"</span>, disabled ? <span class="hljs-string">'none'</span> : <span class="hljs-string">''</span>);
    <span class="hljs-keyword">this</span>._setFieldReadOnly(ge, <span class="hljs-string">"ni."</span> + <span class="hljs-keyword">this</span>.tableName + <span class="hljs-string">"."</span> + fieldName, disabled);
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.tableName == <span class="hljs-string">"ni"</span>)
      <span class="hljs-keyword">this</span>._setFieldReadOnly(ge, <span class="hljs-string">"ni."</span> + ge.fieldName, disabled);
    <span class="hljs-keyword">var</span> suggestionExists = gel(<span class="hljs-string">'ni.dependent_reverse.'</span> + <span class="hljs-keyword">this</span>.tableName + <span class="hljs-string">'.'</span> + fieldName);
    <span class="hljs-keyword">if</span> (suggestionExists) {
      <span class="hljs-keyword">this</span>._setFieldReadOnly(ge, <span class="hljs-string">"lookup."</span> + <span class="hljs-keyword">this</span>.tableName + <span class="hljs-string">"."</span> + fieldName, disabled, <span class="hljs-literal">true</span>);
    }
  },
  <span class="hljs-attr">_setFieldReadOnly</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">ge, s, disabled, skipProcessLabelChange</span>) </span>{
    <span class="hljs-keyword">var</span> control = ge.getChildElementById(s);
    <span class="hljs-keyword">if</span> (control) {
      <span class="hljs-keyword">this</span>.setDisabledControl(control, disabled);
      <span class="hljs-keyword">this</span>._setDisabledField(control, disabled);
      <span class="hljs-keyword">if</span> (!skipProcessLabelChange)
        onChangeLabelProcessByEl(control, ge.getStatusElement());
    }
  },
  <span class="hljs-attr">setDisabledControl</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">control, disabled</span>) </span>{
    <span class="hljs-keyword">if</span> (disabled) {
      control.setAttribute(<span class="hljs-string">"readonly"</span>, <span class="hljs-string">"readonly"</span>);
      addClassName(control, <span class="hljs-string">'disabled'</span>);
    } <span class="hljs-keyword">else</span> {
      control.removeAttribute(<span class="hljs-string">"readonly"</span>);
      removeClassName(control, <span class="hljs-string">'disabled'</span>);
    }
    <span class="hljs-keyword">var</span> name = control.tagName.toLowerCase();
    <span class="hljs-keyword">var</span> type = control.getAttribute(<span class="hljs-string">'type'</span>);
    <span class="hljs-keyword">if</span> ((isFirefox &amp;&amp; (name == <span class="hljs-string">'input'</span> &amp;&amp; (type == <span class="hljs-string">'text'</span> || type == <span class="hljs-literal">null</span>))) || name == <span class="hljs-string">'textarea'</span>)
      control.disabled = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">else</span>
      control.disabled = disabled;
  },
  <span class="hljs-attr">_setDisabledField</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">control, disabled</span>) </span>{
    <span class="hljs-keyword">if</span> (disabled) {
      addClassName(control, <span class="hljs-string">'disabled'</span>);
      addClassName(control, <span class="hljs-string">'readonly'</span>);
      <span class="hljs-keyword">this</span>._addDisabledField(control);
    } <span class="hljs-keyword">else</span> {
      removeClassName(control, <span class="hljs-string">'disabled'</span>);
      removeClassName(control, <span class="hljs-string">'readonly'</span>);
      <span class="hljs-keyword">this</span>._removeDisabledField(control);
    }
  },
  <span class="hljs-attr">_addDisabledField</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">control</span>) </span>{
    <span class="hljs-keyword">var</span> n = <span class="hljs-keyword">this</span>.disabledFields.length;
    <span class="hljs-keyword">this</span>.disabledFields[n] = control;
  },
  <span class="hljs-attr">_removeDisabledField</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">control</span>) </span>{
    <span class="hljs-keyword">var</span> n = <span class="hljs-keyword">this</span>.disabledFields.length;
    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; n; i++) {
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.disabledFields[i] == control) {
        <span class="hljs-keyword">this</span>.disabledFields.splice(i, <span class="hljs-number">1</span>);
        <span class="hljs-keyword">break</span>;
      }
    }
  },
  <span class="hljs-attr">onSubmit</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>.getFormElement().addClassName(<span class="hljs-string">'form-submitted'</span>);
    <span class="hljs-keyword">var</span> action = <span class="hljs-keyword">this</span>.getActionName();
    <span class="hljs-keyword">if</span> (action &amp;&amp; !action.startsWith(<span class="hljs-string">"sysverb_no_update"</span>))
      <span class="hljs-keyword">this</span>.submitted = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">if</span> (action == <span class="hljs-string">'sysverb_back'</span> || action == <span class="hljs-string">'sysverb_cancel'</span> || action == <span class="hljs-string">'sysverb_delete'</span> || action == <span class="hljs-string">'sysverb_query'</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">var</span> rc = <span class="hljs-keyword">this</span>.mandatoryCheck();
    <span class="hljs-keyword">if</span> (rc &amp;&amp; <span class="hljs-keyword">typeof</span> g_sc_form != <span class="hljs-string">"undefined"</span>)
      rc = g_sc_form.mandatoryCheck() &amp;&amp; g_sc_form.catalogOnSubmit();
    rc = rc &amp;&amp; <span class="hljs-keyword">this</span>.validate();
    <span class="hljs-keyword">return</span> rc;
  },
  <span class="hljs-attr">enableUIPolicyFields</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-keyword">this</span>.disabledFields.length; i++) {
      <span class="hljs-keyword">var</span> disabledID = <span class="hljs-keyword">this</span>.disabledFields[i].id;
      <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>._isDerivedWaiting(disabledID))
        <span class="hljs-keyword">this</span>.disabledFields[i].disabled = <span class="hljs-literal">false</span>;
      <span class="hljs-keyword">else</span>
        jslog(<span class="hljs-string">"Did not re-enable "</span> + disabledID + <span class="hljs-string">" as it is derived waiting for AJAX lookup"</span>);
    }
  },
  <span class="hljs-attr">mandatoryCheck</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.checkMandatory || (!<span class="hljs-keyword">this</span>.modified &amp;&amp; <span class="hljs-keyword">this</span>.mandatoryOnlyIfModified))
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">var</span> rc = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">var</span> invalidFields = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>();
    <span class="hljs-keyword">var</span> labels = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>();
    <span class="hljs-keyword">var</span> missing = <span class="hljs-keyword">this</span>.getMissingFields();
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; missing.length; i++) {
      rc = <span class="hljs-literal">false</span>;
      <span class="hljs-keyword">var</span> field = missing[i];
      <span class="hljs-keyword">var</span> widget = <span class="hljs-keyword">this</span>.getControl(field);
      <span class="hljs-keyword">var</span> tryLabel = <span class="hljs-literal">false</span>;
      <span class="hljs-keyword">try</span> {
        widget.focus();
      } <span class="hljs-keyword">catch</span> (e) {
        tryLabel = <span class="hljs-literal">true</span>;
      }
      <span class="hljs-keyword">if</span> (tryLabel) {
        <span class="hljs-keyword">var</span> displayWidget = <span class="hljs-keyword">this</span>.getDisplayBox(field);
        <span class="hljs-keyword">if</span> (displayWidget) {
          <span class="hljs-keyword">try</span> {
            displayWidget.focus();
          } <span class="hljs-keyword">catch</span> (exception) {}
        }
      }
      labels.push(<span class="hljs-keyword">this</span>.tableName + <span class="hljs-string">'.'</span> + field);
      <span class="hljs-keyword">var</span> widgetLabel = <span class="hljs-keyword">this</span>.getLabelOf(field);
      <span class="hljs-keyword">var</span> shortLabel = trim(widgetLabel + <span class="hljs-string">''</span>);
      invalidFields.push(shortLabel);
    }
    <span class="hljs-keyword">if</span> (!rc) {
      <span class="hljs-keyword">var</span> theText = invalidFields.join(<span class="hljs-string">', '</span>);
      theText = getMessage(<span class="hljs-string">'The following mandatory fields are not filled in'</span>) + <span class="hljs-string">': '</span> + theText;
      <span class="hljs-keyword">try</span> {
        alert(theText);
        <span class="hljs-keyword">this</span>.submitted = <span class="hljs-literal">false</span>;
      } <span class="hljs-keyword">catch</span> (e) {}
    }
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; labels.length; i++) {
      <span class="hljs-keyword">this</span>.flash(labels[i], <span class="hljs-string">"#FFFACD"</span>, <span class="hljs-number">0</span>);
    }
    <span class="hljs-keyword">return</span> rc;
  },
  <span class="hljs-attr">setVariablesReadOnly</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">readOnly</span>) </span>{
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> x = <span class="hljs-number">0</span>; x &lt; g_form.elements.length; x++) {
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-keyword">this</span>.nameMap.length; i++) {
        <span class="hljs-keyword">var</span> entry = <span class="hljs-keyword">this</span>.nameMap[i];
        <span class="hljs-keyword">var</span> element = g_form.elements[x];
        <span class="hljs-keyword">if</span> (entry.realName == element.fieldName &amp;&amp; element.tableName == <span class="hljs-string">"variable"</span>) {
          <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> g_sc_form == <span class="hljs-string">"undefined"</span> || !g_sc_form)
            <span class="hljs-keyword">this</span>.setReadOnly(entry.prettyName, readOnly);
          <span class="hljs-keyword">else</span>
            g_sc_form.setReadOnly(entry.prettyName, readOnly);
        }
      }
    }
  },
  <span class="hljs-attr">getEditableFields</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> fa = <span class="hljs-keyword">this</span>.elements;
    <span class="hljs-keyword">var</span> answer = [];
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; fa.length; i++) {
      <span class="hljs-keyword">var</span> ed = fa[i];
      <span class="hljs-keyword">var</span> widget = <span class="hljs-keyword">this</span>.getControl(ed.fieldName);
      <span class="hljs-keyword">if</span> (!widget)
        <span class="hljs-keyword">continue</span>;
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.isEditableField(ed, widget))
        answer.push(ed.fieldName);
    }
    <span class="hljs-keyword">return</span> answer;
  },
  <span class="hljs-attr">isEditableField</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">ge, control</span>) </span>{
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.isTemplateCompatible(ge, control)) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.isVisible(ge, control))
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.isReadOnly(ge, control))
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.isDisplayNone(ge, control))
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  },
  <span class="hljs-attr">isTemplateCompatible</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">ge, control</span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.elementHandlers[control.id]) {
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-keyword">this</span>.elementHandlers[control.id].isTemplatable == <span class="hljs-string">"function"</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.elementHandlers[control.id].isTemplatable();
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
      }
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
  },
  <span class="hljs-attr">isVisible</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">ge, control</span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.elementHandlers[control.id])
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-keyword">this</span>.elementHandlers[control.id].isVisible == <span class="hljs-string">"function"</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.elementHandlers[control.id].isVisible();
    <span class="hljs-keyword">if</span> (ge.getType() != <span class="hljs-string">"glide_duration"</span> &amp;&amp; ge.getType != <span class="hljs-string">"glide_time"</span>) {
      <span class="hljs-keyword">var</span> xx = control.style[<span class="hljs-string">'visibility'</span>];
      <span class="hljs-keyword">if</span> (xx == <span class="hljs-string">'hidden'</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
    xx = <span class="hljs-keyword">this</span>._getElementStyle(ge, <span class="hljs-string">'visibility'</span>);
    <span class="hljs-keyword">if</span> (xx == <span class="hljs-string">'hidden'</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  },
  <span class="hljs-attr">isDisabled</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName</span>) </span>{
    fieldName = <span class="hljs-keyword">this</span>.removeCurrentPrefix(fieldName);
    <span class="hljs-keyword">var</span> control = <span class="hljs-keyword">this</span>.getControl(fieldName);
    <span class="hljs-keyword">if</span> (!control)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.elementHandlers[control.id])
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-keyword">this</span>.elementHandlers[control.id].isDisabled == <span class="hljs-string">"function"</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.elementHandlers[control.id].isDisabled();
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.isReadOnly(<span class="hljs-string">""</span>, control);
  },
  <span class="hljs-attr">isReadOnly</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">ge, control</span>) </span>{
    <span class="hljs-keyword">if</span> (control) {
      <span class="hljs-keyword">return</span> control.disabled || control.readOnly;
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
  },
  <span class="hljs-attr">isDisplayNone</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">ge, control</span>) </span>{
    <span class="hljs-keyword">if</span> (ge.getType() == <span class="hljs-string">'html'</span> || ge.getType() == <span class="hljs-string">'translated_html'</span> || ge.getType() == <span class="hljs-string">'composite_name'</span> || ge.getType() == <span class="hljs-string">'url'</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">if</span> (!control)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">var</span> xx = control.style[<span class="hljs-string">'display'</span>];
    <span class="hljs-keyword">if</span> (xx == <span class="hljs-string">'none'</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">var</span> xx = <span class="hljs-keyword">this</span>._getElementStyle(ge, <span class="hljs-string">'display'</span>);
    <span class="hljs-keyword">if</span> (xx == <span class="hljs-string">'none'</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  },
  <span class="hljs-attr">_getElementStyle</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">ge, style</span>) </span>{
    <span class="hljs-keyword">var</span> element = ge.getElementParentNode();
    <span class="hljs-keyword">if</span> (element)
      <span class="hljs-keyword">return</span> element.style[style];
    <span class="hljs-keyword">var</span> labelElement = ge.getLabelElement();
    <span class="hljs-keyword">if</span> (labelElement)
      <span class="hljs-keyword">return</span> labelElement.parentNode.parentNode.style[style];
    <span class="hljs-keyword">var</span> parentTR = findParentByTag(ge.getElement(), <span class="hljs-string">"tr"</span>);
    <span class="hljs-keyword">if</span> (parentTR &amp;&amp; parentTR != labelElement)
      <span class="hljs-keyword">return</span> parentTR.style[name];
    <span class="hljs-keyword">return</span> <span class="hljs-string">""</span>;
  },
  <span class="hljs-attr">getMissingFields</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> fa = <span class="hljs-keyword">this</span>.elements;
    <span class="hljs-keyword">var</span> answer = [];
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; fa.length; i++) {
      <span class="hljs-keyword">var</span> ed = fa[i];
      <span class="hljs-keyword">if</span> (!ed.mandatory)
        <span class="hljs-keyword">continue</span>;
      <span class="hljs-keyword">var</span> widget = <span class="hljs-keyword">this</span>.getControl(ed.fieldName);
      <span class="hljs-keyword">if</span> (!widget)
        <span class="hljs-keyword">continue</span>;
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._isMandatoryFieldEmpty(ed))
        answer.push(ed.fieldName);
    }
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> g_sc_form != <span class="hljs-string">"undefined"</span> &amp;&amp; g_sc_form)
      g_sc_form.getMissingFields(answer);
    <span class="hljs-keyword">return</span> answer;
  },
  <span class="hljs-attr">_isMandatoryFieldEmpty</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">ed</span>) </span>{
    <span class="hljs-keyword">var</span> widgetValue = <span class="hljs-keyword">this</span>.getValue(ed.fieldName);
    <span class="hljs-keyword">if</span> (widgetValue != <span class="hljs-literal">null</span> &amp;&amp; widgetValue != <span class="hljs-string">''</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">var</span> displayBox = <span class="hljs-keyword">this</span>.getDisplayBox(ed.fieldName);
    <span class="hljs-keyword">if</span> (displayBox != <span class="hljs-literal">null</span>) {
      <span class="hljs-keyword">var</span> displayValue = displayBox.value;
      <span class="hljs-keyword">if</span> (displayValue != <span class="hljs-literal">null</span> &amp;&amp; displayValue != <span class="hljs-string">''</span> &amp;&amp; displayBox.getAttribute(<span class="hljs-string">'data-ref-dynamic'</span>) == <span class="hljs-string">'true'</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
      }
    }
    <span class="hljs-keyword">if</span> ((<span class="hljs-keyword">this</span>.isNewRecord() || <span class="hljs-keyword">this</span>.mandatory) &amp;&amp; !ed.isDerived())
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    widgetName = <span class="hljs-string">"sys_original."</span> + <span class="hljs-keyword">this</span>.tableName + <span class="hljs-string">'.'</span> + ed.fieldName;
    widget = gel(widgetName);
    <span class="hljs-keyword">if</span> (widget) {
      widgetValue = widget.value;
      <span class="hljs-keyword">if</span> (widgetValue == <span class="hljs-literal">null</span> || widgetValue == <span class="hljs-string">''</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  },
  <span class="hljs-attr">resolveNameMap</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">prettyName</span>) </span>{
    <span class="hljs-keyword">var</span> rc = prettyName;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-keyword">this</span>.nameMap.length; i++) {
      <span class="hljs-keyword">var</span> entry = <span class="hljs-keyword">this</span>.nameMap[i];
      <span class="hljs-keyword">if</span> (entry.prettyName == prettyName) {
        rc = entry.realName;
      }
    }
    <span class="hljs-keyword">return</span> rc;
  },
  <span class="hljs-attr">getFormElement</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> gel(<span class="hljs-keyword">this</span>.tableName + <span class="hljs-string">'.do'</span>);
  },
  <span class="hljs-attr">getControl</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName</span>) </span>{
    <span class="hljs-keyword">var</span> ge = <span class="hljs-keyword">this</span>.getGlideUIElement(fieldName);
    <span class="hljs-keyword">if</span> (ge) {
      <span class="hljs-keyword">var</span> widget = ge.getElement();
      <span class="hljs-keyword">if</span> (widget) {
        <span class="hljs-keyword">return</span> widget;
      }
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.getControlByForm(fieldName);
  },
  <span class="hljs-attr">getControlByForm</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName</span>) </span>{
    <span class="hljs-keyword">var</span> form = <span class="hljs-keyword">this</span>.getFormElement();
    <span class="hljs-keyword">if</span> (!form)
      <span class="hljs-keyword">return</span>;
    widget = form[<span class="hljs-keyword">this</span>.tableName + <span class="hljs-string">'.'</span> + fieldName];
    <span class="hljs-keyword">if</span> (!widget)
      widget = form[fieldName];
    <span class="hljs-keyword">if</span> (widget &amp;&amp; <span class="hljs-keyword">typeof</span> widget != <span class="hljs-string">'string'</span> &amp;&amp; widget.length &amp;&amp; widget.tagName != <span class="hljs-string">"SELECT"</span>) {
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; widget.length; i++) {
        <span class="hljs-keyword">if</span> (widget[i].checked)
          <span class="hljs-keyword">return</span> widget[i];
      }
      <span class="hljs-keyword">var</span> wt = widget[<span class="hljs-number">0</span>].type;
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> wt != <span class="hljs-string">'undefined'</span> &amp;&amp; wt == <span class="hljs-string">'radio'</span>)
        <span class="hljs-keyword">return</span> widget[<span class="hljs-number">0</span>];
    }
    <span class="hljs-keyword">return</span> widget;
  },
  <span class="hljs-attr">_tryLabelRow</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName</span>) </span>{
    <span class="hljs-keyword">var</span> element = <span class="hljs-keyword">this</span>._tryLabelRowElement(fieldName);
    <span class="hljs-keyword">if</span> (element)
      <span class="hljs-keyword">return</span> element.innerText || element.textContent;
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  },
  <span class="hljs-attr">_tryLabelRowElement</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName</span>) </span>{
    <span class="hljs-keyword">var</span> id = <span class="hljs-string">"label_"</span> + fieldName;
    <span class="hljs-keyword">var</span> row = gel(id);
    <span class="hljs-keyword">if</span> (row) {
      <span class="hljs-keyword">var</span> child = row.firstChild;
      <span class="hljs-keyword">if</span> (child) {
        <span class="hljs-keyword">return</span> child;
      }
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  },
  <span class="hljs-attr">getLabelOf</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName</span>) </span>{
    <span class="hljs-keyword">var</span> fieldid = <span class="hljs-keyword">this</span>.tableName + <span class="hljs-string">'.'</span> + fieldName;
    <span class="hljs-keyword">var</span> widgetLabel = <span class="hljs-keyword">this</span>.getLabel(fieldid);
    <span class="hljs-keyword">var</span> labelContent = <span class="hljs-string">""</span>;
    <span class="hljs-keyword">if</span> (widgetLabel) {
      labelContent = widgetLabel.innerText ||
        widgetLabel.textContent;
      <span class="hljs-keyword">if</span> (labelContent.indexOf(<span class="hljs-string">'*'</span>) == <span class="hljs-number">0</span> &amp;&amp;
        <span class="hljs-built_in">document</span>.documentElement.getAttribute(<span class="hljs-string">'data-doctype'</span>) == <span class="hljs-string">'true'</span>)
        labelContent = labelContent.toString().substring(<span class="hljs-number">1</span>);
      <span class="hljs-keyword">if</span> ((labelContent.lastIndexOf(<span class="hljs-string">":"</span>) + <span class="hljs-number">1</span>) == labelContent.length)
        labelContent = labelContent.toString().substring(<span class="hljs-number">0</span>, (labelContent.length - <span class="hljs-number">1</span>));
    }
    <span class="hljs-keyword">if</span> (labelContent == <span class="hljs-literal">null</span> || labelContent == <span class="hljs-string">''</span>)
      labelContent = <span class="hljs-keyword">this</span>._tryLabelRow(fieldName);
    <span class="hljs-keyword">if</span> (labelContent == <span class="hljs-literal">null</span> || labelContent == <span class="hljs-string">''</span>)
      labelContent = fieldName;
    <span class="hljs-keyword">return</span> labelContent.trim();
  },
  <span class="hljs-attr">setLabelOf</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName, value</span>) </span>{
    <span class="hljs-keyword">var</span> control = g_form.getControl(fieldName);
    <span class="hljs-keyword">var</span> setLabelOfSomething = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.elementHandlers[control.id] &amp;&amp; (<span class="hljs-keyword">typeof</span> <span class="hljs-keyword">this</span>.elementHandlers[control.id].setLabelOf == <span class="hljs-string">"function"</span>))
      setLabelOfSomething = <span class="hljs-keyword">this</span>.elementHandlers[control.id].setLabelOf(value);
    <span class="hljs-keyword">var</span> labelEl = <span class="hljs-keyword">this</span>._getLabelEl(fieldName);
    <span class="hljs-keyword">if</span> (labelEl) {
      $j(labelEl).find(<span class="hljs-string">'.label-text'</span>).text(value);
      setLabelOfSomething = <span class="hljs-literal">true</span>;
    }
    <span class="hljs-keyword">return</span> setLabelOfSomething;
  },
  <span class="hljs-attr">_getLabelEl</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName</span>) </span>{
    <span class="hljs-keyword">var</span> fieldID = <span class="hljs-keyword">this</span>.tableName + <span class="hljs-string">'.'</span> + fieldName;
    <span class="hljs-keyword">var</span> labelEl = <span class="hljs-keyword">this</span>.getLabel(fieldID);
    <span class="hljs-keyword">if</span> (labelEl)
      <span class="hljs-keyword">return</span> labelEl;
    labelEl = <span class="hljs-keyword">this</span>._tryLabelRowElement(fieldName);
    <span class="hljs-keyword">if</span> (labelEl)
      <span class="hljs-keyword">return</span> labelEl;
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  },
  <span class="hljs-attr">_getDecorationsEl</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">field</span>) </span>{
    <span class="hljs-keyword">var</span> label = (field <span class="hljs-keyword">instanceof</span> jQuery) ? field : $j(<span class="hljs-keyword">this</span>._getLabelEl(field));
    <span class="hljs-keyword">if</span> (!label.length)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">var</span> decorations = label.find(<span class="hljs-string">'.field_decorations'</span>);
    <span class="hljs-keyword">if</span> (!decorations.length) {
      $j(<span class="hljs-string">'&lt;span class="field_decorations" data-label-decorations="[]" /&gt;'</span>).prependTo(label);
      decorations = label.find(<span class="hljs-string">'.field_decorations'</span>);
    }
    <span class="hljs-keyword">return</span> decorations;
  },
  <span class="hljs-attr">_getDecorations</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName</span>) </span>{
    <span class="hljs-keyword">var</span> attrName = <span class="hljs-string">'data-label-decorations'</span>;
    <span class="hljs-keyword">var</span> decorations = <span class="hljs-keyword">this</span>._getDecorationsEl(fieldName);
    <span class="hljs-keyword">if</span> (decorations &amp;&amp; decorations.length) {
      <span class="hljs-keyword">var</span> raw = decorations.attr(attrName);
      <span class="hljs-keyword">var</span> json = <span class="hljs-built_in">JSON</span>.parse(raw);
      <span class="hljs-keyword">if</span> (json)
        <span class="hljs-keyword">return</span> json;
    }
    <span class="hljs-keyword">return</span> [];
  },
  <span class="hljs-attr">_setDecorations</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName, decorations</span>) </span>{
    <span class="hljs-keyword">var</span> isArr = <span class="hljs-built_in">Array</span>.isArray || <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">obj</span>) </span>{
      <span class="hljs-keyword">return</span> $j.type(obj) === <span class="hljs-string">"array"</span>;
    };
    <span class="hljs-keyword">if</span> (!isArr(decorations))
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">var</span> attrName = <span class="hljs-string">'data-label-decorations'</span>;
    <span class="hljs-keyword">var</span> labelEl = <span class="hljs-keyword">this</span>._getLabelEl(fieldName);
    <span class="hljs-keyword">if</span> (labelEl) {
      <span class="hljs-keyword">var</span> raw = <span class="hljs-built_in">JSON</span>.stringify(decorations);
      <span class="hljs-keyword">var</span> decorEl = <span class="hljs-keyword">this</span>._getDecorationsEl($j(labelEl));
      decorEl.empty();
      decorEl.attr(attrName, raw);
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; decorations.length; i++) {
        <span class="hljs-keyword">var</span> dec = decorations[i];
        <span class="hljs-keyword">var</span> $dec = $j(<span class="hljs-string">'&lt;span class="field_decoration '</span> + dec.icon + <span class="hljs-string">' '</span> + dec.color + <span class="hljs-string">'" '</span> +
          <span class="hljs-string">'title="'</span> + dec.text + <span class="hljs-string">'" '</span> +
          <span class="hljs-string">'data-placement="right"&gt;&lt;/span&gt;'</span>)
        decorEl.append($dec);
        $dec.tooltip().hideFix();
      }
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  },
  <span class="hljs-attr">addDecoration</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">field, icon, text, color</span>) </span>{
    text = text || <span class="hljs-string">''</span>;
    color = color || <span class="hljs-string">''</span>;
    <span class="hljs-keyword">var</span> decorations = <span class="hljs-keyword">this</span>._getDecorations(field);
    <span class="hljs-keyword">var</span> deco = {
      <span class="hljs-attr">icon</span>: icon,
      <span class="hljs-attr">text</span>: text,
      <span class="hljs-attr">color</span>: color
    };
    <span class="hljs-keyword">var</span> isDuplicate = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">var</span> maxi = decorations.length;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; maxi; i++) {
      <span class="hljs-keyword">var</span> dec = decorations[i];
      <span class="hljs-keyword">if</span> (dec.icon == icon &amp;&amp;
        dec.text == text &amp;&amp;
        dec.color == color) {
        isDuplicate = <span class="hljs-literal">true</span>;
      }
    }
    <span class="hljs-keyword">if</span> (!isDuplicate)
      decorations.push(deco);
    <span class="hljs-keyword">this</span>._setDecorations(field, decorations);
  },
  <span class="hljs-attr">removeDecoration</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">field, icon, text, color</span>) </span>{
    text = text || <span class="hljs-string">''</span>;
    color = color || <span class="hljs-string">''</span>;
    <span class="hljs-keyword">var</span> decorations = <span class="hljs-keyword">this</span>._getDecorations(field);
    <span class="hljs-keyword">var</span> out = [];
    <span class="hljs-keyword">var</span> maxi = decorations.length;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; maxi; i++) {
      <span class="hljs-keyword">var</span> dec = decorations[i];
      <span class="hljs-keyword">if</span> (!(dec.icon == icon &amp;&amp;
          dec.text == text &amp;&amp;
          dec.color == color)) {
        out.push(dec);
      }
    }
    <span class="hljs-keyword">this</span>._setDecorations(field, out);
  },
  <span class="hljs-attr">removeAllDecorations</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    $j(<span class="hljs-string">'.field_decorations'</span>).remove();
  },
  <span class="hljs-attr">getSectionNames</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> g_tabs2Sections.tabNames;
  },
  <span class="hljs-attr">setSectionDisplay</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name, display</span>) </span>{
    <span class="hljs-keyword">var</span> index = g_tabs2Sections.findTabIndexByName(name);
    <span class="hljs-keyword">if</span> (index === <span class="hljs-number">-1</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">if</span> (display)
      g_tabs2Sections.showTab(index);
    <span class="hljs-keyword">else</span>
      g_tabs2Sections.hideTab(index);
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  },
  <span class="hljs-attr">isSectionVisible</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name</span>) </span>{
    <span class="hljs-keyword">var</span> index = g_tabs2Sections.findTabIndexByName(name);
    <span class="hljs-keyword">if</span> (index !== <span class="hljs-number">-1</span>)
      <span class="hljs-keyword">return</span> g_tabs2Sections.isVisible(index);
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  },
  <span class="hljs-attr">activateTab</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name</span>) </span>{
    <span class="hljs-keyword">var</span> index = g_tabs2Sections.findTabIndexByName(name);
    <span class="hljs-keyword">if</span> (index !== <span class="hljs-number">-1</span>)
      <span class="hljs-keyword">return</span> g_tabs2Sections.setActive(index);
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  },
  <span class="hljs-attr">getTabNameForField</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName</span>) </span>{
    <span class="hljs-keyword">if</span> (!g_form.hasField(fieldName))
      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">var</span> control = g_form.getControl(fieldName);
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._getTabNameForElement(control);
  },
  <span class="hljs-attr">_getTabNameForElement</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">element</span>) </span>{
    <span class="hljs-keyword">var</span> sectionId = $j(element).closest(<span class="hljs-string">'[data-section-id]'</span>).attr(<span class="hljs-string">'id'</span>);
    <span class="hljs-keyword">if</span> (sectionId) {
      <span class="hljs-keyword">var</span> tabIndex = g_tabs2Sections.findTabIndexByID(sectionId);
      <span class="hljs-keyword">return</span> g_tabs2Sections.tabNames[tabIndex];
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  },
  <span class="hljs-attr">validate</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> fa = <span class="hljs-keyword">this</span>.elements;
    <span class="hljs-keyword">var</span> rc = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">var</span> labels = [];
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; fa.length; i++) {
      <span class="hljs-keyword">var</span> ed = fa[i];
      <span class="hljs-keyword">var</span> widgetName = <span class="hljs-keyword">this</span>.tableName + <span class="hljs-string">'.'</span> + ed.fieldName;
      <span class="hljs-keyword">var</span> widget = <span class="hljs-keyword">this</span>.getControl(ed.fieldName);
      <span class="hljs-keyword">if</span> (!widget)
        <span class="hljs-keyword">continue</span>;
      <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.isEditableField(ed, widget))
        <span class="hljs-keyword">continue</span>;
      <span class="hljs-keyword">if</span> (widget.getAttribute(<span class="hljs-string">"validate"</span>) == <span class="hljs-string">"false"</span>)
        <span class="hljs-keyword">continue</span>;
      <span class="hljs-keyword">var</span> widgetValue = widget.value;
      <span class="hljs-keyword">var</span> widgetType = ed.type;
      <span class="hljs-keyword">var</span> specialType = widget.getAttribute(<span class="hljs-string">"specialtype"</span>);
      <span class="hljs-keyword">if</span> (specialType)
        widgetType = specialType;
      <span class="hljs-keyword">var</span> validator = <span class="hljs-keyword">this</span>.validators[widgetType];
      <span class="hljs-keyword">if</span> (!validator)
        <span class="hljs-keyword">continue</span>;
      <span class="hljs-keyword">this</span>.hideFieldMsg(widget);
      <span class="hljs-keyword">var</span> isValid = validator.call(<span class="hljs-keyword">this</span>, widgetValue);
      <span class="hljs-keyword">if</span> (isValid != <span class="hljs-literal">null</span> &amp;&amp; isValid != <span class="hljs-literal">true</span>) {
        <span class="hljs-keyword">var</span> widgetLabel = <span class="hljs-keyword">this</span>.getLabelOf(ed.fieldName);
        labels.push(widgetName);
        rc = <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">if</span> (isValid == <span class="hljs-literal">false</span> || isValid == <span class="hljs-string">"false"</span>)
          isValid = getMessage(<span class="hljs-string">"Invalid text"</span>);
        <span class="hljs-keyword">this</span>.showFieldMsg(widget, isValid, <span class="hljs-string">'error'</span>);
      }
    }
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; labels.length; i++)
      <span class="hljs-keyword">this</span>.flash(labels[i], <span class="hljs-string">"#FFFACD"</span>, <span class="hljs-number">0</span>);
    <span class="hljs-keyword">return</span> rc;
  },
  <span class="hljs-attr">removeCurrentPrefix</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">id</span>) </span>{
    <span class="hljs-keyword">if</span> (id) {
      <span class="hljs-keyword">if</span> (id.indexOf(<span class="hljs-string">'current.'</span>) == <span class="hljs-number">0</span>) {
        id = id.substring(<span class="hljs-number">8</span>);
      }
      <span class="hljs-keyword">return</span> id;
    }
  },
  <span class="hljs-attr">isNumeric</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">internaltype</span>) </span>{
    <span class="hljs-keyword">if</span> (internaltype == <span class="hljs-string">'decimal'</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">if</span> (internaltype == <span class="hljs-string">'float'</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">if</span> (internaltype == <span class="hljs-string">'integer'</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">if</span> (internaltype == <span class="hljs-string">'numeric'</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  },
  <span class="hljs-attr">isInteger</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">internaltype</span>) </span>{
    <span class="hljs-keyword">if</span> (internaltype == <span class="hljs-string">'integer'</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  },
  <span class="hljs-attr">setTemplateValue</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName, value, displayValue</span>) </span>{
    fieldName = <span class="hljs-keyword">this</span>.removeCurrentPrefix(fieldName);
    <span class="hljs-keyword">var</span> control = <span class="hljs-keyword">this</span>.getControl(fieldName);
    <span class="hljs-keyword">if</span> (control)
      control.templateValue = <span class="hljs-string">'true'</span>;
    <span class="hljs-keyword">var</span> text = <span class="hljs-string">"Field modified by template"</span>;
    <span class="hljs-keyword">this</span>.setValue(fieldName, value, displayValue);
    <span class="hljs-keyword">this</span>.addDecoration(fieldName, <span class="hljs-string">'icon-success'</span>, text);
  },
  <span class="hljs-attr">setValue</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName, value, displayValue</span>) </span>{
    <span class="hljs-keyword">var</span> oldValue = <span class="hljs-keyword">this</span>.getValue(fieldName);
    fieldName = <span class="hljs-keyword">this</span>.removeCurrentPrefix(fieldName);
    <span class="hljs-keyword">var</span> control = <span class="hljs-keyword">this</span>.getControl(fieldName);
    <span class="hljs-keyword">if</span> (!control) {
      <span class="hljs-keyword">var</span> handler = <span class="hljs-keyword">this</span>.getPrefixHandler(fieldName);
      <span class="hljs-keyword">if</span> (handler)
        handler.getObject().setValue(handler.getFieldName(),
          value, displayValue);
      <span class="hljs-keyword">return</span>;
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">if</span> (control.options &amp;&amp; control.options.length) {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; control.options.length; i++) {
          control.options[i].removeAttribute(<span class="hljs-string">'selected'</span>);
        }
      }
    }
    <span class="hljs-keyword">this</span>._internalChange = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">this</span>._setValue(fieldName, value, displayValue, <span class="hljs-literal">true</span>);
    <span class="hljs-keyword">this</span>._internalChange = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">this</span>._opticsInspectorLog(fieldName, oldValue);
  },
  <span class="hljs-attr">getNiBox</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName</span>) </span>{
    <span class="hljs-keyword">var</span> niName = <span class="hljs-string">'ni.'</span> + <span class="hljs-keyword">this</span>.tableName + <span class="hljs-string">'.'</span> + fieldName;
    <span class="hljs-keyword">return</span> gel(niName);
  },
  <span class="hljs-attr">getDisplayBox</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName</span>) </span>{
    <span class="hljs-keyword">var</span> dName = <span class="hljs-string">'sys_display.'</span> + <span class="hljs-keyword">this</span>.tableName + <span class="hljs-string">'.'</span> + fieldName;
    <span class="hljs-keyword">var</span> field = gel(dName);
    <span class="hljs-keyword">if</span> (field)
      <span class="hljs-keyword">return</span> field;
    dName = <span class="hljs-string">'sys_display.'</span> + fieldName;
    field = gel(dName);
    <span class="hljs-keyword">if</span> (field)
      <span class="hljs-keyword">return</span> field;
    <span class="hljs-keyword">var</span> handler = <span class="hljs-keyword">this</span>.getPrefixHandler(fieldName);
    <span class="hljs-keyword">if</span> (handler) {
      <span class="hljs-keyword">var</span> handlerObject = handler.getObject();
      <span class="hljs-keyword">return</span> handlerObject.getDisplayBox(handlerObject.removeCurrentPrefix(fieldName));
    }
    <span class="hljs-keyword">return</span>;
  },
  <span class="hljs-attr">clearValue</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName</span>) </span>{
    fieldName = <span class="hljs-keyword">this</span>.removeCurrentPrefix(fieldName);
    <span class="hljs-keyword">var</span> control = <span class="hljs-keyword">this</span>.getControl(fieldName);
    <span class="hljs-keyword">if</span> (!control)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">if</span> (!control.options) {
      <span class="hljs-keyword">this</span>._setValue(fieldName, <span class="hljs-string">''</span>);
      <span class="hljs-keyword">return</span>;
    }
    <span class="hljs-keyword">var</span> selindex = control.selectedIndex;
    <span class="hljs-keyword">if</span> (selindex != <span class="hljs-number">-1</span>) {
      <span class="hljs-keyword">var</span> option = control.options[selindex];
      option.selected = <span class="hljs-literal">false</span>;
    }
    <span class="hljs-keyword">var</span> options = control.options;
    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; options.length; i++) {
      <span class="hljs-keyword">var</span> option = options[i];
      <span class="hljs-keyword">var</span> optval = option.value;
      <span class="hljs-keyword">if</span> (optval == <span class="hljs-string">''</span>) {
        option.selected = <span class="hljs-literal">true</span>;
        <span class="hljs-keyword">break</span>;
      }
    }
  },
  <span class="hljs-attr">_sanitizeFieldName</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName</span>) </span>{
    fieldName = <span class="hljs-keyword">this</span>.removeCurrentPrefix(fieldName);
    fieldName = <span class="hljs-keyword">this</span>._removeTableName(fieldName);
    <span class="hljs-keyword">return</span> fieldName;
  },
  <span class="hljs-attr">_removeTableName</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName</span>) </span>{
    <span class="hljs-keyword">if</span> (fieldName.indexOf(<span class="hljs-keyword">this</span>.tableName + <span class="hljs-string">"."</span>) === <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">var</span> length = <span class="hljs-keyword">this</span>.tableName.length + <span class="hljs-number">1</span>;
      fieldName = fieldName.substring(length);
    }
    <span class="hljs-keyword">return</span> fieldName;
  },
  <span class="hljs-attr">_setValue</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName, value, displayValue, updateRelated</span>) </span>{
    fieldName = <span class="hljs-keyword">this</span>._sanitizeFieldName(fieldName);
    <span class="hljs-keyword">var</span> control = <span class="hljs-keyword">this</span>.getControl(fieldName);
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> control === <span class="hljs-string">'undefined'</span>)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">var</span> readOnlyField = gel(<span class="hljs-string">'sys_readonly.'</span> + control.id);
    <span class="hljs-keyword">if</span> (readOnlyField) {
      <span class="hljs-keyword">if</span> (readOnlyField.tagName == <span class="hljs-string">"SPAN"</span>) {
        <span class="hljs-keyword">var</span> fieldType = readOnlyField.getAttribute(<span class="hljs-string">'gsft_fieldtype'</span>);
        <span class="hljs-keyword">if</span> (fieldType &amp;&amp; fieldType.indexOf(<span class="hljs-string">"html"</span>) &gt; <span class="hljs-number">-1</span>)
          readOnlyField.innerHTML = value;
        <span class="hljs-keyword">else</span>
          readOnlyField.innerHTML = htmlEscape(value);
      } <span class="hljs-keyword">else</span>
      <span class="hljs-keyword">if</span> (displayValue &amp;&amp; readOnlyField.tagName != <span class="hljs-string">"SELECT"</span>)
        readOnlyField.value = displayValue;
      <span class="hljs-keyword">else</span>
        readOnlyField.value = value;
    } <span class="hljs-keyword">else</span> {
      readOnlyField = gel(control.id + <span class="hljs-string">"_label"</span>);
      <span class="hljs-keyword">if</span> (readOnlyField) {
        displayValue = <span class="hljs-keyword">this</span>._ensureDisplayValue(fieldName, value, displayValue);
        <span class="hljs-keyword">if</span> (readOnlyField.tagName == <span class="hljs-string">'SPAN'</span>)
          readOnlyField.innerHTML = displayValue;
        <span class="hljs-keyword">else</span>
          readOnlyField.value = displayValue;
      }
    }
    <span class="hljs-keyword">if</span> (control &amp;&amp; control.id &amp;&amp; <span class="hljs-keyword">this</span>.elementHandlers[control.id] &amp;&amp; (<span class="hljs-keyword">typeof</span> <span class="hljs-keyword">this</span>.elementHandlers[control.id].setValue == <span class="hljs-string">"function"</span>)) {
      <span class="hljs-keyword">this</span>.elementHandlers[control.id].setValue(value, displayValue);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-string">'select2'</span> <span class="hljs-keyword">in</span> $j(control).data()) {
      $j(control).select2(<span class="hljs-string">'val'</span>, value);
      onChange(<span class="hljs-keyword">this</span>.tableName + <span class="hljs-string">"."</span> + fieldName);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (control.options) {
      <span class="hljs-keyword">var</span> i = <span class="hljs-keyword">this</span>._getSelectedIndex(control, value, displayValue);
      control.selectedIndex = i;
      onChange(<span class="hljs-keyword">this</span>.tableName + <span class="hljs-string">"."</span> + fieldName);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (control.type == <span class="hljs-string">'hidden'</span>) {
      <span class="hljs-keyword">var</span> nibox = <span class="hljs-keyword">this</span>.getNiBox(fieldName);
      <span class="hljs-keyword">if</span> (nibox &amp;&amp; nibox.type == <span class="hljs-string">'checkbox'</span>) {
        <span class="hljs-keyword">if</span> (value &amp;&amp; value == <span class="hljs-string">'0'</span>)
          value = <span class="hljs-string">'false'</span>;
        <span class="hljs-keyword">if</span> (value &amp;&amp; value == <span class="hljs-string">'1'</span>)
          value = <span class="hljs-string">'true'</span>;
        control.value = value;
        onChange(<span class="hljs-keyword">this</span>.tableName + <span class="hljs-string">"."</span> + fieldName);
        <span class="hljs-keyword">if</span> (value &amp;&amp; value == <span class="hljs-string">'false'</span>)
          nibox.checked = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (value || value == <span class="hljs-string">'true'</span>)
          nibox.checked = <span class="hljs-string">'true'</span>;
        <span class="hljs-keyword">else</span>
          nibox.checked = <span class="hljs-literal">null</span>;
        setCheckBox(nibox);
        <span class="hljs-keyword">return</span>;
      }
      <span class="hljs-keyword">var</span> displaybox = <span class="hljs-keyword">this</span>.getDisplayBox(fieldName);
      <span class="hljs-keyword">if</span> (displaybox) {
        <span class="hljs-keyword">var</span> sel = gel(<span class="hljs-string">"sys_select."</span> + <span class="hljs-keyword">this</span>.tableName + <span class="hljs-string">"."</span> + fieldName);
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span>(displayValue) == <span class="hljs-string">'undefined'</span> &amp;&amp; value)
          displayValue = <span class="hljs-keyword">this</span>._ensureDisplayValue(fieldName, value, displayValue);
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span>(displayValue) != <span class="hljs-string">'undefined'</span>) {
          control.value = value;
          displaybox.value = displayValue;
          onChange(<span class="hljs-keyword">this</span>.tableName + <span class="hljs-string">"."</span> + fieldName);
          removeClassName(displaybox, <span class="hljs-string">'ref_invalid'</span>);
          removeClassName(displaybox, <span class="hljs-string">'ref_dynamic'</span>);
          displaybox.title = <span class="hljs-string">""</span>;
          <span class="hljs-keyword">this</span>._setReferenceSelect(control, sel, value, displayValue);
          refFlipImage(displaybox, control.id);
          <span class="hljs-keyword">if</span> (updateRelated) {
            updateRelatedGivenNameAndValue(<span class="hljs-keyword">this</span>.tableName + <span class="hljs-string">'.'</span> + fieldName, value);
          }
          <span class="hljs-keyword">return</span>;
        }
        control.value = value;
        onChange(<span class="hljs-keyword">this</span>.tableName + <span class="hljs-string">"."</span> + fieldName);
        <span class="hljs-keyword">if</span> (value == <span class="hljs-literal">null</span> || value == <span class="hljs-string">''</span>) {
          displaybox.value = <span class="hljs-string">''</span>;
          <span class="hljs-keyword">this</span>._setReferenceSelect(control, sel, value, <span class="hljs-string">''</span>);
          refFlipImage(displaybox, control.id);
          <span class="hljs-keyword">return</span>;
        }
        displaybox.value = displayValue;
        <span class="hljs-keyword">this</span>._setReferenceSelect(control, sel, value, displayValue);
        refFlipImage(displaybox, control.id);
        updateRelatedGivenNameAndValue(<span class="hljs-keyword">this</span>.tableName + <span class="hljs-string">'.'</span> + fieldName, value);
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ($(control).hasClassName(<span class="hljs-string">'glide_destroy_filter'</span>)) {
        control.value = value;
        onChange(<span class="hljs-keyword">this</span>.tableName + <span class="hljs-string">"."</span> + fieldName);
      }
    } <span class="hljs-keyword">else</span> {
      control.value = value;
      onChange(<span class="hljs-keyword">this</span>.tableName + <span class="hljs-string">"."</span> + fieldName);
    }
  },
  <span class="hljs-attr">_setReferenceSelect</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">control, sel, value, displayValue</span>) </span>{
    <span class="hljs-keyword">if</span> (control &amp;&amp; !control.options &amp;&amp; sel) {
      <span class="hljs-keyword">var</span> i = <span class="hljs-keyword">this</span>._getSelectedIndex(sel, value, displayValue);
      sel.selectedIndex = i;
    }
  },
  <span class="hljs-attr">_getSelectedIndex</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">control, value, displayValue</span>) </span>{
    <span class="hljs-keyword">var</span> options = control.options;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; options.length; i++) {
      <span class="hljs-keyword">var</span> option = options[i];
      <span class="hljs-keyword">if</span> (option.value == value) {
        <span class="hljs-keyword">return</span> i;
      }
    }
    <span class="hljs-keyword">var</span> dv = value;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span>(displayValue) != <span class="hljs-string">'undefined'</span>)
      dv = displayValue;
    <span class="hljs-keyword">var</span> newOption = <span class="hljs-keyword">new</span> Option(dv, value);
    control.options[control.options.length] = newOption;
    <span class="hljs-keyword">return</span> control.options.length - <span class="hljs-number">1</span>;
  },
  <span class="hljs-attr">_ensureDisplayValue</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName, value, displayValue</span>) </span>{
    <span class="hljs-keyword">if</span> (displayValue)
      <span class="hljs-keyword">return</span> displayValue;
    <span class="hljs-keyword">var</span> ed = <span class="hljs-keyword">this</span>.getGlideUIElement(fieldName);
    <span class="hljs-keyword">if</span> (!ed)
      <span class="hljs-keyword">return</span> displayValue;
    <span class="hljs-keyword">if</span> (ed.type != <span class="hljs-string">'reference'</span> &amp;&amp; ed.type != <span class="hljs-string">'domain_id'</span>)
      <span class="hljs-keyword">return</span> displayValue;
    <span class="hljs-keyword">var</span> ga = <span class="hljs-keyword">new</span> GlideAjax(<span class="hljs-string">'AjaxClientHelper'</span>);
    ga.addParam(<span class="hljs-string">'sysparm_name'</span>, <span class="hljs-string">'getDisplay'</span>);
    ga.addParam(<span class="hljs-string">'sysparm_table'</span>, ed.reference);
    ga.addParam(<span class="hljs-string">'sysparm_value'</span>, value);
    ga.getXMLWait();
    <span class="hljs-keyword">return</span> ga.getAnswer();
  },
  <span class="hljs-attr">getUniqueValue</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.getValue(<span class="hljs-string">'sys_uniqueValue'</span>);
  },
  <span class="hljs-attr">getTitle</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.getValue(<span class="hljs-string">'sys_titleValue'</span>);
  },
  <span class="hljs-attr">getValue</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName</span>) </span>{
    fieldName = <span class="hljs-keyword">this</span>.removeCurrentPrefix(fieldName);
    <span class="hljs-keyword">var</span> control = <span class="hljs-keyword">this</span>.getControl(fieldName);
    <span class="hljs-keyword">if</span> (!control) {
      <span class="hljs-keyword">var</span> handler = <span class="hljs-keyword">this</span>.getPrefixHandler(fieldName);
      <span class="hljs-keyword">if</span> (handler)
        <span class="hljs-keyword">return</span> handler.getObject().getValue(
          handler.getFieldName());
      <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._getValueFromControl(control);
  },
  <span class="hljs-attr">getDisplayValue</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.getValue(<span class="hljs-string">'sys_displayValue'</span>);
  },
  <span class="hljs-attr">_getValueFromControl</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">control</span>) </span>{
    <span class="hljs-keyword">var</span> value;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.elementHandlers[control.id] &amp;&amp; (<span class="hljs-keyword">typeof</span> <span class="hljs-keyword">this</span>.elementHandlers[control.id].getValue == <span class="hljs-string">"function"</span>)) {
      value = <span class="hljs-keyword">this</span>.elementHandlers[control.id].getValue();
    } <span class="hljs-keyword">else</span> {
      value = control.value;
    }
    <span class="hljs-keyword">return</span> (<span class="hljs-keyword">typeof</span> value !== <span class="hljs-string">'undefined'</span>) ? value.toString() : <span class="hljs-string">''</span>;
  },
  <span class="hljs-attr">getIntValue</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName</span>) </span>{
    <span class="hljs-keyword">var</span> val = <span class="hljs-keyword">this</span>.getValue(fieldName);
    <span class="hljs-keyword">if</span> (!val || val.length == <span class="hljs-number">0</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">parseInt</span>(formatClean(val));
  },
  <span class="hljs-attr">getDecimalValue</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName</span>) </span>{
    <span class="hljs-keyword">var</span> val = <span class="hljs-keyword">this</span>.getValue(fieldName);
    <span class="hljs-keyword">if</span> (!val || val.length == <span class="hljs-number">0</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
    <span class="hljs-keyword">var</span> fc = formatClean(val);
    fc = fc.replace(<span class="hljs-regexp">/,/g</span>, <span class="hljs-string">'.'</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">parseFloat</span>(fc);
  },
  <span class="hljs-attr">getBooleanValue</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName</span>) </span>{
    <span class="hljs-keyword">var</span> val = <span class="hljs-keyword">this</span>.getValue(fieldName);
    val = val ? val + <span class="hljs-string">''</span> : val;
    <span class="hljs-keyword">if</span> (!val || val.length == <span class="hljs-number">0</span> || val == <span class="hljs-string">"false"</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  },
  <span class="hljs-attr">addOption</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName, choiceValue, choiceLabel, choiceIndex</span>) </span>{
    fieldName = <span class="hljs-keyword">this</span>.removeCurrentPrefix(fieldName);
    <span class="hljs-keyword">var</span> control = <span class="hljs-keyword">this</span>.getControl(fieldName);
    <span class="hljs-keyword">if</span> (!control) {
      <span class="hljs-keyword">var</span> handler = <span class="hljs-keyword">this</span>.getPrefixHandler(fieldName);
      <span class="hljs-keyword">if</span> (handler)
        handler.getObject().addOption(handler.getFieldName(), choiceValue, choiceLabel, choiceIndex);
      <span class="hljs-keyword">return</span>;
    }
    <span class="hljs-keyword">if</span> (!control.options)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">var</span> len = control.options.length;
    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; len; i++) {
      <span class="hljs-keyword">if</span> (control.options[i].text == choiceLabel) {
        <span class="hljs-keyword">return</span>;
      }
    }
    <span class="hljs-keyword">if</span> (choiceIndex == <span class="hljs-literal">undefined</span>)
      choiceIndex = len;
    <span class="hljs-keyword">if</span> (choiceIndex &lt; <span class="hljs-number">0</span> || choiceIndex &gt; len)
      choiceIndex = len;
    <span class="hljs-keyword">var</span> newOption = <span class="hljs-keyword">new</span> Option(choiceLabel, choiceValue);
    <span class="hljs-keyword">var</span> value = choiceValue;
    <span class="hljs-keyword">if</span> (len &gt; <span class="hljs-number">0</span>) {
      value = <span class="hljs-keyword">this</span>.getValue(fieldName);
      control.options[len] = <span class="hljs-keyword">new</span> Option(<span class="hljs-string">''</span>, <span class="hljs-string">''</span>);
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = len; i &gt; choiceIndex; i--) {
        control.options[i].text = control.options[i - <span class="hljs-number">1</span>].text;
        control.options[i].value = control.options[i - <span class="hljs-number">1</span>].value;
      }
    }
    control.options[choiceIndex] = newOption;
    <span class="hljs-keyword">this</span>.setValue(fieldName, value);
  },
  <span class="hljs-attr">enableOption</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">control, choiceValue, choiceLabel</span>) </span>{
    <span class="hljs-keyword">var</span> len = control.options.length;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = len - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) {
      <span class="hljs-keyword">if</span> (control.options[i].text == choiceLabel &amp;&amp; control.options[i].value == choiceValue) {
        control.options[i].disabled = <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
      }
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  },
  <span class="hljs-attr">clearOptions</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName</span>) </span>{
    fieldName = <span class="hljs-keyword">this</span>.removeCurrentPrefix(fieldName);
    <span class="hljs-keyword">var</span> control = <span class="hljs-keyword">this</span>.getControl(fieldName);
    <span class="hljs-keyword">if</span> (control &amp;&amp; !control.options) {
      <span class="hljs-keyword">var</span> name = <span class="hljs-string">"sys_select."</span> + <span class="hljs-keyword">this</span>.tableName + <span class="hljs-string">"."</span> + fieldName;
      control = gel(name);
    }
    <span class="hljs-keyword">if</span> (!control) {
      <span class="hljs-keyword">var</span> handler = <span class="hljs-keyword">this</span>.getPrefixHandler(fieldName);
      <span class="hljs-keyword">if</span> (handler)
        handler.getObject().clearOptions(handler.getFieldName());
      <span class="hljs-keyword">return</span>;
    }
    <span class="hljs-keyword">if</span> (!control.options)
      <span class="hljs-keyword">return</span>;
    control.innerHTML = <span class="hljs-string">''</span>;
  },
  <span class="hljs-attr">getOptionControl</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName, choiceValue</span>) </span>{
    <span class="hljs-keyword">var</span> noPrefix = <span class="hljs-keyword">this</span>.removeCurrentPrefix(fieldName);
    <span class="hljs-keyword">var</span> control = <span class="hljs-keyword">this</span>.getControl(noPrefix);
    <span class="hljs-keyword">if</span> (control &amp;&amp; !control.options) {
      <span class="hljs-keyword">var</span> name = <span class="hljs-string">"sys_select."</span> + <span class="hljs-keyword">this</span>.tableName + <span class="hljs-string">"."</span> + noPrefix;
      control = gel(name);
    }
    <span class="hljs-keyword">return</span> control;
  },
  <span class="hljs-attr">removeOption</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName, choiceValue</span>) </span>{
    <span class="hljs-keyword">var</span> control = <span class="hljs-keyword">this</span>.getOptionControl(fieldName, choiceValue);
    <span class="hljs-keyword">if</span> (!control)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">if</span> (!control.options)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">var</span> options = control.options;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; options.length; i++) {
      <span class="hljs-keyword">var</span> option = options[i];
      <span class="hljs-keyword">if</span> (option.value == choiceValue) {
        control.options[i] = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">break</span>;
      }
    }
  },
  <span class="hljs-attr">getOption</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName, choiceValue</span>) </span>{
    <span class="hljs-keyword">var</span> control = <span class="hljs-keyword">this</span>.getOptionControl(fieldName, choiceValue);
    <span class="hljs-keyword">if</span> (!control)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">if</span> (!control.options)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">var</span> options = control.options;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; options.length; i++) {
      <span class="hljs-keyword">var</span> option = options[i];
      <span class="hljs-keyword">if</span> (option.value == choiceValue)
        <span class="hljs-keyword">return</span> option;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  },
  <span class="hljs-attr">removeContextItem</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">itemID</span>) </span>{
    <span class="hljs-keyword">for</span> (av <span class="hljs-keyword">in</span> contextMenus) {
      <span class="hljs-keyword">if</span> (contextMenus[av]) {
        <span class="hljs-keyword">var</span> menu = contextMenus[av];
        <span class="hljs-keyword">var</span> c = menu.context;
        <span class="hljs-keyword">if</span> (c)
          <span class="hljs-keyword">this</span>.removeItem(menu, itemID);
      }
    }
  },
  <span class="hljs-attr">removeItem</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">menu, itemID</span>) </span>{
    <span class="hljs-keyword">var</span> items = menu.childNodes;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; items.length; i++) {
      <span class="hljs-keyword">var</span> item = items[i];
      <span class="hljs-keyword">if</span> (item.innerHTML == itemID) {
        menu.removeChild(item);
        clearNodes(item);
        <span class="hljs-keyword">break</span>;
      }
    }
    <span class="hljs-keyword">return</span>;
  },
  <span class="hljs-attr">getGlideUIElement</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName</span>) </span>{
    fieldName = <span class="hljs-keyword">this</span>.removeCurrentPrefix(fieldName);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-keyword">this</span>.elements.length; i++) {
      <span class="hljs-keyword">var</span> thisElement = <span class="hljs-keyword">this</span>.elements[i];
      <span class="hljs-keyword">if</span> (thisElement.fieldName == fieldName)
        <span class="hljs-keyword">return</span> thisElement;
    }
  },
  <span class="hljs-attr">getDerivedFields</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName</span>) </span>{
    <span class="hljs-keyword">var</span> parts = fieldName.split(<span class="hljs-string">"."</span>);
    parts.shift();
    fieldName = parts.join(<span class="hljs-string">"."</span>) + <span class="hljs-string">"."</span>;
    <span class="hljs-keyword">var</span> list = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>();
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-keyword">this</span>.elements.length; i++) {
      <span class="hljs-keyword">var</span> thisElement = <span class="hljs-keyword">this</span>.elements[i];
      <span class="hljs-keyword">if</span> (thisElement.fieldName.indexOf(fieldName) == <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">var</span> target = thisElement.fieldName.substring(fieldName.length);
        list.push(target);
      }
    }
    <span class="hljs-keyword">if</span> (list.length == <span class="hljs-number">0</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">return</span> list;
  },
  <span class="hljs-attr">_addDerivedWaiting</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName</span>) </span>{
    <span class="hljs-keyword">this</span>.derivedWaiting.push(fieldName);
  },
  <span class="hljs-attr">_isDerivedWaiting</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName</span>) </span>{
    <span class="hljs-keyword">var</span> tablePrefix = <span class="hljs-keyword">this</span>.tableName + <span class="hljs-string">"."</span>;
    <span class="hljs-keyword">if</span> (fieldName.startsWith(tablePrefix))
      fieldName = fieldName.substring(tablePrefix.length);
    <span class="hljs-keyword">var</span> index = <span class="hljs-keyword">this</span>.derivedWaiting.indexOf(fieldName);
    <span class="hljs-keyword">return</span> (index != <span class="hljs-number">-1</span>);
  },
  <span class="hljs-attr">_removeDerivedWaiting</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName</span>) </span>{
    <span class="hljs-keyword">var</span> index = <span class="hljs-keyword">this</span>.derivedWaiting.indexOf(fieldName);
    <span class="hljs-keyword">if</span> (index &gt; <span class="hljs-number">-1</span>)
      <span class="hljs-keyword">this</span>.derivedWaiting.splice(index, <span class="hljs-number">1</span>);
  },
  <span class="hljs-attr">getReference</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName, callback</span>) </span>{
    <span class="hljs-keyword">var</span> opticsContext = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>[<span class="hljs-string">'g_optics_inspect_handler'</span>] &amp;&amp; g_optics_inspect_handler.opticsContextStack.length &gt; <span class="hljs-number">0</span>)
      opticsContext = g_optics_inspect_handler.opticsContextStack[g_optics_inspect_handler.opticsContextStack.length - <span class="hljs-number">1</span>];
    fieldName = <span class="hljs-keyword">this</span>.removeCurrentPrefix(fieldName);
    <span class="hljs-keyword">var</span> ed = <span class="hljs-keyword">this</span>.getGlideUIElement(fieldName);
    <span class="hljs-keyword">if</span> (!ed) {
      <span class="hljs-keyword">var</span> handler = <span class="hljs-keyword">this</span>.getPrefixHandler(fieldName);
      <span class="hljs-keyword">if</span> (handler)
        <span class="hljs-keyword">return</span> handler.getObject().getReference(handler.getFieldName(), callback);
      <span class="hljs-keyword">return</span>;
    }
    <span class="hljs-keyword">if</span> (ed.type != <span class="hljs-string">'reference'</span> &amp;&amp; ed.type != <span class="hljs-string">'domain_id'</span>)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">var</span> value = <span class="hljs-keyword">this</span>.getValue(fieldName);
    <span class="hljs-keyword">var</span> gr = <span class="hljs-keyword">new</span> GlideRecord(ed.reference);
    <span class="hljs-keyword">if</span> (value == <span class="hljs-string">""</span>) {
      <span class="hljs-keyword">if</span> (callback)
        callback(gr);
      <span class="hljs-keyword">return</span> gr;
    }
    gr.addQuery(<span class="hljs-string">'sys_id'</span>, value);
    <span class="hljs-keyword">if</span> (callback) {
      <span class="hljs-keyword">var</span> fn = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">gr</span>) </span>{
        gr.next();
        <span class="hljs-keyword">if</span> (opticsContext)
          CustomEvent.fire(<span class="hljs-string">'glide_optics_inspect_put_context'</span>, opticsContext[<span class="hljs-string">"category"</span>], opticsContext[<span class="hljs-string">"name"</span>], opticsContext[<span class="hljs-string">"sys_id"</span>]);
        callback(gr);
        <span class="hljs-keyword">if</span> (opticsContext)
          CustomEvent.fire(<span class="hljs-string">'glide_optics_inspect_pop_context'</span>);
      };
      gr.query(fn);
      <span class="hljs-keyword">return</span>;
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">var</span> sw = <span class="hljs-keyword">new</span> StopWatch();
      sw.jslog(<span class="hljs-string">"*** WARNING *** GlideForm: synchronous getReference call on "</span> + <span class="hljs-keyword">this</span>.getTableName());
    }
    gr.query();
    gr.next();
    <span class="hljs-keyword">return</span> gr;
  },
  <span class="hljs-attr">submit</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> action = gel(<span class="hljs-string">'sysverb_update'</span>);
    <span class="hljs-keyword">if</span> (action)
      <span class="hljs-keyword">return</span> gsftSubmit(action);
  },
  <span class="hljs-attr">save</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> action = gel(<span class="hljs-string">'sysverb_update_and_stay'</span>);
    <span class="hljs-keyword">if</span> (action)
      <span class="hljs-keyword">return</span> gsftSubmit(action);
  },
  <span class="hljs-attr">getActionName</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> form = <span class="hljs-keyword">this</span>.getFormElement();
    <span class="hljs-keyword">if</span> (form) {
      <span class="hljs-keyword">var</span> theButton = form.sys_action;
      <span class="hljs-keyword">if</span> (theButton)
        <span class="hljs-keyword">return</span> theButton.value;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.action;
  },
  <span class="hljs-attr">getTableName</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.tableName;
  },
  <span class="hljs-attr">getSections</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> $$(<span class="hljs-string">'form span.tabs2_section span[data-header-only="false"]'</span>);
  },
  <span class="hljs-attr">serialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">filterFunc</span>) </span>{
    <span class="hljs-keyword">var</span> formName = <span class="hljs-keyword">this</span>.tableName + <span class="hljs-string">'.do'</span>;
    <span class="hljs-keyword">if</span> (!filterFunc)
      <span class="hljs-keyword">return</span> Form.serialize(gel(formName)) + <span class="hljs-keyword">this</span>._serializeDisabled();
    <span class="hljs-keyword">var</span> elements = Form.getElements(gel(formName));
    <span class="hljs-keyword">var</span> queryComponents = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>();
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; elements.length; i++) {
      <span class="hljs-keyword">if</span> (filterFunc(elements[i])) {
        <span class="hljs-keyword">var</span> queryComponent;
        <span class="hljs-keyword">if</span> (elements[i].disabled)
          queryComponent = elements[i].id + <span class="hljs-string">'='</span> + <span class="hljs-built_in">encodeURIComponent</span>(elements[i].value);
        <span class="hljs-keyword">else</span>
          queryComponent = Form.Element.serialize(elements[i]);
        <span class="hljs-keyword">if</span> (queryComponent)
          queryComponents.push(queryComponent);
      }
    }
    <span class="hljs-keyword">return</span> queryComponents.join(<span class="hljs-string">'&amp;'</span>);
  },
  <span class="hljs-attr">_serializeDisabled</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> n = <span class="hljs-keyword">this</span>.disabledFields.length;
    <span class="hljs-keyword">var</span> dfa = [];
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; n; i++) {
      <span class="hljs-keyword">var</span> e = <span class="hljs-keyword">this</span>.disabledFields[i];
      <span class="hljs-keyword">if</span> (!e.value || !e.id)
        <span class="hljs-keyword">continue</span>;
      dfa.push(e.id + <span class="hljs-string">'='</span> + <span class="hljs-built_in">encodeURIComponent</span>(e.value));
    }
    <span class="hljs-keyword">if</span> (dfa.length)
      <span class="hljs-keyword">return</span> <span class="hljs-string">'&amp;'</span> + dfa.join(<span class="hljs-string">'&amp;'</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>;
  },
  <span class="hljs-attr">serializeChanged</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> s = <span class="hljs-keyword">this</span>.serializeTargetFields();
    <span class="hljs-keyword">var</span> f = <span class="hljs-keyword">this</span>.serialize(<span class="hljs-keyword">this</span>.changedFieldsFilter.bind(<span class="hljs-keyword">this</span>));
    <span class="hljs-keyword">if</span> (f)
      f = <span class="hljs-string">"&amp;"</span> + f;
    <span class="hljs-keyword">return</span> s + f;
  },
  <span class="hljs-attr">serializeChangedAll</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> s = <span class="hljs-keyword">this</span>.serializeTargetFields();
    <span class="hljs-keyword">var</span> f = <span class="hljs-keyword">this</span>.serialize(<span class="hljs-keyword">this</span>.allChangedFieldsFilter.bind(<span class="hljs-keyword">this</span>));
    <span class="hljs-keyword">if</span> (f)
      f = <span class="hljs-string">"&amp;"</span> + f;
    <span class="hljs-keyword">return</span> s + f;
  },
  <span class="hljs-attr">serializeTargetFields</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> s = <span class="hljs-keyword">this</span>._serializeElement(<span class="hljs-string">"sys_target"</span>);
    s += <span class="hljs-keyword">this</span>._serializeElement(<span class="hljs-string">"sys_uniqueValue"</span>);
    s += <span class="hljs-keyword">this</span>._serializeElement(<span class="hljs-string">"sys_row"</span>);
    s += <span class="hljs-keyword">this</span>._serializeElement(<span class="hljs-string">"sysparm_encoded_record"</span>);
    <span class="hljs-keyword">return</span> s;
  },
  <span class="hljs-attr">_serializeElement</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">id</span>) </span>{
    <span class="hljs-keyword">var</span> e = gel(id);
    <span class="hljs-keyword">if</span> (e) {
      <span class="hljs-keyword">var</span> queryComponent = Form.Element.serialize(e);
      <span class="hljs-keyword">if</span> (queryComponent)
        <span class="hljs-keyword">return</span> <span class="hljs-string">"&amp;"</span> + queryComponent;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-string">""</span>;
  },
  <span class="hljs-attr">changedFieldsFilter</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">element</span>) </span>{
    <span class="hljs-keyword">if</span> (element.changed &amp;&amp;
      element.id.startsWith(<span class="hljs-keyword">this</span>.getTableName() + <span class="hljs-string">"."</span>) &amp;&amp;
      (element.tagName.toUpperCase() != <span class="hljs-string">"TEXTAREA"</span>))
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">if</span> (element.id.startsWith(<span class="hljs-string">"ni.VE"</span>))
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">if</span> (element.name.startsWith(<span class="hljs-string">"ni.WATERMARK"</span>))
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  },
  <span class="hljs-attr">allChangedFieldsFilter</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">element</span>) </span>{
    <span class="hljs-keyword">if</span> (element.changed &amp;&amp; element.id.startsWith(<span class="hljs-keyword">this</span>.getTableName() + <span class="hljs-string">"."</span>))
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  },
  <span class="hljs-attr">flash</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">widgetName, color, count</span>) </span>{
    <span class="hljs-keyword">var</span> row = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">var</span> labels = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>();
    <span class="hljs-keyword">var</span> realLabel = <span class="hljs-keyword">this</span>.getLabel(widgetName);
    <span class="hljs-keyword">if</span> (realLabel)
      row = $(realLabel.parentNode.parentNode);
    <span class="hljs-keyword">else</span> {
      jslog(<span class="hljs-string">"flash() called for '"</span> + widgetName + <span class="hljs-string">"' but there is no label for it"</span>)
      <span class="hljs-keyword">return</span>;
    }
    <span class="hljs-keyword">var</span> temp = row.select(<span class="hljs-string">'.label_left'</span>);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; temp.length; i++)
      labels.push(temp[i]);
    temp = row.select(<span class="hljs-string">'.label_right'</span>);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; temp.length; i++)
      labels.push(temp[i]);
    temp = row.select(<span class="hljs-string">'.label'</span>);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; temp.length; i++)
      labels.push(temp[i]);
    temp = row.select(<span class="hljs-string">'.control-label'</span>);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; temp.length; i++)
      labels.push(temp[i]);
    count = count + <span class="hljs-number">1</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; labels.length; i++) {
      <span class="hljs-keyword">var</span> widget = labels[i];
      <span class="hljs-keyword">if</span> (widget) {
        <span class="hljs-keyword">var</span> originalColor = widget.style.backgroundColor;
        widget.style.backgroundColor = color;
      }
    }
    <span class="hljs-keyword">if</span> (count &lt; <span class="hljs-number">4</span>)
      setTimeout(<span class="hljs-string">'g_form.flash("'</span> + widgetName + <span class="hljs-string">'", "'</span> + originalColor + <span class="hljs-string">'", '</span> + count + <span class="hljs-string">')'</span>, <span class="hljs-number">500</span>);
  },
  <span class="hljs-attr">enable</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> form = <span class="hljs-keyword">this</span>.getFormElement();
    <span class="hljs-keyword">if</span> (form)
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; form.elements.length; i++)
        form.elements[i].disabled = <span class="hljs-literal">false</span>;
  },
  <span class="hljs-attr">disable</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> form = <span class="hljs-keyword">this</span>.getFormElement();
    <span class="hljs-keyword">if</span> (form)
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; form.elements.length; i++)
        form.elements[i].disabled = <span class="hljs-literal">true</span>;
  },
  <span class="hljs-attr">showRelatedList</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">listTableName</span>) </span>{
    CustomEvent.fire(<span class="hljs-string">'related_lists.show'</span>, listTableName);
  },
  <span class="hljs-attr">hideRelatedList</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">listTableName</span>) </span>{
    CustomEvent.fire(<span class="hljs-string">'related_lists.hide'</span>, listTableName);
  },
  <span class="hljs-attr">getRelatedListNames</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.NOW.g_relatedLists)
      <span class="hljs-keyword">return</span> <span class="hljs-built_in">window</span>.NOW.g_relatedLists.lists;
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.g_tabs2List) {
      <span class="hljs-keyword">var</span> relatedListNames = [];
      <span class="hljs-keyword">var</span> trimmedNames = g_tabs2List.tabIDs;
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; trimmedNames.length; i++)
        relatedListNames.push(trimmedNames[i].split(<span class="hljs-string">'.'</span>).slice(<span class="hljs-number">1</span>).join(<span class="hljs-string">'.'</span>));
      <span class="hljs-keyword">return</span> relatedListNames;
    }
    <span class="hljs-keyword">var</span> listWrapper = gel(<span class="hljs-string">"related_lists_wrapper"</span>);
    <span class="hljs-keyword">if</span> (!listWrapper)
      <span class="hljs-keyword">return</span> [];
    <span class="hljs-keyword">var</span> forthcomingTabs = listWrapper.getAttribute(<span class="hljs-string">'data-lists'</span>);
    <span class="hljs-keyword">if</span> (!forthcomingTabs)
      <span class="hljs-keyword">return</span> [];
    <span class="hljs-keyword">return</span> forthcomingTabs.split(<span class="hljs-string">','</span>);
  },
  <span class="hljs-attr">_getRelatedListID</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">listTableName</span>) </span>{
    <span class="hljs-keyword">var</span> relatedList = <span class="hljs-keyword">this</span>.findV2RelatedListName(listTableName);
    <span class="hljs-keyword">var</span> relatedListId;
    <span class="hljs-keyword">if</span> (relatedList)
      relatedListId = relatedList.getAttribute(<span class="hljs-string">"id"</span>);
    <span class="hljs-keyword">if</span> (!relatedListId)
      relatedListId = <span class="hljs-keyword">this</span>.getTableName() + <span class="hljs-string">"."</span> + listTableName;
    <span class="hljs-keyword">return</span> relatedListId;
  },
  <span class="hljs-attr">findV2RelatedListName</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">listTableName</span>) </span>{
    <span class="hljs-keyword">var</span> tableName = <span class="hljs-keyword">this</span>.getTableName();
    <span class="hljs-keyword">var</span> compareId = tableName + <span class="hljs-string">"."</span> + listTableName;
    <span class="hljs-keyword">var</span> rlw = gel(<span class="hljs-string">"related_lists_wrapper"</span>);
    <span class="hljs-keyword">if</span> (!rlw)
      <span class="hljs-keyword">return</span> <span class="hljs-string">""</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; rlw.childNodes.length; i++) {
      <span class="hljs-keyword">var</span> node = rlw.childNodes[i];
      <span class="hljs-keyword">if</span> (node.nodeName != <span class="hljs-string">"DIV"</span>)
        <span class="hljs-keyword">continue</span>;
      <span class="hljs-keyword">var</span> idName = node.getAttribute(<span class="hljs-string">"id"</span>);
      <span class="hljs-keyword">if</span> (idName.length == <span class="hljs-number">0</span>)
        <span class="hljs-keyword">continue</span>;
      <span class="hljs-keyword">if</span> (idName.indexOf(compareId) &gt; <span class="hljs-number">-1</span>)
        <span class="hljs-keyword">return</span> node;
    }
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> GlideLists2 == <span class="hljs-string">"undefined"</span>)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> id <span class="hljs-keyword">in</span> GlideLists2) {
      <span class="hljs-keyword">var</span> list = GlideLists2[id];
      <span class="hljs-keyword">if</span> (list.getTableName() == listTableName &amp;&amp; list.getParentTable() == tableName)
        <span class="hljs-keyword">return</span> list.getContainer();
    }
    <span class="hljs-keyword">return</span> <span class="hljs-string">""</span>;
  },
  <span class="hljs-attr">showRelatedLists</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> listNames = g_form.getRelatedListNames();
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; listNames.length; i++) {
      <span class="hljs-keyword">this</span>.showRelatedList(listNames[i]);
    }
  },
  <span class="hljs-attr">hideRelatedLists</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> listNames = g_form.getRelatedListNames();
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; listNames.length; i++) {
      <span class="hljs-keyword">this</span>.hideRelatedList(listNames[i]);
    }
  },
  <span class="hljs-attr">addInfoMessage</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">msg, id</span>) </span>{
    <span class="hljs-keyword">this</span>._addFormMessage(msg, <span class="hljs-string">"info"</span>, id);
  },
  <span class="hljs-attr">addWarningMessage</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">msg, id</span>) </span>{
    <span class="hljs-keyword">this</span>._addFormMessage(msg, <span class="hljs-string">"warning"</span>, id);
  },
  <span class="hljs-attr">addErrorMessage</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">msg, id</span>) </span>{
    <span class="hljs-keyword">this</span>._addFormMessage(msg, <span class="hljs-string">"error"</span>, id);
  },
  <span class="hljs-attr">_addFormMessage</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">msg, type, id</span>) </span>{
    GlideUI.get().addOutputMessage({
      <span class="hljs-attr">msg</span>: msg,
      <span class="hljs-attr">type</span>: type,
      <span class="hljs-attr">id</span>: id
    });
    <span class="hljs-keyword">var</span> scrollDiv = getFormContentParent();
    scrollDiv.scrollTop = <span class="hljs-number">0</span>;
  },
  <span class="hljs-attr">clearMessages</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    GlideUI.get().clearOutputMessages();
  },
  <span class="hljs-attr">showFieldMsg</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">input, message, type, scrollForm</span>) </span>{
    <span class="hljs-keyword">var</span> msgClass;
    <span class="hljs-keyword">var</span> msgImage;
    <span class="hljs-keyword">var</span> msgImageAlt;
    <span class="hljs-keyword">var</span> msgRowType;
    <span class="hljs-keyword">switch</span> (type) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">"info"</span>:
        msgClass = <span class="hljs-keyword">this</span>.INFO_CLASS;
        msgRowType = <span class="hljs-string">'info'</span> + <span class="hljs-keyword">this</span>.MSG_ROW;
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">"error"</span>:
        msgClass = <span class="hljs-keyword">this</span>.ERROR_CLASS;
        msgRowType = <span class="hljs-string">'error'</span> + <span class="hljs-keyword">this</span>.MSG_ROW;
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">"warning"</span>:
        msgClass = <span class="hljs-keyword">this</span>.WARNING_CLASS;
        msgRowType = <span class="hljs-string">'warning'</span> + <span class="hljs-keyword">this</span>.MSG_ROW;
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">default</span>:
        type = <span class="hljs-string">'info'</span>;
        msgClass = <span class="hljs-keyword">this</span>.INFO_CLASS;
        msgRowType = <span class="hljs-string">'info'</span> + <span class="hljs-keyword">this</span>.MSG_ROW;
        <span class="hljs-keyword">break</span>;
    }
    <span class="hljs-keyword">var</span> inputElement = input;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span>(inputElement) == <span class="hljs-string">"string"</span>)
      inputElement = <span class="hljs-keyword">this</span>.getControl(inputElement);
    <span class="hljs-keyword">if</span> (!inputElement) {
      <span class="hljs-keyword">var</span> handler = <span class="hljs-keyword">this</span>.getPrefixHandler(input);
      <span class="hljs-keyword">if</span> (handler) {
        <span class="hljs-keyword">var</span> handlerObject = handler.getObject();
        <span class="hljs-keyword">var</span> fieldName = handler.getFieldName();
        <span class="hljs-keyword">var</span> actualName = handlerObject.getActualName(fieldName);
        inputElement = handlerObject.getControl(actualName);
      }
    }
    <span class="hljs-keyword">if</span> (!inputElement || !message) {
      jslog(<span class="hljs-string">"ERROR: invalid field or missing message passed to g_form.showFieldMsg('"</span> + input + <span class="hljs-string">"','"</span> + message + <span class="hljs-string">"')"</span>);
      <span class="hljs-keyword">return</span>;
    }
    <span class="hljs-keyword">if</span> (inputElement.id &amp;&amp; <span class="hljs-keyword">this</span>.elementHandlers[inputElement.id] &amp;&amp; (<span class="hljs-keyword">typeof</span> <span class="hljs-keyword">this</span>.elementHandlers[inputElement.id].showFieldMsg == <span class="hljs-string">"function"</span>))
      <span class="hljs-keyword">this</span>.elementHandlers[inputElement.id].showFieldMsg(input, message, type);
    <span class="hljs-keyword">var</span> positionedCursor = <span class="hljs-keyword">this</span>._positionCursorAtError(inputElement, message);
    <span class="hljs-keyword">var</span> fieldRowId = <span class="hljs-string">"element."</span> + inputElement.id;
    <span class="hljs-keyword">var</span> fieldRow = <span class="hljs-built_in">document</span>.getElementById(fieldRowId);
    <span class="hljs-keyword">var</span> doc;
    <span class="hljs-keyword">var</span> isVariable = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">var</span> variableMsgRow = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">if</span> (!fieldRow) {
      <span class="hljs-keyword">var</span> parent = inputElement.parentNode;
      <span class="hljs-keyword">while</span> (parent != <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">if</span> (parent.nodeName.toUpperCase() == <span class="hljs-string">'TR'</span>) {
          fieldRow = parent;
          isVariable = <span class="hljs-literal">true</span>;
          <span class="hljs-keyword">break</span>;
        }
        parent = parent.parentNode;
      }
    }
    <span class="hljs-keyword">if</span> (!fieldRow) {
      jslog(<span class="hljs-string">"Error adding field message. Couldn't find the row to add the field message to."</span>);
      <span class="hljs-keyword">return</span>;
    }
    doc = fieldRow.ownerDocument;
    <span class="hljs-keyword">var</span> inputContainer = inputElement.up(<span class="hljs-string">'.form-field'</span>);
    <span class="hljs-keyword">if</span> (!inputContainer)
      inputContainer = inputElement.up();
    <span class="hljs-keyword">var</span> fieldMsgContainer = inputContainer.down(<span class="hljs-string">'.fieldmsg-container'</span>);
    <span class="hljs-keyword">if</span> (!fieldMsgContainer) {
      fieldMsgContainer = doc.createElement(<span class="hljs-string">'div'</span>);
      fieldMsgContainer.className = <span class="hljs-string">'fieldmsg-container'</span>;
      <span class="hljs-keyword">if</span> (isVariable)
        fieldMsgContainer.className = <span class="hljs-string">'variable-field-msg'</span>;
      fieldMsgContainer.id = inputElement.id + <span class="hljs-string">'_fieldmsg'</span>;
      inputContainer.insert(fieldMsgContainer);
      inputElement.setAttribute(<span class="hljs-string">'aria-describedby'</span>, fieldMsgContainer.id);
    }
    <span class="hljs-keyword">var</span> fieldMsgRow = doc.createElement(<span class="hljs-string">'DIV'</span>);
    fieldMsgRow.className = msgClass;
    fieldMsgRow.hasFieldmsg = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">var</span> fieldmsgMsg = doc.createTextNode(message);
    fieldMsgRow.appendChild(fieldmsgMsg);
    fieldMsgContainer.insert(fieldMsgRow);
    <span class="hljs-keyword">if</span> (!positionedCursor)
      <span class="hljs-keyword">this</span>._scrollToElementTR(fieldRow, fieldMsgRow, scrollForm);
    _frameChanged();
  },
  <span class="hljs-attr">_scrollToElementTR</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">labelTR, msgTR, scrollForm</span>) </span>{
    <span class="hljs-keyword">var</span> scroll = scrollForm;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> scroll == <span class="hljs-string">"undefined"</span>) {
      <span class="hljs-keyword">var</span> scrollToMsg = gel(<span class="hljs-string">"ni.scroll_to_messsage_field"</span>);
      <span class="hljs-keyword">if</span> (scrollToMsg == <span class="hljs-literal">null</span>)
        scroll = <span class="hljs-literal">true</span>;
      <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">if</span> (scrollToMsg.value != <span class="hljs-string">"false"</span>)
          scroll = <span class="hljs-literal">true</span>;
        <span class="hljs-keyword">else</span>
          scroll = <span class="hljs-literal">false</span>;
      }
    }
    <span class="hljs-keyword">if</span> (!scroll)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">var</span> scrollDiv = getFormContentParent();
    <span class="hljs-keyword">var</span> refControl = gel(<span class="hljs-string">"sys_target"</span>);
    <span class="hljs-keyword">var</span> ref;
    <span class="hljs-keyword">var</span> titleDiv;
    <span class="hljs-keyword">if</span> (refControl != <span class="hljs-literal">null</span>) {
      ref = refControl.value;
      titleDiv = gel(ref + <span class="hljs-string">".form_header"</span>);
    } <span class="hljs-keyword">else</span> {
      titleDiv = gel(<span class="hljs-string">"form_header"</span>);
    }
    <span class="hljs-keyword">var</span> headerHeight = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">if</span> (titleDiv &amp;&amp; titleDiv.clientHeight)
      headerHeight = titleDiv.clientHeight;
    <span class="hljs-keyword">var</span> topOfLabel = grabOffsetTop(labelTR);
    <span class="hljs-keyword">var</span> needToScroll = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">if</span> (topOfLabel &gt; scrollDiv.scrollTop + scrollDiv.clientHeight)
      needToScroll = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (topOfLabel &lt; scrollDiv.scrollTop + headerHeight)
      needToScroll = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">var</span> topOfMsg = grabOffsetTop(msgTR);
      <span class="hljs-keyword">if</span> (topOfMsg &gt; scrollDiv.scrollTop + scrollDiv.clientHeight)
        needToScroll = <span class="hljs-literal">true</span>;
    }
    <span class="hljs-keyword">if</span> (!needToScroll)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">var</span> scrollTopSetting = topOfLabel - headerHeight;
    <span class="hljs-keyword">if</span> (scrollDiv.id)
      setTimeout(<span class="hljs-string">"$('"</span> + scrollDiv.id + <span class="hljs-string">"').scrollTop = "</span> + scrollTopSetting, <span class="hljs-number">100</span>);
    <span class="hljs-keyword">else</span>
      scrollDiv.scrollTop = scrollTopSetting;
  },
  <span class="hljs-attr">showErrorBox</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">input, message, scrollForm</span>) </span>{
    <span class="hljs-keyword">this</span>.showFieldMsg(input, message, <span class="hljs-string">"error"</span>, scrollForm);
  },
  <span class="hljs-attr">hideFieldMsg</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">input, clearAll</span>) </span>{
    <span class="hljs-keyword">var</span> inputElement = input;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span>(inputElement) == <span class="hljs-string">"string"</span>)
      inputElement = <span class="hljs-keyword">this</span>.getControl(inputElement);
    <span class="hljs-keyword">if</span> (!inputElement) {
      <span class="hljs-keyword">var</span> handler = <span class="hljs-keyword">this</span>.getPrefixHandler(input);
      <span class="hljs-keyword">if</span> (handler) {
        <span class="hljs-keyword">var</span> handlerObject = handler.getObject();
        <span class="hljs-keyword">var</span> fieldName = handler.getFieldName();
        <span class="hljs-keyword">var</span> actualName = handlerObject.getActualName(fieldName);
        inputElement = handlerObject.getControl(actualName);
      }
    }
    <span class="hljs-keyword">if</span> (!inputElement) {
      jslog(<span class="hljs-string">"ERROR: invalid field ('"</span> + input + <span class="hljs-string">"') passed to g_form.hideFieldMsg"</span>);
      <span class="hljs-keyword">return</span>;
    }
    <span class="hljs-keyword">if</span> (inputElement.id &amp;&amp; <span class="hljs-keyword">this</span>.elementHandlers[inputElement.id] &amp;&amp; (<span class="hljs-keyword">typeof</span> <span class="hljs-keyword">this</span>.elementHandlers[inputElement.id].hideFieldMsg == <span class="hljs-string">"function"</span>))
      <span class="hljs-keyword">this</span>.elementHandlers[inputElement.id].hideFieldMsg(input, clearAll);
    <span class="hljs-keyword">var</span> fieldTrId = <span class="hljs-string">"element."</span> + inputElement.id;
    <span class="hljs-keyword">var</span> tr = <span class="hljs-built_in">document</span>.getElementById(fieldTrId);
    <span class="hljs-keyword">if</span> (!tr) {
      <span class="hljs-keyword">var</span> parent = inputElement.up(<span class="hljs-string">"div.form-field.input_controls"</span>);
      <span class="hljs-keyword">if</span> (!parent)
        parent = inputElement.up(<span class="hljs-string">"td"</span>);
      <span class="hljs-keyword">if</span> (parent) {
        <span class="hljs-keyword">var</span> msgs = $(parent).select(<span class="hljs-string">".variable-field-msg"</span>);
        <span class="hljs-keyword">if</span> (msgs)
          <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; msgs.length; i++) {
            parent.removeChild(msgs[i]);
            <span class="hljs-keyword">if</span> (!clearAll)
              <span class="hljs-keyword">return</span>;
          }
      }
    }
    <span class="hljs-keyword">if</span> (tr == <span class="hljs-literal">null</span>)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">var</span> msgContainer = tr.down(<span class="hljs-string">'.fieldmsg-container'</span>);
    <span class="hljs-keyword">if</span> (!msgContainer)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">if</span> (clearAll)
      msgContainer.update(<span class="hljs-string">''</span>);
    <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">var</span> messages = msgContainer.select(<span class="hljs-string">'.fieldmsg'</span>);
      <span class="hljs-keyword">if</span> (messages[<span class="hljs-number">0</span>])
        messages[<span class="hljs-number">0</span>].remove();
    }
  },
  <span class="hljs-attr">hasFieldMsgs</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">type</span>) </span>{
    <span class="hljs-keyword">var</span> formHasFieldMsgs = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">if</span> (type) {
      <span class="hljs-keyword">var</span> msgTRs = $(<span class="hljs-built_in">document</span>.body).select(<span class="hljs-string">'.fieldmsg.notification-'</span> + type);
      formHasFieldMsgs = msgTRs.length &gt; <span class="hljs-number">0</span>;
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">var</span> msgTRs = $(<span class="hljs-built_in">document</span>.body).select(<span class="hljs-string">'.fieldmsg'</span>);
      formHasFieldMsgs = msgTRs.length &gt; <span class="hljs-number">0</span>;
    }
    <span class="hljs-keyword">return</span> formHasFieldMsgs;
  },
  <span class="hljs-attr">hideAllFieldMsgs</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">type</span>) </span>{
    <span class="hljs-keyword">if</span> (type) {
      <span class="hljs-keyword">var</span> msgTRs = $(<span class="hljs-built_in">document</span>.body).select(<span class="hljs-string">'.fieldmsg.notification-'</span> + type);
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; msgTRs.length; i++) {
        msgTRs[i].parentNode.removeChild(msgTRs[i]);
      }
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">var</span> msgTRs = $(<span class="hljs-built_in">document</span>.body).select(<span class="hljs-string">'.fieldmsg'</span>);
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; msgTRs.length; i++) {
        msgTRs[i].parentNode.removeChild(msgTRs[i]);
      }
    }
    CustomEvent.fire(<span class="hljs-string">'sn.form.hide_all_field_msg'</span>, type);
  },
  <span class="hljs-attr">hideErrorBox</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">input</span>) </span>{
    <span class="hljs-keyword">this</span>.hideFieldMsg(input);
  },
  <span class="hljs-attr">setStreamJournalFieldsDisplay</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">show</span>) </span>{
    CustomEvent.fire(<span class="hljs-string">'sn.stream.change_input_display'</span>, <span class="hljs-keyword">this</span>.getTableName(), show);
    CustomEvent.fire(<span class="hljs-string">'sn.form.change_input_display'</span>, !show);
  },
  <span class="hljs-attr">_positionCursorAtError</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">elem, message</span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> elem == <span class="hljs-string">"undefined"</span> || elem.disabled)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">var</span> index = message.indexOf(<span class="hljs-string">"line ("</span>);
    <span class="hljs-keyword">if</span> (index &gt; <span class="hljs-number">-1</span>) {
      <span class="hljs-keyword">var</span> parenIndex = message.indexOf(<span class="hljs-string">")"</span>, index + <span class="hljs-number">6</span>);
      <span class="hljs-keyword">if</span> (parenIndex &gt; <span class="hljs-number">-1</span>) {
        <span class="hljs-keyword">var</span> lineNo = message.substring(index + <span class="hljs-number">6</span>, parenIndex);
        lineNo = <span class="hljs-built_in">parseInt</span>(lineNo, <span class="hljs-number">10</span>);
        index = message.indexOf(<span class="hljs-string">"("</span>, parenIndex);
        <span class="hljs-keyword">if</span> (index &gt; <span class="hljs-number">-1</span>) {
          parenIndex = message.indexOf(<span class="hljs-string">")"</span>, index);
          <span class="hljs-keyword">if</span> (parenIndex &gt; <span class="hljs-number">-1</span>) {
            <span class="hljs-keyword">var</span> columnNo = message.substring(index + <span class="hljs-number">1</span>, parenIndex);
            columnNo = <span class="hljs-built_in">parseInt</span>(columnNo, <span class="hljs-number">10</span>);
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._setCaretPositionLineColumn(elem, lineNo, columnNo);
          }
        } <span class="hljs-keyword">else</span>
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._setCaretPositionLineColumn(elem, lineNo, <span class="hljs-number">1</span>);
      }
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  },
  <span class="hljs-attr">_setCaretPositionLineColumn</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">elem, lineNo, columnNo</span>) </span>{
    <span class="hljs-keyword">var</span> pl = <span class="hljs-number">1</span>;
    <span class="hljs-keyword">var</span> data = elem.value;
    <span class="hljs-keyword">var</span> len = data.length;
    <span class="hljs-keyword">var</span> position = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">while</span> (pl &lt; lineNo &amp;&amp; position &gt; <span class="hljs-number">-1</span>) {
      position = data.indexOf(<span class="hljs-string">'\n'</span>, position);
      <span class="hljs-keyword">if</span> (position &gt; <span class="hljs-number">-1</span>)
        position++;
      pl++;
    }
    <span class="hljs-keyword">if</span> (position == <span class="hljs-number">-1</span>) {
      jslog(<span class="hljs-string">"Failed to find editor caret position for error"</span>);
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
    position += columnNo - <span class="hljs-number">1</span>;
    <span class="hljs-keyword">if</span> (elem.createTextRange)
      position -= lineNo - <span class="hljs-number">1</span>;
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">this</span>._setCaretPosition(elem, position);
    } <span class="hljs-keyword">catch</span> (err) {
      jslog(<span class="hljs-string">"Failed to position cursor at the error"</span>);
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  },
  <span class="hljs-attr">_setCaretPosition</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">elem, caretPos</span>) </span>{
    <span class="hljs-keyword">if</span> (elem.createTextRange) {
      <span class="hljs-keyword">var</span> range = elem.createTextRange();
      range.move(<span class="hljs-string">'character'</span>, caretPos);
      range.select();
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">if</span> (elem.setSelectionRange) {
        <span class="hljs-keyword">if</span> (caretPos == <span class="hljs-number">0</span>)
          caretPos = <span class="hljs-number">1</span>;
        elem.setSelectionRange(caretPos, caretPos + <span class="hljs-number">1</span>);
        <span class="hljs-keyword">if</span> (isSafari || isChrome)
          elem.focus();
        <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">var</span> ev = <span class="hljs-built_in">document</span>.createEvent(<span class="hljs-string">"KeyEvents"</span>);
          ev.initKeyEvent(<span class="hljs-string">"keypress"</span>, <span class="hljs-literal">true</span>, <span class="hljs-literal">true</span>, <span class="hljs-built_in">window</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>, <span class="hljs-number">0</span>, elem.value.charCodeAt(caretPos - <span class="hljs-number">1</span>));
          elem.dispatchEvent(ev);
          elem.focus();
        }
      } <span class="hljs-keyword">else</span>
        elem.focus();
    }
  },
  <span class="hljs-attr">disableAttachments</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> icon = gel(<span class="hljs-string">"header_add_attachment"</span>);
    <span class="hljs-keyword">if</span> (icon)
      icon.style.display = <span class="hljs-string">'none'</span>;
    AttachmentUploader.disableAttachments();
  },
  <span class="hljs-attr">enableAttachments</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> icon = gel(<span class="hljs-string">"header_add_attachment"</span>);
    <span class="hljs-keyword">if</span> (icon)
      icon.style.display = <span class="hljs-string">''</span>;
    AttachmentUploader.enableAttachments();
  },
  <span class="hljs-attr">hasField</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName</span>) </span>{
    <span class="hljs-keyword">return</span> !!<span class="hljs-keyword">this</span>.getControl(fieldName);
  },
  <span class="hljs-attr">setAction</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">action</span>) </span>{
    <span class="hljs-keyword">this</span>.action = action;
  },
  <span class="hljs-attr">getAction</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.action;
  },
  <span class="hljs-attr">setScope</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">scope</span>) </span>{
    <span class="hljs-keyword">this</span>.scope = scope;
  },
  <span class="hljs-attr">getScope</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.scope;
  },
  <span class="hljs-attr">setLiveUpdating</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">isLiveUpdating</span>) </span>{
    <span class="hljs-keyword">this</span>._isLiveUpdating = isLiveUpdating;
  },
  <span class="hljs-attr">isLiveUpdating</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._isLiveUpdating;
  },
  <span class="hljs-attr">_opticsInspectorLog</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName, oldValue</span>) </span>{
    <span class="hljs-keyword">var</span> value = <span class="hljs-keyword">this</span>.getValue(fieldName);
    opticsLog(<span class="hljs-keyword">this</span>.getTableName(), fieldName, <span class="hljs-literal">null</span>, oldValue, value);
  },
  <span class="hljs-attr">type</span>: <span class="hljs-string">"GlideForm"</span>
});
<span class="hljs-keyword">var</span> GlideFormPrefixHandler = Class.create({
  <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">handlerObject</span>) </span>{
    <span class="hljs-keyword">this</span>.handlerObject = handlerObject;
    <span class="hljs-keyword">this</span>.fieldName = <span class="hljs-string">""</span>;
  },
  <span class="hljs-attr">getObject</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.handlerObject;
  },
  <span class="hljs-attr">getFieldName</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.fieldName;
  },
  <span class="hljs-attr">setFieldName</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">id</span>) </span>{
    <span class="hljs-keyword">this</span>.fieldName = id;
  },
  <span class="hljs-attr">type</span>: <span class="hljs-string">"GlideFormPrefixHandler"</span>
});;
<span class="hljs-comment">/*! RESOURCE: /scripts/doctype/GwtContextMenu.js */</span>
<span class="hljs-keyword">var</span> gActiveContext;
<span class="hljs-keyword">var</span> contextMenus = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Object</span>();
<span class="hljs-keyword">var</span> shortcuts = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Object</span>();
<span class="hljs-keyword">var</span> GwtContextMenu = Class.create({
  <span class="hljs-attr">SUBMENU_INDICATOR</span>: <span class="hljs-string">"&lt;img src='images/context_arrow.gifx' class='context_item_menu_img' alt='Add' /&gt;"</span>,
  <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">id, useBodyAsParent</span>) </span>{
    <span class="hljs-keyword">this</span>.timeout = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">this</span>.properties = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Object</span>();
    <span class="hljs-keyword">this</span>.setID(id);
    <span class="hljs-keyword">this</span>.getMenu();
    <span class="hljs-keyword">this</span>.onshow = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">this</span>.onhide = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">this</span>.beforehide = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">this</span>.docRoot = <span class="hljs-keyword">this</span>._getDocRoot();
    <span class="hljs-keyword">this</span>.hasItems = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">this</span>.hideOnlySelf = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">this</span>.trackSelected = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> useBodyAsParent == <span class="hljs-string">"undefined"</span>)
      useBodyAsParent = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">this</span>._getParentElement(useBodyAsParent);
  },
  <span class="hljs-attr">isEmpty</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> !<span class="hljs-keyword">this</span>.hasItems;
  },
  <span class="hljs-attr">_getParentElement</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">useBodyAsParent</span>) </span>{
    <span class="hljs-keyword">if</span> (useBodyAsParent) {
      <span class="hljs-keyword">this</span>.parentElement = <span class="hljs-built_in">document</span>.body;
      <span class="hljs-keyword">return</span>;
    }
    <span class="hljs-keyword">this</span>.parentElement = getFormContentParent();
  },
  <span class="hljs-attr">_getDocRoot</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> docRoot = <span class="hljs-built_in">window</span>.location.protocol + <span class="hljs-string">"//"</span> + <span class="hljs-built_in">window</span>.location.host;
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.location.pathname.indexOf(<span class="hljs-string">"/"</span>) &gt; <span class="hljs-number">-1</span>) {
      <span class="hljs-keyword">var</span> fp = <span class="hljs-built_in">window</span>.location.pathname;
      fp = fp.substring(<span class="hljs-number">0</span>, fp.lastIndexOf(<span class="hljs-string">"/"</span>));
      <span class="hljs-keyword">if</span> (fp.substring(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>).indexOf(<span class="hljs-string">"/"</span>) != <span class="hljs-number">-1</span>)
        docRoot = docRoot + fp;
      <span class="hljs-keyword">else</span>
        docRoot = docRoot + <span class="hljs-string">"/"</span> + fp;
    }
    docRoot += <span class="hljs-string">"/"</span>;
    <span class="hljs-keyword">return</span> docRoot;
  },
  <span class="hljs-attr">add</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">label, id, keys</span>) </span>{
    <span class="hljs-keyword">this</span>.hasItems = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">var</span> m = <span class="hljs-keyword">this</span>.getMenu();
    <span class="hljs-keyword">var</span> d = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"div"</span>);
    d.setAttribute(<span class="hljs-string">"item_id"</span>, id);
    d.className = <span class="hljs-string">"context_item"</span>;
    d.isMenuItem = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">var</span> l = !keys ? label : (label + <span class="hljs-string">' ('</span> + keys + <span class="hljs-string">')'</span>);
    d.innerHTML = l;
    <span class="hljs-keyword">if</span> (keys)
      d.setAttribute(<span class="hljs-string">"data-label"</span>, label);
    m.appendChild(d);
    <span class="hljs-keyword">return</span> d;
  },
  <span class="hljs-attr">addHref</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">label, href, img, title, id, keys</span>) </span>{
    keys = <span class="hljs-keyword">this</span>.addKeyShortcut(keys, href);
    <span class="hljs-keyword">var</span> d = <span class="hljs-keyword">this</span>.add(label, id, keys);
    d.setAttribute(<span class="hljs-string">"href"</span>, href);
    <span class="hljs-keyword">if</span> (title &amp;&amp; title != <span class="hljs-literal">null</span>)
      d.setAttribute(<span class="hljs-string">"title"</span>, title);
    <span class="hljs-keyword">this</span>.setImage(d, img);
    <span class="hljs-keyword">return</span> d;
  },
  <span class="hljs-attr">addFunc</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">label, func, id</span>) </span>{
    <span class="hljs-keyword">var</span> d = <span class="hljs-keyword">this</span>.add(label, id);
    d.setAttribute(<span class="hljs-string">"func_set"</span>, <span class="hljs-string">"true"</span>);
    d.func = func;
    <span class="hljs-keyword">return</span> d;
  },
  <span class="hljs-attr">addURL</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">label, url, target, id</span>) </span>{
    <span class="hljs-keyword">var</span> d = <span class="hljs-keyword">this</span>.add(label, id);
    url = <span class="hljs-keyword">this</span>._updateURL(d, label, url);
    d.setAttribute(<span class="hljs-string">"url"</span>, url);
    <span class="hljs-keyword">if</span> (target)
      d.setAttribute(<span class="hljs-string">"target"</span>, target);
    <span class="hljs-keyword">return</span> d;
  },
  <span class="hljs-attr">addHrefNoSort</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">label, href, id</span>) </span>{
    <span class="hljs-keyword">var</span> item = <span class="hljs-keyword">this</span>.addHref(label, href, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, id);
    item.setAttribute(<span class="hljs-string">"not_sortable"</span>, <span class="hljs-string">"true"</span>);
    <span class="hljs-keyword">return</span> item;
  },
  <span class="hljs-attr">addHrefNoFilter</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">label, href, id</span>) </span>{
    <span class="hljs-keyword">var</span> item = <span class="hljs-keyword">this</span>.addHref(label, href, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, id);
    item.setAttribute(<span class="hljs-string">"not_filterable"</span>, <span class="hljs-string">"true"</span>);
    <span class="hljs-keyword">return</span> item;
  },
  <span class="hljs-attr">addMenu</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">label, menu, id</span>) </span>{
    <span class="hljs-keyword">var</span> item = <span class="hljs-keyword">this</span>.add(label + <span class="hljs-keyword">this</span>.SUBMENU_INDICATOR, id);
    item.setAttribute(<span class="hljs-string">"label"</span>, <span class="hljs-string">"true"</span>);
    menu.setParent(<span class="hljs-keyword">this</span>);
    item.subMenu = menu;
    <span class="hljs-keyword">return</span> item;
  },
  <span class="hljs-attr">addAction</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">label, action, id</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.addHref(label, <span class="hljs-string">"contextAction('"</span> + <span class="hljs-keyword">this</span>.getTableName() + <span class="hljs-string">"', '"</span> + action + <span class="hljs-string">"')"</span>, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, id);
  },
  <span class="hljs-attr">addConfirmedAction</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">label, action, id</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.addHref(label, <span class="hljs-string">"contextConfirm('"</span> + <span class="hljs-keyword">this</span>.getTableName() + <span class="hljs-string">"', '"</span> + action + <span class="hljs-string">"')"</span>, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, id);
  },
  <span class="hljs-attr">addLine</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>.hasItems = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">var</span> m = <span class="hljs-keyword">this</span>.getMenu();
    <span class="hljs-keyword">var</span> d = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"div"</span>);
    d.className = <span class="hljs-string">"context_item_hr"</span>;
    d.isMenuItem = <span class="hljs-literal">true</span>;
    d.disabled = <span class="hljs-string">"disabled"</span>;
    m.appendChild(d);
    <span class="hljs-keyword">return</span> d;
  },
  <span class="hljs-attr">addLabel</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">label, id</span>) </span>{
    <span class="hljs-keyword">var</span> m = <span class="hljs-keyword">this</span>.getMenu();
    <span class="hljs-keyword">var</span> d = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"div"</span>);
    d.setAttribute(<span class="hljs-string">"item_id"</span>, id);
    d.className = <span class="hljs-string">"context_item"</span>;
    d.isMenuItem = <span class="hljs-literal">true</span>;
    d.innerHTML = label;
    d.disabled = <span class="hljs-string">"disabled"</span>;
    m.appendChild(d);
    <span class="hljs-keyword">return</span> d;
  },
  <span class="hljs-attr">addKeyShortcut</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">keys, href</span>) </span>{
    <span class="hljs-keyword">var</span> topWindow = getTopWindow();
    <span class="hljs-keyword">var</span> keyboardEnabled = topWindow.com &amp;&amp; topWindow.com.glide &amp;&amp; topWindow.com.glide.ui &amp;&amp; topWindow.com.glide.ui.keyboard;
    <span class="hljs-keyword">if</span> (!keyboardEnabled)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">if</span> (!keys)
      <span class="hljs-keyword">return</span> keys;
    <span class="hljs-keyword">if</span> (shortcuts[keys])
      <span class="hljs-keyword">return</span> keys;
    shortcuts[keys] = {};
    <span class="hljs-keyword">var</span> callback = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
      <span class="hljs-keyword">var</span> start = e.data.href.indexOf(<span class="hljs-string">'javascript:'</span>) == <span class="hljs-number">0</span> ? <span class="hljs-number">11</span> : <span class="hljs-number">0</span>;
      <span class="hljs-keyword">var</span> startParen = e.data.href.indexOf(<span class="hljs-string">'('</span>);
      <span class="hljs-keyword">var</span> functionName = startParen &gt; start ? e.data.href.substring(start, startParen) : {};
      <span class="hljs-keyword">var</span> func = <span class="hljs-built_in">eval</span>(functionName);
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> func == <span class="hljs-string">'function'</span>)
        <span class="hljs-built_in">eval</span>(e.data.href);
      <span class="hljs-keyword">else</span>
        <span class="hljs-built_in">document</span>.location.href = e.data.href;
    };
    addLoadEvent(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> keyboard = getTopWindow().com.glide.ui.keyboard;
      <span class="hljs-keyword">var</span> isMainFrame = <span class="hljs-built_in">window</span>.frameElement.id == keyboard.mainFrame;
      <span class="hljs-keyword">var</span> isFormFrame = <span class="hljs-built_in">window</span>.frameElement.id == keyboard.formFrame;
      <span class="hljs-keyword">if</span> (isMainFrame)
        shortcuts[keys] = keyboard.bind(keys, callback, {
          <span class="hljs-attr">href</span>: href
        }).global(keyboard.formFrame);
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (isFormFrame)
        shortcuts[keys] = keyboard.bind(keys, callback, {
          <span class="hljs-attr">href</span>: href
        }).formFrame();
      <span class="hljs-keyword">else</span>
        shortcuts[keys] = <span class="hljs-literal">null</span>;
    });
    <span class="hljs-keyword">return</span> keys;
  },
  <span class="hljs-attr">getItem</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">itemId</span>) </span>{
    <span class="hljs-keyword">var</span> items = <span class="hljs-keyword">this</span>.getMenu().getElementsByTagName(<span class="hljs-string">"div"</span>);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; items.length; i++) {
      <span class="hljs-keyword">var</span> item = items[i];
      <span class="hljs-keyword">if</span> (item.getAttribute(<span class="hljs-string">"item_id"</span>) == itemId)
        <span class="hljs-keyword">return</span> item;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  },
  <span class="hljs-attr">setImage</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">item, img</span>) </span>{
    <span class="hljs-keyword">if</span> (item &amp;&amp; img) {
      item.style.backgroundImage = <span class="hljs-string">"url("</span> + <span class="hljs-keyword">this</span>.docRoot + img + <span class="hljs-string">")"</span>;
      item.style.backgroundRepeat = <span class="hljs-string">"no-repeat"</span>;
    }
  },
  <span class="hljs-attr">setChecked</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">item</span>) </span>{
    <span class="hljs-keyword">if</span> (item)
      <span class="hljs-keyword">this</span>.setImage(item, <span class="hljs-string">"images/checked.pngx"</span>);
  },
  <span class="hljs-attr">clearImage</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">item</span>) </span>{
    <span class="hljs-keyword">if</span> (item) {
      item.style.backgroundImage = <span class="hljs-string">""</span>;
      item.style.backgroundRepeat = <span class="hljs-string">""</span>;
    }
  },
  <span class="hljs-attr">setDisabled</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">item</span>) </span>{
    <span class="hljs-keyword">if</span> (!item)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">this</span>._dullItem(item);
  },
  <span class="hljs-attr">setEnabled</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">item</span>) </span>{
    <span class="hljs-keyword">if</span> (!item)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">this</span>._undullItem(item);
  },
  <span class="hljs-attr">setHidden</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">item</span>) </span>{
    <span class="hljs-keyword">if</span> (!item)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">this</span>._hideItem(item);
  },
  <span class="hljs-attr">setVisible</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">item</span>) </span>{
    <span class="hljs-keyword">if</span> (!item)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">this</span>._showItem(item);
  },
  <span class="hljs-attr">setLabel</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">item, label</span>) </span>{
    <span class="hljs-keyword">if</span> (item)
      item.innerHTML = label;
  },
  <span class="hljs-attr">setHideOnlySelf</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">hideSelf</span>) </span>{
    <span class="hljs-keyword">this</span>.hideOnlySelf = hideSelf;
  },
  <span class="hljs-attr">clearSelected</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> items = <span class="hljs-keyword">this</span>.getMenu().getElementsByTagName(<span class="hljs-string">"div"</span>);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; items.length; i++) {
      <span class="hljs-keyword">var</span> item = items[i];
      <span class="hljs-keyword">if</span> (item.isMenuItem)
        <span class="hljs-keyword">this</span>.clearImage(item);
    }
  },
  <span class="hljs-attr">clear</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> m = <span class="hljs-keyword">this</span>.getMenu();
    clearNodes(m);
    <span class="hljs-keyword">this</span>._setMinWidth();
    <span class="hljs-keyword">this</span>.hasItems = <span class="hljs-literal">false</span>;
  },
  <span class="hljs-attr">destroy</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>.parentElement = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">this</span>.menu.context = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">this</span>.menu.onmouseover = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">this</span>.menu.onmouseout = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">this</span>.menu.onclick = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">if</span> (isMSIE)
      <span class="hljs-keyword">this</span>.menu.outerHTML = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">this</span>.parentMenu = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">this</span>.onshow = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">this</span>.onhide = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">this</span>.properties = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">this</span>.timeout = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">this</span>.menu = <span class="hljs-literal">null</span>;
  },
  <span class="hljs-attr">display</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.getParent())
      CustomEvent.fireAll(<span class="hljs-string">'body_clicked'</span>, <span class="hljs-literal">null</span>);
    menuSort = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">this</span>._dullMenu();
    <span class="hljs-keyword">this</span>._toggleMenuItems(<span class="hljs-string">"not_sortable"</span>, <span class="hljs-keyword">this</span>.getProperty(<span class="hljs-string">'sortable'</span>));
    <span class="hljs-keyword">this</span>._toggleMenuItems(<span class="hljs-string">"not_filterable"</span>, <span class="hljs-keyword">this</span>.getProperty(<span class="hljs-string">'filterable'</span>));
    <span class="hljs-keyword">this</span>.setFiringObject(<span class="hljs-keyword">this</span>._getElement(e));
    e = <span class="hljs-keyword">this</span>._getRealEvent(e);
    <span class="hljs-keyword">var</span> menu = <span class="hljs-keyword">this</span>.getMenu();
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._isEmpty(menu))
      <span class="hljs-keyword">return</span>;
    menu.style.left = <span class="hljs-string">"0"</span>;
    menu.style.top = <span class="hljs-string">"0"</span>;
    <span class="hljs-keyword">this</span>.parentElement.appendChild(menu);
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.getProperty(<span class="hljs-string">"top"</span>) &gt; <span class="hljs-number">0</span> &amp;&amp; ((<span class="hljs-keyword">this</span>.getProperty(<span class="hljs-string">"left"</span>) &gt; <span class="hljs-number">0</span>) || (<span class="hljs-keyword">this</span>.getProperty(<span class="hljs-string">"right"</span>) &gt; <span class="hljs-number">0</span>))) {
      menu.style.visibility = <span class="hljs-string">'hidden'</span>;
      menu.style.display = <span class="hljs-string">'block'</span>;
      <span class="hljs-keyword">this</span>.moveMenuToXY(e, <span class="hljs-keyword">this</span>.getProperty(<span class="hljs-string">"left"</span>), <span class="hljs-keyword">this</span>.getProperty(<span class="hljs-string">"top"</span>), <span class="hljs-keyword">this</span>.getProperty(<span class="hljs-string">"right"</span>));
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.getParent()) {
      <span class="hljs-keyword">var</span> x = <span class="hljs-keyword">this</span>._getElement(e);
      menu.style.visibility = <span class="hljs-string">'hidden'</span>;
      menu.style.display = <span class="hljs-string">'block'</span>;
      <span class="hljs-keyword">this</span>.moveMenuToParent(e, x);
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">var</span> x = <span class="hljs-keyword">this</span>._getElement(e);
      menu.style.visibility = <span class="hljs-string">'hidden'</span>;
      menu.style.display = <span class="hljs-string">'block'</span>;
      <span class="hljs-keyword">this</span>.moveMenuToCursor(e);
    }
    gActiveContext = <span class="hljs-keyword">this</span>;
    showObject(menu);
  },
  <span class="hljs-attr">hide</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    gActiveContext = <span class="hljs-string">""</span>;
    hideObject(<span class="hljs-keyword">this</span>.getMenu());
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.getMenu().parentNode)
      <span class="hljs-keyword">this</span>.getMenu().parentNode.removeChild(<span class="hljs-keyword">this</span>.getMenu());
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.onhide)
      <span class="hljs-keyword">this</span>.onhide();
    CustomEvent.fire(<span class="hljs-string">'refresh.event'</span>);
  },
  <span class="hljs-attr">hideAll</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> m = <span class="hljs-keyword">this</span>;
    <span class="hljs-keyword">while</span> (m) {
      m.hide();
      m = m.getParent();
    }
  },
  <span class="hljs-attr">execute</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
    <span class="hljs-keyword">var</span> x = <span class="hljs-keyword">this</span>._getElement(e);
    <span class="hljs-keyword">if</span> (x.isMenuItem &amp;&amp; !x.disabled) {
      <span class="hljs-keyword">if</span> (x.getAttribute(<span class="hljs-string">"label"</span>) == <span class="hljs-string">"true"</span>) {
        <span class="hljs-keyword">this</span>._getRealEvent(e).cancelBubble = <span class="hljs-literal">true</span>;
        <span class="hljs-keyword">return</span>;
      }
      <span class="hljs-keyword">if</span> (x.getAttribute(<span class="hljs-string">"target"</span>)) {
        <span class="hljs-built_in">window</span>.open(x.getAttribute(<span class="hljs-string">"url"</span>), x.getAttribute(<span class="hljs-string">"target"</span>));
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (x.getAttribute(<span class="hljs-string">"href"</span>)) {
        <span class="hljs-keyword">var</span> expression = x.getAttribute(<span class="hljs-string">"href"</span>);
        gActiveContext = <span class="hljs-keyword">this</span>;
        <span class="hljs-built_in">eval</span>(expression);
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (x.getAttribute(<span class="hljs-string">"func_set"</span>) == <span class="hljs-string">"true"</span>) {
        x.func();
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-built_in">window</span>.location = x.getAttribute(<span class="hljs-string">"url"</span>);
      }
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.trackSelected) {
        <span class="hljs-keyword">this</span>.clearSelected();
        <span class="hljs-keyword">this</span>.setChecked(x);
      }
    }
    <span class="hljs-keyword">if</span> (x.subMenu)
      x.subMenu.hideAll();
    <span class="hljs-keyword">else</span>
      <span class="hljs-keyword">this</span>.hideAll();
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  },
  <span class="hljs-attr">menuLowLight</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
    <span class="hljs-keyword">var</span> x = <span class="hljs-keyword">this</span>._getElement(e);
    <span class="hljs-keyword">this</span>._handleTimeout(<span class="hljs-literal">false</span>, x);
    <span class="hljs-keyword">if</span> (!x.isMenuItem)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">if</span> (!x.subMenu || x.subMenu.getMenu().style.display == <span class="hljs-string">'none'</span>)
      <span class="hljs-keyword">this</span>._disableItem(x);
    <span class="hljs-built_in">window</span>.status = <span class="hljs-string">''</span>;
    CustomEvent.fire(<span class="hljs-string">'refresh.event'</span>);
  },
  <span class="hljs-attr">menuHighLight</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
    <span class="hljs-keyword">var</span> x = <span class="hljs-keyword">this</span>._getElement(e);
    <span class="hljs-keyword">this</span>._handleTimeout(<span class="hljs-literal">true</span>, x);
    <span class="hljs-keyword">if</span> (!x.isMenuItem)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">this</span>._hideAllSubs(x.parentNode);
    <span class="hljs-keyword">this</span>._enableItem(x);
    <span class="hljs-keyword">if</span> (x.subMenu) {
      x.subMenu.setParent(<span class="hljs-keyword">this</span>);
      x.subMenu.display(e);
    }
  },
  <span class="hljs-attr">moveMenuToXY</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e, left, top, right</span>) </span>{
    <span class="hljs-keyword">var</span> menu = <span class="hljs-keyword">this</span>.getMenu();
    <span class="hljs-keyword">if</span> (right)
      left = right - menu.offsetWidth;
    <span class="hljs-keyword">var</span> offsetTop = <span class="hljs-built_in">window</span>.pageYOffset + top;
    <span class="hljs-keyword">var</span> offsetLeft = <span class="hljs-built_in">window</span>.pageXOffset + left;
    <span class="hljs-keyword">this</span>.moveMenu(top, left, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, offsetTop, offsetLeft);
  },
  <span class="hljs-attr">moveMenuToCursor</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
    <span class="hljs-keyword">var</span> offsetTop = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">var</span> offsetLeft = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">if</span> (isTouchDevice) {
      offsetTop = e.pageY;
      offsetLeft = e.pageX;
    } <span class="hljs-keyword">else</span> {
      offsetTop = e.clientY;
      offsetLeft = e.clientX;
    }
    <span class="hljs-keyword">this</span>.moveMenu(e.clientY, e.clientX, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, offsetTop, offsetLeft);
  },
  <span class="hljs-attr">moveMenuToParent</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e, firingObject</span>) </span>{
    <span class="hljs-keyword">var</span> parent = <span class="hljs-keyword">this</span>.getParent().getMenu();
    <span class="hljs-keyword">var</span> offsetTop = grabOffsetTop(firingObject) - parent.scrollTop;
    <span class="hljs-keyword">var</span> borderLeftWidth = <span class="hljs-built_in">parseInt</span>($j(<span class="hljs-keyword">this</span>.getParent().getMenu()).css(<span class="hljs-string">'border-right-width'</span>), <span class="hljs-number">10</span>);
    <span class="hljs-keyword">var</span> offsetLeft = grabOffsetLeft(parent) - borderLeftWidth;
    <span class="hljs-keyword">this</span>.moveMenu(offsetTop, offsetLeft, firingObject.offsetHeight, parent.offsetWidth, offsetTop, offsetLeft);
  },
  <span class="hljs-attr">moveMenu</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">top, left, height, width, offsetTop, offsetLeft</span>) </span>{
    <span class="hljs-keyword">var</span> menu = <span class="hljs-keyword">this</span>.getMenu();
    menu.style.overflowY = <span class="hljs-string">"visible"</span>;
    menu.setAttribute(<span class="hljs-string">'gsft_has_scroll'</span>, <span class="hljs-literal">false</span>);
    <span class="hljs-keyword">if</span> (menu.getAttribute(<span class="hljs-string">'gsft_width'</span>))
      menu.style.width = menu.getAttribute(<span class="hljs-string">'gsft_width'</span>) + <span class="hljs-string">"px"</span>;
    <span class="hljs-keyword">if</span> (menu.getAttribute(<span class="hljs-string">'gsft_height'</span>))
      menu.style.height = menu.getAttribute(<span class="hljs-string">'gsft_height'</span>) + <span class="hljs-string">"px"</span>;
    <span class="hljs-keyword">var</span> leftPos;
    <span class="hljs-keyword">var</span> viewport = <span class="hljs-keyword">new</span> WindowSize();
    <span class="hljs-keyword">if</span> ((left + width + menu.offsetWidth) &gt; viewport.width)
      leftPos = offsetLeft - menu.offsetWidth;
    <span class="hljs-keyword">else</span>
      leftPos = offsetLeft + width;
    menu.style.left = leftPos + <span class="hljs-string">"px"</span>;
    <span class="hljs-keyword">var</span> scrollOffsets = <span class="hljs-keyword">this</span>._getScrollOffsets(<span class="hljs-keyword">this</span>.parentElement);
    <span class="hljs-keyword">var</span> scrollTop = scrollOffsets.top;
    <span class="hljs-keyword">var</span> direction = <span class="hljs-string">'down'</span>;
    <span class="hljs-keyword">var</span> clip = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">if</span> ((top + menu.offsetHeight) &gt; viewport.height) {
      <span class="hljs-keyword">var</span> bottomClip = menu.offsetHeight - (viewport.height - top);
      <span class="hljs-keyword">var</span> topClip = menu.offsetHeight - top + height;
      <span class="hljs-keyword">if</span> (topClip &lt; bottomClip) {
        direction = <span class="hljs-string">'up'</span>;
        clip = topClip;
      } <span class="hljs-keyword">else</span>
        clip = bottomClip;
    }
    <span class="hljs-keyword">var</span> topPos;
    <span class="hljs-keyword">if</span> (direction == <span class="hljs-string">'up'</span>) {
      <span class="hljs-keyword">var</span> mHeight = menu.offsetHeight;
      <span class="hljs-keyword">var</span> bottomEdge = offsetTop + height;
      topPos = (bottomEdge &gt; mHeight) ? (bottomEdge - mHeight) : <span class="hljs-number">0</span>;
    } <span class="hljs-keyword">else</span>
      topPos = offsetTop;
    <span class="hljs-keyword">if</span> ((topPos - scrollTop + menu.offsetHeight) &gt; viewport.height)
      clip = (topPos - scrollTop + menu.offsetHeight) - viewport.height;
    menu.style.top = topPos + <span class="hljs-string">"px"</span>;
    <span class="hljs-keyword">if</span> (clip &gt; <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">if</span> (!menu.getAttribute(<span class="hljs-string">'gsft_width'</span>)) {
        menu.setAttribute(<span class="hljs-string">'gsft_width'</span>, menu.offsetWidth);
        menu.setAttribute(<span class="hljs-string">'gsft_height'</span>, menu.offsetHeight);
      }
      menu.setAttribute(<span class="hljs-string">'gsft_has_scroll'</span>, <span class="hljs-literal">true</span>);
      menu.style.overflowY = <span class="hljs-string">"auto"</span>;
      <span class="hljs-keyword">var</span> w = menu.offsetWidth + <span class="hljs-number">18</span>;
      menu.style.width = w + <span class="hljs-string">"px"</span>;
      <span class="hljs-keyword">var</span> h = menu.offsetHeight - clip - <span class="hljs-number">4</span>;
      menu.style.height = h + <span class="hljs-string">"px"</span>;
    }
  },
  <span class="hljs-attr">_getScrollOffsets</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
    <span class="hljs-keyword">var</span> offsets = {};
    <span class="hljs-keyword">if</span> (e.nodeName.toUpperCase() == <span class="hljs-string">"BODY"</span>) {
      offsets.top = <span class="hljs-built_in">window</span>.pageYOffset || <span class="hljs-built_in">document</span>.documentElement.scrollTop || <span class="hljs-built_in">document</span>.body.scrollTop;
      offsets.left = <span class="hljs-built_in">window</span>.pageXOffset || <span class="hljs-built_in">document</span>.documentElement.scrollLeft || <span class="hljs-built_in">document</span>.body.scrollLeft;
    } <span class="hljs-keyword">else</span> {
      offsets.top = e.scrollTop;
      offsets.left = e.scrollLeft;
    }
    <span class="hljs-keyword">return</span> offsets;
  },
  <span class="hljs-attr">getFiringObject</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.eventObject;
  },
  <span class="hljs-attr">getID</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.id;
  },
  <span class="hljs-attr">getMenu</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.menu) {
      <span class="hljs-keyword">this</span>.menu = contextMenus[<span class="hljs-keyword">this</span>.getID()];
      <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.menu)
        <span class="hljs-keyword">this</span>._createMenu();
      <span class="hljs-keyword">this</span>._setMenuAttrs();
      <span class="hljs-keyword">this</span>._setMinWidth();
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.menu;
  },
  <span class="hljs-attr">getParent</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.parentMenu;
  },
  <span class="hljs-attr">getProperty</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">c</span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.properties)
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.properties[c];
    <span class="hljs-keyword">else</span>
      <span class="hljs-keyword">return</span> <span class="hljs-string">""</span>;
  },
  <span class="hljs-attr">getTableName</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.tableName;
  },
  <span class="hljs-attr">setFiringObject</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
    <span class="hljs-keyword">this</span>.eventObject = e;
  },
  <span class="hljs-attr">setID</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">id</span>) </span>{
    <span class="hljs-keyword">this</span>.id = id;
  },
  <span class="hljs-attr">setOnShow</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">onshow</span>) </span>{
    <span class="hljs-keyword">this</span>.onshow = onshow;
  },
  <span class="hljs-attr">setOnHide</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">oh</span>) </span>{
    <span class="hljs-keyword">this</span>.onhide = oh;
  },
  <span class="hljs-attr">setBeforeHide</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">beforeHide</span>) </span>{
    <span class="hljs-keyword">this</span>.beforehide = beforeHide;
  },
  <span class="hljs-attr">setParent</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">m</span>) </span>{
    <span class="hljs-keyword">this</span>.parentMenu = m;
    <span class="hljs-keyword">this</span>.parentElement = m.parentElement;
  },
  <span class="hljs-attr">setProperty</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">c, v</span>) </span>{
    <span class="hljs-keyword">this</span>.properties[c] = v;
  },
  <span class="hljs-attr">setTableName</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name</span>) </span>{
    <span class="hljs-keyword">this</span>.tableName = name;
  },
  <span class="hljs-attr">setTimeout</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">t</span>) </span>{
    <span class="hljs-keyword">this</span>.timeout = t;
  },
  <span class="hljs-attr">setTrackSelected</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">flag</span>) </span>{
    <span class="hljs-keyword">this</span>.trackSelected = flag;
  },
  <span class="hljs-attr">_createMenu</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>.menu = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"div"</span>);
    <span class="hljs-keyword">this</span>.menu.name = <span class="hljs-keyword">this</span>.menu.id = <span class="hljs-keyword">this</span>.getID();
    contextMenus[<span class="hljs-keyword">this</span>.getID()] = <span class="hljs-keyword">this</span>.menu;
  },
  <span class="hljs-attr">_disableItem</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">item</span>) </span>{
    <span class="hljs-keyword">if</span> (item &amp;&amp; !item.disabled) {
      removeClassName(item, <span class="hljs-string">"context_menu_hover"</span>);
    }
  },
  <span class="hljs-attr">_dullMenu</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> items = <span class="hljs-keyword">this</span>.getMenu().childNodes;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; items.length; i++) {
      <span class="hljs-keyword">var</span> item = items[i];
      <span class="hljs-keyword">this</span>._disableItem(item);
    }
  },
  <span class="hljs-attr">_enableItem</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">item</span>) </span>{
    <span class="hljs-keyword">if</span> (item &amp;&amp; !item.disabled) {
      addClassName(item, <span class="hljs-string">"context_menu_hover"</span>);
    }
  },
  <span class="hljs-attr">_getElement</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
    <span class="hljs-keyword">var</span> x = e.target;
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">if</span> (!x.isMenuItem &amp;&amp; x.parentNode.isMenuItem)
        x = x.parentNode;
    } <span class="hljs-keyword">catch</span> (err) {}
    <span class="hljs-keyword">return</span> x;
  },
  <span class="hljs-attr">_getRealEvent</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
    <span class="hljs-keyword">return</span> e;
  },
  <span class="hljs-attr">_handleTimeout</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">lght, firingObject</span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.getProperty(<span class="hljs-string">"timeout"</span>) &gt; <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">if</span> (lght) {
        clearTimeout(<span class="hljs-keyword">this</span>.timeout);
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">if</span> (!firingObject.subMenu || firingObject.subMenu != gActiveContext)
          <span class="hljs-keyword">this</span>.timeout = setTimeout(<span class="hljs-string">'contextHide()'</span>, <span class="hljs-keyword">this</span>.getProperty(<span class="hljs-string">"timeout"</span>));
      }
    }
  },
  <span class="hljs-attr">_hideAllSubs</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">el</span>) </span>{
    <span class="hljs-keyword">var</span> list = el.getElementsByTagName(<span class="hljs-string">"div"</span>);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; list.length; i++) {
      <span class="hljs-keyword">var</span> element = list[i];
      <span class="hljs-keyword">if</span> (element.subMenu) {
        <span class="hljs-keyword">var</span> subMenu = element.subMenu.getMenu();
        <span class="hljs-keyword">this</span>._hideAllSubs(element.subMenu.getMenu());
        hideObject(subMenu);
        <span class="hljs-keyword">this</span>._disableItem(element);
      }
    }
  },
  <span class="hljs-attr">_setMenuAttrs</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>.menu.context = <span class="hljs-keyword">this</span>;
    <span class="hljs-keyword">this</span>.menu.className = <span class="hljs-string">"context_menu"</span>;
    <span class="hljs-keyword">this</span>.menu.style.display = <span class="hljs-string">"none"</span>;
    <span class="hljs-keyword">this</span>.menu.style.zIndex = (<span class="hljs-keyword">this</span>.getParent() ? GwtContextMenu.zIndex + <span class="hljs-number">1</span> : GwtContextMenu.zIndex);
    <span class="hljs-keyword">this</span>.menu.onmouseover = <span class="hljs-keyword">this</span>.menuHighLight.bind(<span class="hljs-keyword">this</span>);
    <span class="hljs-keyword">this</span>.menu.onmouseout = <span class="hljs-keyword">this</span>.menuLowLight.bind(<span class="hljs-keyword">this</span>);
    <span class="hljs-keyword">if</span> (<span class="hljs-string">"ontouchstart"</span> <span class="hljs-keyword">in</span> <span class="hljs-built_in">window</span> &amp;&amp; (<span class="hljs-keyword">typeof</span> FastButton != <span class="hljs-string">'undefined'</span>))
      <span class="hljs-keyword">new</span> FastButton(<span class="hljs-keyword">this</span>.menu, <span class="hljs-keyword">this</span>.execute.bind(<span class="hljs-keyword">this</span>));
    <span class="hljs-keyword">else</span>
      <span class="hljs-keyword">this</span>.menu.onclick = <span class="hljs-keyword">this</span>.execute.bind(<span class="hljs-keyword">this</span>);
  },
  <span class="hljs-attr">_setMinWidth</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> widther = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"div"</span>);
    widther.style.width = <span class="hljs-string">"120px"</span>;
    widther.style.height = <span class="hljs-string">"1px"</span>;
    widther.style.overflow = <span class="hljs-string">"hidden"</span>;
    <span class="hljs-keyword">this</span>.menu.appendChild(widther);
  },
  <span class="hljs-attr">_toggleMenuItems</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">attr, enabled</span>) </span>{
    <span class="hljs-keyword">var</span> items = <span class="hljs-keyword">this</span>.getMenu().childNodes;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; items.length; i++) {
      <span class="hljs-keyword">var</span> item = items[i];
      <span class="hljs-keyword">if</span> (item.getAttribute(attr) == <span class="hljs-string">"true"</span>) {
        <span class="hljs-keyword">if</span> (enabled) {
          <span class="hljs-keyword">this</span>._undullItem(item);
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">this</span>._dullItem(item);
        }
      }
    }
  },
  <span class="hljs-attr">_dullItem</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">item</span>) </span>{
    item.disabled = <span class="hljs-string">"disabled"</span>;
    item.style.color = <span class="hljs-string">"#cccccc"</span>;
    removeClassName(item, <span class="hljs-string">"context_menu_hover"</span>);
  },
  <span class="hljs-attr">_undullItem</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">item</span>) </span>{
    item.disabled = <span class="hljs-string">""</span>;
    item.style.color = <span class="hljs-string">""</span>;
  },
  <span class="hljs-attr">_hideItem</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">item</span>) </span>{
    item.style.display = <span class="hljs-string">'none'</span>;
  },
  <span class="hljs-attr">_showItem</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">item</span>) </span>{
    item.style.display = <span class="hljs-string">''</span>;
  },
  <span class="hljs-attr">_isEmpty</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">menu</span>) </span>{
    <span class="hljs-keyword">if</span> (!menu)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">if</span> (!menu.firstChild)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  },
  <span class="hljs-attr">_updateURL</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">d, label, url</span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> GlideTransactionScope != <span class="hljs-string">'undefined'</span>) {
      GlideTransactionScope.appendTransactionScope(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name, value</span>) </span>{
        url += <span class="hljs-string">"&amp;"</span> + name + <span class="hljs-string">"="</span> + value;
      });
      <span class="hljs-keyword">return</span> url;
    }
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> g_form != <span class="hljs-string">'undefined'</span>) {
      <span class="hljs-keyword">this</span>.dmap = <span class="hljs-keyword">this</span>.dmap || {};
      <span class="hljs-keyword">this</span>.dmap[label] = d;
      $(g_form.getFormElement()).observe(<span class="hljs-string">'glidescope:initialized'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
        e.memo.gts.appendTransactionScope(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name, value</span>) </span>{
          <span class="hljs-keyword">var</span> _d = <span class="hljs-keyword">this</span>.dmap[label];
          <span class="hljs-keyword">var</span> _url = _d.getAttribute(<span class="hljs-string">"url"</span>);
          _url += <span class="hljs-string">"&amp;"</span> + name + <span class="hljs-string">"="</span> + value;
          _d.setAttribute(<span class="hljs-string">"url"</span>, _url);
        }.bind(<span class="hljs-keyword">this</span>));
      }.bind(<span class="hljs-keyword">this</span>));
    }
    <span class="hljs-keyword">return</span> url;
  },
  <span class="hljs-attr">z</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{}
});
GwtContextMenu.zIndex = <span class="hljs-number">1100</span>;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">displayContextMenu</span>(<span class="hljs-params">e, name, filterable</span>) </span>{
  <span class="hljs-keyword">if</span> (!getMenuByName(name))
    <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">var</span> contextMenu = getMenuByName(name).context;
  contextMenu.setProperty(<span class="hljs-string">'sortable'</span>, <span class="hljs-literal">true</span>);
  contextMenu.setProperty(<span class="hljs-string">'filterable'</span>, filterable);
  contextMenu.display(e);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">contextShow</span>(<span class="hljs-params">e, tableName, timeoutValue, ttop, lleft, rright</span>) </span>{
  <span class="hljs-keyword">var</span> frameWindow = <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">try</span> {
    frameWindow = <span class="hljs-built_in">window</span>.frameElement;
    <span class="hljs-keyword">if</span> (frameWindow &amp;&amp; frameWindow.id == <span class="hljs-string">"dialog_frame"</span> &amp;&amp; frameWindow.noContext == <span class="hljs-literal">true</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  } <span class="hljs-keyword">catch</span> (err) {}
  <span class="hljs-keyword">if</span> (shouldSkipContextMenu(e))
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  e = getRealEvent(e);
  menuTable = tableName;
  <span class="hljs-keyword">var</span> name = tableName;
  <span class="hljs-keyword">if</span> (name &amp;&amp; name.substring(<span class="hljs-number">0</span>, <span class="hljs-number">8</span>) != <span class="hljs-string">"context_"</span>)
    name = <span class="hljs-string">"context_"</span> + name;
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">document</span>.readyState &amp;&amp; <span class="hljs-built_in">document</span>.readyState != <span class="hljs-string">"complete"</span> &amp;&amp; <span class="hljs-built_in">document</span>.readyState != <span class="hljs-string">"interactive"</span> &amp;&amp; <span class="hljs-keyword">typeof</span> <span class="hljs-built_in">window</span>.g_hasCompleted == <span class="hljs-string">"undefined"</span>) {
    jslog(<span class="hljs-string">"Ignored context menu show for "</span> + name + <span class="hljs-string">" because document was not ready"</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  }
  <span class="hljs-built_in">window</span>.g_hasCompleted = <span class="hljs-literal">true</span>;
  <span class="hljs-keyword">if</span> (getMenuByName(name)) {
    <span class="hljs-keyword">var</span> contextMenu = getMenuByName(name).context;
    contextMenu.setProperty(<span class="hljs-string">'timeout'</span>, timeoutValue);
    contextMenu.setProperty(<span class="hljs-string">'top'</span>, ttop);
    contextMenu.setProperty(<span class="hljs-string">'left'</span>, lleft);
    contextMenu.setProperty(<span class="hljs-string">'right'</span>, rright);
    <span class="hljs-keyword">if</span> (contextMenu.menu.style.display == <span class="hljs-string">"block"</span>)
      contextMenu.menu.style.display = <span class="hljs-string">"none"</span>;
    <span class="hljs-keyword">else</span>
      contextMenu.display(e);
    <span class="hljs-keyword">if</span> (contextMenu.onshow)
      contextMenu.onshow();
  }
  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">contextQuestionLabel</span>(<span class="hljs-params">e, sys_id</span>) </span>{
  <span class="hljs-keyword">if</span> (shouldSkipContextMenu(e))
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  e = getRealEvent(e);
  <span class="hljs-keyword">var</span> name = <span class="hljs-string">"context_question_label"</span>;
  menuTable = <span class="hljs-string">"not_important"</span>;
  menuField = <span class="hljs-string">"not_important"</span>;
  rowSysId = sys_id;
  <span class="hljs-keyword">if</span> (getMenuByName(name)) {
    <span class="hljs-keyword">var</span> contextMenu = getMenuByName(name).context;
    contextMenu.setProperty(<span class="hljs-string">'sysparm_sys_id'</span>, sys_id);
    contextMenu.display(e);
  }
  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">shouldSkipContextMenu</span>(<span class="hljs-params">e</span>) </span>{
  <span class="hljs-keyword">if</span> (e.ctrlKey &amp;&amp; trustCtrlKeyResponse())
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">trustCtrlKeyResponse</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> isMacintosh || !isSafari;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">contextTimeout</span>(<span class="hljs-params">e, tableName, waitCount</span>) </span>{
  <span class="hljs-keyword">var</span> name = <span class="hljs-string">"context_"</span> + tableName;
  <span class="hljs-keyword">if</span> (!getMenuByName(name))
    <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">var</span> contextMenu = getMenuByName(name).context;
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> waitCount == <span class="hljs-string">"undefined"</span>)
    waitCount = <span class="hljs-number">500</span>;
  contextMenu.setProperty(<span class="hljs-string">"timeout"</span>, waitCount);
  <span class="hljs-keyword">var</span> hideParam;
  <span class="hljs-keyword">if</span> (contextMenu.hideOnlySelf == <span class="hljs-literal">true</span>)
    hideParam = <span class="hljs-string">'"'</span> + name + <span class="hljs-string">'"'</span>;
  contextMenu.setTimeout(setTimeout(<span class="hljs-string">'contextHide('</span> + hideParam + <span class="hljs-string">')'</span>, waitCount));
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getMenuByName</span>(<span class="hljs-params">name</span>) </span>{
  <span class="hljs-keyword">return</span> contextMenus[name];
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getRowID</span>(<span class="hljs-params">e</span>) </span>{
  <span class="hljs-keyword">var</span> id = <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">var</span> cell = e.srcElement;
  <span class="hljs-keyword">if</span> (cell == <span class="hljs-literal">null</span>)
    cell = e.target;
  <span class="hljs-keyword">var</span> row = cell.parentNode;
  <span class="hljs-keyword">var</span> id = row.id;
  <span class="hljs-keyword">if</span> (id == <span class="hljs-literal">null</span> || id.length == <span class="hljs-number">0</span>)
    id = row.parentNode.id;
  <span class="hljs-keyword">return</span> id;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">contextHide</span>(<span class="hljs-params">name</span>) </span>{
  <span class="hljs-keyword">if</span> (!gActiveContext)
    <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> name != <span class="hljs-string">"undefined"</span> &amp;&amp; gActiveContext.getID() != name)
    <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">if</span> (gActiveContext.beforehide) {
    <span class="hljs-keyword">if</span> (gActiveContext.beforehide() == <span class="hljs-literal">false</span>)
      <span class="hljs-keyword">return</span>;
  }
  gActiveContext.hideAll();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">elementAction</span>(<span class="hljs-params">e, event, gcm</span>) </span>{
  <span class="hljs-keyword">var</span> type = e.getAttribute(<span class="hljs-string">"type"</span>);
  <span class="hljs-keyword">var</span> choice = e.getAttribute(<span class="hljs-string">"choice"</span>);
  <span class="hljs-keyword">var</span> id = e.id;
  <span class="hljs-keyword">var</span> fName = id.substring(id.indexOf(<span class="hljs-string">'.'</span>) + <span class="hljs-number">1</span>);
  <span class="hljs-keyword">var</span> tableName = fName.substring(<span class="hljs-number">0</span>, fName.indexOf(<span class="hljs-string">'.'</span>));
  <span class="hljs-keyword">var</span> haveAccess = $(<span class="hljs-string">"personalizer_"</span> + tableName);
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span>(g_user) != <span class="hljs-string">'undefined'</span>) {
    <span class="hljs-keyword">var</span> count = <span class="hljs-number">1</span>;
    <span class="hljs-keyword">if</span> (!gcm)
      gcm = addActionItems(fName, tableName, type, choice);
    <span class="hljs-keyword">if</span> (gcm)
      <span class="hljs-keyword">return</span> contextShow(event, gcm.getID(), <span class="hljs-number">-1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
  }
  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addActionItems</span>(<span class="hljs-params">id, table, type, choice</span>) </span>{
  <span class="hljs-keyword">var</span> jr = <span class="hljs-keyword">new</span> GlideAjax(<span class="hljs-string">"AJAXJellyRunner"</span>, <span class="hljs-string">"AJAXJellyRunner.do"</span>);
  jr.addParam(<span class="hljs-string">'template'</span>, <span class="hljs-string">'element_context.xml'</span>);
  jr.addParam(<span class="hljs-string">'sysparm_id'</span>, id);
  jr.addParam(<span class="hljs-string">'sysparm_table'</span>, table);
  jr.addParam(<span class="hljs-string">'sysparm_type'</span>, type);
  jr.addParam(<span class="hljs-string">'sysparm_choice'</span>, choice);
  jr.addParam(<span class="hljs-string">'sysparm_contextual_security'</span>, g_form.hasAttribute(<span class="hljs-string">'contextual_security'</span>));
  jr.setWantRequestObject(<span class="hljs-literal">true</span>);
  <span class="hljs-keyword">var</span> response = jr.getXMLWait();
  <span class="hljs-keyword">if</span> (!response)
    <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">var</span> html = response.responseText;
  html.evalScripts(<span class="hljs-literal">true</span>);
  <span class="hljs-keyword">return</span> gcm;
}
Event.observe(<span class="hljs-built_in">window</span>, <span class="hljs-string">'unload'</span>, clearMenus, <span class="hljs-literal">false</span>);
Event.observe(<span class="hljs-built_in">window</span>, <span class="hljs-string">'scroll'</span>, debounceContextScroll(<span class="hljs-number">100</span>));

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">debounceContextScroll</span>(<span class="hljs-params">ms</span>) </span>{
  <span class="hljs-keyword">var</span> timeout;
  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (timeout)
      clearTimeout(timeout);
    timeout = setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      contextMenuHide();
      timeout = <span class="hljs-literal">null</span>;
    }, ms);
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">clearMenus</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">for</span> (av <span class="hljs-keyword">in</span> contextMenus) {
    <span class="hljs-keyword">if</span> (contextMenus[av]) {
      <span class="hljs-keyword">var</span> c = contextMenus[av].context;
      <span class="hljs-keyword">if</span> (c) {
        c.destroy();
      }
      contextMenus[av] = <span class="hljs-literal">null</span>;
    }
  }
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> keys <span class="hljs-keyword">in</span> shortcuts) {
    <span class="hljs-keyword">if</span> (shortcuts[keys])
      shortcuts[keys].clear();
  }
  shortcuts = <span class="hljs-literal">null</span>;
};
<span class="hljs-comment">/*! RESOURCE: /scripts/doctype/functions.js */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isDoctype</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">gsftSubmit</span>(<span class="hljs-params">control, form, action_name</span>) </span>{
  <span class="hljs-keyword">var</span> f;
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> form == <span class="hljs-string">"undefined"</span>) {
    f = findParentByTag(control, <span class="hljs-string">'form'</span>);
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> form == <span class="hljs-string">"undefined"</span>) {
      <span class="hljs-keyword">var</span> sectionFormId = $(<span class="hljs-string">"section_form_id"</span>);
      <span class="hljs-keyword">if</span> (sectionFormId)
        f = $(sectionFormId.value);
    }
  } <span class="hljs-keyword">else</span>
    f = form;
  <span class="hljs-keyword">if</span> (g_submitted)
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> action_name == <span class="hljs-string">"undefined"</span> &amp;&amp; control)
    action_name = control.id;
  <span class="hljs-keyword">if</span> (action_name == <span class="hljs-string">'sysverb_delete'</span>) {
    <span class="hljs-keyword">if</span> (!confirm(getMessage(<span class="hljs-string">"Delete this record"</span>) + <span class="hljs-string">"?"</span>)) {
      g_submitted = <span class="hljs-literal">false</span>;
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
  }
  f.sys_action.value = action_name;
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> f.onsubmit == <span class="hljs-string">"function"</span> &amp;&amp; action_name != <span class="hljs-string">'sysverb_back'</span>) {
    <span class="hljs-keyword">var</span> rc = f.onsubmit();
    <span class="hljs-keyword">if</span> (rc === <span class="hljs-literal">false</span>) {
      g_submitted = g_form.submitted = <span class="hljs-literal">false</span>;
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
  }
  <span class="hljs-keyword">if</span> (control &amp;&amp; control.getAttribute(<span class="hljs-string">'gsft_id'</span>)) {
    action_name = control.getAttribute(<span class="hljs-string">'gsft_id'</span>);
    f.sys_action.value = action_name;
  }
  <span class="hljs-keyword">if</span> (action_name == <span class="hljs-string">'sysverb_back'</span>)
    g_submitted = <span class="hljs-literal">false</span>;
  <span class="hljs-keyword">else</span>
    g_submitted = <span class="hljs-literal">true</span>;
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> g_form != <span class="hljs-string">'undefined'</span> &amp;&amp; g_form &amp;&amp; g_submitted)
    g_form.enableUIPolicyFields();
  CustomEvent.fire(<span class="hljs-string">"glide:form_submitted"</span>);
  <span class="hljs-keyword">try</span> {
    GlideAjax.disableSessionMessages();
    f.submit();
  } <span class="hljs-keyword">catch</span> (ex) {
    GlideAjax.enableSessionMessages();
    <span class="hljs-keyword">if</span> (ex.message.indexOf(<span class="hljs-string">'Unspecified'</span>) == <span class="hljs-number">-1</span>)
      <span class="hljs-keyword">throw</span> ex;
  }
  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setCheckBox</span>(<span class="hljs-params">box</span>) </span>{
  <span class="hljs-keyword">var</span> name = box.name;
  <span class="hljs-keyword">var</span> id = name.substring(<span class="hljs-number">3</span>);
  <span class="hljs-keyword">var</span> frm = box.form;
  <span class="hljs-keyword">if</span> (frm)
    frm[id].value = box.checked;
  <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">var</span> widget = $(id);
    <span class="hljs-keyword">if</span> (widget)
      widget.value = box.checked;
  }
  <span class="hljs-keyword">if</span> (box[<span class="hljs-string">'onchange'</span>])
    box.onchange();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">populateParmQuery</span>(<span class="hljs-params">form, prefix, defaultNULL, action</span>) </span>{
  <span class="hljs-keyword">var</span> keys = [<span class="hljs-string">'No records selected'</span>, <span class="hljs-string">'Delete the selected item?'</span>, <span class="hljs-string">'Delete these'</span>, <span class="hljs-string">'items?'</span>];
  <span class="hljs-keyword">var</span> msgs = getMessages(keys);
  <span class="hljs-keyword">var</span> keyset = getChecked(form);
  <span class="hljs-keyword">if</span> (!action)
    action = form.sys_action.value;
  <span class="hljs-keyword">if</span> (action.indexOf(<span class="hljs-string">"sysverb"</span>) != <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">if</span> (keyset == <span class="hljs-string">''</span>) {
      <span class="hljs-keyword">if</span> (!alert(msgs[<span class="hljs-string">"No records selected"</span>]))
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">if</span> (action == <span class="hljs-string">"delete_checked"</span>) {
        <span class="hljs-keyword">var</span> items = keyset.split(<span class="hljs-string">","</span>);
        <span class="hljs-keyword">if</span> (items.length == <span class="hljs-number">1</span>) {
          <span class="hljs-keyword">if</span> (!confirm(msgs[<span class="hljs-string">"Delete the selected item?"</span>]))
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (items.length &gt; <span class="hljs-number">0</span>) {
          <span class="hljs-keyword">if</span> (!confirm(msgs[<span class="hljs-string">"Delete these"</span>] + <span class="hljs-string">" "</span> + items.length + <span class="hljs-string">" "</span> + msgs[<span class="hljs-string">"items?"</span>]))
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }
      }
    }
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (form.sys_action.value == <span class="hljs-string">"sysverb_new"</span>) {
    addInput(form, <span class="hljs-string">'HIDDEN'</span>, <span class="hljs-string">'sys_id'</span>, <span class="hljs-string">'-1'</span>);
  }
  <span class="hljs-keyword">if</span> (keyset == <span class="hljs-string">''</span> &amp;&amp; defaultNULL)
    keyset = defaultNULL;
  <span class="hljs-keyword">if</span> (prefix)
    keyset = prefix + keyset;
  addInput(form, <span class="hljs-string">'HIDDEN'</span>, <span class="hljs-string">'sysparm_checked_items'</span>, keyset);
  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getChecked</span>(<span class="hljs-params">form</span>) </span>{
  <span class="hljs-keyword">var</span> keyset = <span class="hljs-string">''</span>;
  <span class="hljs-keyword">var</span> lookup = form;
  <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; lookup.elements.length; i++) {
    <span class="hljs-keyword">if</span> (lookup.elements[i].type != <span class="hljs-string">"checkbox"</span>)
      <span class="hljs-keyword">continue</span>;
    <span class="hljs-keyword">var</span> v = lookup.elements[i];
    <span class="hljs-keyword">if</span> (v.checked) {
      <span class="hljs-keyword">var</span> id = v.id.substring(<span class="hljs-number">3</span>);
      <span class="hljs-keyword">var</span> skip = v.name.substring(<span class="hljs-number">0</span>, <span class="hljs-number">4</span>);
      <span class="hljs-keyword">if</span> (skip == <span class="hljs-string">"SKIP"</span>)
        <span class="hljs-keyword">continue</span>;
      <span class="hljs-keyword">if</span> (id == <span class="hljs-string">"all"</span>)
        <span class="hljs-keyword">continue</span>;
      <span class="hljs-keyword">if</span> (keyset == <span class="hljs-string">''</span>)
        keyset = id;
      <span class="hljs-keyword">else</span>
        keyset = keyset + <span class="hljs-string">','</span> + id;
    }
  }
  <span class="hljs-keyword">return</span> keyset;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">iterateList</span>(<span class="hljs-params">e, row, value, update</span>) </span>{
  update = (<span class="hljs-keyword">typeof</span> update === <span class="hljs-string">'undefined'</span>) ? <span class="hljs-literal">true</span> : update;
  <span class="hljs-keyword">if</span> (update)
    g_form.setMandatoryOnlyIfModified(<span class="hljs-literal">true</span>);
  <span class="hljs-keyword">var</span> form = g_form.getFormElement();
  form.sys_action.value = value;
  <span class="hljs-keyword">var</span> query = e.getAttribute(<span class="hljs-string">"query"</span>);
  addInput(form, <span class="hljs-string">'HIDDEN'</span>, <span class="hljs-string">'sys_record_row'</span>, row);
  addInput(form, <span class="hljs-string">'HIDDEN'</span>, <span class="hljs-string">'sys_record_list'</span>, query);
  <span class="hljs-keyword">if</span> (update &amp;&amp; <span class="hljs-keyword">typeof</span> form.onsubmit == <span class="hljs-string">"function"</span>) {
    <span class="hljs-keyword">var</span> rc = form.onsubmit();
    <span class="hljs-keyword">if</span> (!rc) {
      g_submitted = <span class="hljs-literal">false</span>;
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
  }
  <span class="hljs-keyword">try</span> {
    form.submit();
  } <span class="hljs-keyword">catch</span> (ex) {
    <span class="hljs-keyword">if</span> (ex.message.indexOf(<span class="hljs-string">'Unspecified'</span>) == <span class="hljs-number">-1</span>)
      <span class="hljs-keyword">throw</span> ex;
  }
  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">refreshNav</span>(<span class="hljs-params"></span>) </span>{
  CustomEvent.fireTop(<span class="hljs-string">'navigator.refresh'</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">checkSave</span>(<span class="hljs-params">tableName, urlBase, idField, refKey</span>) </span>{
  <span class="hljs-keyword">var</span> sysid = <span class="hljs-built_in">document</span>.getElementsByName(idField)[<span class="hljs-number">0</span>].value;
  checkSaveID(tableName, urlBase, sysid, refKey);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">checkSaveID</span>(<span class="hljs-params">tableName, urlBase, sysid, refKey</span>) </span>{
  sysid = trim(sysid);
  <span class="hljs-keyword">var</span> url = urlBase + <span class="hljs-string">"?sys_id="</span> + sysid;
  <span class="hljs-keyword">if</span> (refKey)
    url += <span class="hljs-string">"&amp;sysparm_refkey="</span> + refKey;
  <span class="hljs-keyword">var</span> view = $(<span class="hljs-string">'sysparm_view'</span>);
  <span class="hljs-keyword">if</span> (view != <span class="hljs-literal">null</span>) {
    view = view.value;
    <span class="hljs-keyword">if</span> (view != <span class="hljs-string">''</span>)
      url += <span class="hljs-string">"&amp;sysparm_view="</span> + view;
  }
  <span class="hljs-keyword">var</span> nameOfStack = $(<span class="hljs-string">'sysparm_nameofstack'</span>);
  <span class="hljs-keyword">if</span> (nameOfStack != <span class="hljs-literal">null</span>) {
    nameOfStack = nameOfStack.value;
    <span class="hljs-keyword">if</span> (nameOfStack != <span class="hljs-string">''</span>)
      url += <span class="hljs-string">"&amp;sysparm_nameofstack="</span> + nameOfStack;
  }
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> GlideTransactionScope != <span class="hljs-string">'undefined'</span>) {
    GlideTransactionScope.appendTransactionScope(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name, value</span>) </span>{
      url += <span class="hljs-string">"&amp;"</span> + name + <span class="hljs-string">"="</span> + value;
    });
  }
  <span class="hljs-keyword">return</span> checkSaveURL(tableName, url);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">checkSaveURL</span>(<span class="hljs-params">tableName, url</span>) </span>{
  <span class="hljs-keyword">if</span> (g_submitted)
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  <span class="hljs-keyword">var</span> f = <span class="hljs-built_in">document</span>.getElementById(tableName + <span class="hljs-string">".do"</span>);
  <span class="hljs-keyword">if</span> (g_form.getTableName() == tableName) {
    <span class="hljs-keyword">var</span> fs = <span class="hljs-built_in">document</span>.forms;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> z = <span class="hljs-number">0</span>; z &lt; fs.length; z++) {
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> fs[z].sys_uniqueValue != <span class="hljs-string">'undefined'</span>) {
        f = fs[z];
        <span class="hljs-keyword">break</span>;
      }
    }
  }
  <span class="hljs-keyword">if</span> (!g_form.isNewRecord())
    g_form.setMandatoryOnlyIfModified(<span class="hljs-literal">true</span>);
  f.sys_action.value = <span class="hljs-string">'sysverb_check_save'</span>;
  addInput(f, <span class="hljs-string">'HIDDEN'</span>, <span class="hljs-string">'sysparm_goto_url'</span>, url);
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> f.onsubmit == <span class="hljs-string">"function"</span>) {
    <span class="hljs-keyword">var</span> rc = f.onsubmit();
    <span class="hljs-keyword">if</span> (!rc) {
      g_submitted = <span class="hljs-literal">false</span>;
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
  }
  g_submitted = <span class="hljs-literal">true</span>;
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> g_form != <span class="hljs-string">'undefined'</span> &amp;&amp; g_form)
    g_form.enableUIPolicyFields();
  f.submit();
  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">submitTextSearch</span>(<span class="hljs-params">event, tableName</span>) </span>{
  <span class="hljs-keyword">if</span> (event != <span class="hljs-literal">true</span> &amp;&amp; event.keyCode != <span class="hljs-number">13</span>)
    <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">var</span> form = getControlForm(tableName);
  addHidden(form, <span class="hljs-string">'sysverb_textsearch'</span>, form[<span class="hljs-string">'sys_searchtext'</span>].value);
  addHidden(form, <span class="hljs-string">'sysparm_query'</span>, <span class="hljs-string">''</span>);
  addHidden(form, <span class="hljs-string">'sysparm_referring_url'</span>, <span class="hljs-string">''</span>);
  form.submit();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getControlForm</span>(<span class="hljs-params">name</span>) </span>{
  <span class="hljs-keyword">var</span> form = <span class="hljs-built_in">document</span>.forms[name + <span class="hljs-string">'_control'</span>];
  <span class="hljs-keyword">if</span> (isSafari || isChrome) {
    <span class="hljs-keyword">if</span> (form) {
      <span class="hljs-keyword">var</span> collectionType = form.toString();
      <span class="hljs-keyword">if</span> (collectionType != <span class="hljs-string">"[object HTMLFormElement]"</span>)
        form = form[<span class="hljs-number">0</span>];
    }
  }
  <span class="hljs-keyword">return</span> form;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getFormForList</span>(<span class="hljs-params">listId</span>) </span>{
  <span class="hljs-keyword">return</span> $(listId + <span class="hljs-string">"_control"</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getFormForElement</span>(<span class="hljs-params">element</span>) </span>{
  <span class="hljs-keyword">var</span> f = element.form;
  <span class="hljs-keyword">if</span> (f)
    <span class="hljs-keyword">return</span> f;
  <span class="hljs-keyword">return</span> findParentByTag(element, <span class="hljs-string">"form"</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hideReveal</span>(<span class="hljs-params">sectionName, imagePrefix, snap</span>) </span>{
  <span class="hljs-keyword">var</span> el = $(sectionName);
  <span class="hljs-keyword">if</span> (!el)
    <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">var</span> $s = $j(<span class="hljs-string">'#section-'</span> + sectionName);
  <span class="hljs-keyword">if</span> ($s.length == <span class="hljs-number">0</span>)
    <span class="hljs-keyword">return</span> _hideRevealDirect(sectionName, imagePrefix, snap);
  <span class="hljs-keyword">var</span> $b = $j(<span class="hljs-string">".section-content"</span>, $s);
  <span class="hljs-keyword">if</span> ($s.hasClass(<span class="hljs-string">"state-closed"</span>))
    $b.show(<span class="hljs-string">"medium"</span>);
  <span class="hljs-keyword">else</span>
    $b.hide(<span class="hljs-string">"medium"</span>);
  $s.toggleClass(<span class="hljs-string">'state-closed'</span>);
  setPreference(<span class="hljs-string">"collapse.section."</span> + sectionName, $s.hasClass(<span class="hljs-string">'state-closed'</span>) ? <span class="hljs-string">"true"</span> : <span class="hljs-string">"false"</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_hideRevealDirect</span>(<span class="hljs-params">sectionName, imagePrefix, snap</span>) </span>{
  <span class="hljs-keyword">var</span> el = $(sectionName);
  <span class="hljs-keyword">if</span> (!el)
    <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">var</span> img = $(<span class="hljs-string">"img."</span> + sectionName);
  <span class="hljs-keyword">var</span> imageName = <span class="hljs-string">"section"</span>;
  <span class="hljs-keyword">if</span> (imagePrefix)
    imageName = imagePrefix;
  <span class="hljs-keyword">if</span> (el.style.display == <span class="hljs-string">"block"</span>) {
    hide(el);
    <span class="hljs-keyword">if</span> (img) {
      img.src = <span class="hljs-string">"images/"</span> + imageName + <span class="hljs-string">"_hide.gifx"</span>;
      img.alt = getMessage(<span class="hljs-string">"Display / Hide"</span>);
    }
  } <span class="hljs-keyword">else</span> {
    show(el);
    <span class="hljs-keyword">if</span> (img) {
      img.src = <span class="hljs-string">"images/"</span> + imageName + <span class="hljs-string">"_reveal.gifx"</span>;
      img.alt = getMessage(<span class="hljs-string">"Display / Hide"</span>);
    }
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hideRevealWithTitle</span>(<span class="hljs-params">name, hideMsg, showMsg</span>) </span>{
  <span class="hljs-keyword">var</span> el = $(name);
  <span class="hljs-keyword">if</span> (!el)
    <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">var</span> img = $(<span class="hljs-string">"img."</span> + name);
  <span class="hljs-keyword">if</span> (el.style.display == <span class="hljs-string">"block"</span>) {
    el.style.display = <span class="hljs-string">"none"</span>;
    img.src = <span class="hljs-string">"images/section_hide.gifx"</span>
    img.title = showMsg;
    img.alt = showMsg;
  } <span class="hljs-keyword">else</span> {
    el.style.display = <span class="hljs-string">"block"</span>;
    img.src = <span class="hljs-string">"images/section_reveal.gifx"</span>
    img.title = hideMsg;
    img.alt = hideMsg;
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">forceHideWithTitle</span>(<span class="hljs-params">name, msg</span>) </span>{
  <span class="hljs-keyword">var</span> el = $(name);
  <span class="hljs-keyword">if</span> (!el)
    <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">var</span> img = $(<span class="hljs-string">"img."</span> + name);
  el.style.display = <span class="hljs-string">"none"</span>;
  img.src = <span class="hljs-string">"images/section_hide.gifx"</span>
  img.title = msg;
  img.alt = msg;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">forceHide</span>(<span class="hljs-params">sectionName</span>) </span>{
  <span class="hljs-keyword">var</span> el = $(sectionName);
  <span class="hljs-keyword">if</span> (!el)
    <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">var</span> img = $(<span class="hljs-string">"img."</span> + sectionName);
  el.style.display = <span class="hljs-string">"none"</span>;
  img.src = <span class="hljs-string">"images/section_hide.gifx"</span>;
  img.alt = getMessage(<span class="hljs-string">"Collapse"</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">forceReveal</span>(<span class="hljs-params">sectionName, sectionNameStarts, tagName</span>) </span>{
  <span class="hljs-keyword">var</span> els = $$(tagName);
  <span class="hljs-keyword">if</span> (els) {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> c = <span class="hljs-number">0</span>; c &lt; els.length; ++c) {
      <span class="hljs-keyword">if</span> (els[c].id.indexOf(sectionNameStarts) == <span class="hljs-number">0</span>) {
        forceHide(els[c].id);
      }
    }
  }
  <span class="hljs-keyword">var</span> el = $(sectionName);
  <span class="hljs-keyword">if</span> (!el)
    <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">var</span> img = $(<span class="hljs-string">"img."</span> + sectionName);
  el.style.display = <span class="hljs-string">"block"</span>;
  img.src = <span class="hljs-string">"images/section_reveal.gif"</span>;
  img.alt = getMessage(<span class="hljs-string">"Expand"</span>);
  <span class="hljs-built_in">window</span>.location = <span class="hljs-string">'#'</span> + sectionName;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">insertAtCursor</span>(<span class="hljs-params">textField, value</span>) </span>{
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">document</span>.selection) {
    textField.focus();
    sel = <span class="hljs-built_in">document</span>.selection.createRange();
    sel.text = value;
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (textField.selectionStart || textField.selectionStart == <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">var</span> startPos = textField.selectionStart;
    <span class="hljs-keyword">var</span> endPos = textField.selectionEnd;
    textField.value = textField.value.substring(<span class="hljs-number">0</span>, startPos) + value +
      textField.value.substring(endPos, textField.value.length);
  } <span class="hljs-keyword">else</span> {
    textField.value += value;
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">insertScriptVar</span>(<span class="hljs-params">textBoxName, selectBoxName</span>) </span>{
  <span class="hljs-keyword">var</span> textBox = $(textBoxName);
  <span class="hljs-keyword">var</span> select = $(selectBoxName);
  <span class="hljs-keyword">var</span> options = select.options;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i != select.length; i++) {
    <span class="hljs-keyword">var</span> option = options[i];
    <span class="hljs-keyword">if</span> (!option.selected)
      <span class="hljs-keyword">continue</span>;
    <span class="hljs-keyword">var</span> label = option.text;
    <span class="hljs-keyword">var</span> v = option.value.split(<span class="hljs-string">'.'</span>);
    v = <span class="hljs-string">'current.'</span> + v[<span class="hljs-number">1</span>];
    insertAtCursor(textBox, v);
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fieldTyped</span>(<span class="hljs-params">me</span>) </span>{
  formChangeKeepAlive();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setPreference</span>(<span class="hljs-params">name, value, func</span>) </span>{
  <span class="hljs-keyword">var</span> u = getActiveUser();
  <span class="hljs-keyword">if</span> (u)
    u.setPreference(name, value);
  <span class="hljs-keyword">var</span> url = <span class="hljs-keyword">new</span> GlideAjax(<span class="hljs-string">"UserPreference"</span>);
  url.addParam(<span class="hljs-string">"sysparm_type"</span>, <span class="hljs-string">"set"</span>);
  url.addParam(<span class="hljs-string">"sysparm_name"</span>, name);
  url.addParam(<span class="hljs-string">"sysparm_value"</span>, value);
  url.getXML(func);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">deletePreference</span>(<span class="hljs-params">name</span>) </span>{
  <span class="hljs-keyword">var</span> u = getActiveUser();
  <span class="hljs-keyword">if</span> (u)
    u.deletePreference(name);
  <span class="hljs-keyword">var</span> url = <span class="hljs-keyword">new</span> GlideAjax(<span class="hljs-string">"UserPreference"</span>);
  url.addParam(<span class="hljs-string">"sysparm_type"</span>, <span class="hljs-string">"delete"</span>);
  url.addParam(<span class="hljs-string">"sysparm_name"</span>, name);
  url.getXML(doNothing);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getPreference</span>(<span class="hljs-params">name</span>) </span>{
  <span class="hljs-keyword">var</span> u = getActiveUser();
  <span class="hljs-keyword">if</span> (u) {
    <span class="hljs-keyword">var</span> opinion = u.getPreference(name);
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> opinion != <span class="hljs-string">'undefined'</span>)
      <span class="hljs-keyword">return</span> opinion;
  }
  <span class="hljs-keyword">var</span> url = <span class="hljs-keyword">new</span> GlideAjax(<span class="hljs-string">"UserPreference"</span>);
  url.addParam(<span class="hljs-string">"sysparm_type"</span>, <span class="hljs-string">"get"</span>);
  url.addParam(<span class="hljs-string">"sysparm_name"</span>, name);
  <span class="hljs-keyword">var</span> xml = url.getXMLWait();
  <span class="hljs-keyword">if</span> (!xml)
    <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>;
  <span class="hljs-keyword">var</span> items = xml.getElementsByTagName(<span class="hljs-string">"item"</span>);
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; items.length; i++) {
    <span class="hljs-keyword">var</span> item = items[i];
    <span class="hljs-keyword">var</span> value = item.getAttribute(<span class="hljs-string">"value"</span>);
    <span class="hljs-keyword">if</span> (u)
      u.setPreference(name, value);
    <span class="hljs-keyword">return</span> value;
  }
  <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getActiveUser</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> getTopWindow().g_active_user || <span class="hljs-built_in">window</span>.g_user;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">labelClicked</span>(<span class="hljs-params">label, elementType</span>) </span>{
  <span class="hljs-keyword">var</span> hFor = label.htmlFor;
  <span class="hljs-keyword">if</span> (hFor) {
    <span class="hljs-keyword">var</span> elpaco = $(<span class="hljs-string">"sys_display."</span> + hFor);
    <span class="hljs-keyword">if</span> (!elpaco || elpaco.type == <span class="hljs-string">"hidden"</span>)
      elpaco = $(hFor);
    <span class="hljs-keyword">if</span> (elpaco &amp;&amp; elpaco.type != <span class="hljs-string">"hidden"</span> &amp;&amp; elpaco.style.visibility != <span class="hljs-string">"hidden"</span>) {
      <span class="hljs-keyword">if</span> (elpaco.disabled != <span class="hljs-literal">true</span>)
        <span class="hljs-keyword">if</span> (elementType == <span class="hljs-string">"html"</span> || elementType == <span class="hljs-string">"translated_html"</span>) {
          <span class="hljs-keyword">var</span> handler = g_form.elementHandlers[hFor];
          <span class="hljs-keyword">if</span> (handler)
            handler.focusEditor();
        } <span class="hljs-keyword">else</span>
          elpaco.focus();
    }
  }
  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">insertFieldName</span>(<span class="hljs-params">textBoxName, label</span>) </span>{
  <span class="hljs-keyword">var</span> textBox = $(textBoxName);
  <span class="hljs-keyword">var</span> index = label.indexOf(<span class="hljs-string">":"</span>);
  <span class="hljs-keyword">if</span> (index &gt; <span class="hljs-number">-1</span>)
    insertAtCursor(textBox, <span class="hljs-string">"\n"</span> + label);
  <span class="hljs-keyword">else</span>
    insertAtCursor(textBox, label);
  <span class="hljs-keyword">var</span> form = textBox.up(<span class="hljs-string">'form'</span>);
  <span class="hljs-keyword">if</span> (form) {
    <span class="hljs-keyword">var</span> onChangeData = {
      <span class="hljs-attr">id</span>: textBox.id,
      <span class="hljs-attr">value</span>: textBox.value,
      <span class="hljs-attr">modified</span>: <span class="hljs-literal">true</span>
    };
    form.fire(<span class="hljs-string">'glideform:onchange'</span>, onChangeData);
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">replaceRegEx</span>(<span class="hljs-params">text, doc, tableName</span>) </span>{
  <span class="hljs-keyword">var</span> s = <span class="hljs-string">""</span>;
  <span class="hljs-keyword">var</span> re = <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(<span class="hljs-string">"%\\{\\w+[\\}]"</span>);
  <span class="hljs-keyword">var</span> m = re.exec(text);
  <span class="hljs-keyword">if</span> (m != <span class="hljs-literal">null</span>) {
    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; m.length; i++) {
      s = s + m[i];
    }
  }
  <span class="hljs-keyword">if</span> (tableName.indexOf(<span class="hljs-string">'.'</span>) &gt; <span class="hljs-number">0</span>)
    tableName = tableName.split(<span class="hljs-string">'.'</span>)[<span class="hljs-number">0</span>];
  <span class="hljs-keyword">if</span> (s.length &gt; <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">var</span> field = s.substring(<span class="hljs-number">2</span>, s.length - <span class="hljs-number">1</span>);
    <span class="hljs-keyword">var</span> obj = doc.getElementById(<span class="hljs-string">"sys_display."</span> + tableName + <span class="hljs-string">"."</span> + field);
    <span class="hljs-keyword">var</span> val = <span class="hljs-string">"?"</span>;
    <span class="hljs-keyword">if</span> (obj != <span class="hljs-literal">null</span>)
      val = obj.value;
    <span class="hljs-keyword">if</span> (val.length == <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">var</span> labelText = <span class="hljs-string">"?"</span>;
      <span class="hljs-keyword">var</span> labels = doc.getElementsByTagName(<span class="hljs-string">"label"</span>);
      <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; labels.length; i++) {
        <span class="hljs-keyword">if</span> (labels[i].htmlFor == tableName + <span class="hljs-string">"."</span> + field) {
          labelText = labels[i].innerHTML;
          <span class="hljs-keyword">break</span>;
        }
      }
      <span class="hljs-keyword">if</span> (labelText.indexOf(<span class="hljs-string">':'</span>) &gt; <span class="hljs-number">0</span>)
        labelText = labelText.split(<span class="hljs-string">':'</span>)[<span class="hljs-number">0</span>];
      val = labelText;
    }
    re = <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(<span class="hljs-string">"%\\{"</span> + field + <span class="hljs-string">"[\\}]"</span>, <span class="hljs-string">"g"</span>);
    <span class="hljs-keyword">var</span> result = text.replace(re, val);
    <span class="hljs-keyword">if</span> (result.indexOf(<span class="hljs-string">"%{"</span>) &gt; <span class="hljs-number">0</span>)
      result = replaceRegEx(result, doc, tableName);
    <span class="hljs-keyword">return</span> result;
  }
  <span class="hljs-keyword">return</span> text;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toggleInline</span>(<span class="hljs-params">name</span>) </span>{
  _toggleDisplay(name, <span class="hljs-string">'inline'</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_toggleDisplay</span>(<span class="hljs-params">name, displayType</span>) </span>{
  <span class="hljs-keyword">var</span> e = $(name);
  <span class="hljs-keyword">if</span> (e.style.display == <span class="hljs-string">'none'</span>) {
    e.style.display = displayType;
    setPreference(name, displayType, <span class="hljs-literal">null</span>);
  } <span class="hljs-keyword">else</span> {
    e.style.display = <span class="hljs-string">'none'</span>;
    setPreference(name, <span class="hljs-string">'none'</span>, <span class="hljs-literal">null</span>);
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">textareaResizer</span>(<span class="hljs-params">id, change</span>) </span>{
  objectResizer(id, change, <span class="hljs-string">'rows'</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">textareaSizer</span>(<span class="hljs-params">id, rows</span>) </span>{
  <span class="hljs-keyword">var</span> element = $(id);
  <span class="hljs-keyword">if</span> (element)
    setAttributeValue(element, <span class="hljs-string">'rows'</span>, rows);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">selectResizer</span>(<span class="hljs-params">id, change</span>) </span>{
  objectResizer(id, change, <span class="hljs-string">'size'</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">objectResizer</span>(<span class="hljs-params">id, change, attrName</span>) </span>{
  <span class="hljs-keyword">var</span> element = $(id);
  <span class="hljs-keyword">if</span> (!element)
    <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">var</span> value = <span class="hljs-built_in">parseInt</span>(element.style.height, <span class="hljs-number">10</span>)
  value += change;
  <span class="hljs-keyword">if</span> (value &lt; <span class="hljs-number">1</span>)
    value = <span class="hljs-number">1</span>;
  <span class="hljs-keyword">if</span> (element.tagName == <span class="hljs-string">'INPUT'</span>) {
    element = $(<span class="hljs-string">"div."</span> + id);
    <span class="hljs-keyword">if</span> (element) {
      <span class="hljs-keyword">if</span> (change &gt; <span class="hljs-number">0</span>) {
        element.show();
      } <span class="hljs-keyword">else</span> {
        element.hide();
        value = <span class="hljs-number">1</span>;
      }
    }
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">var</span> oldRows = element.rows;
    element.style.height = value + <span class="hljs-string">'px'</span>;
    handleMaxMinHeights(element, value);
    resizeTextAreaIframe(<span class="hljs-literal">true</span>, id, value);
  }
  setPreference(<span class="hljs-string">'rows.'</span> + id, value);
  _frameChanged();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleMaxMinHeights</span>(<span class="hljs-params">element, height</span>) </span>{
  <span class="hljs-keyword">if</span> (!element || !height)
    <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">var</span> $element = $(element),
    maxHeight = <span class="hljs-built_in">parseInt</span>($element.getStyle(<span class="hljs-string">'maxHeight'</span>), <span class="hljs-number">10</span>),
    minHeight = <span class="hljs-built_in">parseInt</span>($element.getStyle(<span class="hljs-string">'minHeight'</span>), <span class="hljs-number">10</span>),
    id = getAttributeValue($element, <span class="hljs-string">'id'</span>);
  <span class="hljs-keyword">if</span> (height &gt;= maxHeight) {
    $(<span class="hljs-string">'sizer_plus_'</span> + id).addClassName(<span class="hljs-string">'disabled'</span>);
    $element.setStyle({
      <span class="hljs-attr">overflowY</span>: <span class="hljs-string">'auto'</span>
    });
    <span class="hljs-keyword">return</span>;
  }
  <span class="hljs-keyword">if</span> (height &lt;= minHeight) {
    $(<span class="hljs-string">'sizer_minus_'</span> + id).addClassName(<span class="hljs-string">'disabled'</span>);
    <span class="hljs-keyword">return</span>;
  }
  $(<span class="hljs-string">'sizer_plus_'</span> + id).removeClassName(<span class="hljs-string">'disabled'</span>);
  $(<span class="hljs-string">'sizer_minus_'</span> + id).removeClassName(<span class="hljs-string">'disabled'</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">resizeTextAreaIframe</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> args = <span class="hljs-built_in">Array</span>.prototype.slice.call(<span class="hljs-built_in">arguments</span>, <span class="hljs-number">0</span>),
    tf = $(<span class="hljs-string">"textarea_iframe."</span> + id),
    doctype = args[<span class="hljs-number">0</span>],
    id = args[<span class="hljs-number">1</span>],
    height,
    oldRows,
    rows;
  <span class="hljs-keyword">if</span> (doctype) {
    height = args[<span class="hljs-number">2</span>];
  } <span class="hljs-keyword">else</span> {
    rows = args[<span class="hljs-number">2</span>];
    oldRows = args[<span class="hljs-number">3</span>];
  }
  <span class="hljs-keyword">if</span> (!tf) {
    tf = $(id + <span class="hljs-string">'_ifr'</span>);
    <span class="hljs-keyword">if</span> (!tf)
      tf = $(<span class="hljs-string">'textarea_iframe.'</span> + id);
    <span class="hljs-keyword">if</span> (tf) {
      <span class="hljs-keyword">var</span> tbl = $(id + <span class="hljs-string">'_tbl'</span>);
      <span class="hljs-keyword">var</span> readOnlyDiv = $(id + <span class="hljs-string">'_readOnlyDiv'</span>);
      <span class="hljs-keyword">if</span> (doctype) {
        tf.style.height = (height + <span class="hljs-number">60</span>) + <span class="hljs-string">"px"</span>;
        <span class="hljs-keyword">if</span> (tbl) {
          tbl.style.height = (height + <span class="hljs-number">60</span>) + <span class="hljs-string">"px"</span>;
        }
        <span class="hljs-keyword">if</span> (readOnlyDiv) {
          readOnlyDiv.style.height = (height + <span class="hljs-number">60</span>) + <span class="hljs-string">"px"</span>;
        }
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">var</span> elHeight = <span class="hljs-built_in">parseInt</span>(tf.clientHeight);
        <span class="hljs-keyword">if</span> (elHeight == <span class="hljs-number">0</span> &amp;&amp; readOnlyDiv)
          elHeight = <span class="hljs-built_in">parseInt</span>(readOnlyDiv.style.height);
        <span class="hljs-keyword">var</span> pixelsPerRow = <span class="hljs-number">12</span>;
        <span class="hljs-keyword">var</span> newHeight = elHeight + (rows - oldRows) * pixelsPerRow;
        tf.style.height = newHeight + <span class="hljs-string">"px"</span>;
        <span class="hljs-keyword">if</span> (tbl) {
          tbl.style.height = (<span class="hljs-built_in">parseInt</span>(tbl.style.height) + (newHeight - elHeight)) + <span class="hljs-string">"px"</span>;
        }
        <span class="hljs-keyword">if</span> (readOnlyDiv) {
          readOnlyDiv.style.height = newHeight + <span class="hljs-string">"px"</span>;
        }
      }
    }
  }
  <span class="hljs-keyword">if</span> (!tf)
    <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">if</span> (!tf.parentNode)
    <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">if</span> (!tf.parentNode.nextSibling)
    <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">var</span> nid = tf.parentNode.nextSibling.id;
  <span class="hljs-keyword">if</span> (nid != id)
    <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">var</span> elHeight = tf.clientHeight;
  <span class="hljs-keyword">var</span> pixelsPerRow = <span class="hljs-built_in">Math</span>.round(elHeight / oldRows);
  tf.style.height = rows * pixelsPerRow + <span class="hljs-string">"px"</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toggleQuestionRows</span>(<span class="hljs-params">thisclass, display, fl</span>) </span>{
  forcelabels = <span class="hljs-literal">false</span>;
  <span class="hljs-keyword">if</span> (fl == <span class="hljs-literal">true</span>)
    forcelabels = <span class="hljs-literal">true</span>;
  <span class="hljs-keyword">var</span> rows = $(<span class="hljs-built_in">document</span>.body).select(<span class="hljs-string">'.'</span> + thisclass);
  <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; rows.length; i++) {
    <span class="hljs-keyword">var</span> element = rows[i];
    <span class="hljs-keyword">var</span> id = element.id;
    <span class="hljs-keyword">if</span> (<span class="hljs-string">'CATEGORY_LABEL'</span> != id || forcelabels)
      element.style.display = display;
  }
  <span class="hljs-keyword">var</span> openStyle = <span class="hljs-string">'none'</span>;
  <span class="hljs-keyword">var</span> closedStyle = <span class="hljs-string">'none'</span>;
  <span class="hljs-keyword">if</span> (<span class="hljs-string">'none'</span> == display)
    openStyle = <span class="hljs-string">''</span>;
  <span class="hljs-keyword">else</span>
    closedStyle = <span class="hljs-string">''</span>;
  <span class="hljs-keyword">var</span> s = $(thisclass + <span class="hljs-string">'CLOSED'</span>);
  s.style.display = closedStyle;
  s = $(thisclass + <span class="hljs-string">'OPEN'</span>);
  s.style.display = openStyle;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toggleWorkflow</span>(<span class="hljs-params">id, expandPref</span>) </span>{
  <span class="hljs-keyword">var</span> map = getMessages([<span class="hljs-string">'Expand'</span>, <span class="hljs-string">'Collapse'</span>]);
  <span class="hljs-keyword">var</span> table = $(<span class="hljs-string">"workflow."</span> + id);
  <span class="hljs-keyword">var</span> spans = table.getElementsByTagName(<span class="hljs-string">"span"</span>);
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i != spans.length; i++) {
    <span class="hljs-keyword">var</span> span = spans[i];
    <span class="hljs-keyword">if</span> (!span.getAttribute(<span class="hljs-string">"stage"</span>))
      <span class="hljs-keyword">continue</span>;
    <span class="hljs-keyword">var</span> spanImage = $(span.id + <span class="hljs-string">'.image'</span>);
    <span class="hljs-keyword">var</span> spanText = $(span.id + <span class="hljs-string">'.text'</span>);
    <span class="hljs-keyword">if</span> (span.getAttribute(<span class="hljs-string">"selected"</span>) == <span class="hljs-string">'true'</span>)
      spanText.style.color = <span class="hljs-string">"#2050d0"</span>;
    <span class="hljs-keyword">var</span> filterImg = $(<span class="hljs-string">'filterimg.'</span> + id);
    <span class="hljs-keyword">if</span> (expandPref == <span class="hljs-string">"false"</span>) {
      span.style.display = <span class="hljs-string">""</span>;
      spanText.style.display = <span class="hljs-string">"none"</span>;
      filterImg.src = <span class="hljs-string">"images/filter_hide16.gifx"</span>;
      filterImg.title = map[<span class="hljs-string">"Expand"</span>];
      filterImg.alt = map[<span class="hljs-string">"Expand"</span>];
    } <span class="hljs-keyword">else</span> {
      span.style.display = <span class="hljs-string">"block"</span>;
      spanText.style.display = <span class="hljs-string">""</span>;
      filterImg.src = <span class="hljs-string">"images/filter_reveal16.gifx"</span>;
      filterImg.title = map[<span class="hljs-string">"Collapse"</span>];
      filterImg.alt = map[<span class="hljs-string">"Collapse"</span>];
    }
  }
  _frameChanged();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">togglePreference</span>(<span class="hljs-params">id</span>) </span>{
  toggleItems(id);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toggleItems</span>(<span class="hljs-params">id, force</span>) </span>{
  <span class="hljs-keyword">var</span> tables = $$(<span class="hljs-string">"table"</span>);
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; tables.length; i++) {
    <span class="hljs-keyword">var</span> tableId = tables[i].id;
    <span class="hljs-keyword">if</span> (tableId.indexOf(<span class="hljs-string">"workflow."</span>) == <span class="hljs-number">-1</span>)
      <span class="hljs-keyword">continue</span>;
    <span class="hljs-keyword">var</span> idParts = tables[i].id.split(<span class="hljs-string">"."</span>);
    <span class="hljs-keyword">if</span> (id &amp;&amp; tableId != <span class="hljs-string">"workflow."</span> + id)
      <span class="hljs-keyword">continue</span>;
    <span class="hljs-keyword">var</span> pref = getPref(idParts[<span class="hljs-number">1</span>]);
    <span class="hljs-keyword">if</span> (force != pref)
      toggleWorkflow(idParts[<span class="hljs-number">1</span>], pref);
    <span class="hljs-keyword">if</span> (id)
      <span class="hljs-keyword">break</span>;
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getPref</span>(<span class="hljs-params">id</span>) </span>{
  <span class="hljs-keyword">var</span> filterImgSrc = $(<span class="hljs-string">'filterimg.'</span> + id).src
  <span class="hljs-keyword">if</span> (filterImgSrc.indexOf(<span class="hljs-string">'filter_hide'</span>) != <span class="hljs-number">-1</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-string">"true"</span>;
  <span class="hljs-keyword">return</span> <span class="hljs-string">"false"</span>;
}
<span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">'keyup'</span>, checkForClientKeystroke);

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">checkForClientKeystroke</span>(<span class="hljs-params">evt</span>) </span>{
  <span class="hljs-keyword">if</span> (evt.keyCode == <span class="hljs-number">27</span> &amp;&amp; <span class="hljs-built_in">window</span>.g_popup_manager) {
    g_popup_manager.destroypopDiv();
    <span class="hljs-keyword">return</span>;
  }
  <span class="hljs-keyword">if</span> (evt.shiftKey &amp;&amp; evt.ctrlKey &amp;&amp; evt.keyCode == <span class="hljs-number">74</span>) {
    <span class="hljs-keyword">var</span> gWindow = <span class="hljs-keyword">new</span> GlideDialogWindow(<span class="hljs-string">"client_js"</span>);
    gWindow.setTitle(<span class="hljs-string">"JavaScript Executor"</span>);
    gWindow.setPreference(<span class="hljs-string">'table'</span>, <span class="hljs-string">'javascript_executor'</span>);
    gWindow.render();
    Event.stop(evt);
    <span class="hljs-keyword">return</span>;
  }
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> parent.navVisible == <span class="hljs-string">"function"</span>) {
      <span class="hljs-keyword">if</span> (evt.ctrlKey &amp;&amp; evt.keyCode == <span class="hljs-number">190</span> &amp;&amp; !evt.shiftKey &amp;&amp; !evt.altKey) {
        Event.stop(evt);
        <span class="hljs-keyword">if</span> (parent.navVisible()) {
          parent.hideNav();
          parent.hide(<span class="hljs-string">"banner_top_left"</span>);
          parent.hide(<span class="hljs-string">"banner_top_right"</span>);
        } <span class="hljs-keyword">else</span> {
          parent.showNav();
          parent.show(<span class="hljs-string">"banner_top_left"</span>);
          parent.show(<span class="hljs-string">"banner_top_right"</span>);
        }
      }
    }
  } <span class="hljs-keyword">catch</span> (e) {}
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toggleHelp</span>(<span class="hljs-params">name</span>) </span>{
  <span class="hljs-keyword">var</span> wrapper = $(<span class="hljs-string">'help_'</span> + name + <span class="hljs-string">'_wrapper'</span>);
  <span class="hljs-keyword">var</span> image = $(<span class="hljs-string">'img.help_'</span> + name + <span class="hljs-string">'_wrapper'</span>);
  <span class="hljs-keyword">if</span> (wrapper.style.display == <span class="hljs-string">"block"</span>) {
    wrapper.style.display = <span class="hljs-string">"none"</span>;
    image.src = <span class="hljs-string">"images/filter_hide16.gifx"</span>;
  } <span class="hljs-keyword">else</span> {
    wrapper.style.display = <span class="hljs-string">"block"</span>;
    image.src = <span class="hljs-string">"images/filter_reveal16.gifx"</span>;
  }
  image.alt = getMessage(<span class="hljs-string">"Display / Hide"</span>);
  _frameChanged();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">validateHex</span>(<span class="hljs-params">field</span>) </span>{
  <span class="hljs-keyword">var</span> num = field.value;
  <span class="hljs-keyword">var</span> valid = isHex(num);
  <span class="hljs-keyword">if</span> (!valid) {
    <span class="hljs-keyword">var</span> sName = <span class="hljs-string">''</span>;
    <span class="hljs-keyword">if</span> (field.name != <span class="hljs-literal">null</span>)
      sName = <span class="hljs-string">' of '</span> + field.name + <span class="hljs-string">' '</span>;
    alert(<span class="hljs-string">"The entered value "</span> + sName + <span class="hljs-string">"is not hex.  Please correct."</span>);
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isHex</span>(<span class="hljs-params">num</span>) </span>{
  <span class="hljs-keyword">var</span> str = num.replace(<span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(<span class="hljs-string">'[0-9a-fA-F]'</span>, <span class="hljs-string">'g'</span>), <span class="hljs-string">''</span>);
  <span class="hljs-keyword">if</span> (str.length &gt; <span class="hljs-number">0</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setLightWeightLink</span>(<span class="hljs-params">name</span>) </span>{
  <span class="hljs-keyword">var</span> v = $(name);
  <span class="hljs-keyword">if</span> (!v)
    <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">var</span> link = $(name + <span class="hljs-string">"LINK"</span>);
  <span class="hljs-keyword">if</span> (!link)
    <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">var</span> vis = <span class="hljs-string">"hidden"</span>;
  <span class="hljs-keyword">if</span> (v.value != <span class="hljs-string">''</span>)
    vis = <span class="hljs-string">""</span>;
  link.style.visibility = vis;
  link.style.display = vis == <span class="hljs-string">'hidden'</span> ? <span class="hljs-string">'none'</span> : <span class="hljs-string">''</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toggleDebug</span>(<span class="hljs-params">id</span>) </span>{
  id = id.split(<span class="hljs-string">'.'</span>)[<span class="hljs-number">1</span>];
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1000</span>; i++) {
    <span class="hljs-keyword">var</span> widgetName = <span class="hljs-string">'debug.'</span> + id + <span class="hljs-string">'.'</span> + i;
    <span class="hljs-keyword">var</span> w = $(widgetName);
    <span class="hljs-keyword">if</span> (!w)
      <span class="hljs-keyword">return</span>;
    w.toggle();
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">enterSubmitsForm</span>(<span class="hljs-params">e, enter_submits_form</span>) </span>{
  <span class="hljs-keyword">if</span> (e.keyCode != <span class="hljs-number">13</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  <span class="hljs-keyword">if</span> (e.ctrlKey == <span class="hljs-literal">true</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  <span class="hljs-keyword">var</span> source = Event.element(e);
  <span class="hljs-keyword">if</span> (source.getAttribute(<span class="hljs-string">"data-type"</span>) &amp;&amp; e.keyCode == <span class="hljs-number">13</span> &amp;&amp; source.getAttribute(<span class="hljs-string">"data-type"</span>) == <span class="hljs-string">'ac_reference_input'</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  <span class="hljs-keyword">if</span> (source &amp;&amp; source.type == <span class="hljs-string">"textarea"</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  <span class="hljs-keyword">if</span> (source &amp;&amp; source.type == <span class="hljs-string">"submit"</span>) {
    <span class="hljs-keyword">if</span> (source.disabled == <span class="hljs-literal">false</span> &amp;&amp; source.onclick) {
      source.onclick();
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
  }
  <span class="hljs-keyword">if</span> (enter_submits_form == <span class="hljs-string">'false'</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  <span class="hljs-keyword">var</span> headerElements = $(<span class="hljs-built_in">document</span>.body).select(<span class="hljs-string">".header"</span>);
  <span class="hljs-keyword">var</span> eSize = headerElements.length;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; eSize; i++) {
    <span class="hljs-keyword">var</span> element = headerElements[i];
    <span class="hljs-keyword">if</span> (element.type == <span class="hljs-string">"submit"</span>) {
      <span class="hljs-keyword">if</span> (element.disabled == <span class="hljs-literal">false</span>) {
        source.blur();
        setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
          element.onclick();
        }, <span class="hljs-number">0</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
      }
    }
  }
  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">gsftPrompt</span>(<span class="hljs-params">title, question, onPromptComplete, onPromptCancel</span>) </span>{
  <span class="hljs-keyword">var</span> dialog = <span class="hljs-keyword">new</span> GlideDialogWindow(<span class="hljs-string">'glide_prompt'</span>, <span class="hljs-literal">false</span>);
  dialog.setTitle(title);
  dialog.setPreference(<span class="hljs-string">'title'</span>, question);
  dialog.setPreference(<span class="hljs-string">'onPromptComplete'</span>, onPromptComplete);
  dialog.setPreference(<span class="hljs-string">'onPromptCancel'</span>, onPromptCancel);
  dialog.render();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">gsftConfirm</span>(<span class="hljs-params">title, question, onPromptSave, onPromptCancel, onPromptDiscard</span>) </span>{
  <span class="hljs-keyword">var</span> width, dialogClass = GlideDialogWindow;
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.GlideModal) {
    dialogClass = GlideModal;
    width = <span class="hljs-number">400</span>;
  }
  <span class="hljs-keyword">var</span> dialog = <span class="hljs-keyword">new</span> dialogClass(<span class="hljs-string">'glide_confirm'</span>, <span class="hljs-literal">false</span>, width);
  dialog.setTitle(title);
  dialog.setPreference(<span class="hljs-string">'title'</span>, question);
  dialog.setPreference(<span class="hljs-string">'onPromptSave'</span>, onPromptSave);
  dialog.setPreference(<span class="hljs-string">'onPromptCancel'</span>, onPromptCancel);
  dialog.setPreference(<span class="hljs-string">'onPromptDiscard'</span>, onPromptDiscard);
  dialog.render();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">tsIndexCreatorPopup</span>(<span class="hljs-params">tableName</span>) </span>{
  <span class="hljs-keyword">var</span> gDialog = <span class="hljs-keyword">new</span> GlideDialogWindow(<span class="hljs-string">"dialog_text_index_creator"</span>);
  gDialog.setSize(<span class="hljs-number">400</span>, <span class="hljs-number">250</span>);
  gDialog.setPreference(<span class="hljs-string">"table_name"</span>, tableName);
  <span class="hljs-keyword">if</span> (tableName != <span class="hljs-string">""</span>)
    gDialog.setTitle(<span class="hljs-string">'Generate Text Index'</span>);
  <span class="hljs-keyword">else</span>
    gDialog.setTitle(<span class="hljs-string">'Regenerate All Text Indexes'</span>);
  gDialog.render();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isTextDirectionRTL</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> g_text_direction == <span class="hljs-string">'rtl'</span> ? <span class="hljs-literal">true</span> : <span class="hljs-literal">false</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">simpleRemoveOption</span>(<span class="hljs-params">sourceSelect</span>) </span>{
  <span class="hljs-keyword">var</span> sourceOptions = sourceSelect.options;
  <span class="hljs-keyword">var</span> selectedIds = [];
  <span class="hljs-keyword">var</span> index = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; sourceSelect.length; i++) {
    option = sourceOptions[i];
    <span class="hljs-keyword">if</span> (option.selected) {
      selectedIds[index] = i;
      index++;
    }
  }
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = selectedIds.length - <span class="hljs-number">1</span>; i &gt; <span class="hljs-number">-1</span>; i--)
    sourceSelect.remove(selectedIds[i]);
  sourceSelect.disabled = <span class="hljs-literal">true</span>;
  sourceSelect.disabled = <span class="hljs-literal">false</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">saveAllSelected</span>(<span class="hljs-params">fromSelectArray, toArray, delim, escape, emptyLabel, doEscape</span>) </span>{
  <span class="hljs-keyword">var</span> translatedEmptyLabel = getMessage(emptyLabel);
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; fromSelectArray.length; i++) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> fromSelectArray[i] == <span class="hljs-string">'undefined'</span>) {
      toArray[i].value = <span class="hljs-string">''</span>;
      <span class="hljs-keyword">continue</span>;
    }
    <span class="hljs-keyword">var</span> toValue = <span class="hljs-string">""</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> j = <span class="hljs-number">0</span>; j &lt; fromSelectArray[i].length; j++) {
      <span class="hljs-keyword">if</span> (!(fromSelectArray[i].length == <span class="hljs-number">1</span> &amp;&amp; fromSelectArray[i].options[<span class="hljs-number">0</span>].value == translatedEmptyLabel)) {
        <span class="hljs-keyword">var</span> val = fromSelectArray[i].options[j].value;
        <span class="hljs-keyword">if</span> (doEscape)
          val = <span class="hljs-built_in">encodeURIComponent</span>(val);
        toValue += val.replace(<span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(delim, <span class="hljs-string">"g"</span>), <span class="hljs-built_in">escape</span> + delim);
      }
      <span class="hljs-keyword">if</span> (j + <span class="hljs-number">1</span> &lt; fromSelectArray[i].length)
        toValue += delim;
    }
    toArray[i].value = toValue;
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sortSelect</span>(<span class="hljs-params">obj</span>) </span>{
  <span class="hljs-keyword">var</span> maxSort = obj.getAttribute(<span class="hljs-string">"max_sort"</span>);
  <span class="hljs-keyword">if</span> (!maxSort || maxSort == <span class="hljs-number">0</span>)
    maxSort = <span class="hljs-number">500</span>;
  <span class="hljs-keyword">if</span> (obj.length &gt; maxSort &amp;&amp; isMSIE &amp;&amp; !isMSIE9) {
    <span class="hljs-keyword">return</span>;
  }
  <span class="hljs-keyword">if</span> (!sortSupported(obj)) {
    <span class="hljs-keyword">return</span>;
  }
  <span class="hljs-keyword">if</span> (!hasOptions(obj)) {
    <span class="hljs-keyword">return</span>;
  }
  <span class="hljs-keyword">var</span> o = [];
  <span class="hljs-keyword">var</span> o2 = [];
  <span class="hljs-keyword">var</span> o3 = [];
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; obj.options.length; i++) {
    <span class="hljs-keyword">var</span> newOption = <span class="hljs-keyword">new</span> Option(obj.options[i].text, obj.options[i].value, obj.options[i].defaultSelected, obj.options[i].selected);
    copyAttributes(obj.options[i], newOption);
    <span class="hljs-keyword">if</span> (newOption.value.indexOf(<span class="hljs-string">'split'</span>) &gt; <span class="hljs-number">0</span>)
      o2[o2.length] = newOption;
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (newOption.value &amp;&amp; newOption.value.substr(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>) !== <span class="hljs-string">"u_"</span> &amp;&amp; (newOption.value.indexOf(<span class="hljs-string">'formatter'</span>) &gt; <span class="hljs-number">0</span> || newOption.value.indexOf(<span class="hljs-string">'component'</span>) &gt; <span class="hljs-number">0</span> ||
        newOption.value.indexOf(<span class="hljs-string">'annotation'</span>) &gt; <span class="hljs-number">0</span> || newOption.value.indexOf(<span class="hljs-string">'chart'</span>) &gt; <span class="hljs-number">0</span>))
      o3[o3.length] = newOption;
    <span class="hljs-keyword">else</span>
      o[o.length] = newOption;
  }
  <span class="hljs-keyword">if</span> (o.length == <span class="hljs-number">0</span>)
    <span class="hljs-keyword">return</span>;
  o = o.sort(
    <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a, b</span>) </span>{
      <span class="hljs-keyword">if</span> ((a.text.toLowerCase() + <span class="hljs-string">""</span>) &lt; (b.text.toLowerCase() + <span class="hljs-string">""</span>)) {
        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;
      }
      <span class="hljs-keyword">if</span> ((a.text.toLowerCase() + <span class="hljs-string">""</span>) &gt; (b.text.toLowerCase() + <span class="hljs-string">""</span>)) {
        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
      }
      <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
    }
  );
  o3 = o3.sort(
    <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a, b</span>) </span>{
      <span class="hljs-keyword">if</span> ((a.text.toLowerCase() + <span class="hljs-string">""</span>) &lt; (b.text.toLowerCase() + <span class="hljs-string">""</span>)) {
        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;
      }
      <span class="hljs-keyword">if</span> ((a.text.toLowerCase() + <span class="hljs-string">""</span>) &gt; (b.text.toLowerCase() + <span class="hljs-string">""</span>)) {
        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
      }
      <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
    }
  );
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; o.length; i++) {
    <span class="hljs-keyword">var</span> newOption = <span class="hljs-keyword">new</span> Option(o[i].text, o[i].value, o[i].defaultSelected, o[i].selected);
    copyAttributes(o[i], newOption);
    obj.options[i] = newOption;
  }
  <span class="hljs-keyword">var</span> counter = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = o.length; i &lt; (o.length + o2.length); i++) {
    <span class="hljs-keyword">var</span> newOption = <span class="hljs-keyword">new</span> Option(o2[counter].text, o2[counter].value, o2[counter].defaultSelected, o2[counter].selected);
    copyAttributes(o2[counter], newOption);
    obj.options[i] = newOption;
    counter++;
  }
  <span class="hljs-keyword">var</span> counter = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = (o.length + o2.length); i &lt; (o.length + o2.length + o3.length); i++) {
    <span class="hljs-keyword">var</span> newOption = <span class="hljs-keyword">new</span> Option(o3[counter].text, o3[counter].value, o3[counter].defaultSelected, o3[counter].selected);
    copyAttributes(o3[counter], newOption);
    obj.options[i] = newOption;
    counter++;
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">copyAttributes</span>(<span class="hljs-params">from, to</span>) </span>{
  <span class="hljs-keyword">var</span> attributes = <span class="hljs-keyword">from</span>.attributes;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> n = <span class="hljs-number">0</span>; n &lt; attributes.length; n++) {
    <span class="hljs-keyword">var</span> attr = attributes[n];
    <span class="hljs-keyword">var</span> aname = attr.nodeName;
    <span class="hljs-keyword">var</span> avalue = attr.nodeValue;
    to.setAttribute(aname, avalue);
  }
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">from</span>.style.cssText)
    to.style.cssText = <span class="hljs-keyword">from</span>.style.cssText;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hasOptions</span>(<span class="hljs-params">obj</span>) </span>{
  <span class="hljs-keyword">if</span> (obj != <span class="hljs-literal">null</span> &amp;&amp; obj.options != <span class="hljs-literal">null</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sortSupported</span>(<span class="hljs-params">obj</span>) </span>{
  <span class="hljs-keyword">if</span> (obj == <span class="hljs-literal">null</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  <span class="hljs-keyword">var</span> noSort = obj.no_sort || obj.getAttribute(<span class="hljs-string">'no_sort'</span>);
  <span class="hljs-keyword">if</span> (noSort) {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  }
  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
};
<span class="hljs-comment">/*! RESOURCE: /scripts/scoped_object_generators.js */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ScopedGlideAjaxGenerator</span>(<span class="hljs-params">scope</span>) </span>{
  <span class="hljs-keyword">var</span> ScopedGlideAjax = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    ScopedGlideAjax.prototype.initialize.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
  };
  ScopedGlideAjax.prototype = classExtendForScope({}, <span class="hljs-built_in">window</span>.GlideAjax.prototype, {
    <span class="hljs-attr">scope</span>: scope,
    <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">endpoint, url</span>) </span>{
      GlideAjax.prototype.initialize.call(<span class="hljs-keyword">this</span>, endpoint, url);
      <span class="hljs-keyword">this</span>.setScope(<span class="hljs-keyword">this</span>.scope);
    },
    <span class="hljs-attr">getXMLWait</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> err_options = {
        <span class="hljs-attr">text</span>: <span class="hljs-string">"Access to getXMLWait is not available in scoped applications."</span>,
        <span class="hljs-attr">type</span>: <span class="hljs-string">"system"</span>,
        <span class="hljs-attr">attributes</span>: {
          <span class="hljs-attr">type</span>: <span class="hljs-string">"error"</span>
        }
      };
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> GlideUI != <span class="hljs-string">'undefined'</span>)
        GlideUI.get().fire(<span class="hljs-keyword">new</span> GlideUINotification(err_options));
    },
    <span class="hljs-attr">setScope</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">newScope</span>) </span>{
      <span class="hljs-keyword">if</span> (newScope != <span class="hljs-keyword">this</span>.scope &amp;&amp; newScope !== <span class="hljs-string">"global"</span>) {
        <span class="hljs-keyword">var</span> err_options = {
          <span class="hljs-attr">text</span>: <span class="hljs-string">"Scoped applications cannot impersonate other scopes."</span>,
          <span class="hljs-attr">type</span>: <span class="hljs-string">"system"</span>,
          <span class="hljs-attr">attributes</span>: {
            <span class="hljs-attr">type</span>: <span class="hljs-string">"error"</span>
          }
        };
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> GlideUI != <span class="hljs-string">'undefined'</span>)
          GlideUI.get().fire(<span class="hljs-keyword">new</span> GlideUINotification(err_options));
        <span class="hljs-keyword">return</span>;
      }
      <span class="hljs-keyword">return</span> GlideAjax.prototype.setScope.call(<span class="hljs-keyword">this</span>, scope);
    },
    <span class="hljs-attr">addParam</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">param, value</span>) </span>{
      <span class="hljs-keyword">if</span> (param == <span class="hljs-string">"sysparm_scope"</span> &amp;&amp; value != <span class="hljs-keyword">this</span>.scope &amp;&amp; value != <span class="hljs-string">"global"</span>) {
        <span class="hljs-keyword">var</span> err_options = {
          <span class="hljs-attr">text</span>: <span class="hljs-string">"Scoped applications cannot impersonate other scopes."</span>,
          <span class="hljs-attr">type</span>: <span class="hljs-string">"system"</span>,
          <span class="hljs-attr">attributes</span>: {
            <span class="hljs-attr">type</span>: <span class="hljs-string">"error"</span>
          }
        };
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> GlideUI != <span class="hljs-string">'undefined'</span>)
          GlideUI.get().fire(<span class="hljs-keyword">new</span> GlideUINotification(err_options));
        <span class="hljs-keyword">return</span>;
      }
      <span class="hljs-keyword">return</span> <span class="hljs-built_in">window</span>.GlideAjax.prototype.addParam.call(<span class="hljs-keyword">this</span>, param, value);
    }
  })
  <span class="hljs-keyword">return</span> ScopedGlideAjax;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ScopedGFormGenerator</span>(<span class="hljs-params">scope</span>) </span>{
  <span class="hljs-keyword">var</span> ScopedGForm = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{};
  <span class="hljs-keyword">if</span> (<span class="hljs-string">"undefined"</span> == <span class="hljs-keyword">typeof</span> g_form) {
    <span class="hljs-keyword">return</span> ScopedGForm;
  }
  ScopedGForm.prototype = g_form;
  <span class="hljs-keyword">var</span> scoped_g_form = <span class="hljs-keyword">new</span> ScopedGForm();

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">inScope</span>(<span class="hljs-params">fieldName</span>) </span>{
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">if</span> (scope == g_form.getGlideUIElement(fieldName).getScope())
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
      <span class="hljs-keyword">if</span> (g_form.getGlideUIElement(fieldName).isInherited &amp;&amp; (scope == g_form.getScope()))
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    } <span class="hljs-keyword">catch</span> (e) {
      jslog(e);
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_noCallbackError</span>(<span class="hljs-params">displayName, fieldName</span>) </span>{
    <span class="hljs-keyword">var</span> text = displayName + <span class="hljs-string">" for "</span> + fieldName + <span class="hljs-string">" not allowed: missing callback function as parameter"</span>;
    <span class="hljs-keyword">var</span> err_options = {
      <span class="hljs-attr">text</span>: text,
      <span class="hljs-attr">type</span>: <span class="hljs-string">"system"</span>,
      <span class="hljs-attr">attributes</span>: {
        <span class="hljs-attr">type</span>: <span class="hljs-string">"error"</span>
      }
    }
    jslog(text);
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> GlideUI != <span class="hljs-string">'undefined'</span>)
      GlideUI.get().fire(<span class="hljs-keyword">new</span> GlideUINotification(err_options));
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_showScopeError</span>(<span class="hljs-params">displayName, fieldName, value</span>) </span>{
    <span class="hljs-keyword">var</span> text = displayName + <span class="hljs-string">" "</span> + value + <span class="hljs-string">" not set on field "</span> + fieldName + <span class="hljs-string">": cross-scope access denied."</span>;
    <span class="hljs-keyword">var</span> err_options = {
      <span class="hljs-attr">text</span>: text,
      <span class="hljs-attr">type</span>: <span class="hljs-string">"system"</span>,
      <span class="hljs-attr">attributes</span>: {
        <span class="hljs-attr">type</span>: <span class="hljs-string">"error"</span>
      }
    }
    opticsLog(scoped_g_form.getTableName(), fieldName, text);
    jslog(text);
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> GlideUI != <span class="hljs-string">'undefined'</span>)
      GlideUI.get().fire(<span class="hljs-keyword">new</span> GlideUINotification(err_options));
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">validField</span>(<span class="hljs-params">fieldName</span>) </span>{
    fieldName = g_form.removeCurrentPrefix(fieldName);
    <span class="hljs-keyword">return</span> g_form.hasField(fieldName) || g_form.getPrefixHandler(fieldName);
  }
  scoped_g_form.setReadOnly = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName, disabled</span>) </span>{
    <span class="hljs-keyword">if</span> (!validField(fieldName))
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">if</span> (inScope(fieldName))
      <span class="hljs-keyword">return</span> g_form.setReadOnly(fieldName, disabled);
    _showScopeError(<span class="hljs-string">"ReadOnly"</span>, fieldName, disabled);
  }
  scoped_g_form.setReadonly = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName, disabled</span>) </span>{
    <span class="hljs-keyword">if</span> (!validField(fieldName))
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">if</span> (inScope(fieldName))
      <span class="hljs-keyword">return</span> g_form.setReadonly(fieldName, disabled);
    _showScopeError(<span class="hljs-string">"ReadOnly"</span>, fieldName, disabled);
  }
  scoped_g_form.setMandatory = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName, mandatory</span>) </span>{
    <span class="hljs-keyword">if</span> (!validField(fieldName))
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">if</span> (inScope(fieldName))
      <span class="hljs-keyword">return</span> g_form.setMandatory(fieldName, mandatory);
    _showScopeError(<span class="hljs-string">"Mandatory"</span>, fieldName, mandatory);
  }
  scoped_g_form.setDisplay = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName, display</span>) </span>{
    <span class="hljs-keyword">if</span> (!validField(fieldName))
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">if</span> (inScope(fieldName))
      <span class="hljs-keyword">return</span> g_form.setDisplay(fieldName, display);
    _showScopeError(<span class="hljs-string">"Display"</span>, fieldName, display);
  }
  scoped_g_form.setDisabled = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName, disabled</span>) </span>{
    <span class="hljs-keyword">if</span> (!validField(fieldName))
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">if</span> (inScope(fieldName))
      <span class="hljs-keyword">return</span> g_form.setDisabled(fieldName, disabled);
    _showScopeError(<span class="hljs-string">"Disabled"</span>, fieldName, disabled);
  }
  scoped_g_form.getReference = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName, callBack</span>) </span>{
    <span class="hljs-keyword">if</span> (!validField(fieldName))
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-string">'function'</span> == <span class="hljs-keyword">typeof</span> callBack)
      <span class="hljs-keyword">return</span> g_form.getReference(fieldName, callBack);
    _noCallbackError(<span class="hljs-string">"getReference"</span>, fieldName, <span class="hljs-literal">false</span>);
  }
  <span class="hljs-keyword">return</span> scoped_g_form;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ScopedGlideDialogWindowGenerator</span>(<span class="hljs-params">scope</span>) </span>{
  <span class="hljs-keyword">var</span> extendFrom = <span class="hljs-built_in">window</span>.GlideDialogWindow ? GlideDialogWindow.prototype : GlideModal.prototype;
  <span class="hljs-keyword">var</span> ScopedGlideDialogWindow = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    ScopedGlideDialogWindow.prototype.initialize.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
  };
  ScopedGlideDialogWindow.prototype = classExtendForScope({}, extendFrom, {
    <span class="hljs-attr">scope</span>: scope,
    <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">id, readOnly, width, height</span>) </span>{
      extendFrom.initialize.call(<span class="hljs-keyword">this</span>, id, readOnly, width, height);
      <span class="hljs-keyword">this</span>.setScope(<span class="hljs-keyword">this</span>.scope);
    }
  });
  <span class="hljs-keyword">return</span> ScopedGlideDialogWindow;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">classExtendForScope</span>(<span class="hljs-params">extended, defaults, options</span>) </span>{
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.jQuery)
    <span class="hljs-keyword">return</span> jQuery.extend(extended, defaults, options);
  <span class="hljs-keyword">var</span> prop;
  <span class="hljs-keyword">for</span> (prop <span class="hljs-keyword">in</span> defaults) {
    extended[prop] = defaults[prop];
  }
  <span class="hljs-keyword">for</span> (prop <span class="hljs-keyword">in</span> options) {
    extended[prop] = options[prop];
  }
  <span class="hljs-keyword">return</span> extended;
};;
<span class="hljs-comment">/*! RESOURCE: /scripts/functions_reference.js */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">updateAndFlip</span>(<span class="hljs-params">select, elementName</span>) </span>{
  <span class="hljs-keyword">var</span> option = setSelectValue(select, elementName);
  onChange(elementName);
  refFlipImage(option, elementName);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setSelectValue</span>(<span class="hljs-params">select, elementName</span>) </span>{
  <span class="hljs-keyword">var</span> value = <span class="hljs-string">''</span>;
  <span class="hljs-keyword">var</span> text = <span class="hljs-string">''</span>;
  <span class="hljs-keyword">var</span> option;
  <span class="hljs-keyword">if</span> (select.selectedIndex != <span class="hljs-number">-1</span>) {
    option = select.options[select.selectedIndex];
    value = option.value;
    text = option.text;
  }
  <span class="hljs-keyword">var</span> id = gel(elementName);
  id.value = value;
  <span class="hljs-keyword">var</span> idd = gel(<span class="hljs-string">'sys_display.'</span> + elementName);
  <span class="hljs-keyword">if</span> (value == <span class="hljs-string">''</span>)
    idd.value = <span class="hljs-string">''</span>;
  <span class="hljs-keyword">else</span>
    idd.value = text;
  <span class="hljs-keyword">return</span> option;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">refFlipImage</span>(<span class="hljs-params">element, elementName, useText</span>) </span>{
  <span class="hljs-keyword">var</span> viewField = gel(<span class="hljs-string">"view."</span> + elementName);
  <span class="hljs-keyword">if</span> (!viewField)
    <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">var</span> viewRField = gel(<span class="hljs-string">"viewr."</span> + elementName);
  <span class="hljs-keyword">var</span> viewHideField = gel(<span class="hljs-string">"view."</span> + elementName + <span class="hljs-string">".no"</span>);
  <span class="hljs-keyword">var</span> refid = gel(elementName);
  <span class="hljs-keyword">var</span> value = element.value;
  <span class="hljs-keyword">if</span> (!value) {
    hideObject(viewField);
    hideObject(viewRField);
    showObjectInline(viewHideField);
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">if</span> (isDoctype()) {
      showObjectInlineBlock(viewField);
      showObjectInlineBlock(viewRField);
    } <span class="hljs-keyword">else</span> {
      showObjectInline(viewField);
      showObjectInline(viewRField);
    }
    hideObject(viewHideField);
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">refFlipImageDisplay</span>(<span class="hljs-params">element, dsp</span>) </span>{
  <span class="hljs-keyword">if</span> (element)
    element.style.display = dsp;
};
<span class="hljs-comment">/*! RESOURCE: /scripts/functions_onchange.js */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onChange</span>(<span class="hljs-params">elementName</span>) </span>{
  <span class="hljs-keyword">var</span> eChanged = gel(elementName);
  <span class="hljs-keyword">var</span> eOriginal = gel(<span class="hljs-string">"sys_original."</span> + elementName);
  <span class="hljs-keyword">var</span> eDisplay = gel(<span class="hljs-string">"sys_display."</span> + elementName);
  <span class="hljs-keyword">if</span> (eOriginal == <span class="hljs-literal">null</span>) {
    <span class="hljs-keyword">return</span>;
  }
  <span class="hljs-keyword">var</span> vOriginal = eOriginal.value;
  <span class="hljs-keyword">var</span> vChanged = eChanged.value;
  <span class="hljs-keyword">var</span> vDisplay = eDisplay ? eDisplay.value : <span class="hljs-literal">null</span>;
  eChanged.changed = (vOriginal != vChanged);
  <span class="hljs-keyword">if</span> (!elementName.startsWith(<span class="hljs-string">"IO:"</span>) &amp;&amp; !elementName.startsWith(<span class="hljs-string">"ni.VE"</span>)) {
    onChangeLabelProcess(elementName);
  }
  setMandatoryExplained();
  <span class="hljs-keyword">if</span> (hasDepends != <span class="hljs-literal">null</span> &amp;&amp; hasDepends(elementName))
    onSelChange(elementName);
  clientScriptOnChange(elementName, eChanged, vOriginal, vChanged);
  fieldChanged(elementName, eChanged.changed);
  <span class="hljs-keyword">var</span> onChangeData = {
    <span class="hljs-attr">id</span>: elementName,
    <span class="hljs-attr">value</span>: vChanged,
    <span class="hljs-attr">modified</span>: eChanged.changed
  };
  <span class="hljs-keyword">if</span> (vDisplay)
    onChangeData.displayValue = vDisplay;
  <span class="hljs-keyword">var</span> parentForm = $(elementName).up(<span class="hljs-string">'form'</span>);
  parentForm &amp;&amp; parentForm.fire(<span class="hljs-string">'glideform:onchange'</span>, onChangeData);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onChangeLabelProcess</span>(<span class="hljs-params">elementName, value</span>) </span>{
  <span class="hljs-keyword">var</span> el = gel(elementName);
  <span class="hljs-keyword">var</span> statusNode = gel(<span class="hljs-string">'status.'</span> + elementName);
  onChangeLabelProcessByEl(el, statusNode, value);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onChangeLabelProcessByEl</span>(<span class="hljs-params">elementNode, statusLabel, value</span>) </span>{
  <span class="hljs-keyword">if</span> (!elementNode || !statusLabel)
    <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">var</span> mandatory = elementNode.getAttribute(<span class="hljs-string">"mandatory"</span>) + <span class="hljs-string">""</span>;
  <span class="hljs-keyword">var</span> readonly = elementNode.disabled || hasClassName(elementNode, <span class="hljs-string">'disabled'</span>);
  <span class="hljs-keyword">if</span> (mandatory == <span class="hljs-literal">null</span> || mandatory == <span class="hljs-string">"null"</span>)
    mandatory = statusLabel.getAttribute(<span class="hljs-string">"mandatory"</span>) + <span class="hljs-string">""</span>;
  <span class="hljs-keyword">else</span>
    statusLabel.setAttribute(<span class="hljs-string">"mandatory"</span>, mandatory);
  <span class="hljs-keyword">var</span> newClassName = statusLabel.getAttribute(<span class="hljs-string">"oclass"</span>);
  <span class="hljs-keyword">var</span> newFieldClassName = <span class="hljs-string">""</span>;
  <span class="hljs-keyword">var</span> newTitle = statusLabel.getAttribute(<span class="hljs-string">"title"</span>);
  <span class="hljs-keyword">if</span> (value == <span class="hljs-literal">undefined</span>)
    value = elementNode.value;
  <span class="hljs-keyword">if</span> (mandatory == <span class="hljs-string">"true"</span>) {
    <span class="hljs-keyword">var</span> currencySuffix = <span class="hljs-string">";0.00"</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> value != <span class="hljs-string">'undefined'</span> &amp;&amp; (value == <span class="hljs-string">""</span> || value.indexOf(currencySuffix, value.length - currencySuffix.length) != <span class="hljs-number">-1</span>)) {
      newClassName = <span class="hljs-string">"mandatory"</span>;
      newFieldClassName = <span class="hljs-string">"is-required"</span>;
      newTitle = getMessage(<span class="hljs-string">"Mandatory - must be populated before Submit"</span>);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (elementNode.changed) {
      newClassName = <span class="hljs-string">"changed"</span>;
      newFieldClassName = <span class="hljs-string">"is-filled"</span>;
      newTitle = getMessage(<span class="hljs-string">"Field value has changed since last update"</span>);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!readonly) {
      newClassName = <span class="hljs-string">"mandatory_populated"</span>;
      newFieldClassName = <span class="hljs-string">"is-prefilled"</span>;
      newTitle = getMessage(<span class="hljs-string">"Mandatory - preloaded with saved data"</span>);
    } <span class="hljs-keyword">else</span> {
      newClassName = <span class="hljs-string">"read_only"</span>;
      newTitle = getMessage(<span class="hljs-string">"Read only - cannot be modified"</span>);
    }
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">if</span> (elementNode.changed) {
      newClassName = <span class="hljs-string">"changed"</span>;
      newTitle = getMessage(<span class="hljs-string">"Field value has changed since last update"</span>);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (readonly) {
      newClassName = <span class="hljs-string">"read_only"</span>;
      <span class="hljs-keyword">if</span> (newTitle == <span class="hljs-string">""</span> || newTitle == <span class="hljs-literal">null</span>)
        newTitle = <span class="hljs-string">"Read only - cannot be modified"</span>;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (newClassName != <span class="hljs-string">"read_only"</span> &amp;&amp; newClassName != <span class="hljs-string">"changed"</span>) {
      newClassName = <span class="hljs-string">""</span>;
      newTitle = <span class="hljs-string">""</span>;
    }
  }
  <span class="hljs-keyword">var</span> slm = gel(<span class="hljs-string">"section508."</span> + elementNode.id);
  <span class="hljs-keyword">if</span> (slm) {
    slm.setAttribute(<span class="hljs-string">"title"</span>, statusLabel.getAttribute(<span class="hljs-string">"title"</span>));
    slm.setAttribute(<span class="hljs-string">"alt"</span>, statusLabel.getAttribute(<span class="hljs-string">"title"</span>));
  }
  newClassName += <span class="hljs-string">' label_description'</span>;
  <span class="hljs-keyword">if</span> (statusLabel.className == newClassName)
    <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">var</span> parentElement = gel(<span class="hljs-string">"element."</span> + elementNode.id);
  <span class="hljs-keyword">if</span> (statusLabel.className.indexOf(<span class="hljs-string">"required-marker"</span>) &gt; <span class="hljs-number">-1</span>)
    <span class="hljs-keyword">var</span> previousMandatory = <span class="hljs-literal">true</span>;
  statusLabel.className = newClassName;
  <span class="hljs-keyword">if</span> (previousMandatory &amp;&amp; statusLabel.className.indexOf(<span class="hljs-string">"required-marker"</span>) == <span class="hljs-number">-1</span> &amp;&amp; parentElement &amp;&amp; parentElement.className.indexOf(<span class="hljs-string">"is-required"</span>) &gt; <span class="hljs-number">-1</span>)
    gel(<span class="hljs-string">"element."</span> + elementNode.id).className = parentElement.className.replace(<span class="hljs-string">"is-required"</span>, <span class="hljs-string">""</span>);
  statusLabel.setAttribute(<span class="hljs-string">"title"</span>, newTitle);
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">document</span>.documentElement.getAttribute(<span class="hljs-string">'data-doctype'</span>) == <span class="hljs-string">'true'</span>) {
    <span class="hljs-keyword">if</span> (mandatory == <span class="hljs-string">'true'</span>) {
      statusLabel.className = <span class="hljs-string">"required-marker label_description"</span>;
    }
    <span class="hljs-keyword">if</span> (newFieldClassName) {
      <span class="hljs-keyword">var</span> formGroup = elementNode.up(<span class="hljs-string">'.form-group'</span>);
      formGroup.removeClassName(<span class="hljs-string">'is-prefilled'</span>);
      formGroup.removeClassName(<span class="hljs-string">'is-required'</span>);
      formGroup.removeClassName(<span class="hljs-string">'is-filled'</span>);
      formGroup.addClassName(newFieldClassName);
    }
    statusLabel.setAttribute(<span class="hljs-string">'aria-label'</span>, newTitle);
  }
  CustomEvent.fire(<span class="hljs-string">"mandatory.changed"</span>, elementNode.id, newClassName);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">clientScriptOnChange</span>(<span class="hljs-params">elementName, eChanged, vOriginal, vChanged</span>) </span>{
  <span class="hljs-keyword">var</span> splitMe = elementName.split(<span class="hljs-string">'.'</span>);
  <span class="hljs-keyword">var</span> tableName = splitMe[<span class="hljs-number">0</span>];
  <span class="hljs-keyword">var</span> fieldName = splitMe.slice(<span class="hljs-number">1</span>).join(<span class="hljs-string">'.'</span>);
  callChangeHandlers(tableName, fieldName, eChanged, vOriginal, vChanged);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">callChangeHandlers</span>(<span class="hljs-params">tableName, fieldName, eChanged, vOriginal, vChanged</span>) </span>{
  <span class="hljs-keyword">var</span> widgetName = tableName + <span class="hljs-string">"."</span> + fieldName;
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span>(g_form) != <span class="hljs-string">"undefined"</span>)
    g_form.hideFieldMsg(fieldName, <span class="hljs-literal">true</span>);
  template = <span class="hljs-literal">false</span>;
  <span class="hljs-keyword">if</span> (eChanged.templateValue == <span class="hljs-string">'true'</span>)
    template = <span class="hljs-literal">true</span>;
  eChanged.templateValue = <span class="hljs-string">'false'</span>;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; g_event_handlers.length; i++) {
    <span class="hljs-keyword">var</span> handler = g_event_handlers[i];
    <span class="hljs-keyword">if</span> (handler.fieldName != widgetName &amp;&amp; handler.fieldName != fieldName)
      <span class="hljs-keyword">continue</span>;
    callChangeHandler(handler, <span class="hljs-keyword">this</span>, eChanged, vOriginal, vChanged, <span class="hljs-literal">false</span>, template);
  }
  CustomEvent.fire(<span class="hljs-string">"change.handlers.run"</span>, tableName, fieldName);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fireAllChangeHandlers</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> x = <span class="hljs-number">0</span>; x &lt; g_event_handlers.length; x++) {
    <span class="hljs-keyword">var</span> handler = g_event_handlers[x];
    <span class="hljs-keyword">var</span> elementName = handler.fieldName;
    <span class="hljs-keyword">var</span> theWidget = gel(elementName);
    <span class="hljs-keyword">if</span> (!theWidget)
      <span class="hljs-keyword">continue</span>;
    <span class="hljs-keyword">var</span> original = gel(<span class="hljs-string">"sys_original."</span> + elementName);
    <span class="hljs-keyword">var</span> oldVal = <span class="hljs-string">'unknown'</span>;
    <span class="hljs-keyword">if</span> (original)
      oldVal = original.value;
    <span class="hljs-keyword">var</span> newVal;
    <span class="hljs-keyword">if</span> ($(theWidget).getAttribute(<span class="hljs-string">"type"</span>) == <span class="hljs-string">"radio"</span>) {
      newVal = oldVal;
      <span class="hljs-keyword">var</span> elems = $$(<span class="hljs-string">'#'</span> + $(theWidget).getAttribute(<span class="hljs-string">"id"</span>)).each(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">el</span>) </span>{
        <span class="hljs-keyword">var</span> checkedValue = el.getAttribute(<span class="hljs-string">"checked"</span>);
        <span class="hljs-keyword">if</span> (checkedValue != <span class="hljs-literal">null</span> &amp;&amp; checkedValue.length &gt; <span class="hljs-number">0</span>)
          newVal = el.value;
      });
    } <span class="hljs-keyword">else</span>
      newVal = theWidget.value;
    callChangeHandler(handler, <span class="hljs-keyword">this</span>, theWidget, oldVal, newVal, <span class="hljs-literal">true</span>, <span class="hljs-literal">false</span>);
  }
  CustomEvent.fire(<span class="hljs-string">"change.handlers.run.all"</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">callChangeHandler</span>(<span class="hljs-params">handler, control, theWidget, oldVal, newVal, loading, template</span>) </span>{
  <span class="hljs-keyword">try</span> {
    callChangeHandler0(handler, control, theWidget, oldVal, newVal, loading, template);
  } <span class="hljs-keyword">catch</span> (ex) {
    <span class="hljs-keyword">if</span> (g_user.hasRole(<span class="hljs-string">'client_script_admin'</span>)) {
      g_form.showFieldMsg(theWidget, <span class="hljs-string">"onChange script error: "</span> + ex.toString() + <span class="hljs-string">"\n"</span> +
        handler.handler.toString(), <span class="hljs-string">"error"</span>, <span class="hljs-literal">false</span>);
    } <span class="hljs-keyword">else</span> {
      g_form.showFieldMsg(theWidget,
        <span class="hljs-string">"Script error encountered when changing this field - please contact your System Administrator"</span>,
        <span class="hljs-string">"error"</span>, <span class="hljs-literal">false</span>);
    }
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">callChangeHandler0</span>(<span class="hljs-params">handler, control, theWidget, oldVal, newVal, loading, template</span>) </span>{
  CustomEvent.fire(<span class="hljs-string">'glide_optics_inspect_put_cs_context'</span>, handler.handlerName, <span class="hljs-string">'change'</span>);
  <span class="hljs-keyword">var</span> startTimer = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>();
  handler.handler.call(control, theWidget, oldVal, newVal, loading, template);
  <span class="hljs-keyword">var</span> n = g_event_handlers_onChange[handler.handlerName];
  <span class="hljs-keyword">if</span> (n)
    CustomEvent.fire(<span class="hljs-string">'page_timing'</span>, {
      <span class="hljs-attr">name</span>: <span class="hljs-string">'CSOC'</span>,
      <span class="hljs-attr">child</span>: {
        <span class="hljs-attr">description</span>: n,
        <span class="hljs-attr">sys_id</span>: g_event_handler_ids[handler.handlerName],
        <span class="hljs-attr">source_table</span>: <span class="hljs-string">'sys_script_client'</span>
      },
      <span class="hljs-attr">startTime</span>: startTimer,
      <span class="hljs-attr">win</span>: <span class="hljs-built_in">window</span>
    });
  CustomEvent.fire(<span class="hljs-string">'glide_optics_inspect_pop_cs_context'</span>, handler.handlerName, <span class="hljs-string">'change'</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">multiKeyDown</span>(<span class="hljs-params">me</span>) </span>{
  <span class="hljs-keyword">if</span> ($(me.id).getAttribute(<span class="hljs-string">"isquestionhtml"</span>) == <span class="hljs-string">"true"</span>)
    <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">var</span> eOriginal = <span class="hljs-string">'g_'</span> + me.id.replace(<span class="hljs-regexp">/\./g</span>, <span class="hljs-string">'_'</span>);
  <span class="hljs-keyword">var</span> eOriginalSet = <span class="hljs-built_in">eval</span>(<span class="hljs-string">"typeof "</span> + eOriginal + <span class="hljs-string">" != 'undefined'"</span>);
  <span class="hljs-keyword">if</span> (eOriginalSet)
    <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">var</span> oValue = <span class="hljs-built_in">escape</span>(me.value);
  <span class="hljs-built_in">eval</span>(eOriginal + <span class="hljs-string">'="'</span> + oValue + <span class="hljs-string">'";'</span>);
  <span class="hljs-keyword">var</span> form = findParentByTag(me, <span class="hljs-string">"form"</span>);
  <span class="hljs-keyword">if</span> (me.id &amp;&amp; form) {
    <span class="hljs-keyword">var</span> elementName = me.id;
    <span class="hljs-keyword">if</span> (gel(<span class="hljs-string">"sys_original."</span> + elementName)) {
      gel(<span class="hljs-string">"sys_original."</span> + elementName).value = <span class="hljs-string">"XXmultiChangeXX"</span>
    } <span class="hljs-keyword">else</span> {
      addInput(form, <span class="hljs-string">'hidden'</span>, <span class="hljs-string">"sys_original."</span> + elementName, <span class="hljs-string">"XXmultiChangeXX"</span>);
    }
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">multiModified</span>(<span class="hljs-params">me, type, currentValue</span>) </span>{
  <span class="hljs-keyword">if</span> ($(me.id).getAttribute(<span class="hljs-string">"isquestionhtml"</span>) == <span class="hljs-string">"true"</span>) {
    $(me.id).onchange();
    <span class="hljs-keyword">return</span>;
  }
  multiKeyDown(me);
  <span class="hljs-keyword">var</span> form = findParentByTag(me, <span class="hljs-string">"form"</span>);
  <span class="hljs-keyword">var</span> changeFlag = <span class="hljs-literal">true</span>;
  <span class="hljs-keyword">if</span> (me.id &amp;&amp; form) {
    <span class="hljs-keyword">var</span> elementName = me.id;
    <span class="hljs-keyword">var</span> vOriginal = <span class="hljs-built_in">unescape</span>(<span class="hljs-built_in">eval</span>(<span class="hljs-string">'g_'</span> + me.id.replace(<span class="hljs-regexp">/\./g</span>, <span class="hljs-string">'_'</span>)));
    <span class="hljs-keyword">if</span> (currentValue == <span class="hljs-literal">undefined</span>)
      currentValue = me.value;
    <span class="hljs-keyword">if</span> (type == <span class="hljs-literal">undefined</span>)
      type = <span class="hljs-string">'htmlarea'</span>;
    <span class="hljs-keyword">if</span> (currentValue == vOriginal)
      changeFlag = <span class="hljs-literal">false</span>;
    me.changed = changeFlag;
    onChangeLabelProcess(elementName, currentValue);
    <span class="hljs-keyword">if</span> (type == <span class="hljs-string">'tinymce'</span>) {
      clientScriptOnChange(elementName, me, <span class="hljs-string">'unknown'</span>, currentValue);
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">if</span> ((<span class="hljs-keyword">typeof</span> me.isFocused) == <span class="hljs-string">"boolean"</span>)
        <span class="hljs-keyword">if</span> (me.isFocused == <span class="hljs-literal">false</span>)
          clientScriptOnChange(elementName, me, <span class="hljs-string">'unknown'</span>, currentValue);
    }
  }
  fieldChanged(elementName, changeFlag);
  <span class="hljs-keyword">var</span> onChangeData = {
    <span class="hljs-attr">id</span>: me.id,
    <span class="hljs-attr">value</span>: me.value,
    <span class="hljs-attr">modified</span>: me.changed
  };
  me.up(<span class="hljs-string">'form'</span>).fire(<span class="hljs-string">'glideform:onchange'</span>, onChangeData);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">formChangeKeepAlive</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> AJAX_KEEPALIVE_TIMEOUT = <span class="hljs-number">900</span>;
  <span class="hljs-keyword">var</span> nowsecs = <span class="hljs-built_in">parseInt</span>((<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>()).getTime() / <span class="hljs-number">1000</span>);
  <span class="hljs-keyword">var</span> secs = <span class="hljs-built_in">parseInt</span>(lastActivity.getTime() / <span class="hljs-number">1000</span>);
  <span class="hljs-keyword">var</span> difference = nowsecs - secs;
  <span class="hljs-keyword">if</span> (difference &gt; AJAX_KEEPALIVE_TIMEOUT) {
    <span class="hljs-keyword">var</span> aj = <span class="hljs-keyword">new</span> GlideAjax(<span class="hljs-string">"GlideSystemAjax"</span>);
    aj.addParam(<span class="hljs-string">"sysparm_name"</span>, <span class="hljs-string">"isLoggedIn"</span>);
    aj.getXML(doNothing);
    lastActivity = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>();
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fieldChanged</span>(<span class="hljs-params">elementName, changeFlag</span>) </span>{
  formChangeKeepAlive();
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span>(g_form) != <span class="hljs-string">"undefined"</span>)
    g_form.fieldChanged(elementName, changeFlag);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addOnChangeEvent</span>(<span class="hljs-params">fields, tableName, callfunc</span>) </span>{
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; fields.length; i++) {
    <span class="hljs-keyword">var</span> field = fields[i];
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> field == <span class="hljs-string">"string"</span>) {
      <span class="hljs-keyword">if</span> (tableName)
        field = tableName + <span class="hljs-string">"."</span> + field;
      field = gel(field);
    }
    <span class="hljs-keyword">if</span> (field &amp;&amp; field.tagName)
      Event.observe(field, <span class="hljs-string">'change'</span>, callfunc);
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setColorSwatch</span>(<span class="hljs-params">fieldName</span>) </span>{
  <span class="hljs-keyword">var</span> colorValue = $(fieldName).value;
  <span class="hljs-keyword">var</span> colorDisplay = $(<span class="hljs-string">"color_swatch."</span> + fieldName);
  <span class="hljs-keyword">try</span> {
    colorDisplay.style.backgroundColor = colorValue;
  } <span class="hljs-keyword">catch</span> (ex) {
    g_form.showErrorBox(fieldName, getMessage(<span class="hljs-string">"Invalid color"</span>) + <span class="hljs-string">":"</span> + colorValue);
    $(fieldName).value = <span class="hljs-string">""</span>;
    colorDisplay.style.backgroundColor = <span class="hljs-string">""</span>;
  }
};
<span class="hljs-comment">/*! RESOURCE: /scripts/functions_fontsizer.js */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setPreferredFontSize</span>(<span class="hljs-params">increment</span>) </span>{
  <span class="hljs-keyword">var</span> ruleStart = <span class="hljs-string">"BODY, TABLE, INPUT, SELECT, BUTTON, INPUT.TEXT, TEXTAREA, INPUT.button {font-size: "</span>
  <span class="hljs-keyword">var</span> ruleEnd = <span class="hljs-string">"}"</span>;
  <span class="hljs-keyword">var</span> t = g_fontSize;
  <span class="hljs-keyword">if</span> (g_fontSizePreference)
    t = g_fontSizePreference;
  <span class="hljs-keyword">var</span> t = t.split(<span class="hljs-string">'p'</span>)[<span class="hljs-number">0</span>];
  t = <span class="hljs-built_in">parseInt</span>(t) + increment;
  <span class="hljs-keyword">if</span> (<span class="hljs-number">6</span> &gt; t || t &gt; <span class="hljs-number">18</span>)
    <span class="hljs-keyword">return</span>;
  t += <span class="hljs-string">"pt"</span>;
  <span class="hljs-keyword">if</span> (g_fontSizePreference != t) {
    g_fontSizePreference = t;
    setPreference(<span class="hljs-string">'font-size'</span>, g_fontSizePreference);
    <span class="hljs-keyword">var</span> al = getFontWindowList();
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i != al.length; i++) {
      <span class="hljs-keyword">var</span> w = al[i];
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> w.deleteStyleSheet == <span class="hljs-string">'function'</span>) {
        w.deleteStyleSheet(<span class="hljs-string">"font_size"</span>);
        w.createStyleSheet(ruleStart + t + ruleEnd, <span class="hljs-string">"font_size"</span>);
      }
    }
  }
  deleteStyleSheet(<span class="hljs-string">"font_size"</span>);
  createStyleSheet(ruleStart + t + ruleEnd, <span class="hljs-string">"font_size"</span>);
  <span class="hljs-keyword">if</span> (increment) {
    <span class="hljs-keyword">var</span> e = $(<span class="hljs-string">"font_pref_text"</span>);
    <span class="hljs-keyword">if</span> (e)
      e.innerHTML = <span class="hljs-string">"("</span> + g_fontSizePreference + <span class="hljs-string">")"</span>;
  }
  CustomEvent.fireAll(<span class="hljs-string">"fontsize.change"</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getFontWindowList</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> answer = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>();
  <span class="hljs-keyword">var</span> m = getMainWindow();
  <span class="hljs-keyword">if</span> (m)
    answer.push(m);
  <span class="hljs-keyword">var</span> m = getMainFormWindow();
  <span class="hljs-keyword">if</span> (m)
    answer.push(m);
  <span class="hljs-keyword">var</span> m = getNavWindow();
  <span class="hljs-keyword">if</span> (m)
    answer.push(m);
  <span class="hljs-keyword">return</span> answer;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">deleteStyleSheet</span>(<span class="hljs-params">id</span>) </span>{
  <span class="hljs-keyword">var</span> sheet = <span class="hljs-built_in">document</span>.getElementById(id);
  <span class="hljs-keyword">if</span> (sheet) {
    <span class="hljs-keyword">var</span> head = <span class="hljs-built_in">document</span>.getElementsByTagName(<span class="hljs-string">"head"</span>)[<span class="hljs-number">0</span>];
    head.removeChild(sheet);
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createStyleSheet</span>(<span class="hljs-params">cssText, id</span>) </span>{
  <span class="hljs-keyword">var</span> head = <span class="hljs-built_in">document</span>.getElementsByTagName(<span class="hljs-string">"head"</span>)[<span class="hljs-number">0</span>];
  <span class="hljs-keyword">var</span> rules = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"style"</span>);
  rules.setAttribute(<span class="hljs-string">"type"</span>, <span class="hljs-string">"text/css"</span>);
  <span class="hljs-keyword">if</span> (id)
    rules.setAttribute(<span class="hljs-string">"id"</span>, id);
  <span class="hljs-keyword">if</span> (navigator.userAgent.toLowerCase().indexOf(<span class="hljs-string">"msie"</span>) &gt;= <span class="hljs-number">0</span>) {
    head.appendChild(rules);
    <span class="hljs-keyword">var</span> ss = rules.styleSheet;
    ss.cssText = cssText;
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">try</span> {
      rules.appendChild(<span class="hljs-built_in">document</span>.createTextNode(cssText));
    } <span class="hljs-keyword">catch</span> (e) {
      rules.cssText = cssText;
    }
    head.appendChild(rules);
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setPreferredFont</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> t = getPreference(<span class="hljs-string">'font-size'</span>);
  <span class="hljs-keyword">if</span> (!t)
    <span class="hljs-keyword">return</span>;
  g_fontSizePreference = t;
  setPreferredFontSize(<span class="hljs-number">0</span>);
};
<span class="hljs-comment">/*! RESOURCE: /scripts/functions_attachments.js */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addAttachmentNameToForm</span>(<span class="hljs-params">sysid, name, hoverText, image, showRename, showView, showPopup</span>) </span>{
  <span class="hljs-keyword">var</span> modified = $(<span class="hljs-string">"attachments_modified"</span>);
  <span class="hljs-keyword">if</span> (modified)
    modified.value = <span class="hljs-string">"true"</span>;
  showObjectInline($(<span class="hljs-string">"header_attachment_list_label"</span>));
  <span class="hljs-keyword">var</span> line = $(<span class="hljs-string">"header_attachment_line"</span>);
  <span class="hljs-keyword">if</span> (line)
    line.setStyle({
      <span class="hljs-attr">visibility</span>: <span class="hljs-string">'visible'</span>,
      <span class="hljs-attr">display</span>: <span class="hljs-string">''</span>
    });
  <span class="hljs-keyword">var</span> span = $(cel(<span class="hljs-string">'span'</span>));
  span.id = <span class="hljs-string">"attachment_"</span> + sysid;
  span.style.marginRight = <span class="hljs-string">"10px"</span>;
  span.innerHTML = <span class="hljs-string">'&lt;a href="sys_attachment.do?sys_id='</span> + sysid + <span class="hljs-string">'" title="'</span> + hoverText + <span class="hljs-string">'" style="margin-right:4px;"&gt;&lt;img src="'</span> + image + <span class="hljs-string">'" alt="" /&gt;&lt;/a&gt;'</span>;
  <span class="hljs-keyword">var</span> txt = $(cel(<span class="hljs-string">'a'</span>));
  txt.innerHTML = name;
  txt.href = <span class="hljs-string">'#'</span>;
  txt.onkeydown = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>{
    <span class="hljs-keyword">return</span> allowInPlaceEditModification(txt, event);
  };
  txt.href = <span class="hljs-string">'sys_attachment.do?sys_id='</span> + sysid;
  txt.setAttribute(<span class="hljs-string">'data-id'</span>, sysid);
  txt.style.display = <span class="hljs-string">'inline'</span>;
  txt.inPlaceEdit({
    <span class="hljs-attr">selectOnStart</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">turnClickEditingOff</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">onAfterEdit</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">newName</span>) </span>{
      <span class="hljs-keyword">var</span> oldName = <span class="hljs-keyword">this</span>.oldValue;
      <span class="hljs-keyword">var</span> ga = <span class="hljs-keyword">new</span> GlideAjax(<span class="hljs-string">'AttachmentAjax'</span>);
      ga.addParam(<span class="hljs-string">'sysparm_type'</span>, <span class="hljs-string">'initialRename'</span>);
      ga.addParam(<span class="hljs-string">'sysparm_value'</span>, sysid);
      ga.addParam(<span class="hljs-string">'sysparm_name'</span>, newName);
      ga.getXML(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">response</span>) </span>{
        <span class="hljs-keyword">var</span> answer = response.responseXML.documentElement.getAttribute(<span class="hljs-string">"answer"</span>);
        <span class="hljs-keyword">if</span> (answer !== <span class="hljs-string">'0'</span>)
          alert(<span class="hljs-keyword">new</span> GwtMessage().getMessage(<span class="hljs-string">"Renaming attachment {0} to new name {1} is not allowed"</span>, oldName, newName));
        $$(<span class="hljs-string">'a[data-id="'</span> + sysid + <span class="hljs-string">'"]'</span>).each(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">elem</span>) </span>{
          elem.innerHTML = (answer === <span class="hljs-string">'0'</span>) ? newName : oldName;
        });
      });
    }
  });
  txt.style.marginRight = <span class="hljs-string">"5px"</span>;
  span.appendChild(txt);
  <span class="hljs-keyword">if</span> (showRename == <span class="hljs-string">'true'</span>) {
    <span class="hljs-keyword">var</span> renameAttachment = $(cel(<span class="hljs-string">'a'</span>));
    renameAttachment.className = <span class="hljs-string">'attachment'</span>;
    renameAttachment.onclick = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      txt.beginEdit();
    };
    renameAttachment.innerHTML = getMessage(<span class="hljs-string">'[rename]'</span>);
    span.appendChild(renameAttachment);
  }
  <span class="hljs-keyword">if</span> (showView == <span class="hljs-string">"true"</span>) {
    <span class="hljs-keyword">var</span> blank = <span class="hljs-built_in">document</span>.createTextNode(<span class="hljs-string">" "</span>);
    span.appendChild(blank);
    <span class="hljs-keyword">var</span> view = cel(<span class="hljs-string">"a"</span>);
    <span class="hljs-keyword">var</span> newText = <span class="hljs-built_in">document</span>.createTextNode(getMessage(<span class="hljs-string">'[view]'</span>));
    view.appendChild(newText);
    view.className = <span class="hljs-string">"attachment"</span>;
    <span class="hljs-keyword">if</span> (showPopup == <span class="hljs-string">"false"</span>)
      view.href = <span class="hljs-string">"sys_attachment.do?sys_id="</span> + sysid + <span class="hljs-string">"&amp;view=true"</span>;
    <span class="hljs-keyword">else</span>
      view.onclick = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        tearOffAttachment(sysid)
      };
    span.appendChild(view);
    span.appendChild(blank);
  }
  <span class="hljs-keyword">var</span> storage = cel(<span class="hljs-string">'li'</span>);
  storage.className = <span class="hljs-string">'attachment_list_items'</span>;
  storage.appendChild(span);
  <span class="hljs-keyword">var</span> attachList = $(<span class="hljs-string">"header_attachment_list"</span>);
  <span class="hljs-keyword">if</span> (attachList)
    attachList.appendChild(storage);
  <span class="hljs-keyword">var</span> header_attachment = $(<span class="hljs-string">'header_attachment'</span>);
  <span class="hljs-keyword">if</span> (header_attachment) {
    _frameChanged();
  }
  <span class="hljs-keyword">var</span> ga = <span class="hljs-keyword">new</span> GlideAjax(<span class="hljs-string">'AttachmentAjax'</span>);
  ga.addParam(<span class="hljs-string">'sysparm_type'</span>, <span class="hljs-string">'attachmentParentSysId'</span>);
  ga.addParam(<span class="hljs-string">'sysparm_value'</span>, sysid);
  ga.getXMLAnswer(changeCount, <span class="hljs-literal">null</span>, <span class="hljs-string">'increase'</span>);
  <span class="hljs-keyword">var</span> more_attachments = $(<span class="hljs-string">'more_attachments'</span>);
  <span class="hljs-keyword">if</span> (header_attachment &amp;&amp; more_attachments)
    <span class="hljs-keyword">if</span> ((computeAttachmentWidth() - <span class="hljs-number">20</span>) &gt;= (header_attachment.getWidth() - more_attachments.getWidth()))
      more_attachments.style.display = <span class="hljs-string">'block'</span>;
    <span class="hljs-keyword">else</span>
      more_attachments.style.display = <span class="hljs-string">'none'</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addEllipsesToAttachments</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> list = $(<span class="hljs-string">'header_attachment_list'</span>);
  <span class="hljs-keyword">if</span> (!list)
    <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">var</span> att = $(<span class="hljs-string">'header_attachment'</span>);
  <span class="hljs-keyword">if</span> (!att)
    <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">var</span> li = list.select(<span class="hljs-string">'li'</span>);
  <span class="hljs-keyword">var</span> totalWidth = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; li.length; i++)
    totalWidth += li[i].getWidth();
  <span class="hljs-keyword">var</span> more = $(<span class="hljs-string">'more_attachments'</span>);
  <span class="hljs-keyword">if</span> ((totalWidth - <span class="hljs-number">20</span>) &gt;= ($(<span class="hljs-string">'header_attachment'</span>).getWidth() - more.getWidth()))
    more.style.display = <span class="hljs-string">'block'</span>;
  <span class="hljs-keyword">else</span>
    more.style.display = <span class="hljs-string">'none'</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addAttachmentNameToDialog</span>(<span class="hljs-params">id, fileName, canDelete, createdBy, createdOn, contentType, iconPath</span>) </span>{
  <span class="hljs-keyword">if</span> ($(<span class="hljs-string">'attachment'</span>) == <span class="hljs-literal">null</span>)
    <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">var</span> encryptCheck = gel(<span class="hljs-string">"encrypt_checkbox"</span>);
  <span class="hljs-keyword">if</span> (encryptCheck) {
    encryptCheck.checked = <span class="hljs-literal">false</span>;
    $(<span class="hljs-string">'sysparm_encryption_context'</span>).value = <span class="hljs-string">""</span>;
  }
  gel(<span class="hljs-string">"please_wait"</span>).style.display = <span class="hljs-string">"none"</span>;
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> id == <span class="hljs-string">"undefined"</span>)
    <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">var</span> noAttachments = gel(<span class="hljs-string">"no_attachments"</span>);
  <span class="hljs-keyword">if</span> (noAttachments.style.display == <span class="hljs-string">"block"</span>)
    noAttachments.style.display = <span class="hljs-string">"none"</span>;
  <span class="hljs-keyword">var</span> table = gel(<span class="hljs-string">"attachment_table_body"</span>);
  <span class="hljs-keyword">var</span> tr = cel(<span class="hljs-string">"tr"</span>);
  <span class="hljs-keyword">var</span> td = cel(<span class="hljs-string">"td"</span>);
  td.style.whiteSpace = <span class="hljs-string">"nowrap"</span>;
  td.colspan = <span class="hljs-string">"2"</span>;
  <span class="hljs-keyword">if</span> (canDelete) {
    <span class="hljs-keyword">var</span> input = cel(<span class="hljs-string">"input"</span>);
    <span class="hljs-keyword">var</span> checkId = <span class="hljs-string">"sys_id_"</span> + id;
    input.name = checkId;
    input.id = checkId;
    input.type = <span class="hljs-string">"checkbox"</span>;
    input.onclick = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      setRemoveButton(gel(checkId));
    };
    td.appendChild(input);
    gel(<span class="hljs-string">"delete_button_span"</span>).style.display = <span class="hljs-string">"inline"</span>;
    <span class="hljs-keyword">var</span> text = <span class="hljs-built_in">document</span>.createTextNode(<span class="hljs-string">" "</span>);
    td.appendChild(text);
    input = cel(<span class="hljs-string">"input"</span>);
    input.type = <span class="hljs-string">"hidden"</span>;
    input.name = <span class="hljs-string">"Name"</span>;
    input.value = <span class="hljs-string">"false"</span>;
    td.appendChild(input);
  }
  <span class="hljs-keyword">var</span> anchor = cel(<span class="hljs-string">"a"</span>);
  anchor.style.marginRight = <span class="hljs-string">"4px"</span>;
  anchor.href = <span class="hljs-string">"sys_attachment.do?sys_id="</span> + id;
  anchor.title = <span class="hljs-string">" "</span> + createdBy + <span class="hljs-string">"  "</span> + createdOn;
  <span class="hljs-keyword">var</span> imgSrc = iconPath;
  <span class="hljs-keyword">var</span> img = cel(<span class="hljs-string">"img"</span>);
  img.src = imgSrc;
  img.alt = anchor.title;
  anchor.appendChild(img);
  <span class="hljs-keyword">var</span> text = $(cel(<span class="hljs-string">'a'</span>));
  text.style.display = <span class="hljs-string">"inline"</span>;
  text.href = <span class="hljs-string">'#'</span>;
  text.href = <span class="hljs-string">"sys_attachment.do?sys_id="</span> + id;
  text.onkeydown = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>{
    <span class="hljs-keyword">return</span> allowInPlaceEditModification(text, event);
  };
  text.style.marginRight = <span class="hljs-string">"5px"</span>;
  text.style.maxWidth = <span class="hljs-string">"75%"</span>;
  text.style.display = <span class="hljs-string">"inline-block"</span>;
  text.style.overflow = <span class="hljs-string">"hidden"</span>;
  text.style.verticalAlign = <span class="hljs-string">"middle"</span>;
  text.innerHTML = fileName;
  text.setAttribute(<span class="hljs-string">"data-id"</span>, id);
  text.inPlaceEdit({
    <span class="hljs-attr">selectOnStart</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">turnClickEditingOff</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">onAfterEdit</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">newName</span>) </span>{
      <span class="hljs-keyword">var</span> ga = <span class="hljs-keyword">new</span> GlideAjax(<span class="hljs-string">'AttachmentAjax'</span>);
      ga.addParam(<span class="hljs-string">'sysparm_type'</span>, <span class="hljs-string">'rename'</span>);
      ga.addParam(<span class="hljs-string">'sysparm_value'</span>, id);
      ga.addParam(<span class="hljs-string">'sysparm_name'</span>, newName);
      ga.getXML();
      $$(<span class="hljs-string">'a[data-id="'</span> + id + <span class="hljs-string">'"]'</span>).each(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">elem</span>) </span>{
        elem.innerHTML = newName;
      });
      $$(<span class="hljs-string">'span[data-id="'</span> + id + <span class="hljs-string">'"]'</span>).each(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">el</span>) </span>{
        el.innerHTML = newName;
      });
    }
  });
  <span class="hljs-keyword">if</span> (contentType == <span class="hljs-string">"text/html"</span>)
    anchor.target = <span class="hljs-string">"_blank"</span>;
  td.appendChild(anchor);
  td.appendChild(text);
  <span class="hljs-keyword">if</span> ($(<span class="hljs-string">'ni.show_rename_link'</span>).value) {
    <span class="hljs-keyword">var</span> renameAttachment = $(cel(<span class="hljs-string">'a'</span>));
    renameAttachment.className = <span class="hljs-string">'attachment'</span>;
    renameAttachment.onclick = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      text.beginEdit();
    };
    renameAttachment.innerHTML = getMessage(<span class="hljs-string">'[rename]'</span>);
    td.appendChild(renameAttachment);
  }
  <span class="hljs-keyword">var</span> showView = gel(<span class="hljs-string">"ni.show_attachment_view"</span>).value;
  <span class="hljs-keyword">if</span> (showView == <span class="hljs-string">"true"</span>) {
    <span class="hljs-keyword">var</span> blank = <span class="hljs-built_in">document</span>.createTextNode(<span class="hljs-string">" "</span>);
    tr.appendChild(blank);
    <span class="hljs-keyword">var</span> view = cel(<span class="hljs-string">"a"</span>);
    <span class="hljs-keyword">var</span> newText = <span class="hljs-built_in">document</span>.createTextNode(getMessage(<span class="hljs-string">"[view]"</span>));
    view.appendChild(newText);
    view.className = <span class="hljs-string">"attachment"</span>;
    <span class="hljs-keyword">if</span> (showPopup == <span class="hljs-string">"false"</span>)
      view.href = <span class="hljs-string">"sys_attachment.do?sys_id="</span> + id + <span class="hljs-string">"&amp;view=true"</span>;
    <span class="hljs-keyword">else</span>
      view.onclick = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        tearOffAttachment(id)
      };
    td.appendChild(blank);
    td.appendChild(view);
  }
  <span class="hljs-keyword">var</span> showPopup = gel(<span class="hljs-string">"ni.show_attachment_popup"</span>).value;
  tr.appendChild(td);
  table.appendChild(tr);
  <span class="hljs-keyword">var</span> alert508 = <span class="hljs-string">"$[GlideAccessibility.isEnabled()]"</span>;
  <span class="hljs-keyword">if</span> (alert508 == <span class="hljs-string">'true'</span>)
    alert(fileName + <span class="hljs-string">" "</span> + anchor.title);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">computeAttachmentWidth</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> temp = $(<span class="hljs-string">'header_attachment_list'</span>).select(<span class="hljs-string">'li'</span>);
  <span class="hljs-keyword">var</span> totalWidth = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; temp.length; i++) {
    totalWidth += temp[i].getWidth();
  }
  <span class="hljs-keyword">return</span> totalWidth;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">updateAttachmentCount</span>(<span class="hljs-params">sysid</span>) </span>{
  <span class="hljs-keyword">var</span> ga = <span class="hljs-keyword">new</span> GlideAjax(<span class="hljs-string">'AttachmentAjax'</span>);
  ga.addParam(<span class="hljs-string">'sysparm_type'</span>, <span class="hljs-string">'attachmentCount'</span>);
  ga.addParam(<span class="hljs-string">'sysparm_value'</span>, sysid);
  ga.getXMLAnswer(numberOfAttachments, <span class="hljs-literal">null</span>, sysid);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">numberOfAttachments</span>(<span class="hljs-params">answer, sysid</span>) </span>{
  <span class="hljs-keyword">var</span> number = <span class="hljs-built_in">parseInt</span>(answer);
  <span class="hljs-keyword">var</span> buttons = $$(<span class="hljs-string">'.attachmentNumber_'</span> + sysid);
  <span class="hljs-keyword">if</span> (buttons[<span class="hljs-number">0</span>] == <span class="hljs-literal">undefined</span>)
    $(<span class="hljs-string">'header_attachment_list_label'</span>).down().innerHTML = number;
  <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; buttons.length; i++) {
      buttons[i].innerHTML = number;
    }
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getCurrentAttachmentNumber</span>(<span class="hljs-params">sysid</span>) </span>{
  <span class="hljs-keyword">if</span> ($$(<span class="hljs-string">'.attachmentNumber_'</span> + sysid)[<span class="hljs-number">0</span>] == <span class="hljs-literal">undefined</span>) {
    <span class="hljs-keyword">if</span> ($(<span class="hljs-string">'header_attachment_list_label'</span>) == <span class="hljs-literal">undefined</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">undefined</span>;
    <span class="hljs-keyword">else</span>
      <span class="hljs-keyword">return</span> $(<span class="hljs-string">'header_attachment_list_label'</span>).down().innerHTML;
  }
  <span class="hljs-keyword">return</span> $$(<span class="hljs-string">'.attachmentNumber_'</span> + sysid)[<span class="hljs-number">0</span>].innerHTML;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">updateAttachmentCount2</span>(<span class="hljs-params">number, sysid</span>) </span>{
  <span class="hljs-keyword">var</span> buttons = $$(<span class="hljs-string">'.attachmentNumber_'</span> + sysid);
  <span class="hljs-keyword">if</span> (buttons[<span class="hljs-number">0</span>] == <span class="hljs-literal">undefined</span>)
    $(<span class="hljs-string">'header_attachment_list_label'</span>).down().innerHTML = number;
  <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; buttons.length; i++) {
      buttons[i].innerHTML = number;
    }
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">changeCount</span>(<span class="hljs-params">sysid, type</span>) </span>{
  <span class="hljs-keyword">var</span> number = getCurrentAttachmentNumber(sysid);
  <span class="hljs-keyword">if</span> (number != <span class="hljs-literal">undefined</span>) {
    <span class="hljs-keyword">if</span> (type == <span class="hljs-string">'increase'</span>)
      number++;
    <span class="hljs-keyword">else</span>
      number--;
    updateAttachmentCount2(number, sysid);
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">deleteAttachment</span>(<span class="hljs-params">sysid</span>) </span>{
  <span class="hljs-keyword">var</span> gr = <span class="hljs-keyword">new</span> GlideRecord(<span class="hljs-string">'sys_attachment'</span>);
  <span class="hljs-keyword">var</span> parentRecord = recordAttachmentBelongsTo(sysid);
  gr.addQuery(<span class="hljs-string">'sys_id'</span>, sysid);
  gr.query();
  <span class="hljs-keyword">if</span> (gr.next()) {
    <span class="hljs-keyword">if</span> (confirmDeletion(gr.file_name, sysid)) {
      <span class="hljs-keyword">var</span> ol = GlideOverlay.get(<span class="hljs-string">'attachment_manager_overlay'</span>);
      alert(ol._box.select(<span class="hljs-string">'div[data-id="'</span> + sysid + <span class="hljs-string">'"]'</span>)[<span class="hljs-number">0</span>].up().up().inspect());
      ol._box.select(<span class="hljs-string">'div[data-id="'</span> + sysid + <span class="hljs-string">'"]'</span>)[<span class="hljs-number">0</span>].up().up().remove();
      ol.autoDimension();
      $(<span class="hljs-string">"attachment_"</span> + sysid).remove();
      <span class="hljs-keyword">if</span> (numberOfAttachments(gr.table_sys_id) == <span class="hljs-number">1</span>) {
        hideObject($(<span class="hljs-string">"header_attachment_list_label"</span>));
        <span class="hljs-keyword">var</span> line = $(<span class="hljs-string">"header_attachment_line"</span>);
        <span class="hljs-keyword">if</span> (line) {
          line.setStyle({
            <span class="hljs-attr">visibility</span>: <span class="hljs-string">"hidden"</span>,
            <span class="hljs-attr">display</span>: <span class="hljs-string">"none"</span>
          });
        }
        $(<span class="hljs-string">"header_attachment"</span>).style.height = <span class="hljs-string">"auto"</span>;
        ol.close();
      }
      gr.deleteRecord();
      updateAttachmentCount(parentRecord);
    }
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">saveAttachment</span>(<span class="hljs-params">tableName, sys_id, allowAttachment</span>) </span>{
  <span class="hljs-keyword">var</span> g_dialog = <span class="hljs-keyword">new</span> GlideModal(<span class="hljs-string">'attachment'</span>, <span class="hljs-literal">false</span>, <span class="hljs-number">500</span>);
  g_dialog.setTitle(getMessage(<span class="hljs-string">'Attachments'</span>));
  g_dialog.setPreference(<span class="hljs-string">'target_table'</span>, tableName);
  g_dialog.setPreference(<span class="hljs-string">'target_sys_id'</span>, sys_id);
  <span class="hljs-keyword">if</span> (allowAttachment)
    g_dialog.setPreference(<span class="hljs-string">'sc_override'</span>, <span class="hljs-string">'true'</span>);
  g_dialog.setPreference(<span class="hljs-string">'attachment_disabled'</span>,
    (<span class="hljs-built_in">window</span>[<span class="hljs-string">"AttachmentUploader"</span>] ? AttachmentUploader.isAttachmentDisabled() : <span class="hljs-string">"false"</span>));
  g_dialog.on(<span class="hljs-string">"closeconfirm"</span>, _saveAttachmentConfirm);
  g_dialog.render();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_saveAttachmentConfirm</span>(<span class="hljs-params">dialog</span>) </span>{
  <span class="hljs-keyword">var</span> attachmentRows = $$(<span class="hljs-string">'.attachmentRow'</span>);
  <span class="hljs-keyword">var</span> value = <span class="hljs-string">''</span>;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; attachmentRows.length; i++) {
    <span class="hljs-keyword">if</span> (isMSIE) {
      <span class="hljs-keyword">var</span> files = attachmentRows[i].select(<span class="hljs-string">'input'</span>)[<span class="hljs-number">0</span>].getValue();
      <span class="hljs-keyword">if</span> (!files.empty())
        value += files + <span class="hljs-string">"\n"</span>;
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">var</span> files = attachmentRows[i].select(<span class="hljs-string">'input'</span>)[<span class="hljs-number">0</span>].files;
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> j = <span class="hljs-number">0</span>; j &lt; files.length; j++) {
        <span class="hljs-keyword">if</span> (files[j] != <span class="hljs-literal">null</span>) {
          value += files[j].name + <span class="hljs-string">"\n"</span>;
        }
      }
    }
  }
  <span class="hljs-keyword">if</span> (!value.empty())
    <span class="hljs-keyword">if</span> (!confirm(getMessage(<span class="hljs-string">"Close before uploading attachments?"</span>) + <span class="hljs-string">"\n"</span> + value.substring(<span class="hljs-number">0</span>, value.length - <span class="hljs-number">1</span>)))
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  _saveAttachmentClose();
  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_saveAttachmentClose</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> modified = $(<span class="hljs-string">"attachments_modified"</span>);
  <span class="hljs-keyword">if</span> (modified) {
    <span class="hljs-keyword">var</span> attachmentsModified = modified.value;
    <span class="hljs-keyword">if</span> (attachmentsModified != <span class="hljs-string">"true"</span>)
      <span class="hljs-keyword">return</span>;
  }
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> g_form == <span class="hljs-string">"undefined"</span>)
    <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">if</span> (g_form.newRecord)
    g_form.modified = <span class="hljs-literal">true</span>;
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> GlideLists2 == <span class="hljs-string">"undefined"</span>)
    <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> id <span class="hljs-keyword">in</span> GlideLists2) {
    <span class="hljs-keyword">var</span> list = GlideLists2[id];
    <span class="hljs-keyword">if</span> (list.getTableName() === <span class="hljs-string">'sys_attachment'</span>)
      list.refresh();
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">allowInPlaceEditModification</span>(<span class="hljs-params">elem, event</span>) </span>{
  <span class="hljs-keyword">var</span> length = (elem.textContent != <span class="hljs-literal">null</span>) ? elem.textContent.length : elem.innerText.length;
  <span class="hljs-keyword">var</span> max_length = maximumCharacterLimit();
  <span class="hljs-keyword">if</span> (length &gt;= max_length) {
    <span class="hljs-keyword">var</span> keyCode = (event) ? event.keyCode : <span class="hljs-built_in">window</span>.event.keyCode;
    <span class="hljs-built_in">console</span>.log(keyCode);
    <span class="hljs-keyword">switch</span> (keyCode) {
      <span class="hljs-keyword">case</span> Event.KEY_LEFT:
      <span class="hljs-keyword">case</span> Event.KEY_RIGHT:
      <span class="hljs-keyword">case</span> Event.KEY_UP:
      <span class="hljs-keyword">case</span> Event.KEY_DOWN:
      <span class="hljs-keyword">case</span> Event.KEY_BACKSPACE:
      <span class="hljs-keyword">case</span> Event.KEY_DELETE:
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
      <span class="hljs-keyword">default</span>:
        alert(<span class="hljs-string">"Filename has reached the character limit of "</span> + max_length + <span class="hljs-string">"."</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
  }
  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">maximumCharacterLimit</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> f = $(<span class="hljs-string">'header_attachment_list'</span>);
  <span class="hljs-keyword">if</span> (f)
    <span class="hljs-keyword">return</span> f.getAttribute(<span class="hljs-string">'data-max-filename-length'</span>);
  <span class="hljs-keyword">return</span> <span class="hljs-number">100</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">confirmDeletion</span>(<span class="hljs-params">file_name, sysid</span>) </span>{
  <span class="hljs-keyword">var</span> r = confirm(<span class="hljs-string">"Are you sure you want to delete "</span> +
    file_name +
    <span class="hljs-string">"?"</span>);
  <span class="hljs-keyword">return</span> r;
};
<span class="hljs-comment">/*! RESOURCE: /scripts/functions_calendar.js */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">nextCalendarAction</span>(<span class="hljs-params">duration, year, month, day, calendarID, styleField, event</span>) </span>{
  <span class="hljs-keyword">var</span> form = <span class="hljs-built_in">document</span>.getElementsByName(<span class="hljs-string">'dash_form'</span>)[<span class="hljs-number">0</span>];
  <span class="hljs-keyword">if</span> (form) {
    <span class="hljs-keyword">var</span> name = form.dashboard_name.value;
    <span class="hljs-keyword">var</span> url = <span class="hljs-string">"sys_dashboard_template.do?"</span>;
    url += <span class="hljs-string">"sysparm_query=name="</span> + name;
    url += <span class="hljs-string">"&amp;sysparm_calview="</span> + duration;
    url += <span class="hljs-string">"&amp;sysparm_year="</span> + year;
    url += <span class="hljs-string">"&amp;sysparm_month="</span> + month;
    url += <span class="hljs-string">"&amp;sysparm_day="</span> + day;
    <span class="hljs-keyword">var</span> viewwidget = form[<span class="hljs-string">'sysparm_view'</span>];
    <span class="hljs-keyword">if</span> (viewwidget)
      url += <span class="hljs-string">'&amp;sysparm_view='</span> + viewwidget.value;
    <span class="hljs-built_in">window</span>.location = url;
  } <span class="hljs-keyword">else</span> {
    form = <span class="hljs-built_in">document</span>.getElementsByName(<span class="hljs-string">'calendarform'</span>)[<span class="hljs-number">0</span>];
    <span class="hljs-keyword">if</span> (form == <span class="hljs-literal">null</span>) {
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> $j != <span class="hljs-string">"undefined"</span> &amp;&amp; calendarID != <span class="hljs-literal">null</span> &amp;&amp; calendarID.length) {
        <span class="hljs-keyword">var</span> element = event.srcElement;
        <span class="hljs-keyword">if</span> (!element)
          element = event.target;
        <span class="hljs-keyword">var</span> content = $j(element).closest(<span class="hljs-string">".report_content"</span>);
        <span class="hljs-keyword">if</span> (content.length) {
          <span class="hljs-keyword">var</span> cstyle = <span class="hljs-literal">null</span>;
          media = <span class="hljs-built_in">document</span>.getElementsByName(<span class="hljs-string">'sysparm_calstyle_choice'</span>);
          <span class="hljs-keyword">if</span> (media != <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; media.length; i++) {
              <span class="hljs-keyword">var</span> r = media[i];
              <span class="hljs-keyword">if</span> (r.checked) {
                cstyle = r.value;
                <span class="hljs-keyword">break</span>;
              }
            }
          }
          <span class="hljs-keyword">if</span> (!cstyle) {
            media = $(<span class="hljs-string">"sysparm_calstyle"</span> + calendarID);
            <span class="hljs-keyword">if</span> (media != <span class="hljs-literal">null</span>)
              cstyle = media.value;
          }
          <span class="hljs-keyword">var</span> params = <span class="hljs-string">"sysparm_calview="</span> + duration;
          params += <span class="hljs-string">"&amp;sysparm_year="</span> + year;
          params += <span class="hljs-string">"&amp;sysparm_month="</span> + month;
          params += <span class="hljs-string">"&amp;sysparm_day="</span> + day;
          params += <span class="hljs-string">"&amp;sysparm_calstyle="</span> + cstyle;
          drillReport(content.parent(), calendarID, <span class="hljs-string">""</span>, params);
          <span class="hljs-keyword">return</span>;
        }
      }
      form = <span class="hljs-built_in">document</span>.getElementsByName(<span class="hljs-string">'reportform_control'</span>)[<span class="hljs-number">0</span>];
    }
    <span class="hljs-keyword">if</span> (form == <span class="hljs-literal">null</span>) {
      form = <span class="hljs-built_in">document</span>.getElementsByName(<span class="hljs-string">'history'</span>)[<span class="hljs-number">0</span>];
      <span class="hljs-keyword">if</span> (form != <span class="hljs-literal">null</span>) {
        addInput(form, <span class="hljs-string">'HIDDEN'</span>, <span class="hljs-string">'sysparm_stack'</span>, <span class="hljs-string">"no"</span>);
      }
    }
    <span class="hljs-keyword">if</span> (form != <span class="hljs-literal">null</span>) {
      addInput(form, <span class="hljs-string">'HIDDEN'</span>, <span class="hljs-string">'sysparm_calview'</span>, duration);
      addInput(form, <span class="hljs-string">'HIDDEN'</span>, <span class="hljs-string">'sysparm_year'</span>, year);
      addInput(form, <span class="hljs-string">'HIDDEN'</span>, <span class="hljs-string">'sysparm_month'</span>, month);
      addInput(form, <span class="hljs-string">'HIDDEN'</span>, <span class="hljs-string">'sysparm_day'</span>, day);
      <span class="hljs-keyword">var</span> media = $(<span class="hljs-string">'sysparm_media'</span>);
      <span class="hljs-keyword">if</span> (media != <span class="hljs-literal">null</span>) {
        addInput(form, <span class="hljs-string">'HIDDEN'</span>, <span class="hljs-string">'sysparm_media'</span>, media.value);
      }
      media = $(<span class="hljs-string">'sysparm_view'</span>);
      <span class="hljs-keyword">if</span> (media != <span class="hljs-literal">null</span>) {
        addInput(form, <span class="hljs-string">'HIDDEN'</span>, <span class="hljs-string">'sysparm_view'</span>, media.value);
      }
      media = <span class="hljs-built_in">document</span>.getElementsByName(<span class="hljs-string">'sysparm_calstyle_choice'</span>);
      <span class="hljs-keyword">if</span> (media != <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; media.length; i++) {
          <span class="hljs-keyword">var</span> r = media[i];
          <span class="hljs-keyword">if</span> (r.checked) {
            addInput(form, <span class="hljs-string">'HIDDEN'</span>, <span class="hljs-string">'sysparm_calstyle'</span>, r.value);
            <span class="hljs-keyword">break</span>;
          }
        }
      }
      media = $(<span class="hljs-string">'sysparm_calstyle'</span>);
      <span class="hljs-keyword">if</span> (media != <span class="hljs-literal">null</span>) {
        addInput(form, <span class="hljs-string">'HIDDEN'</span>, <span class="hljs-string">'sysparm_calstyle'</span>, media.value);
      }
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> form.onsubmit == <span class="hljs-string">"function"</span>)
        form.onsubmit();
      <span class="hljs-keyword">if</span> (<span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'partialPage:theReport'</span>))
        fetchPartial(<span class="hljs-string">'reportform_control'</span>, <span class="hljs-string">'theReport'</span>);
      <span class="hljs-keyword">else</span>
        form.submit();
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">var</span> url = <span class="hljs-string">"calendar_view.do?"</span>;
      url += <span class="hljs-string">"sysparm_calview="</span> + duration;
      url += <span class="hljs-string">"&amp;sysparm_year="</span> + year;
      url += <span class="hljs-string">"&amp;sysparm_month="</span> + month;
      url += <span class="hljs-string">"&amp;sysparm_day="</span> + day;
      <span class="hljs-keyword">if</span> (styleField)
        url += <span class="hljs-string">"&amp;sysparm_calstyle="</span> + styleField;
      <span class="hljs-built_in">window</span>.location = url;
    }
  }
};
<span class="hljs-comment">/*! RESOURCE: /scripts/functions_email.js */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sendEmail</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> form = <span class="hljs-built_in">document</span>.forms[<span class="hljs-string">'emailclient'</span>];
  addInput(form, <span class="hljs-string">'HIDDEN'</span>, <span class="hljs-string">'EMAIL-CLIENT'</span>, <span class="hljs-string">'send'</span>);
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> form.onsubmit == <span class="hljs-string">"function"</span>) {
    form.onsubmit();
  }
  form.submit();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">mailTo</span>(<span class="hljs-params">field</span>) </span>{
  <span class="hljs-keyword">var</span> nameField = $(field);
  <span class="hljs-keyword">if</span> (nameField &amp;&amp; nameField.value) {
    <span class="hljs-built_in">window</span>.top.location = <span class="hljs-string">"mailto:"</span> + nameField.value;
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setCannedText</span>(<span class="hljs-params">selectBox, isPlainText</span>) </span>{
  <span class="hljs-keyword">var</span> theOption = selectBox.options[selectBox.selectedIndex];
  <span class="hljs-keyword">var</span> messageText = theOption.value;
  <span class="hljs-keyword">var</span> body = $(<span class="hljs-string">'message.text'</span>);
  <span class="hljs-keyword">if</span> (tiny_html_editor &amp;&amp; <span class="hljs-keyword">typeof</span> tinymce != <span class="hljs-string">"undefined"</span>) {
    <span class="hljs-keyword">if</span> (isPlainText) {
      tinymce.EditorManager.activeEditor.setContent(<span class="hljs-string">""</span>);
      tinymce.EditorManager.activeEditor.plugins.paste.clipboard.pasteText(messageText)
    } <span class="hljs-keyword">else</span>
      tinymce.EditorManager.activeEditor.setContent(messageText);
  } <span class="hljs-keyword">else</span> {
    body.value = messageText;
    <span class="hljs-keyword">if</span> (body.htmlArea)
      body.htmlArea._doc.body.innerHTML = messageText;
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isEmailValid</span>(<span class="hljs-params">value</span>) </span>{
  <span class="hljs-keyword">var</span> problemMsg = isEmailValidWithReason(value);
  <span class="hljs-keyword">if</span> (problemMsg != <span class="hljs-string">""</span>) {
    jslog(<span class="hljs-string">"isEmailValid: "</span> + problemMsg);
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  }
  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isEmailValidWithReason</span>(<span class="hljs-params">value</span>) </span>{
  <span class="hljs-keyword">var</span> localPartChars = <span class="hljs-string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!#$%*/?|^{}`~&amp;'+-=_."</span>;
  <span class="hljs-keyword">var</span> domainChars = <span class="hljs-string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_."</span>;
  <span class="hljs-keyword">if</span> (value.indexOf(<span class="hljs-string">"@"</span>) == <span class="hljs-number">-1</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-string">"missing @ sign"</span>;
  <span class="hljs-keyword">var</span> s = value.split(<span class="hljs-string">"@"</span>);
  <span class="hljs-keyword">if</span> (s.length != <span class="hljs-number">2</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-string">"too many at signs"</span>;
  <span class="hljs-keyword">if</span> (!containsOnlyChars(localPartChars, s[<span class="hljs-number">0</span>]))
    <span class="hljs-keyword">return</span> <span class="hljs-string">"invalid character before the at sign"</span>;
  <span class="hljs-keyword">if</span> (s[<span class="hljs-number">0</span>].length &lt; <span class="hljs-number">1</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-string">"at least one character must be before the at sign"</span>;
  <span class="hljs-keyword">if</span> (s[<span class="hljs-number">0</span>].substr(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>) == <span class="hljs-string">"."</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-string">"period cannot be the first character"</span>;
  <span class="hljs-keyword">if</span> (s[<span class="hljs-number">0</span>].substr(s[<span class="hljs-number">0</span>].length - <span class="hljs-number">1</span>, <span class="hljs-number">1</span>) == <span class="hljs-string">"."</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-string">"period cannot be the last character before the at sign"</span>;
  <span class="hljs-keyword">if</span> (!containsOnlyChars(domainChars, s[<span class="hljs-number">1</span>]))
    <span class="hljs-keyword">return</span> <span class="hljs-string">"invalid character after the at sign"</span>;
  <span class="hljs-keyword">var</span> periodIndex = s[<span class="hljs-number">1</span>].indexOf(<span class="hljs-string">"."</span>);
  <span class="hljs-keyword">if</span> (periodIndex == <span class="hljs-number">-1</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-string">"missing period after the at sign"</span>;
  <span class="hljs-keyword">if</span> (periodIndex == <span class="hljs-number">0</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-string">"period cannot be the first character after the at sign"</span>;
  <span class="hljs-keyword">var</span> periods = s[<span class="hljs-number">1</span>].split(<span class="hljs-string">"."</span>);
  <span class="hljs-keyword">var</span> lastPeriod = periods[periods.length - <span class="hljs-number">1</span>];
  <span class="hljs-keyword">if</span> (lastPeriod.length &lt; <span class="hljs-number">1</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-string">"must be at least 1 character after the last period"</span>;
  <span class="hljs-keyword">if</span> (!isAlphaNum(s[<span class="hljs-number">1</span>].substr(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>)))
    <span class="hljs-keyword">return</span> <span class="hljs-string">"the first character after the at sign must be alphanumeric"</span>;
  <span class="hljs-keyword">if</span> (!isAlphaNum(s[<span class="hljs-number">1</span>].substr(s[<span class="hljs-number">1</span>].length - <span class="hljs-number">1</span>, <span class="hljs-number">1</span>)))
    <span class="hljs-keyword">return</span> <span class="hljs-string">"the last character must be alphanumeric"</span>;
  <span class="hljs-keyword">return</span> <span class="hljs-string">""</span>;
};
<span class="hljs-comment">/*! RESOURCE: /scripts/functions_user_image.js */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">saveUserImage</span>(<span class="hljs-params">tableName, gotourl</span>) </span>{
  <span class="hljs-keyword">var</span> form = <span class="hljs-built_in">document</span>.forms[tableName + <span class="hljs-string">'.do'</span>];
  <span class="hljs-keyword">var</span> viewwidget = form[<span class="hljs-string">'sysparm_view'</span>];
  <span class="hljs-keyword">if</span> (viewwidget)
    gotourl += <span class="hljs-string">'&amp;sysparm_view='</span> + viewwidget.value;
  form.sys_action.value = <span class="hljs-string">'sysverb_check_save'</span>;
  addInput(form, <span class="hljs-string">'HIDDEN'</span>, <span class="hljs-string">'sysparm_goto_url'</span>, gotourl);
  <span class="hljs-keyword">var</span> okToSubmit = <span class="hljs-literal">true</span>;
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> form.onsubmit == <span class="hljs-string">"function"</span>)
    okToSubmit = form.onsubmit();
  <span class="hljs-keyword">if</span> (okToSubmit)
    form.submit();
  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">validateVideoFileName</span>(<span class="hljs-params">fileExtensions</span>) </span>{
  <span class="hljs-keyword">var</span> fileName = getAttachedFileName();
  <span class="hljs-keyword">var</span> isvalid = validateWithExtensions(fileName, fileExtensions);
  <span class="hljs-keyword">if</span> (!isvalid) {
    alert(fileName + <span class="hljs-string">" isn't a recognized video format"</span>);
  }
  <span class="hljs-keyword">return</span> isvalid;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">validateAudioFileName</span>(<span class="hljs-params">fileExtensions</span>) </span>{
  <span class="hljs-keyword">var</span> fileName = getAttachedFileName();
  <span class="hljs-keyword">var</span> isvalid = validateWithExtensions(fileName, fileExtensions);
  <span class="hljs-keyword">if</span> (!isvalid) {
    alert(fileName + <span class="hljs-string">" isn't a recognized audio format"</span>);
  }
  <span class="hljs-keyword">return</span> isvalid;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getAttachedFileName</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> widget = $(<span class="hljs-string">"attachFile"</span>);
  <span class="hljs-keyword">if</span> (!widget)
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  <span class="hljs-keyword">return</span> widget.value;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">validateWithExtensions</span>(<span class="hljs-params">fileName, fileExtensions</span>) </span>{
  <span class="hljs-keyword">var</span> action = $(<span class="hljs-string">'sys_action'</span>);
  <span class="hljs-keyword">if</span> (<span class="hljs-string">'sysverb_cancel'</span> == action.value)
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  <span class="hljs-keyword">return</span> endsWithVideoExtension(fileName, fileExtensions);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">endsWithVideoExtension</span>(<span class="hljs-params">fileName, fileExtensions</span>) </span>{
  <span class="hljs-keyword">var</span> extensionArray = fileExtensions.split(<span class="hljs-string">","</span>);
  <span class="hljs-keyword">var</span> dot = fileName.lastIndexOf(<span class="hljs-string">'.'</span>) + <span class="hljs-number">1</span>;
  <span class="hljs-keyword">var</span> suffix = fileName.substring(dot);
  suffix = suffix.toLowerCase();
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; extensionArray.length; i++) {
    <span class="hljs-keyword">var</span> element = extensionArray[i];
    <span class="hljs-keyword">if</span> (element == suffix)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  }
  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">validateImageFileName</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> action = $(<span class="hljs-string">'sys_action'</span>);
  <span class="hljs-keyword">if</span> (<span class="hljs-string">'sysverb_cancel'</span> == action.value)
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  <span class="hljs-keyword">var</span> widget = $(<span class="hljs-string">"attachFile"</span>);
  <span class="hljs-keyword">if</span> (!widget)
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  <span class="hljs-keyword">var</span> filename = widget.value;
  <span class="hljs-keyword">var</span> isvalid = endsWithImageExtension(filename);
  <span class="hljs-keyword">if</span> (!isvalid) {
    alert(filename + <span class="hljs-string">" isn't a recognized image file format"</span>);
  }
  <span class="hljs-keyword">return</span> isvalid;
}
<span class="hljs-keyword">var</span> VALID_IMAGE_SUFFIX = [<span class="hljs-string">"jpg"</span>, <span class="hljs-string">"jpeg"</span>, <span class="hljs-string">"png"</span>, <span class="hljs-string">"bmp"</span>, <span class="hljs-string">"gif"</span>, <span class="hljs-string">"ico"</span>, <span class="hljs-string">"svg"</span>];

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">endsWithImageExtension</span>(<span class="hljs-params">filename</span>) </span>{
  <span class="hljs-keyword">var</span> dot = filename.lastIndexOf(<span class="hljs-string">'.'</span>) + <span class="hljs-number">1</span>;
  <span class="hljs-keyword">var</span> suffix = filename.substring(dot);
  suffix = suffix.toLowerCase();
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; VALID_IMAGE_SUFFIX.length; i++) {
    <span class="hljs-keyword">var</span> element = VALID_IMAGE_SUFFIX[i];
    element = element.toLowerCase();
    <span class="hljs-keyword">if</span> (element == suffix)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  }
  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">deleteUserImage</span>(<span class="hljs-params">image_id, replacement</span>) </span>{
  <span class="hljs-keyword">var</span> ajax = <span class="hljs-keyword">new</span> GlideAjax(<span class="hljs-string">"AttachmentAjax"</span>);
  ajax.addParam(<span class="hljs-string">"sysparm_value"</span>, image_id);
  ajax.addParam(<span class="hljs-string">"sysparm_type"</span>, <span class="hljs-string">"delete"</span>);
  ajax.getXML(doNothing);
  <span class="hljs-keyword">var</span> image = $(image_id);
  <span class="hljs-keyword">if</span> (image) {
    image.src = <span class="hljs-string">"images/s.gif"</span>;
    image.alt = <span class="hljs-string">""</span>;
  }
  <span class="hljs-keyword">var</span> delspan = $(image_id + <span class="hljs-string">"_delete"</span>);
  <span class="hljs-keyword">if</span> (delspan)
    delspan.innerHTML = <span class="hljs-string">''</span>;
  <span class="hljs-keyword">var</span> addanchor = $(image_id + <span class="hljs-string">"_update"</span>);
  <span class="hljs-keyword">if</span> (addanchor)
    addanchor.innerHTML = <span class="hljs-string">""</span>;
  <span class="hljs-keyword">var</span> imagespan = $(image_id + <span class="hljs-string">"_image"</span>);
  <span class="hljs-keyword">if</span> (imagespan)
    imagespan.style.visibiity = <span class="hljs-string">"hidden"</span>;
  <span class="hljs-keyword">var</span> noimagespan = $(image_id + <span class="hljs-string">"_noimage"</span>);
  <span class="hljs-keyword">if</span> (noimagespan)
    noimagespan.style.visibility = <span class="hljs-string">""</span>;
  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
};
<span class="hljs-comment">/*! RESOURCE: /scripts/formatting.js */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">formatPhone</span>(<span class="hljs-params">field</span>) </span>{
  field.value = trim(field.value);
  <span class="hljs-keyword">var</span> ov = field.value;
  <span class="hljs-keyword">var</span> v = <span class="hljs-string">""</span>;
  <span class="hljs-keyword">var</span> x = <span class="hljs-number">-1</span>;
  <span class="hljs-keyword">if</span> (<span class="hljs-number">0</span> &lt; ov.length &amp;&amp; <span class="hljs-string">'+'</span> != ov.charAt(<span class="hljs-number">0</span>)) {
    <span class="hljs-keyword">var</span> n = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-string">'1'</span> == ov.charAt(<span class="hljs-number">0</span>)) {
      ov = ov.substring(<span class="hljs-number">1</span>, ov.length);
    }
    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; ov.length; i++) {
      <span class="hljs-keyword">var</span> ch = ov.charAt(i);
      <span class="hljs-keyword">if</span> (ch &gt;= <span class="hljs-string">'0'</span> &amp;&amp; ch &lt;= <span class="hljs-string">'9'</span>) {
        <span class="hljs-keyword">if</span> (n == <span class="hljs-number">0</span>) v += <span class="hljs-string">"("</span>;
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (n == <span class="hljs-number">3</span>) v += <span class="hljs-string">") "</span>;
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (n == <span class="hljs-number">6</span>) v += <span class="hljs-string">"-"</span>;
        v += ch;
        n++;
      }
      <span class="hljs-keyword">if</span> (!(ch &gt;= <span class="hljs-string">'0'</span> &amp;&amp; ch &lt;= <span class="hljs-string">'9'</span>) &amp;&amp; ch != <span class="hljs-string">' '</span> &amp;&amp; ch != <span class="hljs-string">'-'</span> &amp;&amp; ch != <span class="hljs-string">'.'</span> &amp;&amp; ch != <span class="hljs-string">'('</span> &amp;&amp; ch != <span class="hljs-string">')'</span>) {
        x = i;
        <span class="hljs-keyword">break</span>;
      }
    }
    <span class="hljs-keyword">if</span> (x &gt;= <span class="hljs-number">0</span>) v += <span class="hljs-string">" "</span> + ov.substring(x, ov.length);
    <span class="hljs-keyword">if</span> (n == <span class="hljs-number">10</span> &amp;&amp; v.length &lt;= <span class="hljs-number">40</span>) field.value = v;
  }
  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">formatClean</span>(<span class="hljs-params">num</span>) </span>{
  <span class="hljs-keyword">var</span> sVal = <span class="hljs-string">''</span>;
  <span class="hljs-keyword">var</span> nVal = num.length;
  <span class="hljs-keyword">var</span> sChar = <span class="hljs-string">''</span>;
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; nVal; i++) {
      sChar = num.charAt(i);
      nChar = sChar.charCodeAt(<span class="hljs-number">0</span>);
      <span class="hljs-keyword">if</span> (sChar == <span class="hljs-string">'-'</span> || sChar == getDecimalSeparator() || ((nChar &gt;= <span class="hljs-number">48</span>) &amp;&amp; (nChar &lt;= <span class="hljs-number">57</span>))) {
        sVal += num.charAt(i);
      }
    }
  } <span class="hljs-keyword">catch</span> (exception) {
    alertError(<span class="hljs-string">"formatClean"</span>, exception);
  }
  <span class="hljs-keyword">return</span> sVal;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">formatCurrency</span>(<span class="hljs-params">num</span>) </span>{
  <span class="hljs-keyword">var</span> sVal = <span class="hljs-string">''</span>;
  <span class="hljs-keyword">var</span> minus = <span class="hljs-string">''</span>;
  <span class="hljs-keyword">if</span> (num.lastIndexOf(<span class="hljs-string">"-"</span>) == <span class="hljs-number">0</span>) {
    minus = <span class="hljs-string">'-'</span>;
  }
  <span class="hljs-keyword">if</span> (num.lastIndexOf(<span class="hljs-string">"."</span>) &lt; <span class="hljs-number">0</span>) {
    num = num + <span class="hljs-string">'00'</span>;
  }
  num = formatClean(num);
  sVal = minus + formatDollar(num, getGroupingSeparator()) + getDecimalSeparator() + formatCents(num);
  <span class="hljs-keyword">return</span> sVal;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">formatNumber</span>(<span class="hljs-params">num</span>) </span>{
  <span class="hljs-keyword">if</span> (num.length == <span class="hljs-number">0</span>)
    <span class="hljs-keyword">return</span> num;
  num = <span class="hljs-keyword">new</span> <span class="hljs-built_in">String</span>(num);
  <span class="hljs-keyword">var</span> sVal = <span class="hljs-string">''</span>;
  <span class="hljs-keyword">var</span> minus = <span class="hljs-string">''</span>;
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">if</span> (num.lastIndexOf(<span class="hljs-string">"-"</span>) == <span class="hljs-number">0</span>) {
      minus = <span class="hljs-string">'-'</span>;
    }
    num = formatClean(num);
    <span class="hljs-keyword">if</span> (num.indexOf(<span class="hljs-string">"-"</span>) == <span class="hljs-number">0</span>)
      num = num.substring(<span class="hljs-number">1</span>);
    num = <span class="hljs-string">"0"</span> + num;
    <span class="hljs-keyword">var</span> fraction = parseFraction(<span class="hljs-keyword">new</span> <span class="hljs-built_in">String</span>(num));
    num = <span class="hljs-built_in">parseInt</span>(num, <span class="hljs-number">10</span>);
    <span class="hljs-keyword">var</span> samount = <span class="hljs-keyword">new</span> <span class="hljs-built_in">String</span>(num);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-built_in">Math</span>.floor((samount.length - (<span class="hljs-number">1</span> + i)) / <span class="hljs-number">3</span>); i++) {
      samount = samount.substring(<span class="hljs-number">0</span>, samount.length - (<span class="hljs-number">4</span> * i + <span class="hljs-number">3</span>)) + getGroupingSeparator() + samount.substring(samount.length - (<span class="hljs-number">4</span> * i + <span class="hljs-number">3</span>));
    }
    <span class="hljs-keyword">if</span> (fraction.length &gt; <span class="hljs-number">0</span>) {
      fraction = getDecimalSeparator() + fraction;
      samount += fraction;
    }
  } <span class="hljs-keyword">catch</span> (exception) {
    alertError(<span class="hljs-string">"Format Number"</span>, exception);
  }
  <span class="hljs-keyword">return</span> minus + samount;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">parseFraction</span>(<span class="hljs-params">num</span>) </span>{
  <span class="hljs-keyword">var</span> index = num.indexOf(getDecimalSeparator());
  <span class="hljs-keyword">if</span> (index == <span class="hljs-number">-1</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-string">""</span>;
  <span class="hljs-keyword">return</span> num.substring(index + <span class="hljs-number">1</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">formatCents</span>(<span class="hljs-params">amount</span>) </span>{
  <span class="hljs-keyword">var</span> cents = <span class="hljs-string">''</span>;
  <span class="hljs-keyword">try</span> {
    amount = <span class="hljs-built_in">parseInt</span>(amount, <span class="hljs-number">10</span>);
    <span class="hljs-keyword">var</span> samount = <span class="hljs-keyword">new</span> <span class="hljs-built_in">String</span>(amount);
    <span class="hljs-keyword">if</span> (samount.length == <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-string">'00'</span>;
    }
    <span class="hljs-keyword">if</span> (samount.length == <span class="hljs-number">1</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-string">'0'</span> + samount;
    }
    <span class="hljs-keyword">if</span> (samount.length == <span class="hljs-number">2</span>) {
      <span class="hljs-keyword">return</span> samount;
    }
    cents = samount.substring(samount.length - <span class="hljs-number">2</span>, samount.length);
  } <span class="hljs-keyword">catch</span> (exception) {
    alertError(<span class="hljs-string">"Format Cents"</span>, e);
  }
  <span class="hljs-keyword">return</span> cents;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">formatDollar</span>(<span class="hljs-params">amount</span>) </span>{
  <span class="hljs-keyword">try</span> {
    amount = <span class="hljs-built_in">parseInt</span>(amount, <span class="hljs-number">10</span>);
    <span class="hljs-keyword">var</span> samount = <span class="hljs-keyword">new</span> <span class="hljs-built_in">String</span>(amount);
    <span class="hljs-keyword">if</span> (samount.length &lt; <span class="hljs-number">3</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
    samount = samount.substring(<span class="hljs-number">0</span>, samount.length - <span class="hljs-number">2</span>);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-built_in">Math</span>.floor((samount.length - (<span class="hljs-number">1</span> + i)) / <span class="hljs-number">3</span>); i++) {
      samount = samount.substring(<span class="hljs-number">0</span>, samount.length - (<span class="hljs-number">4</span> * i + <span class="hljs-number">3</span>)) + getGroupingSeparator() + samount.substring(samount.length - (<span class="hljs-number">4</span> * i + <span class="hljs-number">3</span>));
    }
  } <span class="hljs-keyword">catch</span> (exception) {
    alertError(<span class="hljs-string">"Format Dollar"</span>, e);
  }
  <span class="hljs-keyword">return</span> samount;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">padLeft</span>(<span class="hljs-params">value, width, fill</span>) </span>{
  value = value + <span class="hljs-string">''</span>;
  <span class="hljs-keyword">while</span> (value.length &lt; width)
    value = fill + value;
  <span class="hljs-keyword">return</span> value;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getDecimalSeparator</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">if</span> (g_user_decimal_separator)
    <span class="hljs-keyword">return</span> g_user_decimal_separator;
  <span class="hljs-keyword">return</span> <span class="hljs-string">"."</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getGroupingSeparator</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">if</span> (g_user_grouping_separator)
    <span class="hljs-keyword">return</span> g_user_grouping_separator;
  <span class="hljs-keyword">return</span> <span class="hljs-string">","</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">alertError</span>(<span class="hljs-params">MethodName, e</span>) </span>{
  <span class="hljs-keyword">if</span> (e.description == <span class="hljs-literal">null</span>) {
    alert(MethodName + <span class="hljs-string">" Exception: "</span> + e.message);
  } <span class="hljs-keyword">else</span> {
    alert(MethodName + <span class="hljs-string">" Exception: "</span> + e.description);
  }
};
<span class="hljs-comment">/*! RESOURCE: /scripts/doctype/utils14.js */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">doNothing</span>(<span class="hljs-params"></span>) </span>{}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">valueExistsInArray</span>(<span class="hljs-params">val, array</span>) </span>{
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; array.length; i++) {
    <span class="hljs-keyword">if</span> (val == array[i])
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  }
  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">doubleDigitFormat</span>(<span class="hljs-params">num</span>) </span>{
  <span class="hljs-keyword">return</span> padLeft(num, <span class="hljs-number">2</span>, <span class="hljs-string">"0"</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">tripleDigitFormat</span>(<span class="hljs-params">num</span>) </span>{
  <span class="hljs-keyword">return</span> padLeft(num, <span class="hljs-number">3</span>, <span class="hljs-string">"0"</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sGetHours</span>(<span class="hljs-params">totalSecs</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-built_in">parseInt</span>(totalSecs / (<span class="hljs-number">60</span> * <span class="hljs-number">60</span>), <span class="hljs-number">10</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sGetMinutes</span>(<span class="hljs-params">totalSecs</span>) </span>{
  totalSecs -= (<span class="hljs-number">60</span> * <span class="hljs-number">60</span>) * sGetHours(totalSecs);
  <span class="hljs-keyword">return</span> <span class="hljs-built_in">parseInt</span>(totalSecs / <span class="hljs-number">60</span>, <span class="hljs-number">10</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sGetSeconds</span>(<span class="hljs-params">totalSecs</span>) </span>{
  totalSecs -= (<span class="hljs-number">60</span> * <span class="hljs-number">60</span>) * sGetHours(totalSecs);
  totalSecs -= (<span class="hljs-number">60</span>) * sGetMinutes(totalSecs);
  <span class="hljs-keyword">return</span> <span class="hljs-built_in">parseInt</span>(totalSecs, <span class="hljs-number">10</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isNumber</span>(<span class="hljs-params">test</span>) </span>{
  <span class="hljs-keyword">if</span> (!test)
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  test = <span class="hljs-keyword">new</span> <span class="hljs-built_in">String</span>(test);
  <span class="hljs-keyword">var</span> _numer = test.search(<span class="hljs-string">"[^0-9]"</span>);
  <span class="hljs-keyword">return</span> _numer == <span class="hljs-number">-1</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isAlphaNum</span>(<span class="hljs-params">thchar</span>) </span>{
  <span class="hljs-keyword">return</span> isAlpha(thchar) || isDigit(thchar);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isAlpha</span>(<span class="hljs-params">thchar</span>) </span>{
  <span class="hljs-keyword">return</span> (thchar &gt;= <span class="hljs-string">'a'</span> &amp;&amp; thchar &lt;= <span class="hljs-string">'z\uffff'</span>) || (thchar &gt;= <span class="hljs-string">'A'</span> &amp;&amp; thchar &lt;= <span class="hljs-string">'Z\uffff'</span>) || thchar == <span class="hljs-string">'_'</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isDigit</span>(<span class="hljs-params">thchar</span>) </span>{
  <span class="hljs-keyword">return</span> (thchar &gt;= <span class="hljs-string">'0'</span> &amp;&amp; thchar &lt;= <span class="hljs-string">'9'</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">containsOnlyChars</span>(<span class="hljs-params">validChars, sText</span>) </span>{
  <span class="hljs-keyword">if</span> (!sText)
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; sText.length; i++) {
    <span class="hljs-keyword">var</span> c = sText.charAt(i);
    <span class="hljs-keyword">if</span> (validChars.indexOf(c) == <span class="hljs-number">-1</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  }
  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getAttributeValue</span>(<span class="hljs-params">element, attrName</span>) </span>{
  <span class="hljs-keyword">return</span> element.getAttribute(attrName);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setAttributeValue</span>(<span class="hljs-params">element, attrName, value</span>) </span>{
  element.setAttribute(attrName, value);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toggleDivDisplayAndReturn</span>(<span class="hljs-params">divName</span>) </span>{
  <span class="hljs-keyword">if</span> (!divName)
    <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">var</span> div = $(divName);
  <span class="hljs-keyword">if</span> (!div)
    <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">if</span> (div.style.display == <span class="hljs-string">"none"</span>)
    showObject(div);
  <span class="hljs-keyword">else</span>
    hideObject(div);
  <span class="hljs-keyword">return</span> div;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toggleDivDisplay</span>(<span class="hljs-params">divName</span>) </span>{
  toggleDivDisplayAndReturn(divName);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">findParentByTag</span>(<span class="hljs-params">element, tag</span>) </span>{
  <span class="hljs-keyword">var</span> ret;
  <span class="hljs-keyword">while</span> (element &amp;&amp; element.parentNode &amp;&amp; element.parentNode.tagName) {
    element = element.parentNode;
    <span class="hljs-keyword">if</span> (element.tagName.toLowerCase() == tag.toLowerCase())
      <span class="hljs-keyword">return</span> element;
  }
  <span class="hljs-keyword">return</span> ret;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">replaceAll</span>(<span class="hljs-params">str, from, to</span>) </span>{
  <span class="hljs-keyword">var</span> idx = str.indexOf(<span class="hljs-keyword">from</span>);
  <span class="hljs-keyword">while</span> (idx &gt; <span class="hljs-number">-1</span>) {
    str = str.replace(<span class="hljs-keyword">from</span>, to);
    idx = str.indexOf(<span class="hljs-keyword">from</span>);
  }
  <span class="hljs-keyword">return</span> str;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useAnimation</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">if</span> (isTouchDevice)
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">expandEffect</span>(<span class="hljs-params">el, duration, steps, stepCallback, completionCallback</span>) </span>{
  <span class="hljs-keyword">if</span> (!useAnimation()) {
    showObject(el);
    <span class="hljs-keyword">if</span> (completionCallback)
      completionCallback(el);
    <span class="hljs-keyword">return</span>;
  }
  <span class="hljs-keyword">var</span> h;
  <span class="hljs-keyword">if</span> (el.originalHeight)
    h = el.originalHeight;
  <span class="hljs-keyword">else</span> {
    h = getHeight(el);
    <span class="hljs-keyword">if</span> (h == <span class="hljs-number">0</span>) {
      showObject(el);
      <span class="hljs-keyword">return</span>;
    }
    el.originalHeight = h;
  }
  <span class="hljs-keyword">if</span> (!duration)
    duration = <span class="hljs-number">70</span>;
  <span class="hljs-keyword">if</span> (!steps)
    steps = <span class="hljs-number">14</span>;
  el.style.overflow = <span class="hljs-string">"hidden"</span>;
  el.style.height = <span class="hljs-string">"1px"</span>;
  el.style.display = <span class="hljs-string">"block"</span>;
  el.style.visibility = <span class="hljs-string">"visible"</span>;
  expandAnimationEffect(el, h, duration, steps, stepCallback, completionCallback);
  <span class="hljs-keyword">return</span> h;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">expandAnimationEffect</span>(<span class="hljs-params">el, height, duration, steps, stepCallback, completionCallback</span>) </span>{
  <span class="hljs-keyword">new</span> Rico.Effect.Size(el.id, <span class="hljs-literal">null</span>, height, duration, steps, {
    <span class="hljs-attr">step</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">if</span> (stepCallback)
        stepCallback(el);
    },
    <span class="hljs-attr">complete</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      _expandComplete(el, completionCallback);
    }
  });
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_expandComplete</span>(<span class="hljs-params">el, completionCallback</span>) </span>{
  el.style.overflow = <span class="hljs-string">""</span>;
  el.style.height = <span class="hljs-string">"auto"</span>;
  <span class="hljs-keyword">if</span> (completionCallback)
    completionCallback(el);
  _frameChanged();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">collapseEffect</span>(<span class="hljs-params">el, duration, steps</span>) </span>{
  <span class="hljs-keyword">if</span> (!useAnimation()) {
    hideObject(el);
    <span class="hljs-keyword">return</span>;
  }
  <span class="hljs-keyword">var</span> h;
  <span class="hljs-keyword">if</span> (el.originalHeight)
    h = el.originalHeight;
  <span class="hljs-keyword">else</span> {
    h = el.offsetHeight;
    el.originalHeight = h;
  }
  <span class="hljs-keyword">if</span> (!duration)
    duration = <span class="hljs-number">70</span>;
  <span class="hljs-keyword">if</span> (!steps)
    steps = <span class="hljs-number">14</span>;
  <span class="hljs-keyword">if</span> (!h)
    h = el.offsetHeight;
  el.style.overflow = <span class="hljs-string">"hidden"</span>;
  collapseAnimationEffect(el, h, duration, steps);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">collapseAnimationEffect</span>(<span class="hljs-params">el, height, duration, steps</span>) </span>{
  <span class="hljs-keyword">new</span> Rico.Effect.Size(el.id, <span class="hljs-literal">null</span>, <span class="hljs-number">1</span>, duration, steps, {
    <span class="hljs-attr">complete</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      _collapseComplete(el, height);
    }
  });
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_collapseComplete</span>(<span class="hljs-params">el, height</span>) </span>{
  el.style.display = <span class="hljs-string">"none"</span>;
  el.style.overflow = <span class="hljs-string">""</span>;
  el.style.height = height;
  _frameChanged();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getHeight</span>(<span class="hljs-params">el</span>) </span>{
  <span class="hljs-keyword">var</span> item;
  <span class="hljs-keyword">try</span> {
    item = el.cloneNode(<span class="hljs-literal">true</span>);
  } <span class="hljs-keyword">catch</span> (e) {
    jslog(<span class="hljs-string">"getHeight blew up... we caught the error and returned 0"</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
  }
  <span class="hljs-keyword">var</span> height = <span class="hljs-number">0</span>;
  item.style.visibility = <span class="hljs-string">"hidden"</span>;
  item.style.display = <span class="hljs-string">"block"</span>;
  item.style.position = <span class="hljs-string">"absolute"</span>;
  item.style.top = <span class="hljs-number">0</span>;
  item.style.left = <span class="hljs-number">0</span>;
  <span class="hljs-built_in">document</span>.body.appendChild(item);
  height = item.offsetHeight;
  <span class="hljs-built_in">document</span>.body.removeChild(item);
  <span class="hljs-keyword">return</span> height;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getWidth</span>(<span class="hljs-params">el</span>) </span>{
  <span class="hljs-keyword">var</span> item = el.cloneNode(<span class="hljs-literal">true</span>);
  <span class="hljs-keyword">var</span> width = <span class="hljs-number">0</span>;
  item.style.visibility = <span class="hljs-string">"hidden"</span>;
  item.style.display = <span class="hljs-string">"block"</span>;
  item.style.position = <span class="hljs-string">"absolute"</span>;
  item.style.top = <span class="hljs-number">0</span>;
  item.style.left = <span class="hljs-number">0</span>;
  <span class="hljs-built_in">document</span>.body.appendChild(item);
  width = item.offsetWidth;
  <span class="hljs-built_in">document</span>.body.removeChild(item);
  <span class="hljs-keyword">return</span> width;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">grabOffsetLeft</span>(<span class="hljs-params">item</span>) </span>{
  <span class="hljs-keyword">return</span> getOffset(item, <span class="hljs-string">"offsetLeft"</span>)
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">grabOffsetTop</span>(<span class="hljs-params">item</span>) </span>{
  <span class="hljs-keyword">return</span> getOffset(item, <span class="hljs-string">"offsetTop"</span>)
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getOffset</span>(<span class="hljs-params">item, attr</span>) </span>{
  <span class="hljs-keyword">var</span> parentElement = getFormContentParent();
  <span class="hljs-keyword">var</span> wb = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">while</span> (item) {
    wb += item[attr];
    item = item.offsetParent;
    <span class="hljs-keyword">if</span> (item == parentElement)
      <span class="hljs-keyword">break</span>;
  }
  <span class="hljs-keyword">return</span> wb;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">grabScrollLeft</span>(<span class="hljs-params">item</span>) </span>{
  <span class="hljs-keyword">return</span> getScrollOffset(item, <span class="hljs-string">"scrollLeft"</span>)
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">grabScrollTop</span>(<span class="hljs-params">item</span>) </span>{
  <span class="hljs-keyword">return</span> getScrollOffset(item, <span class="hljs-string">"scrollTop"</span>)
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getScrollOffset</span>(<span class="hljs-params">item, attr</span>) </span>{
  <span class="hljs-keyword">var</span> parentElement = getFormContentParent();
  <span class="hljs-keyword">var</span> wb = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">while</span> (item &amp;&amp; item.tagName &amp;&amp; item != parentElement) {
    wb += item[attr];
    <span class="hljs-keyword">if</span> (isMSIE)
      item = item.offsetParent;
    <span class="hljs-keyword">else</span>
      item = item.parentNode;
  }
  <span class="hljs-keyword">return</span> wb;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getValue</span>(<span class="hljs-params">evt</span>) </span>{
  <span class="hljs-keyword">var</span> elem = evt.target;
  <span class="hljs-keyword">if</span> (!elem)
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">return</span> elem.options[elem.selectedIndex].value;
  } <span class="hljs-keyword">catch</span> (e) {
    <span class="hljs-keyword">var</span> msg = (<span class="hljs-keyword">typeof</span> e == <span class="hljs-string">"string"</span>) ? e : ((e.message) ? e.message : <span class="hljs-string">"Unknown Error"</span>);
    alert(<span class="hljs-string">"Unable to get data:\n"</span> + msg);
  }
  <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getEvent</span>(<span class="hljs-params">event</span>) </span>{
  <span class="hljs-keyword">return</span> event;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getEventCoords</span>(<span class="hljs-params">e</span>) </span>{
  <span class="hljs-keyword">var</span> fudge = getFormContentParent();
  <span class="hljs-keyword">var</span> answer = Event.pointer(e);
  answer = <span class="hljs-keyword">new</span> Point(answer.x, answer.y);
  <span class="hljs-keyword">if</span> (fudge == <span class="hljs-built_in">document</span>.body)
    <span class="hljs-keyword">return</span> answer;
  answer.x += fudge.scrollLeft;
  answer.y += fudge.scrollTop;
  <span class="hljs-keyword">var</span> fudgeTop = fudge.getStyle(<span class="hljs-string">'top'</span>);
  <span class="hljs-keyword">var</span> fudgePos = fudge.getStyle(<span class="hljs-string">'position'</span>);
  <span class="hljs-keyword">if</span> (fudgePos == <span class="hljs-string">'absolute'</span> &amp;&amp; fudgeTop &amp;&amp; fudgeTop.indexOf(<span class="hljs-string">'px'</span>))
    answer.y -= <span class="hljs-built_in">parseInt</span>(fudgeTop.replace(<span class="hljs-string">'px'</span>, <span class="hljs-string">''</span>));
  <span class="hljs-keyword">return</span> answer;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getRelativeTop</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> port = <span class="hljs-built_in">document</span>.viewport;
  <span class="hljs-keyword">var</span> topLeft = <span class="hljs-keyword">new</span> Point(port.getScrollOffsets().left, port.getScrollOffsets().top)
  <span class="hljs-keyword">var</span> fudge = getFormContentParent();
  <span class="hljs-keyword">if</span> (fudge != <span class="hljs-built_in">document</span>.body) {
    topLeft.x += fudge.scrollLeft;
    topLeft.y += fudge.scrollTop;
  }
  <span class="hljs-keyword">return</span> topLeft;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getRealEvent</span>(<span class="hljs-params">e</span>) </span>{
  <span class="hljs-keyword">if</span> (isTouchDevice &amp;&amp; isTouchEvent(e)) {
    e = e.changedTouches[<span class="hljs-number">0</span>];
  }
  <span class="hljs-keyword">return</span> e;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isTouchEvent</span>(<span class="hljs-params">e</span>) </span>{
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> e == <span class="hljs-string">'undefined'</span> || <span class="hljs-keyword">typeof</span> e.changedTouches == <span class="hljs-string">'undefined'</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isTouchRightClick</span>(<span class="hljs-params">e</span>) </span>{
  <span class="hljs-keyword">if</span> (!isTouchEvent(e))
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  <span class="hljs-keyword">var</span> hasTwoFingers = e.changedTouches.length &gt; <span class="hljs-number">1</span>;
  <span class="hljs-keyword">return</span> hasTwoFingers;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getTextValue</span>(<span class="hljs-params">node</span>) </span>{
  <span class="hljs-keyword">if</span> (node.textContent)
    <span class="hljs-keyword">return</span> node.textContent;
  <span class="hljs-keyword">var</span> firstNode = node.childNodes[<span class="hljs-number">0</span>];
  <span class="hljs-keyword">if</span> (!firstNode)
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">if</span> (firstNode.data)
    <span class="hljs-keyword">return</span> firstNode.data;
  <span class="hljs-keyword">return</span> firstNode.nodeValue;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getScrollX</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-built_in">window</span>.pageXOffset;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getScrollY</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-built_in">window</span>.pageYOffset;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getSrcElement</span>(<span class="hljs-params">evt</span>) </span>{
  <span class="hljs-keyword">return</span> evt.target;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addForm</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> form = cel(<span class="hljs-string">'form'</span>);
  <span class="hljs-built_in">document</span>.body.appendChild(form);
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.g_ck)
    addHidden(form, <span class="hljs-string">"sysparm_ck"</span>, g_ck);
  <span class="hljs-keyword">return</span> form;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addHidden</span>(<span class="hljs-params">form, name, value</span>) </span>{
  addInput(form, <span class="hljs-string">'HIDDEN'</span>, name, value);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addInput</span>(<span class="hljs-params">form, type, name, value</span>) </span>{
  <span class="hljs-keyword">var</span> inputs = Form.getInputs(form, <span class="hljs-string">''</span>, name);
  <span class="hljs-keyword">if</span> (inputs.length &gt; <span class="hljs-number">0</span>) {
    inputs[<span class="hljs-number">0</span>].value = value;
    <span class="hljs-keyword">return</span>;
  }
  <span class="hljs-keyword">var</span> opt = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'input'</span>);
  opt.type = type;
  opt.name = name;
  opt.id = name;
  opt.value = value;
  form.appendChild(opt);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getHiddenInputValuesMap</span>(<span class="hljs-params">parent</span>) </span>{
  <span class="hljs-keyword">var</span> valuesMap = {}
  <span class="hljs-keyword">var</span> inputs = parent.getElementsByTagName(<span class="hljs-string">'input'</span>);
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; inputs.length; i++) {
    <span class="hljs-keyword">var</span> input = inputs[i];
    <span class="hljs-keyword">if</span> (input.type.toLowerCase() != <span class="hljs-string">"hidden"</span>)
      <span class="hljs-keyword">continue</span>;
    valuesMap[input.id] = input.value;
  }
  <span class="hljs-keyword">return</span> valuesMap;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">appendSelectOption</span>(<span class="hljs-params">select, value, label, index</span>) </span>{
  <span class="hljs-keyword">var</span> opt = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"option"</span>);
  opt.value = value;
  opt.appendChild(label);
  <span class="hljs-keyword">if</span> (index &gt;= <span class="hljs-number">0</span> &amp;&amp; index != select.length)
    select.insertBefore(opt, select.children[index]);
  <span class="hljs-keyword">else</span>
    select.appendChild(opt);
  <span class="hljs-keyword">return</span> opt;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">copySelectOptionToIndex</span>(<span class="hljs-params">select, opt, index</span>) </span>{
  <span class="hljs-keyword">var</span> label = opt.text;
  opt.innerHTML = <span class="hljs-string">""</span>;
  opt.appendChild(<span class="hljs-built_in">document</span>.createTextNode(label));
  <span class="hljs-keyword">if</span> (index &gt;= <span class="hljs-number">0</span> &amp;&amp; index != select.length)
    select.insertBefore(opt, select.children[index]);
  <span class="hljs-keyword">else</span>
    select.appendChild(opt);
  <span class="hljs-keyword">return</span> opt;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">selectMenuItem</span>(<span class="hljs-params">id, selectName</span>) </span>{
  <span class="hljs-keyword">var</span> selectMenu = <span class="hljs-built_in">document</span>.getElementById(selectName);
  <span class="hljs-keyword">if</span> (!selectMenu)
    <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;
  <span class="hljs-keyword">var</span> options = selectMenu.options;
  <span class="hljs-keyword">var</span> selectItem = selectMenu.selectedIndex;
  <span class="hljs-keyword">if</span> (id) {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; options.length; i++) {
      <span class="hljs-keyword">var</span> option = options[i];
      <span class="hljs-keyword">if</span> (option.value == id) {
        selectItem = i;
        <span class="hljs-keyword">break</span>;
      }
    }
  }
  <span class="hljs-keyword">if</span> (selectItem &gt; <span class="hljs-number">0</span>) {
    selectMenu.selectedIndex = selectItem;
    <span class="hljs-keyword">if</span> (selectMenu[<span class="hljs-string">"onchange"</span>]) {
      selectMenu.onchange();
    }
  }
  <span class="hljs-keyword">return</span> selectItem;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">menuIsEmpty</span>(<span class="hljs-params">selectName</span>) </span>{
  <span class="hljs-keyword">var</span> selectMenu = <span class="hljs-built_in">document</span>.getElementById(selectName);
  <span class="hljs-keyword">if</span> (!selectMenu || selectMenu.selectedIndex &lt;= <span class="hljs-number">0</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getBounds</span>(<span class="hljs-params">obj, addScroll</span>) </span>{
  <span class="hljs-keyword">var</span> x = grabOffsetLeft(obj);
  <span class="hljs-keyword">var</span> y = grabOffsetTop(obj);
  <span class="hljs-keyword">if</span> (addScroll) {
    x += getScrollX();
    y += getScrollY();
  }
  <span class="hljs-keyword">this</span>.absoluteRect = {
    <span class="hljs-attr">top</span>: y,
    <span class="hljs-attr">left</span>: x,
    <span class="hljs-attr">bottom</span>: y + obj.offsetHeight,
    <span class="hljs-attr">right</span>: x + obj.offsetWidth,
    <span class="hljs-attr">height</span>: obj.offsetHeight,
    <span class="hljs-attr">width</span>: obj.offsetWidth,
    <span class="hljs-attr">middleX</span>: x + (obj.offsetWidth / <span class="hljs-number">2</span>),
    <span class="hljs-attr">middleY</span>: y + (obj.offsetHeight / <span class="hljs-number">2</span>),
    <span class="hljs-attr">cbottom</span>: y + obj.clientHeight,
    <span class="hljs-attr">cright</span>: x + obj.clientWidth
  };
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.absoluteRect;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">guid</span>(<span class="hljs-params">l</span>) </span>{
  <span class="hljs-keyword">var</span> l = l || <span class="hljs-number">32</span>,
    strResult = <span class="hljs-string">''</span>;
  <span class="hljs-keyword">while</span> (strResult.length &lt; l)
    strResult += (((<span class="hljs-number">1</span> + <span class="hljs-built_in">Math</span>.random() + <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().getTime()) * <span class="hljs-number">0x10000</span>) | <span class="hljs-number">0</span>).toString(<span class="hljs-number">16</span>).substring(<span class="hljs-number">1</span>);
  <span class="hljs-keyword">return</span> strResult.substr(<span class="hljs-number">0</span>, l);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">stopSelection</span>(<span class="hljs-params">e</span>) </span>{
  e.onselectstart = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  };
  e.style.MozUserSelect = <span class="hljs-string">"none"</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">restoreSelection</span>(<span class="hljs-params">e</span>) </span>{
  e.onselectstart = <span class="hljs-literal">null</span>;
  e.style.MozUserSelect = <span class="hljs-string">""</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getAttributeValue</span>(<span class="hljs-params">element, name</span>) </span>{
  <span class="hljs-keyword">if</span> (!element.attributes)
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">var</span> v = element.attributes.getNamedItem(name);
  <span class="hljs-keyword">if</span> (v == <span class="hljs-literal">null</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">return</span> v.nodeValue;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createImage</span>(<span class="hljs-params">src, title, object, onClick</span>) </span>{
  <span class="hljs-keyword">var</span> img = cel(<span class="hljs-string">'input'</span>);
  img.type = <span class="hljs-string">'image'</span>;
  img.src = src;
  img.title = title;
  img.alt = title;
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">arguments</span>.length == <span class="hljs-number">4</span>)
    img.onclick = onClick.bindAsEventListener(object);
  <span class="hljs-keyword">return</span> img;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createIcon</span>(<span class="hljs-params">cls, title, object, onClick</span>) </span>{
  <span class="hljs-keyword">var</span> icn = cel(<span class="hljs-string">'a'</span>);
  icn.addClassName(cls);
  icn.setAttribute(<span class="hljs-string">'title'</span>, title);
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">arguments</span>.length == <span class="hljs-number">4</span>)
    icn.onclick = onClick.bindAsEventListener(object);
  <span class="hljs-keyword">return</span> icn;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getXMLString</span>(<span class="hljs-params">node</span>) </span>{
  <span class="hljs-keyword">var</span> xml = <span class="hljs-string">"???"</span>;
  <span class="hljs-keyword">if</span> (node.xml) {
    xml = node.xml;
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.XMLSerializer) {
    xml = (<span class="hljs-keyword">new</span> XMLSerializer()).serializeToString(node);
  }
  <span class="hljs-keyword">return</span> xml;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isLeftClick</span>(<span class="hljs-params">e</span>) </span>{
  <span class="hljs-keyword">return</span> e.button == <span class="hljs-number">0</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">formatMessage</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">arguments</span>.length == <span class="hljs-number">1</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">arguments</span>[<span class="hljs-number">0</span>];
  <span class="hljs-keyword">var</span> str = <span class="hljs-built_in">arguments</span>[<span class="hljs-number">0</span>];
  <span class="hljs-keyword">var</span> args = <span class="hljs-built_in">arguments</span>;
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">arguments</span>.length == <span class="hljs-number">2</span> &amp;&amp; <span class="hljs-keyword">typeof</span> <span class="hljs-built_in">arguments</span>[<span class="hljs-number">1</span>] == <span class="hljs-string">'object'</span> &amp;&amp; <span class="hljs-built_in">arguments</span>[<span class="hljs-number">1</span>] <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Array</span>) {
    args = [<span class="hljs-string">''</span>].concat(<span class="hljs-built_in">arguments</span>[<span class="hljs-number">1</span>]);
  }
  <span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">while</span> (++i &lt; args.length) {
    str = str.replace(<span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(<span class="hljs-string">'\\{'</span> + (i - <span class="hljs-number">1</span>) + <span class="hljs-string">'\\}'</span>, <span class="hljs-string">'g'</span>), args[i]);
  }
  <span class="hljs-keyword">return</span> str;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getFormattedDateAndTime</span>(<span class="hljs-params">date</span>) </span>{
  <span class="hljs-keyword">return</span> getFormattedDate(date) + <span class="hljs-string">" "</span> + getFormattedTime(date);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getFormattedDate</span>(<span class="hljs-params">date</span>) </span>{
  <span class="hljs-keyword">var</span> d = (date ? date : <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>());
  <span class="hljs-keyword">var</span> curr_mon = d.getMonth() + <span class="hljs-number">1</span>;
  <span class="hljs-keyword">var</span> curr_day = d.getDate();
  <span class="hljs-keyword">var</span> curr_year = d.getYear() - <span class="hljs-number">100</span>;
  <span class="hljs-keyword">return</span> doubleDigitFormat(curr_mon) + <span class="hljs-string">"/"</span> + doubleDigitFormat(curr_day) + <span class="hljs-string">"/"</span> + doubleDigitFormat(curr_year)
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getFormattedTime</span>(<span class="hljs-params">date</span>) </span>{
  <span class="hljs-keyword">var</span> d = (date ? date : <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>());
  <span class="hljs-keyword">var</span> curr_hour = d.getHours();
  <span class="hljs-keyword">var</span> curr_min = d.getMinutes();
  <span class="hljs-keyword">var</span> curr_sec = d.getSeconds();
  <span class="hljs-keyword">var</span> curr_msec = d.getMilliseconds();
  <span class="hljs-keyword">return</span> doubleDigitFormat(curr_hour) + <span class="hljs-string">":"</span> + doubleDigitFormat(curr_min) + <span class="hljs-string">":"</span> + doubleDigitFormat(curr_sec) + <span class="hljs-string">" ("</span> + tripleDigitFormat(curr_msec) + <span class="hljs-string">")"</span>
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">showGoToLine</span>(<span class="hljs-params">textAreaID</span>) </span>{
  <span class="hljs-keyword">var</span> e = gel(<span class="hljs-string">"go_to_"</span> + textAreaID)
  <span class="hljs-keyword">if</span> (e) {
    showObjectInline(e);
    gel(<span class="hljs-string">"go_to_input_"</span> + textAreaID).focus();
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">gotoLineKeyPress</span>(<span class="hljs-params">evt, textAreaObject, input</span>) </span>{
  <span class="hljs-keyword">if</span> (evt.keyCode == <span class="hljs-number">13</span>) {
    Event.stop(evt);
    gotoLinePopup(textAreaObject, input.value);
    input.value = <span class="hljs-string">""</span>;
    hideObject(input.parentNode);
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">gotoLinePopup</span>(<span class="hljs-params">textAreaObject, lineText</span>) </span>{
  <span class="hljs-keyword">if</span> (lineText) {
    lineText = trim(lineText);
    <span class="hljs-keyword">if</span> (lineText) {
      <span class="hljs-keyword">var</span> line = <span class="hljs-built_in">parseInt</span>(lineText, <span class="hljs-number">10</span>);
      g_form._setCaretPositionLineColumn(textAreaObject, line, <span class="hljs-number">1</span>);
    }
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getBrowserWindowHeight</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-built_in">window</span>.innerHeight;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getBrowserWindowWidth</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-built_in">window</span>.innerWidth;
}
<span class="hljs-keyword">var</span> WindowSize = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">width</span>: getBrowserWindowWidth(),
    <span class="hljs-attr">height</span>: getBrowserWindowHeight()
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getScrollBarWidthPx</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> inner = cel(<span class="hljs-string">"p"</span>);
  inner.style.width = <span class="hljs-string">"100%"</span>;
  inner.style.height = <span class="hljs-string">"200px"</span>;
  <span class="hljs-keyword">var</span> outer = cel(<span class="hljs-string">"div"</span>);
  outer.style.position = <span class="hljs-string">"absolute"</span>;
  outer.style.top = <span class="hljs-string">"0px"</span>;
  outer.style.left = <span class="hljs-string">"0px"</span>;
  outer.style.visibility = <span class="hljs-string">"hidden"</span>;
  outer.style.width = <span class="hljs-string">"200px"</span>;
  outer.style.height = <span class="hljs-string">"150px"</span>;
  outer.style.overflow = <span class="hljs-string">"hidden"</span>;
  outer.appendChild(inner);
  <span class="hljs-built_in">document</span>.body.appendChild(outer);
  <span class="hljs-keyword">var</span> w1 = inner.offsetWidth;
  outer.style.overflow = <span class="hljs-string">"scroll"</span>;
  <span class="hljs-keyword">var</span> w2 = inner.offsetWidth;
  <span class="hljs-keyword">if</span> (w1 == w2) w2 = outer.clientWidth;
  <span class="hljs-built_in">document</span>.body.removeChild(outer);
  <span class="hljs-keyword">return</span> (w1 - w2);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">showOpticsDebugger</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> mainWindow = getMainWindow();
  <span class="hljs-keyword">if</span> (mainWindow)
    mainWindow.CustomEvent.fire(<span class="hljs-string">'glide_optics_inspect_window_open'</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">opticsLog</span>(<span class="hljs-params">tablename, fieldname, message, oldvalue, newvalue</span>) </span>{
  <span class="hljs-keyword">var</span> info = {};
  info.table = tablename;
  info.field = fieldname;
  info.message = message;
  info.message_type = <span class="hljs-string">"static"</span>;
  <span class="hljs-keyword">if</span> (oldvalue &amp;&amp; newvalue) {
    info.oldvalue = oldvalue;
    info.newvalue = newvalue;
    info.message_type = <span class="hljs-string">"change"</span>;
  }
  CustomEvent.fire(<span class="hljs-string">'glide_optics_inspect_log_message'</span>, info);
};
<span class="hljs-comment">/*! RESOURCE: /scripts/accessibility_tabindex.js */</span>
addLoadEvent(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  $(<span class="hljs-built_in">document</span>).on(<span class="hljs-string">'keydown'</span>, <span class="hljs-string">'*[tabindex], .glide_ref_item_link'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>{
    <span class="hljs-keyword">if</span> (event.keyCode != Event.KEY_RETURN)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">var</span> element = event.element();
    <span class="hljs-keyword">if</span> (!element.hasAttribute(<span class="hljs-string">'tabindex'</span>))
      <span class="hljs-keyword">return</span>;
    element.click();
    event.stop();
  });
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> jQuery != <span class="hljs-string">'undefined'</span>) {
    jQuery(<span class="hljs-string">'[click-on-enter]'</span>).on(<span class="hljs-string">'keydown'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>{
      <span class="hljs-keyword">var</span> keyCode = event.keyCode || event.which;
      <span class="hljs-keyword">if</span> (keyCode != <span class="hljs-number">13</span>)
        <span class="hljs-keyword">return</span>;
      <span class="hljs-keyword">var</span> $<span class="hljs-keyword">this</span> = jQuery(<span class="hljs-keyword">this</span>);
      setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        $<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'click'</span>);
      }, <span class="hljs-number">200</span>);
    });
  }
});;
<span class="hljs-comment">/*! RESOURCE: /scripts/classes/ajax/GlideURL.js */</span>
<span class="hljs-keyword">var</span> GlideURL = Class.create({
  <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">contextPath</span>) </span>{
    <span class="hljs-keyword">this</span>.contextPath = <span class="hljs-string">''</span>;
    <span class="hljs-keyword">this</span>.params = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Object</span>();
    <span class="hljs-keyword">this</span>.encodedString = <span class="hljs-string">''</span>;
    <span class="hljs-keyword">this</span>.encode = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">this</span>.setFromString(contextPath ? contextPath : <span class="hljs-string">''</span>);
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> GlideTransactionScope != <span class="hljs-string">'undefined'</span>)
      GlideTransactionScope.appendTransactionScope(<span class="hljs-keyword">this</span>.addParam.bind(<span class="hljs-keyword">this</span>));
  },
  <span class="hljs-attr">setFromCurrent</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>.setFromString(<span class="hljs-built_in">window</span>.location.href);
  },
  <span class="hljs-attr">setFromString</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">href</span>) </span>{
    <span class="hljs-keyword">var</span> pos = href.indexOf(<span class="hljs-string">'?'</span>);
    <span class="hljs-keyword">if</span> (pos &lt; <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">this</span>.contextPath = href;
      <span class="hljs-keyword">return</span>;
    }
    <span class="hljs-keyword">this</span>.contextPath = href.slice(<span class="hljs-number">0</span>, pos);
    <span class="hljs-keyword">var</span> hashes = href.slice(pos + <span class="hljs-number">1</span>).split(<span class="hljs-string">'&amp;'</span>);
    <span class="hljs-keyword">var</span> i = hashes.length;
    <span class="hljs-keyword">while</span> (i--) {
      <span class="hljs-keyword">var</span> pos = hashes[i].indexOf(<span class="hljs-string">'='</span>);
      <span class="hljs-keyword">this</span>.params[hashes[i].substring(<span class="hljs-number">0</span>, pos)] = hashes[i].substring(++pos);
    }
  },
  <span class="hljs-attr">getContexPath</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.contextPath;
  },
  <span class="hljs-attr">getContextPath</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.contextPath;
  },
  <span class="hljs-attr">setContextPath</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">c</span>) </span>{
    <span class="hljs-keyword">this</span>.contextPath = c;
  },
  <span class="hljs-attr">getParam</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">p</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.params[p];
  },
  <span class="hljs-attr">getParams</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.params;
  },
  <span class="hljs-attr">addParam</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name, value</span>) </span>{
    <span class="hljs-keyword">this</span>.params[name] = value;
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
  },
  <span class="hljs-attr">addToken</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> g_ck != <span class="hljs-string">'undefined'</span> &amp;&amp; g_ck != <span class="hljs-string">""</span>)
      <span class="hljs-keyword">this</span>.addParam(<span class="hljs-string">'sysparm_ck'</span>, g_ck);
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
  },
  <span class="hljs-attr">deleteParam</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name</span>) </span>{
    <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.params[name];
  },
  <span class="hljs-attr">addEncodedString</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">s</span>) </span>{
    <span class="hljs-keyword">if</span> (!s)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">if</span> (s.substr(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>) != <span class="hljs-string">"&amp;"</span>)
      <span class="hljs-keyword">this</span>.encodedString += <span class="hljs-string">"&amp;"</span>;
    <span class="hljs-keyword">this</span>.encodedString += s;
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
  },
  <span class="hljs-attr">getQueryString</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">additionalParams</span>) </span>{
    qs = <span class="hljs-keyword">this</span>._getParamsForURL(<span class="hljs-keyword">this</span>.params);
    qs += <span class="hljs-keyword">this</span>._getParamsForURL(additionalParams);
    qs += <span class="hljs-keyword">this</span>.encodedString;
    <span class="hljs-keyword">if</span> (qs.length == <span class="hljs-number">0</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-string">""</span>;
    <span class="hljs-keyword">return</span> qs.substring(<span class="hljs-number">1</span>);
  },
  <span class="hljs-attr">_getParamsForURL</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">params</span>) </span>{
    <span class="hljs-keyword">if</span> (!params)
      <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>;
    <span class="hljs-keyword">var</span> url = <span class="hljs-string">''</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> n <span class="hljs-keyword">in</span> params) {
      <span class="hljs-keyword">var</span> p = params[n] || <span class="hljs-string">''</span>;
      url += <span class="hljs-string">'&amp;'</span> + n + <span class="hljs-string">'='</span> + (<span class="hljs-keyword">this</span>.encode ? <span class="hljs-built_in">encodeURIComponent</span>(p + <span class="hljs-string">''</span>) : p);
    }
    <span class="hljs-keyword">return</span> url;
  },
  <span class="hljs-attr">getURL</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">additionalParams</span>) </span>{
    <span class="hljs-keyword">var</span> url = <span class="hljs-keyword">this</span>.contextPath;
    <span class="hljs-keyword">var</span> qs = <span class="hljs-keyword">this</span>.getQueryString(additionalParams);
    <span class="hljs-keyword">if</span> (qs)
      url += <span class="hljs-string">"?"</span> + qs;
    <span class="hljs-keyword">return</span> url;
  },
  <span class="hljs-attr">setEncode</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">b</span>) </span>{
    <span class="hljs-keyword">this</span>.encode = b;
  },
  <span class="hljs-attr">toString</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-string">'GlideURL'</span>;
  }
});
GlideURL.refresh = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-built_in">window</span>.location.replace(<span class="hljs-built_in">window</span>.location.href);
};;
<span class="hljs-comment">/*! RESOURCE: /scripts/classes/ajax/GlideAjax.js */</span>
<span class="hljs-keyword">var</span> GlideAjax = Class.create(GlideURL, {
  <span class="hljs-attr">URL</span>: <span class="hljs-string">"xmlhttp.do"</span>,
  <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">initialize</span>(<span class="hljs-params">$super, processor, url</span>) </span>{
    <span class="hljs-keyword">var</span> u = <span class="hljs-keyword">this</span>.URL;
    <span class="hljs-keyword">if</span> (url)
      u = url;
    $<span class="hljs-keyword">super</span>(u);
    <span class="hljs-keyword">this</span>.setProcessor(processor);
    <span class="hljs-keyword">this</span>.callbackFunction;
    <span class="hljs-keyword">this</span>.callbackArgs;
    <span class="hljs-keyword">this</span>.additionalProcessorParams;
    <span class="hljs-keyword">this</span>.errorCallbackFunction;
    <span class="hljs-keyword">this</span>.wantRequestObject = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">this</span>.setScope(<span class="hljs-string">"global"</span>);
    <span class="hljs-keyword">this</span>.setWantSessionMessages(<span class="hljs-literal">true</span>);
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> GlideTransactionScope != <span class="hljs-string">'undefined'</span>)
      GlideTransactionScope.appendTransactionScope(<span class="hljs-keyword">this</span>.addParam.bind(<span class="hljs-keyword">this</span>), <span class="hljs-literal">true</span>);
  },
  <span class="hljs-attr">getProcessor</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.processor;
  },
  <span class="hljs-attr">getAnswer</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (!(<span class="hljs-keyword">this</span>.requestObject &amp;&amp; <span class="hljs-keyword">this</span>.requestObject.responseXML))
      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.requestObject.responseXML.documentElement.getAttribute(<span class="hljs-string">"answer"</span>);
  },
  <span class="hljs-attr">setProcessor</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">p</span>) </span>{
    <span class="hljs-keyword">this</span>.processor = p;
    <span class="hljs-keyword">this</span>.addParam(<span class="hljs-string">"sysparm_processor"</span>, p);
  },
  <span class="hljs-attr">setQueryString</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">qs</span>) </span>{
    <span class="hljs-keyword">this</span>.queryString = qs;
  },
  <span class="hljs-attr">preventLoadingIcon</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>._preventLoadingIcon = <span class="hljs-literal">true</span>;
  },
  <span class="hljs-attr">preventCancelNotification</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>._suppressCancelNotification = <span class="hljs-literal">true</span>;
  },
  <span class="hljs-attr">getXMLWait</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">additionalParams</span>) </span>{
    <span class="hljs-keyword">this</span>.addParam(<span class="hljs-string">"sysparm_synch"</span>, <span class="hljs-string">"true"</span>);
    <span class="hljs-keyword">this</span>.additionalProcessorParams = additionalParams;
    <span class="hljs-keyword">this</span>.async = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">var</span> sw = <span class="hljs-keyword">new</span> StopWatch();
    <span class="hljs-keyword">this</span>._makeRequest();
    <span class="hljs-keyword">var</span> m = <span class="hljs-string">"*** WARNING *** GlideAjax.getXMLWait - synchronous function - processor: "</span> + <span class="hljs-keyword">this</span>.processor
    sw.jslog(m);
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.console &amp;&amp; <span class="hljs-built_in">window</span>.console.log)
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"%c "</span> + m, <span class="hljs-string">'background: darkred; color: white;'</span>);
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.requestObject.status != <span class="hljs-number">200</span>)
      <span class="hljs-keyword">this</span>._handleError();
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._responseReceived();
  },
  <span class="hljs-attr">getXML</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">callback, additionalParams, responseParams</span>) </span>{
    <span class="hljs-keyword">this</span>.wantAnswer = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">this</span>._getXML0(callback, additionalParams, responseParams);
  },
  <span class="hljs-attr">getXMLAnswer</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">callback, additionalParams, responseParams</span>) </span>{
    <span class="hljs-keyword">this</span>.wantAnswer = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">this</span>._getXML0(callback, additionalParams, responseParams);
  },
  <span class="hljs-attr">_getXML0</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">callback, additionalParams, responseParams</span>) </span>{
    <span class="hljs-keyword">this</span>.callbackFunction = callback;
    <span class="hljs-keyword">this</span>.callbackArgs = responseParams;
    <span class="hljs-keyword">this</span>.additionalProcessorParams = additionalParams;
    <span class="hljs-keyword">this</span>.async = <span class="hljs-literal">true</span>;
    setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">this</span>._makeRequest();
    }.bind(<span class="hljs-keyword">this</span>), <span class="hljs-number">0</span>);
  },
  <span class="hljs-attr">_makeRequest</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>.requestObject = <span class="hljs-keyword">this</span>._getRequestObject();
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.requestObject == <span class="hljs-literal">null</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">if</span> (!GlideAjax.want_session_messages)
      <span class="hljs-keyword">this</span>.setWantSessionMessages(<span class="hljs-literal">false</span>);
    <span class="hljs-keyword">var</span> refUrl = <span class="hljs-keyword">this</span>._buildReferringURL();
    <span class="hljs-keyword">if</span> (refUrl != <span class="hljs-string">""</span>) {
      <span class="hljs-keyword">this</span>.addParam(<span class="hljs-string">'ni.nolog.x_referer'</span>, <span class="hljs-string">'ignore'</span>);
      <span class="hljs-keyword">this</span>.addParam(<span class="hljs-string">'x_referer'</span>, refUrl);
    }
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> g_autoRequest != <span class="hljs-string">'undefined'</span> &amp;&amp; <span class="hljs-string">'true'</span> == g_autoRequest)
      <span class="hljs-keyword">this</span>.addParam(<span class="hljs-string">'sysparm_auto_request'</span>, g_autoRequest);
    <span class="hljs-keyword">this</span>.postString = <span class="hljs-keyword">this</span>.getQueryString(<span class="hljs-keyword">this</span>.additionalProcessorParams);
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.queryString) {
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.postString)
        <span class="hljs-keyword">this</span>.postString += <span class="hljs-string">"&amp;"</span>;
      <span class="hljs-keyword">this</span>.postString += <span class="hljs-keyword">this</span>.queryString;
    }
    <span class="hljs-keyword">this</span>._sendRequest();
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.requestObject;
  },
  <span class="hljs-attr">_sendRequest</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>._showLoading();
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.async)
      <span class="hljs-keyword">this</span>.requestObject.onreadystatechange = <span class="hljs-keyword">this</span>._processReqChange.bind(<span class="hljs-keyword">this</span>);
    CustomEvent.fireTop(<span class="hljs-string">"request_start"</span>, <span class="hljs-built_in">document</span>);
    <span class="hljs-keyword">this</span>.requestObject.open(<span class="hljs-string">"POST"</span>, <span class="hljs-keyword">this</span>.contextPath, <span class="hljs-keyword">this</span>.async);
    <span class="hljs-keyword">this</span>.requestObject.setRequestHeader(<span class="hljs-string">'Content-Type'</span>, <span class="hljs-string">'application/x-www-form-urlencoded; charset=UTF-8'</span>);
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> g_ck != <span class="hljs-string">'undefined'</span> &amp;&amp; g_ck != <span class="hljs-string">""</span>)
      <span class="hljs-keyword">this</span>.requestObject.setRequestHeader(<span class="hljs-string">'X-UserToken'</span>, g_ck);
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">this</span>.requestObject.send(<span class="hljs-keyword">this</span>.postString);
    } <span class="hljs-keyword">catch</span> (e) {}
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.async || (<span class="hljs-keyword">this</span>.callbackFunction == <span class="hljs-literal">null</span>))
      <span class="hljs-keyword">this</span>._hideLoading();
  },
  <span class="hljs-attr">_processReqChange</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.requestObject.readyState != <span class="hljs-number">4</span>)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">this</span>.requestObject.onreadystatechange = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{};
    <span class="hljs-keyword">this</span>._hideLoading();
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>._errorCheck()) {
      <span class="hljs-keyword">this</span>._responseReceived();
      <span class="hljs-keyword">return</span>;
    }
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">this</span>._handleError();
    } <span class="hljs-keyword">catch</span> (e) {
      jslog(<span class="hljs-string">"GlideAjax error: "</span> + e);
    }
  },
  <span class="hljs-attr">_errorCheck</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>._cancelErrorXML = <span class="hljs-keyword">this</span>._getCancelError();
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._getResponseCode() != <span class="hljs-number">200</span> || <span class="hljs-keyword">this</span>._wasCanceled();
  },
  <span class="hljs-attr">_handle401Error</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (getTopWindow().loggingOut)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">var</span> sessionLoggedIn = <span class="hljs-keyword">this</span>.requestObject.getResponseHeader(<span class="hljs-string">"X-SessionLoggedIn"</span>);
    <span class="hljs-keyword">if</span> (<span class="hljs-string">"true"</span> != sessionLoggedIn) {
      <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.confirm(<span class="hljs-keyword">new</span> GwtMessage().getMessage(<span class="hljs-string">"ajax_session_timeout_goto_login_confirm"</span>))) {
        getTopWindow().location.href = <span class="hljs-string">"/navpage.do"</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
      }
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">var</span> allowResubmit = <span class="hljs-keyword">this</span>.requestObject.getResponseHeader(<span class="hljs-string">"X-UserToken-AllowResubmit"</span>);
      <span class="hljs-keyword">if</span> (<span class="hljs-string">"true"</span> == allowResubmit) {
        <span class="hljs-keyword">var</span> autoResubmit = <span class="hljs-keyword">this</span>.requestObject.getResponseHeader(<span class="hljs-string">"X-AutoResubmit"</span>);
        <span class="hljs-keyword">if</span> (<span class="hljs-string">"true"</span> == autoResubmit) {
          <span class="hljs-keyword">this</span>._sendRequest();
          <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        }
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.confirm(<span class="hljs-keyword">new</span> GwtMessage().getMessage(<span class="hljs-string">"ajax_session_timeout_resubmit_request_confirm"</span>))) {
          <span class="hljs-keyword">this</span>._sendRequest();
          <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        }
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">if</span> (<span class="hljs-string">"true"</span> == sessionLoggedIn)
          <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">var</span> msg = <span class="hljs-keyword">new</span> GwtMessage().getMessage(<span class="hljs-string">"ajax_session_timeout_refresh_screen"</span>);
        <span class="hljs-keyword">if</span> (!msg)
          msg = <span class="hljs-string">"Your session has expired. Click OK to continue."</span>;
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.confirm(msg)) {
          getTopWindow().location.href = <span class="hljs-string">"/navpage.do"</span>;
          <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        }
      }
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  },
  <span class="hljs-attr">_handleError</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> responseCode = <span class="hljs-keyword">this</span>._getResponseCode();
    <span class="hljs-keyword">if</span> (responseCode == <span class="hljs-number">401</span>) {
      <span class="hljs-keyword">var</span> requestedToken = <span class="hljs-keyword">this</span>.requestObject.getResponseHeader(<span class="hljs-string">"X-UserToken-Request"</span>);
      <span class="hljs-keyword">var</span> respondedToken = <span class="hljs-keyword">this</span>.requestObject.getResponseHeader(<span class="hljs-string">"X-UserToken-Response"</span>);
      <span class="hljs-keyword">if</span> (requestedToken &amp;&amp; respondedToken &amp;&amp; requestedToken != respondedToken)
        CustomEvent.fireAll(<span class="hljs-string">"ck_updated"</span>, respondedToken);
      <span class="hljs-keyword">var</span> handleTimeOut = <span class="hljs-keyword">this</span>.requestObject.getResponseHeader(<span class="hljs-string">"X-HandleTimeOut"</span>);
      <span class="hljs-keyword">if</span> (<span class="hljs-string">"true"</span> == handleTimeOut)
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._handle401Error())
          <span class="hljs-keyword">return</span>;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (responseCode == <span class="hljs-number">404</span> &amp;&amp; <span class="hljs-keyword">this</span>._outOfScope()) {
      <span class="hljs-keyword">var</span> err_options = {
        <span class="hljs-attr">text</span>: <span class="hljs-string">"Access to Script Include "</span> + <span class="hljs-keyword">this</span>.processor + <span class="hljs-string">" blocked from scope: "</span> + (<span class="hljs-keyword">this</span>.getParam(<span class="hljs-string">"sysparm_scope"</span>) ? <span class="hljs-keyword">this</span>.getParam(<span class="hljs-string">"sysparm_scope"</span>) : <span class="hljs-string">"global"</span>),
        <span class="hljs-attr">type</span>: <span class="hljs-string">"system"</span>,
        <span class="hljs-attr">attributes</span>: {
          <span class="hljs-attr">type</span>: <span class="hljs-string">"error"</span>
        }
      };
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> GlideUI != <span class="hljs-string">'undefined'</span>)
        GlideUI.get().fire(<span class="hljs-keyword">new</span> GlideUINotification(err_options));
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._wasCanceled() &amp;&amp; <span class="hljs-keyword">this</span>.callbackFunction &amp;&amp; !<span class="hljs-keyword">this</span>._getSuppressCancelNotification()) {
      <span class="hljs-keyword">var</span> err_options = {
        <span class="hljs-attr">text</span>: <span class="hljs-keyword">this</span>._getCancelErrorText(),
        <span class="hljs-attr">type</span>: <span class="hljs-string">"system"</span>,
        <span class="hljs-attr">attributes</span>: {
          <span class="hljs-attr">type</span>: <span class="hljs-string">"error"</span>
        }
      };
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> GlideUI != <span class="hljs-string">'undefined'</span>)
        GlideUI.get().fire(<span class="hljs-keyword">new</span> GlideUINotification(err_options));
    }
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.errorCallbackFunction)
      <span class="hljs-keyword">this</span>.errorCallbackFunction(<span class="hljs-keyword">this</span>.requestObject, <span class="hljs-keyword">this</span>.callbackArgs);
  },
  <span class="hljs-attr">_getRequestObject</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> req = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.XMLHttpRequest)
      req = <span class="hljs-keyword">new</span> XMLHttpRequest();
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.ActiveXObject)
      req = <span class="hljs-keyword">new</span> ActiveXObject(<span class="hljs-string">"Microsoft.XMLHTTP"</span>);
    <span class="hljs-keyword">return</span> req;
  },
  <span class="hljs-attr">_getResponseCode</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.requestObject.status;
  },
  <span class="hljs-attr">_wasCanceled</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>._cancelErrorXML)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">var</span> answer = <span class="hljs-keyword">this</span>._cancelErrorXML.getAttribute(<span class="hljs-string">'transaction_canceled'</span>);
    <span class="hljs-keyword">return</span> answer == <span class="hljs-string">'true'</span>;
  },
  <span class="hljs-attr">_getSuppressCancelNotification</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._suppressCancelNotification)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._cancelErrorXML) {
      <span class="hljs-keyword">var</span> suppress = <span class="hljs-keyword">this</span>._cancelErrorXML.getAttribute(<span class="hljs-string">"suppress_notification"</span>);
      <span class="hljs-keyword">if</span> (suppress &amp;&amp; suppress == <span class="hljs-string">'true'</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  },
  <span class="hljs-attr">_getCancelErrorText</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._cancelErrorXML) {
      <span class="hljs-keyword">var</span> cancelMessage = <span class="hljs-keyword">this</span>._cancelErrorXML.getAttribute(<span class="hljs-string">'cancel_message'</span>);
      <span class="hljs-keyword">if</span> (cancelMessage)
        <span class="hljs-keyword">return</span> cancelMessage;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-string">"Information could not be downloaded from the server because the transaction was canceled."</span>;
  },
  <span class="hljs-attr">_getCancelError</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> xml = <span class="hljs-keyword">this</span>.requestObject.responseXML;
    <span class="hljs-keyword">if</span> (!xml) {
      <span class="hljs-keyword">var</span> responseText = <span class="hljs-keyword">this</span>.requestObject.responseText;
      <span class="hljs-keyword">var</span> errorPattern = <span class="hljs-regexp">/&lt;xml?[^&gt;]*id="transaction_canceled_island"?[^&gt;]*&gt;/</span>;
      <span class="hljs-keyword">var</span> matches = responseText.match(errorPattern);
      <span class="hljs-keyword">if</span> (!matches)
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
      xml = loadXML(matches[<span class="hljs-number">0</span>]);
    }
    <span class="hljs-keyword">return</span> xml.documentElement;
  },
  <span class="hljs-attr">_outOfScope</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> callerScope = <span class="hljs-keyword">this</span>.getParam(<span class="hljs-string">"sysparm_scope"</span>) ? <span class="hljs-keyword">this</span>.getParam(<span class="hljs-string">"sysparm_scope"</span>) : <span class="hljs-string">"global"</span>;
    <span class="hljs-keyword">var</span> isAppScope = callerScope != <span class="hljs-string">"global"</span>;
    <span class="hljs-keyword">return</span> isAppScope &amp;&amp; <span class="hljs-keyword">this</span>.requestObject.responseXML.documentElement.getAttribute(<span class="hljs-string">"error"</span>).indexOf(<span class="hljs-string">"HTTP Processor class not found"</span>) == <span class="hljs-number">0</span>;
  },
  <span class="hljs-attr">_responseReceived</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    lastActivity = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>();
    CustomEvent.fireTop(<span class="hljs-string">"request_complete"</span>, <span class="hljs-built_in">document</span>);
    <span class="hljs-keyword">this</span>._fireUINotifications();
    <span class="hljs-keyword">this</span>._showSessionNotifications();
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.callbackFunction) {
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.wantAnswer)
        <span class="hljs-keyword">this</span>.callbackFunction(<span class="hljs-keyword">this</span>.getAnswer(), <span class="hljs-keyword">this</span>.callbackArgs);
      <span class="hljs-keyword">else</span>
        <span class="hljs-keyword">this</span>.callbackFunction(<span class="hljs-keyword">this</span>.requestObject, <span class="hljs-keyword">this</span>.callbackArgs);
    }
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.wantRequestObject)
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.requestObject;
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.requestObject ? <span class="hljs-keyword">this</span>.requestObject.responseXML : <span class="hljs-literal">null</span>;
  },
  <span class="hljs-attr">_showLoading</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>._preventLoadingIcon)
      CustomEvent.fireAll(<span class="hljs-string">"ajax.loading.start"</span>, <span class="hljs-keyword">this</span>);
  },
  <span class="hljs-attr">_hideLoading</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>._preventLoadingIcon &amp;&amp; <span class="hljs-built_in">window</span>.CustomEvent)
      CustomEvent.fireAll(<span class="hljs-string">"ajax.loading.end"</span>, <span class="hljs-keyword">this</span>);
  },
  <span class="hljs-attr">_buildReferringURL</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> path = location.pathname;
    <span class="hljs-keyword">var</span> args = location.search;
    <span class="hljs-keyword">if</span> (path.substring(path.length - <span class="hljs-number">1</span>) == <span class="hljs-string">'/'</span>) {
      <span class="hljs-keyword">if</span> (args)
        <span class="hljs-keyword">return</span> args;
      <span class="hljs-keyword">return</span> <span class="hljs-string">""</span>;
    }
    <span class="hljs-keyword">return</span> path.substring(path.lastIndexOf(<span class="hljs-string">'/'</span>) + <span class="hljs-number">1</span>) + args;
  },
  <span class="hljs-attr">_fireUINotifications</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.requestObject || !<span class="hljs-keyword">this</span>.requestObject.responseXML)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">var</span> notifications = <span class="hljs-keyword">this</span>.requestObject.responseXML.getElementsByTagName(<span class="hljs-string">'ui_notifications'</span>);
    <span class="hljs-keyword">if</span> (!notifications || notifications.length == <span class="hljs-number">0</span>)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">var</span> spans = notifications[<span class="hljs-number">0</span>].childNodes;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; spans.length; i++) {
      <span class="hljs-keyword">var</span> span = spans[i];
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> GlideUI != <span class="hljs-string">'undefined'</span>)
        GlideUI.get().fire(<span class="hljs-keyword">new</span> GlideUINotification({
          <span class="hljs-attr">xml</span>: span
        }));
    }
    $(<span class="hljs-built_in">document</span>).fire(<span class="hljs-string">'glide-notification:clear'</span>, {
      <span class="hljs-attr">spans</span>: spans
    });
  },
  <span class="hljs-attr">_showSessionNotifications</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.requestObject || !<span class="hljs-keyword">this</span>.requestObject.responseXML)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">var</span> notifications = <span class="hljs-keyword">this</span>.requestObject.responseXML.getElementsByTagName(<span class="hljs-string">'session_notifications'</span>);
    <span class="hljs-keyword">if</span> (!notifications || notifications.length == <span class="hljs-number">0</span>)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">var</span> spans = notifications[<span class="hljs-number">0</span>].childNodes;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; spans.length; i++) {
      <span class="hljs-keyword">var</span> span = spans[i];
      <span class="hljs-keyword">var</span> type = span.getAttribute(<span class="hljs-string">"data-type"</span>);
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> GlideUI != <span class="hljs-string">'undefined'</span>) {
        <span class="hljs-keyword">if</span> (type !== <span class="hljs-string">'nav'</span>)
          GlideUI.get().addOutputMessage({
            <span class="hljs-attr">msg</span>: span.getAttribute(<span class="hljs-string">"data-text"</span>),
            <span class="hljs-attr">type</span>: type
          });
      }
    }
  },
  <span class="hljs-attr">setScope</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">scope</span>) </span>{
    <span class="hljs-keyword">if</span> (scope) {
      <span class="hljs-keyword">this</span>.addParam(<span class="hljs-string">'sysparm_scope'</span>, scope);
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
  },
  <span class="hljs-attr">setErrorCallback</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">callback</span>) </span>{
    <span class="hljs-keyword">this</span>.errorCallbackFunction = callback;
  },
  <span class="hljs-attr">setWantRequestObject</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">want</span>) </span>{
    <span class="hljs-keyword">this</span>.wantRequestObject = want;
  },
  <span class="hljs-attr">setWantSessionMessages</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">want</span>) </span>{
    <span class="hljs-keyword">this</span>.addParam(<span class="hljs-string">'sysparm_want_session_messages'</span>, want);
  },
  <span class="hljs-attr">toString</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-string">"GlideAjax"</span>;
  }
});
GlideAjax.disableSessionMessages = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  GlideAjax.want_session_messages = <span class="hljs-literal">false</span>;
};
GlideAjax.enableSessionMessages = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  GlideAjax.want_session_messages = <span class="hljs-literal">true</span>;
};
GlideAjax.enableSessionMessages();;
<span class="hljs-comment">/*! RESOURCE: /scripts/classes/ajax/GlideAjaxForm.js */</span>
<span class="hljs-keyword">var</span> GlideAjaxForm = Class.create(GlideAjax, {
  <span class="hljs-attr">PROCESSOR</span>: <span class="hljs-string">'RenderInfo'</span>,
  <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$super, templateName</span>) </span>{
    $<span class="hljs-keyword">super</span>(<span class="hljs-keyword">this</span>.PROCESSOR);
    <span class="hljs-keyword">this</span>._formPreferences = {};
    <span class="hljs-keyword">this</span>._templateName = templateName;
    <span class="hljs-keyword">this</span>.setPreference(<span class="hljs-string">'renderer'</span>, <span class="hljs-string">'RenderForm'</span>);
    <span class="hljs-keyword">this</span>.setPreference(<span class="hljs-string">'type'</span>, <span class="hljs-string">'direct'</span>);
    <span class="hljs-keyword">this</span>.setPreference(<span class="hljs-string">'table'</span>, templateName);
    <span class="hljs-keyword">this</span>.addParam(<span class="hljs-string">'sysparm_name'</span>, templateName);
    <span class="hljs-keyword">this</span>.addParam(<span class="hljs-string">'sysparm_value'</span>, <span class="hljs-keyword">this</span>.getSysparmValue());
  },
  <span class="hljs-attr">getRenderedBodyText</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">callback</span>) </span>{
    <span class="hljs-keyword">this</span>._renderedBodyCallback = callback;
    <span class="hljs-keyword">this</span>.getXML(<span class="hljs-keyword">this</span>._parseTemplate.bind(<span class="hljs-keyword">this</span>));
  },
  <span class="hljs-attr">_parseTemplate</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">response</span>) </span>{
    s = response.responseText;
    s = s.substring(s.indexOf(<span class="hljs-string">'&lt;rendered_body&gt;'</span>) + <span class="hljs-number">15</span>);
    s = s.substring(<span class="hljs-number">0</span>, s.indexOf(<span class="hljs-string">'&lt;/rendered_body&gt;'</span>));
    s = s.replace(<span class="hljs-regexp">/&amp;lt;/g</span>, <span class="hljs-string">"&lt;"</span>).replace(<span class="hljs-regexp">/&amp;gt;/g</span>, <span class="hljs-string">"&gt;"</span>).replace(<span class="hljs-regexp">/&amp;amp;/g</span>, <span class="hljs-string">"&amp;"</span>).replace(<span class="hljs-regexp">/&amp;apos;/g</span>, <span class="hljs-string">"'"</span>);
    <span class="hljs-keyword">this</span>._renderedBodyCallback(s);
  },
  <span class="hljs-attr">setPreference</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">k, v</span>) </span>{
    <span class="hljs-keyword">this</span>._formPreferences[k] = v;
  },
  <span class="hljs-attr">getPreferences</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._formPreferences;
  },
  <span class="hljs-attr">getSysparmValue</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> gxml = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'gxml'</span>);
    <span class="hljs-keyword">var</span> sec = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'section'</span>);
    sec.setAttribute(<span class="hljs-string">'name'</span>, <span class="hljs-keyword">this</span>._templateName);
    gxml.appendChild(sec);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i <span class="hljs-keyword">in</span> <span class="hljs-keyword">this</span>._formPreferences) {
      <span class="hljs-keyword">var</span> e = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'preference'</span>);
      e.setAttribute(<span class="hljs-string">'name'</span>, i);
      e.setAttribute(<span class="hljs-string">'value'</span>, <span class="hljs-keyword">this</span>._formPreferences[i]);
      sec.appendChild(e);
    }
    <span class="hljs-keyword">return</span> gxml.innerHTML;
  },
  <span class="hljs-attr">toString</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-string">'GlideAjaxForm'</span>;
  }
});;
<span class="hljs-comment">/*! RESOURCE: /scripts/calendar.js */</span>
<span class="hljs-keyword">var</span> MONTH_NAMES = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(<span class="hljs-string">'January'</span>, <span class="hljs-string">'February'</span>, <span class="hljs-string">'March'</span>, <span class="hljs-string">'April'</span>, <span class="hljs-string">'May'</span>, <span class="hljs-string">'June'</span>, <span class="hljs-string">'July'</span>, <span class="hljs-string">'August'</span>, <span class="hljs-string">'September'</span>, <span class="hljs-string">'October'</span>, <span class="hljs-string">'November'</span>, <span class="hljs-string">'December'</span>, <span class="hljs-string">'Jan'</span>, <span class="hljs-string">'Feb'</span>, <span class="hljs-string">'Mar'</span>, <span class="hljs-string">'Apr'</span>, <span class="hljs-string">'May'</span>, <span class="hljs-string">'Jun'</span>, <span class="hljs-string">'Jul'</span>, <span class="hljs-string">'Aug'</span>, <span class="hljs-string">'Sep'</span>, <span class="hljs-string">'Oct'</span>, <span class="hljs-string">'Nov'</span>, <span class="hljs-string">'Dec'</span>);
<span class="hljs-keyword">var</span> DAY_NAMES = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(<span class="hljs-string">'Sunday'</span>, <span class="hljs-string">'Monday'</span>, <span class="hljs-string">'Tuesday'</span>, <span class="hljs-string">'Wednesday'</span>, <span class="hljs-string">'Thursday'</span>, <span class="hljs-string">'Friday'</span>, <span class="hljs-string">'Saturday'</span>, <span class="hljs-string">'Sun'</span>, <span class="hljs-string">'Mon'</span>, <span class="hljs-string">'Tue'</span>, <span class="hljs-string">'Wed'</span>, <span class="hljs-string">'Thu'</span>, <span class="hljs-string">'Fri'</span>, <span class="hljs-string">'Sat'</span>);

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">LZ</span>(<span class="hljs-params">x</span>) </span>{
  <span class="hljs-keyword">return</span> (x &lt; <span class="hljs-number">0</span> || x &gt; <span class="hljs-number">9</span> ? <span class="hljs-string">""</span> : <span class="hljs-string">"0"</span>) + x
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isDate</span>(<span class="hljs-params">val, format</span>) </span>{
  <span class="hljs-keyword">var</span> date = getDateFromFormat(val, format);
  <span class="hljs-keyword">if</span> (date == <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  }
  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">compareDates</span>(<span class="hljs-params">date1, dateformat1, date2, dateformat2</span>) </span>{
  <span class="hljs-keyword">var</span> d1 = getDateFromFormat(date1, dateformat1);
  <span class="hljs-keyword">var</span> d2 = getDateFromFormat(date2, dateformat2);
  <span class="hljs-keyword">if</span> (d1 == <span class="hljs-number">0</span> || d2 == <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (d1 &gt; d2) {
    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
  }
  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">formatDateServer</span>(<span class="hljs-params">date, format</span>) </span>{
  <span class="hljs-keyword">var</span> ga = <span class="hljs-keyword">new</span> GlideAjax(<span class="hljs-string">"DateTimeUtils"</span>);
  ga.addParam(<span class="hljs-string">"sysparm_name"</span>, <span class="hljs-string">"formatCalendarDate"</span>);
  <span class="hljs-keyword">var</span> browserOffset = date.getTimezoneOffset() * <span class="hljs-number">60000</span>;
  <span class="hljs-keyword">var</span> utcTime = date.getTime() - browserOffset;
  <span class="hljs-keyword">var</span> userDateTime = utcTime - g_tz_offset;
  ga.addParam(<span class="hljs-string">"sysparm_value"</span>, userDateTime);
  ga.getXMLWait();
  <span class="hljs-keyword">return</span> ga.getAnswer();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">formatDate</span>(<span class="hljs-params">date, format</span>) </span>{
  <span class="hljs-keyword">if</span> (format.indexOf(<span class="hljs-string">"z"</span>) &gt; <span class="hljs-number">0</span>)
    <span class="hljs-keyword">return</span> formatDateServer(date, format);
  format = format + <span class="hljs-string">""</span>;
  <span class="hljs-keyword">var</span> result = <span class="hljs-string">""</span>;
  <span class="hljs-keyword">var</span> i_format = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">var</span> c = <span class="hljs-string">""</span>;
  <span class="hljs-keyword">var</span> token = <span class="hljs-string">""</span>;
  <span class="hljs-keyword">var</span> y = date.getYear() + <span class="hljs-string">""</span>;
  <span class="hljs-keyword">var</span> M = date.getMonth() + <span class="hljs-number">1</span>;
  <span class="hljs-keyword">var</span> d = date.getDate();
  <span class="hljs-keyword">var</span> E = date.getDay();
  <span class="hljs-keyword">var</span> H = date.getHours();
  <span class="hljs-keyword">var</span> m = date.getMinutes();
  <span class="hljs-keyword">var</span> s = date.getSeconds();
  <span class="hljs-keyword">var</span> yyyy, yy, MMM, MM, dd, hh, h, mm, ss, ampm, HH, H, KK, K, kk, k;
  <span class="hljs-keyword">var</span> value = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Object</span>();
  value[<span class="hljs-string">"M"</span>] = M;
  value[<span class="hljs-string">"MM"</span>] = LZ(M);
  value[<span class="hljs-string">"MMM"</span>] = MONTH_NAMES[M + <span class="hljs-number">11</span>];
  value[<span class="hljs-string">"NNN"</span>] = MONTH_NAMES[M + <span class="hljs-number">11</span>];
  value[<span class="hljs-string">"MMMM"</span>] = MONTH_NAMES[M - <span class="hljs-number">1</span>];
  value[<span class="hljs-string">"d"</span>] = d;
  value[<span class="hljs-string">"dd"</span>] = LZ(d);
  value[<span class="hljs-string">"E"</span>] = DAY_NAMES[E + <span class="hljs-number">7</span>];
  value[<span class="hljs-string">"EE"</span>] = DAY_NAMES[E];
  value[<span class="hljs-string">"H"</span>] = H;
  value[<span class="hljs-string">"HH"</span>] = LZ(H);
  <span class="hljs-keyword">if</span> (format.indexOf(<span class="hljs-string">'w'</span>) != <span class="hljs-number">-1</span>) {
    <span class="hljs-keyword">var</span> wk = date.getWeek();
    <span class="hljs-keyword">if</span> (wk &gt;= <span class="hljs-number">52</span> &amp;&amp; M == <span class="hljs-number">1</span>) {
      y = date.getYear();
      y--;
      y = y + <span class="hljs-string">""</span>;
    }
    <span class="hljs-keyword">if</span> (wk == <span class="hljs-number">1</span> &amp;&amp; M == <span class="hljs-number">12</span>) {
      y = date.getYear();
      y++;
      y = y + <span class="hljs-string">""</span>;
    }
    value[<span class="hljs-string">"w"</span>] = wk;
    value[<span class="hljs-string">"ww"</span>] = LZ(wk);
  }
  <span class="hljs-keyword">var</span> dayOfWeek = (<span class="hljs-number">7</span> + (E + <span class="hljs-number">1</span>) - (g_first_day_of_week - <span class="hljs-number">1</span>)) % <span class="hljs-number">7</span>;
  <span class="hljs-keyword">if</span> (dayOfWeek == <span class="hljs-number">0</span>)
    dayOfWeek = <span class="hljs-number">7</span>;
  value[<span class="hljs-string">"D"</span>] = dayOfWeek;
  <span class="hljs-keyword">if</span> (y.length &lt; <span class="hljs-number">4</span>) {
    y = <span class="hljs-string">""</span> + (y - <span class="hljs-number">0</span> + <span class="hljs-number">1900</span>);
  }
  value[<span class="hljs-string">"y"</span>] = <span class="hljs-string">""</span> + y;
  value[<span class="hljs-string">"yyyy"</span>] = y;
  value[<span class="hljs-string">"yy"</span>] = y.substring(<span class="hljs-number">2</span>, <span class="hljs-number">4</span>);
  <span class="hljs-keyword">if</span> (H == <span class="hljs-number">0</span>) {
    value[<span class="hljs-string">"h"</span>] = <span class="hljs-number">12</span>;
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (H &gt; <span class="hljs-number">12</span>) {
    value[<span class="hljs-string">"h"</span>] = H - <span class="hljs-number">12</span>;
  } <span class="hljs-keyword">else</span> {
    value[<span class="hljs-string">"h"</span>] = H;
  }
  value[<span class="hljs-string">"hh"</span>] = LZ(value[<span class="hljs-string">"h"</span>]);
  <span class="hljs-keyword">if</span> (H &gt; <span class="hljs-number">11</span>) {
    value[<span class="hljs-string">"K"</span>] = H - <span class="hljs-number">12</span>;
  } <span class="hljs-keyword">else</span> {
    value[<span class="hljs-string">"K"</span>] = H;
  }
  value[<span class="hljs-string">"k"</span>] = H + <span class="hljs-number">1</span>;
  value[<span class="hljs-string">"KK"</span>] = LZ(value[<span class="hljs-string">"K"</span>]);
  value[<span class="hljs-string">"kk"</span>] = LZ(value[<span class="hljs-string">"k"</span>]);
  <span class="hljs-keyword">if</span> (H &gt; <span class="hljs-number">11</span>) {
    value[<span class="hljs-string">"a"</span>] = <span class="hljs-string">"PM"</span>;
  } <span class="hljs-keyword">else</span> {
    value[<span class="hljs-string">"a"</span>] = <span class="hljs-string">"AM"</span>;
  }
  value[<span class="hljs-string">"m"</span>] = m;
  value[<span class="hljs-string">"mm"</span>] = LZ(m);
  value[<span class="hljs-string">"s"</span>] = s;
  value[<span class="hljs-string">"ss"</span>] = LZ(s);
  <span class="hljs-keyword">while</span> (i_format &lt; format.length) {
    c = format.charAt(i_format);
    token = <span class="hljs-string">""</span>;
    <span class="hljs-keyword">while</span> ((format.charAt(i_format) == c) &amp;&amp; (i_format &lt; format.length)) {
      token += format.charAt(i_format++);
    }
    <span class="hljs-keyword">if</span> (value[token] != <span class="hljs-literal">null</span>) {
      result = result + value[token];
    } <span class="hljs-keyword">else</span> {
      result = result + token;
    }
  }
  <span class="hljs-keyword">return</span> result;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_isInteger</span>(<span class="hljs-params">val</span>) </span>{
  <span class="hljs-keyword">var</span> digits = <span class="hljs-string">"1234567890"</span>;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; val.length; i++) {
    <span class="hljs-keyword">if</span> (digits.indexOf(val.charAt(i)) == <span class="hljs-number">-1</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
  }
  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_getInt</span>(<span class="hljs-params">str, i, minlength, maxlength</span>) </span>{
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> x = maxlength; x &gt;= minlength; x--) {
    <span class="hljs-keyword">var</span> token = str.substring(i, i + x);
    <span class="hljs-keyword">if</span> (token.length &lt; minlength) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }
    <span class="hljs-keyword">if</span> (_isInteger(token)) {
      <span class="hljs-keyword">return</span> token;
    }
  }
  <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
}
<span class="hljs-built_in">Date</span>.prototype.getWeek = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> newYear = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<span class="hljs-keyword">this</span>.getFullYear(), <span class="hljs-number">0</span>, <span class="hljs-number">1</span>);
  <span class="hljs-keyword">var</span> day = newYear.getDay() - (g_first_day_of_week - <span class="hljs-number">1</span>);
  day = (day &gt;= <span class="hljs-number">0</span> ? day : day + <span class="hljs-number">7</span>);
  <span class="hljs-keyword">var</span> dayNum = <span class="hljs-built_in">Math</span>.floor((<span class="hljs-keyword">this</span>.getTime() - newYear.getTime() - (<span class="hljs-keyword">this</span>.getTimezoneOffset() - newYear.getTimezoneOffset()) * <span class="hljs-number">60000</span>) / <span class="hljs-number">86400000</span>) + <span class="hljs-number">1</span>;
  <span class="hljs-keyword">var</span> weekNum;
  <span class="hljs-keyword">if</span> (day &lt; <span class="hljs-number">4</span>) {
    weekNum = <span class="hljs-built_in">Math</span>.floor((dayNum + day - <span class="hljs-number">1</span>) / <span class="hljs-number">7</span>) + <span class="hljs-number">1</span>;
    <span class="hljs-keyword">if</span> (weekNum &gt; <span class="hljs-number">52</span>)
      weekNum = <span class="hljs-keyword">this</span>._checkNextYear(weekNum);
    <span class="hljs-keyword">return</span> weekNum;
  }
  weekNum = <span class="hljs-built_in">Math</span>.floor((dayNum + day - <span class="hljs-number">1</span>) / <span class="hljs-number">7</span>);
  <span class="hljs-keyword">if</span> (weekNum &lt; <span class="hljs-number">1</span>)
    weekNum = <span class="hljs-keyword">this</span>._lastWeekOfYear();
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (weekNum &gt; <span class="hljs-number">52</span>)
    weekNum = <span class="hljs-keyword">this</span>._checkNextYear(weekNum);
  <span class="hljs-keyword">return</span> weekNum;
}
<span class="hljs-built_in">Date</span>.prototype._lastWeekOfYear = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> newYear = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<span class="hljs-keyword">this</span>.getFullYear() - <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>);
  <span class="hljs-keyword">var</span> endOfYear = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<span class="hljs-keyword">this</span>.getFullYear() - <span class="hljs-number">1</span>, <span class="hljs-number">11</span>, <span class="hljs-number">31</span>);
  <span class="hljs-keyword">var</span> day = newYear.getDay() - (g_first_day_of_week - <span class="hljs-number">1</span>);
  <span class="hljs-keyword">var</span> dayNum = <span class="hljs-built_in">Math</span>.floor((endOfYear.getTime() - newYear.getTime() - (endOfYear.getTimezoneOffset() - newYear.getTimezoneOffset()) * <span class="hljs-number">60000</span>) / <span class="hljs-number">86400000</span>) + <span class="hljs-number">1</span>;
  <span class="hljs-keyword">return</span> day &lt; <span class="hljs-number">4</span> ? <span class="hljs-built_in">Math</span>.floor((dayNum + day - <span class="hljs-number">1</span>) / <span class="hljs-number">7</span>) + <span class="hljs-number">1</span> : <span class="hljs-built_in">Math</span>.floor((dayNum + day - <span class="hljs-number">1</span>) / <span class="hljs-number">7</span>);
}
<span class="hljs-built_in">Date</span>.prototype._checkNextYear = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> nYear = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<span class="hljs-keyword">this</span>.getFullYear() + <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>);
  <span class="hljs-keyword">var</span> nDay = nYear.getDay() - (g_first_day_of_week - <span class="hljs-number">1</span>);
  nDay = nDay &gt;= <span class="hljs-number">0</span> ? nDay : nDay + <span class="hljs-number">7</span>;
  <span class="hljs-keyword">return</span> nDay &lt; <span class="hljs-number">4</span> ? <span class="hljs-number">1</span> : <span class="hljs-number">53</span>;
}
<span class="hljs-built_in">Date</span>.prototype.setWeek = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">weekNum</span>) </span>{
  weekNum--;
  <span class="hljs-keyword">var</span> startOfYear = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<span class="hljs-keyword">this</span>.getFullYear(), <span class="hljs-number">0</span>, <span class="hljs-number">1</span>);
  <span class="hljs-keyword">var</span> day = startOfYear.getDay() - (g_first_day_of_week - <span class="hljs-number">1</span>);
  <span class="hljs-keyword">if</span> (day &gt; <span class="hljs-number">0</span> &amp;&amp; day &lt; <span class="hljs-number">4</span>) {
    <span class="hljs-keyword">this</span>.setFullYear(startOfYear.getFullYear() - <span class="hljs-number">1</span>);
    <span class="hljs-keyword">this</span>.setDate(<span class="hljs-number">31</span> - day + <span class="hljs-number">1</span>);
    <span class="hljs-keyword">this</span>.setMonth(<span class="hljs-number">11</span>);
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (day &gt; <span class="hljs-number">3</span>)
    <span class="hljs-keyword">this</span>.setDate(startOfYear.getDate() + (<span class="hljs-number">7</span> - day));
  <span class="hljs-keyword">this</span>.setDate(<span class="hljs-keyword">this</span>.getDate() + (<span class="hljs-number">7</span> * weekNum));
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getDateFromFormat</span>(<span class="hljs-params">val, format</span>) </span>{
  val = val + <span class="hljs-string">""</span>;
  format = format + <span class="hljs-string">""</span>;
  <span class="hljs-keyword">var</span> i_val = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">var</span> i_format = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">var</span> c = <span class="hljs-string">""</span>;
  <span class="hljs-keyword">var</span> token = <span class="hljs-string">""</span>;
  <span class="hljs-keyword">var</span> token2 = <span class="hljs-string">""</span>;
  <span class="hljs-keyword">var</span> x, y;
  <span class="hljs-keyword">var</span> now = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>();
  <span class="hljs-keyword">var</span> year = now.getYear();
  <span class="hljs-keyword">var</span> month = now.getMonth() + <span class="hljs-number">1</span>;
  <span class="hljs-keyword">var</span> date = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">var</span> hh = now.getHours();
  <span class="hljs-keyword">var</span> mm = now.getMinutes();
  <span class="hljs-keyword">var</span> ss = now.getSeconds();
  <span class="hljs-keyword">var</span> ampm = <span class="hljs-string">""</span>;
  <span class="hljs-keyword">var</span> week = <span class="hljs-literal">false</span>;
  <span class="hljs-keyword">while</span> (i_format &lt; format.length) {
    c = format.charAt(i_format);
    token = <span class="hljs-string">""</span>;
    <span class="hljs-keyword">while</span> ((format.charAt(i_format) == c) &amp;&amp; (i_format &lt; format.length)) {
      token += format.charAt(i_format++);
    }
    <span class="hljs-keyword">if</span> (token == <span class="hljs-string">"yyyy"</span> || token == <span class="hljs-string">"yy"</span> || token == <span class="hljs-string">"y"</span>) {
      <span class="hljs-keyword">if</span> (token == <span class="hljs-string">"yyyy"</span>) {
        x = <span class="hljs-number">4</span>;
        y = <span class="hljs-number">4</span>;
      }
      <span class="hljs-keyword">if</span> (token == <span class="hljs-string">"yy"</span>) {
        x = <span class="hljs-number">2</span>;
        y = <span class="hljs-number">2</span>;
      }
      <span class="hljs-keyword">if</span> (token == <span class="hljs-string">"y"</span>) {
        x = <span class="hljs-number">2</span>;
        y = <span class="hljs-number">4</span>;
      }
      year = _getInt(val, i_val, x, y);
      <span class="hljs-keyword">if</span> (year == <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
      }
      i_val += year.length;
      <span class="hljs-keyword">if</span> (year.length == <span class="hljs-number">2</span>) {
        <span class="hljs-keyword">if</span> (year &gt; <span class="hljs-number">70</span>) {
          year = <span class="hljs-number">1900</span> + (year - <span class="hljs-number">0</span>);
        } <span class="hljs-keyword">else</span> {
          year = <span class="hljs-number">2000</span> + (year - <span class="hljs-number">0</span>);
        }
      }
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (token == <span class="hljs-string">"MMM"</span> || token == <span class="hljs-string">"NNN"</span>) {
      month = <span class="hljs-number">0</span>;
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; MONTH_NAMES.length; i++) {
        <span class="hljs-keyword">var</span> month_name = MONTH_NAMES[i];
        <span class="hljs-keyword">if</span> (val.substring(i_val, i_val + month_name.length).toLowerCase() == month_name.toLowerCase()) {
          <span class="hljs-keyword">if</span> (token == <span class="hljs-string">"MMM"</span> || (token == <span class="hljs-string">"NNN"</span> &amp;&amp; i &gt; <span class="hljs-number">11</span>)) {
            month = i + <span class="hljs-number">1</span>;
            <span class="hljs-keyword">if</span> (month &gt; <span class="hljs-number">12</span>) {
              month -= <span class="hljs-number">12</span>;
            }
            i_val += month_name.length;
            <span class="hljs-keyword">break</span>;
          }
        }
      }
      <span class="hljs-keyword">if</span> ((month &lt; <span class="hljs-number">1</span>) || (month &gt; <span class="hljs-number">12</span>)) {
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
      }
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (token == <span class="hljs-string">"EE"</span> || token == <span class="hljs-string">"E"</span>) {
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; DAY_NAMES.length; i++) {
        <span class="hljs-keyword">var</span> day_name = DAY_NAMES[i];
        <span class="hljs-keyword">if</span> (val.substring(i_val, i_val + day_name.length).toLowerCase() == day_name.toLowerCase()) {
          <span class="hljs-keyword">if</span> (week) {
            <span class="hljs-keyword">if</span> (i == <span class="hljs-number">0</span> || i == <span class="hljs-number">7</span>)
              date += <span class="hljs-number">6</span>;
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (i == <span class="hljs-number">2</span> || i == <span class="hljs-number">9</span>)
              date += <span class="hljs-number">1</span>;
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (i == <span class="hljs-number">3</span> || i == <span class="hljs-number">10</span>)
              date += <span class="hljs-number">2</span>;
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (i == <span class="hljs-number">4</span> || i == <span class="hljs-number">11</span>)
              date += <span class="hljs-number">3</span>;
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (i == <span class="hljs-number">5</span> || i == <span class="hljs-number">12</span>)
              date += <span class="hljs-number">4</span>;
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (i == <span class="hljs-number">6</span> || i == <span class="hljs-number">13</span>)
              date += <span class="hljs-number">5</span>;
          }
          i_val += day_name.length;
          <span class="hljs-keyword">break</span>;
        }
      }
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (token == <span class="hljs-string">"MM"</span> || token == <span class="hljs-string">"M"</span>) {
      month = _getInt(val, i_val, token.length, <span class="hljs-number">2</span>);
      <span class="hljs-keyword">if</span> (month == <span class="hljs-literal">null</span> || (month &lt; <span class="hljs-number">1</span>) || (month &gt; <span class="hljs-number">12</span>)) {
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
      }
      i_val += month.length;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (token == <span class="hljs-string">"dd"</span> || token == <span class="hljs-string">"d"</span>) {
      date = _getInt(val, i_val, token.length, <span class="hljs-number">2</span>);
      <span class="hljs-keyword">if</span> (date == <span class="hljs-literal">null</span> || (date &lt; <span class="hljs-number">1</span>) || (date &gt; <span class="hljs-number">31</span>)) {
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
      }
      i_val += date.length;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (token == <span class="hljs-string">"hh"</span> || token == <span class="hljs-string">"h"</span>) {
      hh = _getInt(val, i_val, token.length, <span class="hljs-number">2</span>);
      <span class="hljs-keyword">if</span> (hh == <span class="hljs-literal">null</span> || (hh &lt; <span class="hljs-number">1</span>) || (hh &gt; <span class="hljs-number">12</span>)) {
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
      }
      i_val += hh.length;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (token == <span class="hljs-string">"HH"</span> || token == <span class="hljs-string">"H"</span>) {
      hh = _getInt(val, i_val, token.length, <span class="hljs-number">2</span>);
      <span class="hljs-keyword">if</span> (hh == <span class="hljs-literal">null</span> || (hh &lt; <span class="hljs-number">0</span>) || (hh &gt; <span class="hljs-number">23</span>)) {
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
      }
      i_val += hh.length;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (token == <span class="hljs-string">"KK"</span> || token == <span class="hljs-string">"K"</span>) {
      hh = _getInt(val, i_val, token.length, <span class="hljs-number">2</span>);
      <span class="hljs-keyword">if</span> (hh == <span class="hljs-literal">null</span> || (hh &lt; <span class="hljs-number">0</span>) || (hh &gt; <span class="hljs-number">11</span>)) {
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
      }
      i_val += hh.length;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (token == <span class="hljs-string">"kk"</span> || token == <span class="hljs-string">"k"</span>) {
      hh = _getInt(val, i_val, token.length, <span class="hljs-number">2</span>);
      <span class="hljs-keyword">if</span> (hh == <span class="hljs-literal">null</span> || (hh &lt; <span class="hljs-number">1</span>) || (hh &gt; <span class="hljs-number">24</span>)) {
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
      }
      i_val += hh.length;
      hh--;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (token == <span class="hljs-string">"mm"</span> || token == <span class="hljs-string">"m"</span>) {
      mm = _getInt(val, i_val, token.length, <span class="hljs-number">2</span>);
      <span class="hljs-keyword">if</span> (mm == <span class="hljs-literal">null</span> || (mm &lt; <span class="hljs-number">0</span>) || (mm &gt; <span class="hljs-number">59</span>)) {
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
      }
      i_val += mm.length;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (token == <span class="hljs-string">"ss"</span> || token == <span class="hljs-string">"s"</span>) {
      ss = _getInt(val, i_val, token.length, <span class="hljs-number">2</span>);
      <span class="hljs-keyword">if</span> (ss == <span class="hljs-literal">null</span> || (ss &lt; <span class="hljs-number">0</span>) || (ss &gt; <span class="hljs-number">59</span>)) {
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
      }
      i_val += ss.length;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (token == <span class="hljs-string">"a"</span>) {
      <span class="hljs-keyword">if</span> (val.substring(i_val, i_val + <span class="hljs-number">2</span>).toLowerCase() == <span class="hljs-string">"am"</span>) {
        ampm = <span class="hljs-string">"AM"</span>;
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (val.substring(i_val, i_val + <span class="hljs-number">2</span>).toLowerCase() == <span class="hljs-string">"pm"</span>) {
        ampm = <span class="hljs-string">"PM"</span>;
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
      }
      i_val += <span class="hljs-number">2</span>;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (token == <span class="hljs-string">"w"</span> || token == <span class="hljs-string">"ww"</span>) {
      <span class="hljs-keyword">var</span> weekNum = _getInt(val, i_val, token.length, <span class="hljs-number">2</span>);
      week = <span class="hljs-literal">true</span>;
      <span class="hljs-keyword">if</span> (weekNum != <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">var</span> temp = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(year, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
        temp.setWeek(<span class="hljs-built_in">parseInt</span>(weekNum, <span class="hljs-number">10</span>));
        year = temp.getFullYear();
        month = temp.getMonth() + <span class="hljs-number">1</span>;
        date = temp.getDate();
      }
      weekNum += <span class="hljs-string">""</span>;
      i_val += weekNum.length;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (token == <span class="hljs-string">"D"</span>) {
      <span class="hljs-keyword">if</span> (week) {
        <span class="hljs-keyword">var</span> day = _getInt(val, i_val, token.length, <span class="hljs-number">1</span>);
        <span class="hljs-keyword">if</span> ((day == <span class="hljs-literal">null</span>) || (day &lt;= <span class="hljs-number">0</span>) || (day &gt; <span class="hljs-number">7</span>))
          <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
        <span class="hljs-keyword">var</span> temp = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(year, month - <span class="hljs-number">1</span>, date, hh, mm, ss);
        <span class="hljs-keyword">var</span> dayOfWeek = temp.getDay();
        day = <span class="hljs-built_in">parseInt</span>(day, <span class="hljs-number">10</span>);
        day = (day + g_first_day_of_week - <span class="hljs-number">1</span>) % <span class="hljs-number">7</span>;
        <span class="hljs-keyword">if</span> (day == <span class="hljs-number">0</span>)
          day = <span class="hljs-number">7</span>;
        day--;
        <span class="hljs-keyword">if</span> (day &lt; dayOfWeek)
          day = <span class="hljs-number">7</span> - (dayOfWeek - day);
        <span class="hljs-keyword">else</span>
          day -= dayOfWeek;
        <span class="hljs-keyword">if</span> (day &gt; <span class="hljs-number">0</span>) {
          temp.setDate(temp.getDate() + day);
          year = temp.getFullYear();
          month = temp.getMonth() + <span class="hljs-number">1</span>;
          date = temp.getDate();
        }
        i_val++;
      }
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (token == <span class="hljs-string">"z"</span>)
      i_val += <span class="hljs-number">3</span>;
    <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">if</span> (val.substring(i_val, i_val + token.length) != token) {
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
      } <span class="hljs-keyword">else</span> {
        i_val += token.length;
      }
    }
  }
  <span class="hljs-keyword">if</span> (i_val != val.length) {
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
  }
  <span class="hljs-keyword">if</span> (month == <span class="hljs-number">2</span>) {
    <span class="hljs-keyword">if</span> (((year % <span class="hljs-number">4</span> == <span class="hljs-number">0</span>) &amp;&amp; (year % <span class="hljs-number">100</span> != <span class="hljs-number">0</span>)) || (year % <span class="hljs-number">400</span> == <span class="hljs-number">0</span>)) {
      <span class="hljs-keyword">if</span> (date &gt; <span class="hljs-number">29</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
      }
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">if</span> (date &gt; <span class="hljs-number">28</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
      }
    }
  }
  <span class="hljs-keyword">if</span> ((month == <span class="hljs-number">4</span>) || (month == <span class="hljs-number">6</span>) || (month == <span class="hljs-number">9</span>) || (month == <span class="hljs-number">11</span>)) {
    <span class="hljs-keyword">if</span> (date &gt; <span class="hljs-number">30</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
    }
  }
  <span class="hljs-keyword">if</span> (hh &lt; <span class="hljs-number">12</span> &amp;&amp; ampm == <span class="hljs-string">"PM"</span>) {
    hh = hh - <span class="hljs-number">0</span> + <span class="hljs-number">12</span>;
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (hh &gt; <span class="hljs-number">11</span> &amp;&amp; ampm == <span class="hljs-string">"AM"</span>) {
    hh -= <span class="hljs-number">12</span>;
  }
  <span class="hljs-keyword">var</span> newdate = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(year, month - <span class="hljs-number">1</span>, date, hh, mm, ss);
  <span class="hljs-keyword">return</span> newdate.getTime();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">parseDate</span>(<span class="hljs-params">val</span>) </span>{
  <span class="hljs-keyword">var</span> preferEuro = (<span class="hljs-built_in">arguments</span>.length == <span class="hljs-number">2</span>) ? <span class="hljs-built_in">arguments</span>[<span class="hljs-number">1</span>] : <span class="hljs-literal">false</span>;
  generalFormats = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(<span class="hljs-string">'y-M-d'</span>, <span class="hljs-string">'MMM d, y'</span>, <span class="hljs-string">'MMM d,y'</span>, <span class="hljs-string">'y-MMM-d'</span>, <span class="hljs-string">'d-MMM-y'</span>, <span class="hljs-string">'MMM d'</span>);
  monthFirst = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(<span class="hljs-string">'M/d/y'</span>, <span class="hljs-string">'M-d-y'</span>, <span class="hljs-string">'M.d.y'</span>, <span class="hljs-string">'MMM-d'</span>, <span class="hljs-string">'M/d'</span>, <span class="hljs-string">'M-d'</span>);
  dateFirst = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(<span class="hljs-string">'d/M/y'</span>, <span class="hljs-string">'d-M-y'</span>, <span class="hljs-string">'d.M.y'</span>, <span class="hljs-string">'d-MMM'</span>, <span class="hljs-string">'d/M'</span>, <span class="hljs-string">'d-M'</span>);
  yearFirst = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(<span class="hljs-string">'yyyyw.F'</span>, <span class="hljs-string">'yyw.F'</span>);
  <span class="hljs-keyword">var</span> checkList = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(<span class="hljs-string">'generalFormats'</span>, preferEuro ? <span class="hljs-string">'dateFirst'</span> : <span class="hljs-string">'monthFirst'</span>, preferEuro ? <span class="hljs-string">'monthFirst'</span> : <span class="hljs-string">'dateFirst'</span>, <span class="hljs-string">'yearFirst'</span>);
  <span class="hljs-keyword">var</span> d = <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; checkList.length; i++) {
    <span class="hljs-keyword">var</span> l = <span class="hljs-built_in">window</span>[checkList[i]];
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> j = <span class="hljs-number">0</span>; j &lt; l.length; j++) {
      d = getDateFromFormat(val, l[j]);
      <span class="hljs-keyword">if</span> (d != <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(d);
      }
    }
  }
  <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getDurationString</span>(<span class="hljs-params">ms</span>) </span>{
  <span class="hljs-keyword">var</span> sec = <span class="hljs-built_in">Math</span>.floor(ms / <span class="hljs-number">1000</span>),
    s = <span class="hljs-string">''</span>,
    days = <span class="hljs-built_in">Math</span>.floor(sec / <span class="hljs-number">86400</span>);
  <span class="hljs-keyword">if</span> (days &gt;= <span class="hljs-number">1</span>) {
    s += days + <span class="hljs-string">' day'</span> + (days &gt; <span class="hljs-number">1</span> ? <span class="hljs-string">'s'</span> : <span class="hljs-string">''</span>);
    sec -= days * <span class="hljs-number">86400</span>;
  }
  <span class="hljs-keyword">var</span> hours = <span class="hljs-built_in">Math</span>.floor(sec / <span class="hljs-number">3600</span>);
  <span class="hljs-keyword">if</span> (hours &gt;= <span class="hljs-number">1</span>) {
    s += (days &gt; <span class="hljs-number">0</span> ? <span class="hljs-string">' '</span> : <span class="hljs-string">''</span>) + hours + <span class="hljs-string">' hour'</span> + (hours &gt; <span class="hljs-number">1</span> ? <span class="hljs-string">'s'</span> : <span class="hljs-string">''</span>);
    sec -= hours * <span class="hljs-number">3600</span>;
  }
  <span class="hljs-keyword">var</span> min = <span class="hljs-built_in">Math</span>.floor(sec / <span class="hljs-number">60</span>);
  <span class="hljs-keyword">if</span> (days == <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">if</span> (min &gt;= <span class="hljs-number">1</span>) {
      s += (hours &gt; <span class="hljs-number">0</span> ? <span class="hljs-string">' '</span> : <span class="hljs-string">''</span>) + min + <span class="hljs-string">' minute'</span> + (min &gt; <span class="hljs-number">1</span> ? <span class="hljs-string">'s'</span> : <span class="hljs-string">''</span>);
      <span class="hljs-keyword">if</span> (hours &lt; <span class="hljs-number">1</span>) {
        sec -= min * <span class="hljs-number">60</span>;
        <span class="hljs-keyword">if</span> (sec &gt; <span class="hljs-number">0</span> &amp;&amp; min &lt;= <span class="hljs-number">10</span>)
          s += <span class="hljs-string">' '</span> + sec + <span class="hljs-string">' second'</span> + (sec &gt; <span class="hljs-number">1</span> ? <span class="hljs-string">'s'</span> : <span class="hljs-string">''</span>);
      }
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (hours == <span class="hljs-number">0</span> &amp;&amp; sec &gt; <span class="hljs-number">0</span>)
      s += sec + <span class="hljs-string">' second'</span> + (sec &gt; <span class="hljs-number">1</span> ? <span class="hljs-string">'s'</span> : <span class="hljs-string">''</span>);
  }
  <span class="hljs-keyword">return</span> s;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getUserDateTime</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> browserDate = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>();
  <span class="hljs-keyword">var</span> browserOffset = browserDate.getTimezoneOffset() * <span class="hljs-number">60000</span>;
  <span class="hljs-keyword">var</span> utcTime = browserDate.getTime() + browserOffset;
  <span class="hljs-keyword">var</span> userDateTime = utcTime + g_tz_offset;
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(userDateTime);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">convertUtcTimeToUserTimeMs</span>(<span class="hljs-params">utcTimeMs</span>) </span>{
  <span class="hljs-keyword">var</span> d = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>();
  <span class="hljs-keyword">return</span> <span class="hljs-built_in">parseInt</span>(utcTimeMs) + (d.getTimezoneOffset() * <span class="hljs-number">60000</span>) + g_tz_offset;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">convertUserTimeToUtcTimeMs</span>(<span class="hljs-params">userTimeMs</span>) </span>{
  <span class="hljs-keyword">var</span> d = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>();
  <span class="hljs-keyword">return</span> <span class="hljs-built_in">parseInt</span>(userTimeMs) - (d.getTimezoneOffset() * <span class="hljs-number">60000</span>) - g_tz_offset;
};
<span class="hljs-comment">/*! RESOURCE: /scripts/functions_clipboard.js */</span>
<span class="hljs-built_in">window</span>.NOW = <span class="hljs-built_in">window</span>.NOW || {};
<span class="hljs-built_in">window</span>.NOW.g_clipboard = {};
(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">exports</span>) </span>{
  <span class="hljs-keyword">var</span> browserReturnsErroneousStatus = navigator.userAgent.indexOf(<span class="hljs-string">'MSIE 9'</span>) != <span class="hljs-number">-1</span> ||
    navigator.userAgent.indexOf(<span class="hljs-string">'MSIE 10'</span>) != <span class="hljs-number">-1</span> ||
    navigator.userAgent.indexOf(<span class="hljs-string">'rv:11'</span>) != <span class="hljs-number">-1</span>;
  exports.copyToClipboard = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">str, messageMethod</span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">document</span>.execCommand &amp;&amp; isCapableMessageMethod(messageMethod)) {
      <span class="hljs-keyword">var</span> v = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'textarea'</span>);
      v.innerHTML = str;
      v.className = <span class="hljs-string">"sr-only"</span>;
      <span class="hljs-built_in">document</span>.body.appendChild(v);
      v.select();
      <span class="hljs-keyword">var</span> result = <span class="hljs-literal">true</span>;
      <span class="hljs-keyword">try</span> {
        result = <span class="hljs-built_in">document</span>.execCommand(<span class="hljs-string">'copy'</span>);
        <span class="hljs-keyword">if</span> (result &amp;&amp; browserReturnsErroneousStatus) {
          <span class="hljs-keyword">var</span> checkDiv = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'textarea'</span>);
          checkDiv.className = <span class="hljs-string">"sr-only"</span>;
          <span class="hljs-built_in">document</span>.body.appendChild(checkDiv);
          checkDiv.select();
          <span class="hljs-keyword">try</span> {
            <span class="hljs-built_in">document</span>.execCommand(<span class="hljs-string">'paste'</span>);
            result = checkDiv.value == str;
          } <span class="hljs-keyword">finally</span> {
            <span class="hljs-built_in">document</span>.body.removeChild(checkDiv);
          }
        }
      } <span class="hljs-keyword">catch</span> (e) {
        result = <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.jslog)
          jslog(<span class="hljs-string">"Couldn't access clipboard "</span> + e);
      } <span class="hljs-keyword">finally</span> {
        <span class="hljs-built_in">document</span>.body.removeChild(v);
      }
      <span class="hljs-keyword">if</span> (result) {
        fireCopiedMessage(messageMethod);
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
      }
    }
    legacyClipboardCopy(str);
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isCapableMessageMethod</span>(<span class="hljs-params">messageMethod</span>) </span>{
    <span class="hljs-keyword">if</span> (messageMethod == <span class="hljs-string">'custom'</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-string">'GlideUI'</span> <span class="hljs-keyword">in</span> <span class="hljs-built_in">window</span>;
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fireCopiedMessage</span>(<span class="hljs-params">messageMethod</span>) </span>{
    <span class="hljs-keyword">if</span> (!messageMethod || messageMethod == <span class="hljs-string">'GlideUI'</span>) {
      <span class="hljs-keyword">var</span> span = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'span'</span>);
      span.setAttribute(<span class="hljs-string">'data-type'</span>, <span class="hljs-string">'info'</span>);
      span.setAttribute(<span class="hljs-string">'data-text'</span>, <span class="hljs-string">'Copied to clipboard'</span>);
      span.setAttribute(<span class="hljs-string">'data-duration'</span>, <span class="hljs-string">'2500'</span>);
      GlideUI.get().fire(<span class="hljs-keyword">new</span> GlideUINotification({
        <span class="hljs-attr">xml</span>: span
      }));
    }
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">legacyClipboardCopy</span>(<span class="hljs-params">meintext</span>) </span>{
    prompt(<span class="hljs-string">"Because of a browser limitation the URL can not be placed directly in the clipboard. "</span> +
      <span class="hljs-string">"Please use Ctrl-C to copy the data and escape to dismiss this dialog"</span>, meintext);
  }
})(<span class="hljs-built_in">window</span>.NOW.g_clipboard);;
<span class="hljs-comment">/*! RESOURCE: /scripts/context_actions.js */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">switchView</span>(<span class="hljs-params">type, tableName, viewName</span>) </span>{
  ScriptLoader.getScripts(<span class="hljs-string">'scripts/classes/GlideViewManager.js'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (type == <span class="hljs-string">'list'</span>)
      <span class="hljs-keyword">new</span> GlideViewManager(tableName, viewName).refreshList();
    <span class="hljs-keyword">else</span>
      <span class="hljs-keyword">new</span> GlideViewManager(tableName, viewName).refreshDetail();
  })
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">copyRowToClipboard</span>(<span class="hljs-params">base, ref, sysId, view</span>) </span>{
  <span class="hljs-keyword">var</span> url = base + <span class="hljs-string">"nav_to.do?uri="</span> + ref + <span class="hljs-string">".do?sys_id="</span> + sysId;
  <span class="hljs-keyword">if</span> (view)
    url += <span class="hljs-string">"%26sysparm_view="</span> + view;
  copyToClipboard(url);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">doUpdate</span>(<span class="hljs-params">scope</span>) </span>{
  <span class="hljs-keyword">var</span> name = gActiveContext.getTableName();
  <span class="hljs-keyword">var</span> temp = name + <span class="hljs-string">'_update.do'</span>;
  <span class="hljs-keyword">var</span> form = getControlForm(name);
  <span class="hljs-keyword">var</span> msg = [<span class="hljs-string">'There are no rows selected'</span>, <span class="hljs-string">'Update the entire list?'</span>, <span class="hljs-string">'records'</span>];
  <span class="hljs-keyword">var</span> answer = getMessages(msg);
  <span class="hljs-keyword">if</span> (scope == <span class="hljs-string">'selected'</span> &amp;&amp; getChecked(form) == <span class="hljs-string">''</span>) {
    alert(answer[<span class="hljs-string">'There are no rows selected'</span>]);
    <span class="hljs-keyword">return</span>;
  }
  form.action = temp;
  addInput(form, <span class="hljs-string">'HIDDEN'</span>, <span class="hljs-string">'sys_action'</span>, <span class="hljs-string">'sysverb_multiple_update'</span>);
  addInput(form, <span class="hljs-string">'HIDDEN'</span>, <span class="hljs-string">'sysparm_multiple'</span>, <span class="hljs-string">'true'</span>);
  addInput(form, <span class="hljs-string">'HIDDEN'</span>, <span class="hljs-string">'sysparm_nostack'</span>, <span class="hljs-string">'yes'</span>);
  <span class="hljs-keyword">if</span> (scope == <span class="hljs-string">'selected'</span>)
    populateParmQuery(form, <span class="hljs-string">'sys_idIN'</span>, <span class="hljs-string">'NULL'</span>);
  <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">if</span> (!confirm(answer[<span class="hljs-string">'Update the entire list?'</span>] + <span class="hljs-string">" ("</span> +
        form.sysparm_total_rows.value + <span class="hljs-string">" "</span> + answer[<span class="hljs-string">'records'</span>] + <span class="hljs-string">")"</span>)) {
      <span class="hljs-keyword">return</span>;
    }
  }
  form.submit();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">contextAction</span>(<span class="hljs-params">tableName, actionName</span>) </span>{
  <span class="hljs-keyword">var</span> form = getControlForm(tableName);
  addInput(form, <span class="hljs-string">'HIDDEN'</span>, <span class="hljs-string">'sys_action'</span>, actionName);
  form.submit();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">contextConfirm</span>(<span class="hljs-params">tableName, actionName</span>) </span>{
  <span class="hljs-keyword">var</span> sysparm_rows = gel(<span class="hljs-string">'sysparm_total_rows'</span>).value;
  <span class="hljs-keyword">var</span> num_rows = <span class="hljs-built_in">parseInt</span>(sysparm_rows);
  <span class="hljs-keyword">var</span> sysparm_query = gel(<span class="hljs-string">'sysparm_query'</span>);
  <span class="hljs-keyword">if</span> (sysparm_query)
    sysparm_query = sysparm_query.value;
  <span class="hljs-keyword">else</span>
    sysparm_query = <span class="hljs-string">''</span>;
  <span class="hljs-keyword">var</span> sysparm_view = getView(tableName);
  <span class="hljs-keyword">if</span> (num_rows &lt; g_export_warn_threshold) {
    <span class="hljs-keyword">var</span> dialog = <span class="hljs-keyword">new</span> GwtPollDialog(tableName, sysparm_query, sysparm_rows, sysparm_view, actionName);
    dialog.execute();
    <span class="hljs-keyword">return</span>;
  }
  <span class="hljs-keyword">var</span> dialog = <span class="hljs-keyword">new</span> GwtExportScheduleDialog(tableName, sysparm_query, sysparm_rows, sysparm_view, actionName);
  dialog.execute();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">executeRecentSearch</span>(<span class="hljs-params">searchTerm, url</span>) </span>{
  parent.document.getElementById(<span class="hljs-string">'sysparm_search'</span>).value = <span class="hljs-built_in">decodeURIComponent</span>(searchTerm);
  <span class="hljs-built_in">window</span>.open(url, <span class="hljs-string">'gsft_main'</span>);
  CustomEvent.fire(<span class="hljs-string">'adjustsearch'</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getView</span>(<span class="hljs-params">tableName</span>) </span>{
  <span class="hljs-keyword">var</span> sysparm_view = <span class="hljs-string">''</span>;
  <span class="hljs-keyword">if</span> (isReport()) {
    <span class="hljs-keyword">var</span> form = getControlForm(tableName);
    <span class="hljs-keyword">if</span> (form) {
      <span class="hljs-keyword">var</span> temp = form[<span class="hljs-string">'sysparm_view'</span>];
      <span class="hljs-keyword">if</span> (temp)
        sysparm_view = temp.value;
    }
  }
  <span class="hljs-keyword">if</span> (sysparm_view != <span class="hljs-string">''</span>)
    <span class="hljs-keyword">return</span> sysparm_view;
  <span class="hljs-keyword">var</span> sp = gel(<span class="hljs-string">'sysparm_view'</span>);
  <span class="hljs-keyword">if</span> (sp)
    sysparm_view = sp.value;
  <span class="hljs-keyword">return</span> sysparm_view;

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isReport</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> list = gel(<span class="hljs-string">'reportform_control'</span>);
    <span class="hljs-keyword">if</span> (list)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  }
}
<span class="hljs-keyword">var</span> copyToClipboard = <span class="hljs-keyword">typeof</span> <span class="hljs-built_in">window</span>.NOW.g_clipboard !== <span class="hljs-string">'undefined'</span> ? <span class="hljs-built_in">window</span>.NOW.g_clipboard.copyToClipboard : <span class="hljs-literal">null</span>;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">showQuickForm</span>(<span class="hljs-params">id, action, width, height</span>) </span>{
  <span class="hljs-keyword">var</span> form;
  <span class="hljs-keyword">var</span> tableName;
  <span class="hljs-keyword">var</span> srcElement;
  <span class="hljs-keyword">var</span> keyset;
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.lastEvent) {
    srcElement = getSrcElement(<span class="hljs-built_in">window</span>.lastEvent);
    form = srcElement.form;
    <span class="hljs-keyword">if</span> (srcElement.tagName == <span class="hljs-string">"SELECT"</span>) {
      <span class="hljs-keyword">var</span> o = srcElement.options[srcElement.selectedIndex];
      tableName = o.getAttribute(<span class="hljs-string">"table"</span>);
    } <span class="hljs-keyword">else</span>
      tableName = srcElement.getAttribute(<span class="hljs-string">"table"</span>);
    <span class="hljs-keyword">if</span> ((action == <span class="hljs-literal">undefined</span> || action == <span class="hljs-string">''</span>) &amp;&amp; srcElement.value)
      action = srcElement.value;
    <span class="hljs-keyword">if</span> (!form)
      keyset = g_list.getChecked();
    <span class="hljs-keyword">else</span>
      keyset = getChecked(form);
    <span class="hljs-built_in">window</span>.lastEvent = <span class="hljs-literal">null</span>;
  }
  <span class="hljs-keyword">if</span> (tableName == <span class="hljs-literal">undefined</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span>(gcm) == <span class="hljs-string">'undefined'</span>)
      gcm = crumbMenu;
    tableName = gcm.getTableName();
    form = getFormForList(tableName);
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span>(rowSysId) != <span class="hljs-string">'undefined'</span>)
      keyset = rowSysId;
    <span class="hljs-keyword">else</span>
      keyset = getChecked(form);
    gcm.setFiringObject();
  }
  <span class="hljs-keyword">if</span> ((!form &amp;&amp; !tableName) || (!tableName &amp;&amp; g_list))
    <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">if</span> (!keyset || keyset == <span class="hljs-string">''</span>) {
    alert(<span class="hljs-string">"No records selected"</span>);
    <span class="hljs-keyword">return</span>;
  }
  <span class="hljs-keyword">var</span> gForm = <span class="hljs-keyword">new</span> GlideDialogForm(<span class="hljs-string">""</span>, tableName + <span class="hljs-string">"_update"</span>);
  <span class="hljs-keyword">if</span> (width &amp;&amp; height)
    gForm.setDialogSize(width, height);
  gForm.addParm(<span class="hljs-string">'sysparm_view'</span>, id);
  gForm.setMultiple(form);
  gForm.addParm(<span class="hljs-string">'sysparm_checked_items'</span>, <span class="hljs-string">"sys_idIN"</span> + keyset);
  <span class="hljs-keyword">if</span> (action &amp;&amp; action != <span class="hljs-string">''</span>)
    gForm.addParm(<span class="hljs-string">'sysparm_action_name'</span>, action);
  gForm.render();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">personalizeResponses</span>(<span class="hljs-params">id</span>) </span>{
  <span class="hljs-keyword">var</span> parts = id.split(<span class="hljs-string">'.'</span>);
  <span class="hljs-keyword">var</span> mytable = parts[<span class="hljs-number">0</span>];
  <span class="hljs-keyword">var</span> myfield = parts[<span class="hljs-number">1</span>];
  <span class="hljs-keyword">var</span> myreferurl = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'sysparm_this_url_enc'</span>);
  <span class="hljs-keyword">var</span> url = <span class="hljs-string">"response_list.do?sysparm_name="</span> + mytable +
    <span class="hljs-string">"&amp;sysparm_element="</span> + myfield +
    <span class="hljs-string">"&amp;sysparm_target="</span> + id +
    <span class="hljs-string">"&amp;sysparm_view=sys_response_tailor"</span>;
  <span class="hljs-keyword">if</span> (myreferurl)
    url += <span class="hljs-string">"&amp;sysparm_referring_url="</span> + myreferurl.value;
  self.location = url;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">personalizeChoices</span>(<span class="hljs-params">id</span>) </span>{
  <span class="hljs-keyword">var</span> mytable = id.split(<span class="hljs-string">'.'</span>)[<span class="hljs-number">0</span>];
  <span class="hljs-keyword">var</span> mydependent = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'ni.dependent_reverse.'</span> + id);
  <span class="hljs-keyword">var</span> url = <span class="hljs-keyword">new</span> GlideURL(<span class="hljs-string">"slushbucket_choice.do"</span>);
  url.addParam(<span class="hljs-string">'sysparm_ref'</span>, id);
  url.addParam(<span class="hljs-string">'sysparm_form'</span>, <span class="hljs-string">'sys_choice'</span>);
  url.addParam(<span class="hljs-string">'sysparm_dependent'</span>, (mydependent ? mydependent.value : <span class="hljs-string">""</span>));
  url.addParam(<span class="hljs-string">'sysparm_stack'</span>, <span class="hljs-string">'no'</span>);
  <span class="hljs-keyword">if</span> (mydependent != <span class="hljs-literal">null</span>) {
    <span class="hljs-keyword">var</span> el = <span class="hljs-built_in">document</span>.getElementsByName(mytable + <span class="hljs-string">"."</span> + mydependent.value)[<span class="hljs-number">0</span>];
    <span class="hljs-keyword">if</span> (el != <span class="hljs-literal">null</span>) {
      <span class="hljs-keyword">var</span> selectValue;
      <span class="hljs-keyword">if</span> (el.options)
        selectValue = el.options[el.selectedIndex].value;
      <span class="hljs-keyword">else</span>
        selectValue = el.value;
      url.addParam(<span class="hljs-string">'sysparm_dependent_value'</span>, selectValue);
    }
  }
  self.location = url.getURL();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">personalizeControl</span>(<span class="hljs-params">strIdent, id, query</span>) </span>{
  <span class="hljs-keyword">var</span> url = <span class="hljs-string">'sys_ui_list_control.do?sys_id='</span> + id;
  <span class="hljs-keyword">if</span> (query &amp;&amp; query != <span class="hljs-string">''</span>)
    url += <span class="hljs-string">"&amp;sysparm_query="</span> + query;
  <span class="hljs-built_in">window</span>.location = url;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">personalizer</span>(<span class="hljs-params">strIdent, strForm, strSysId</span>) </span>{
  <span class="hljs-keyword">if</span> (strIdent == <span class="hljs-string">'auto'</span> &amp;&amp; <span class="hljs-built_in">window</span>.$j) {
    strIdent = $j(<span class="hljs-string">'[data-section-id]'</span>).first().attr(<span class="hljs-string">'data-section-id'</span>);
  }
  <span class="hljs-keyword">var</span> parentForm = getControlForm(strIdent);
  <span class="hljs-keyword">var</span> form = <span class="hljs-built_in">document</span>.forms[<span class="hljs-string">'sys_personalize'</span>];
  <span class="hljs-keyword">if</span> (parentForm &amp;&amp; parentForm[<span class="hljs-string">'sysparm_collection_relationship'</span>])
    addInput(form, <span class="hljs-string">'HIDDEN'</span>, <span class="hljs-string">'sysparm_collection_relationship'</span>, parentForm[<span class="hljs-string">'sysparm_collection_relationship'</span>].value);
  <span class="hljs-keyword">else</span>
    addInput(form, <span class="hljs-string">'HIDDEN'</span>, <span class="hljs-string">'sysparm_collection_relationship'</span>, <span class="hljs-string">''</span>);
  addInput(form, <span class="hljs-string">'HIDDEN'</span>, <span class="hljs-string">'sysparm_list'</span>, strIdent);
  addInput(form, <span class="hljs-string">'HIDDEN'</span>, <span class="hljs-string">'sysparm_form'</span>, strForm);
  addInput(form, <span class="hljs-string">'HIDDEN'</span>, <span class="hljs-string">'sysparm_sys_id'</span>, strSysId);
  <span class="hljs-keyword">if</span> (parentForm &amp;&amp; parentForm[<span class="hljs-string">'sysparm_collection'</span>])
    addInput(form, <span class="hljs-string">'HIDDEN'</span>, <span class="hljs-string">'sysparm_collection'</span>, parentForm[<span class="hljs-string">'sysparm_collection'</span>].value);
  <span class="hljs-keyword">var</span> scopeElement = gel(<span class="hljs-string">'sysparm_domain_scope'</span>);
  <span class="hljs-keyword">if</span> (scopeElement &amp;&amp; scopeElement.value) {
    addInput(form, <span class="hljs-string">'HIDDEN'</span>, <span class="hljs-string">'sysparm_domain_scope'</span>, scopeElement.value);
  }
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> GlideTransactionScope != <span class="hljs-string">'undefined'</span>) {
    GlideTransactionScope.appendTransactionScope(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name, value</span>) </span>{
      addInput(form, <span class="hljs-string">'HIDDEN'</span>, name, value);
    });
  }
  form.submit();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">personalizeList</span>(<span class="hljs-params">listId, tableName</span>) </span>{
  <span class="hljs-keyword">var</span> parentForm = getFormForList(listId);
  <span class="hljs-keyword">var</span> form = <span class="hljs-built_in">document</span>.forms[<span class="hljs-string">'sys_personalize'</span>];
  <span class="hljs-keyword">if</span> (parentForm &amp;&amp; parentForm[<span class="hljs-string">'sysparm_collection_relationship'</span>])
    addInput(form, <span class="hljs-string">'HIDDEN'</span>, <span class="hljs-string">'sysparm_collection_relationship'</span>, parentForm[<span class="hljs-string">'sysparm_collection_relationship'</span>].value);
  <span class="hljs-keyword">else</span>
    addInput(form, <span class="hljs-string">'HIDDEN'</span>, <span class="hljs-string">'sysparm_collection_relationship'</span>, <span class="hljs-string">''</span>);
  addInput(form, <span class="hljs-string">'HIDDEN'</span>, <span class="hljs-string">'sysparm_list'</span>, tableName);
  addInput(form, <span class="hljs-string">'HIDDEN'</span>, <span class="hljs-string">'sysparm_form'</span>, <span class="hljs-string">'list'</span>);
  <span class="hljs-keyword">if</span> (parentForm &amp;&amp; parentForm[<span class="hljs-string">'sysparm_collection'</span>])
    addInput(form, <span class="hljs-string">'HIDDEN'</span>, <span class="hljs-string">'sysparm_collection'</span>, parentForm[<span class="hljs-string">'sysparm_collection'</span>].value);
  <span class="hljs-keyword">else</span>
    addInput(form, <span class="hljs-string">'HIDDEN'</span>, <span class="hljs-string">'sysparm_collection'</span>, <span class="hljs-string">''</span>);
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> GlideTransactionScope !== <span class="hljs-string">'undefined'</span>) {
    GlideTransactionScope.appendTransactionScope(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name, value</span>) </span>{
      addInput(form, <span class="hljs-string">'HIDDEN'</span>, name, value);
    });
  }
  form.submit();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">personalizeField</span>(<span class="hljs-params">identifier, formName</span>) </span>{
  <span class="hljs-keyword">var</span> form = <span class="hljs-built_in">document</span>.forms[<span class="hljs-string">'sys_personalize'</span>];
  <span class="hljs-keyword">var</span> fields = <span class="hljs-string">'name.element.language'</span>;
  <span class="hljs-keyword">if</span> (formName &amp;&amp; formName.indexOf(<span class="hljs-string">'sys_dictionary'</span>) == <span class="hljs-number">0</span>)
    fields = <span class="hljs-string">'name.element'</span>;
  addQueryFilter(form, fields, identifier, <span class="hljs-string">''</span>, formName);
  form.action = formName;
  form.submit();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">personalizeFields</span>(<span class="hljs-params">identifier, formName</span>) </span>{
  <span class="hljs-keyword">var</span> form = <span class="hljs-built_in">document</span>.forms[<span class="hljs-string">'sys_personalize'</span>];
  addQueryFilter(form, <span class="hljs-string">'name'</span>, identifier);
  form.action = formName;
  form.submit();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">personalizeSecurity</span>(<span class="hljs-params">identifier, field_name</span>) </span>{
  <span class="hljs-keyword">var</span> a = field_name.split(<span class="hljs-string">'.'</span>);
  <span class="hljs-keyword">var</span> g_dialog = <span class="hljs-keyword">new</span> GlideDialogWindow(<span class="hljs-string">'security_mechanic'</span>);
  g_dialog.setPreference(<span class="hljs-string">'table_name'</span>, a[<span class="hljs-number">0</span>]);
  g_dialog.setPreference(<span class="hljs-string">'field_name'</span>, a[<span class="hljs-number">1</span>]);
  g_dialog.setSize(<span class="hljs-number">600</span>, <span class="hljs-string">''</span>);
  g_dialog.setTitle(<span class="hljs-string">'Security Mechanic'</span>);
  g_dialog.render();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">showDictionary</span>(<span class="hljs-params">identifier, field_id</span>) </span>{
  <span class="hljs-keyword">var</span> a = field_id.split(<span class="hljs-string">'.'</span>);
  <span class="hljs-keyword">var</span> g_dialog = <span class="hljs-keyword">new</span> GlideDialogWindow(<span class="hljs-string">'dictionary_viewer'</span>);
  g_dialog.setPreference(<span class="hljs-string">'table_name'</span>, a[<span class="hljs-number">0</span>]);
  g_dialog.setPreference(<span class="hljs-string">'field_name'</span>, a[<span class="hljs-number">1</span>]);
  g_dialog.setTitle(<span class="hljs-string">'Dictionary Info: '</span> + field_id);
  g_dialog.render();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">listSecurity</span>(<span class="hljs-params">identifier, field_name</span>) </span>{
  <span class="hljs-keyword">var</span> form = <span class="hljs-built_in">document</span>.forms[<span class="hljs-string">'sys_personalize'</span>];
  addQueryFilter(form, <span class="hljs-string">'CALCULATED:SecurityQueryCalculator'</span>, field_name);
  form.action = <span class="hljs-string">"sys_security_acl_list.do"</span>;
  form.submit();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">listCollection</span>(<span class="hljs-params">coll_table, coll_field, of_table, view_name</span>) </span>{
  <span class="hljs-keyword">var</span> form = <span class="hljs-built_in">document</span>.forms[<span class="hljs-string">'sys_personalize'</span>];
  addQueryFilter(form, <span class="hljs-string">'CALCULATED:CollectionQueryCalculator'</span>, of_table + <span class="hljs-string">','</span> + coll_field + <span class="hljs-string">','</span> + view_name);
  addInput(form, <span class="hljs-string">'HIDDEN'</span>, <span class="hljs-string">'sysparm_domain_restore'</span>, <span class="hljs-string">'false'</span>);
  form.action = coll_table + <span class="hljs-string">"_list.do"</span>;
  form.submit();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">exportToPDF</span>(<span class="hljs-params">table, sys_id, isLandscape, sysparm_view</span>) </span>{
  <span class="hljs-keyword">var</span> relatedListFilters = <span class="hljs-string">""</span>;
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.g_tabs2List &amp;&amp; g_tabs2List.tabIDs) {
    <span class="hljs-keyword">var</span> relatedLists = g_tabs2List.tabIDs;
    <span class="hljs-keyword">var</span> relatedListCount = relatedLists.length;
    <span class="hljs-keyword">if</span> (relatedListCount &gt; <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; relatedListCount; i++) {
        <span class="hljs-keyword">var</span> relatedListName = relatedLists[i].substring(<span class="hljs-number">0</span>, relatedLists[i].lastIndexOf(<span class="hljs-string">"_list"</span>));
        <span class="hljs-keyword">var</span> filter = getFilter(relatedListName);
        <span class="hljs-keyword">if</span> (filter &amp;&amp; filter.length &gt; <span class="hljs-number">0</span>) {
          <span class="hljs-keyword">if</span> (i == relatedListCount - <span class="hljs-number">1</span>)
            relatedListFilters += relatedListName + <span class="hljs-string">"="</span> + <span class="hljs-built_in">encodeURIComponent</span>(<span class="hljs-built_in">encodeURIComponent</span>(filter));
          <span class="hljs-keyword">else</span>
            relatedListFilters += relatedListName + <span class="hljs-string">"="</span> + <span class="hljs-built_in">encodeURIComponent</span>(<span class="hljs-built_in">encodeURIComponent</span>(filter)) + <span class="hljs-string">"^"</span>;
        }
      }
    }
  }
  <span class="hljs-keyword">var</span> url = table + <span class="hljs-string">".do?sys_id="</span> + sys_id + <span class="hljs-string">"&amp;PDF"</span> + <span class="hljs-string">"&amp;sysparm_view="</span> + sysparm_view + <span class="hljs-string">"&amp;related_list_filter="</span> + relatedListFilters;
  <span class="hljs-keyword">if</span> (isLandscape)
    url += <span class="hljs-string">"&amp;landscape=true"</span>;
  <span class="hljs-built_in">window</span>.location = url;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">showList</span>(<span class="hljs-params">tableName, fields, ids</span>) </span>{
  <span class="hljs-keyword">if</span> (!ids)
    ids = gActiveContext.getTableName();
  self.location = tableName + <span class="hljs-string">"_list.do?sysparm_query="</span> + addQueryFilter(<span class="hljs-string">''</span>, fields, ids, tableName);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">showItem</span>(<span class="hljs-params">tableName, fields, ids, view</span>) </span>{
  <span class="hljs-keyword">if</span> (!ids)
    ids = gActiveContext.getTableName();
  <span class="hljs-keyword">var</span> url = tableName + <span class="hljs-string">".do?sysparm_query="</span> + addQueryFilter(<span class="hljs-string">''</span>, fields, ids, tableName);
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span>(view) != <span class="hljs-string">"undefined"</span>) {
    url += <span class="hljs-string">"&amp;sysparm_view="</span> + view;
  }
  self.location = url;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addQueryFilter</span>(<span class="hljs-params">form, names, values, table, formName</span>) </span>{
  <span class="hljs-keyword">var</span> tableName = table;
  <span class="hljs-keyword">if</span> ((names == <span class="hljs-string">''</span> || names == <span class="hljs-literal">null</span>) || (values == <span class="hljs-string">''</span> || values == <span class="hljs-literal">null</span>))
    <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">if</span> (names.indexOf(<span class="hljs-string">"CALCULATED"</span>) == <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">var</span> ec = <span class="hljs-string">""</span>;
    <span class="hljs-keyword">if</span> (names.indexOf(<span class="hljs-string">"CollectionQueryCalculator"</span>) &gt; <span class="hljs-number">0</span>)
      ec = collectionQueryCalculator(values);
    <span class="hljs-keyword">else</span>
      ec = securityQueryCalculator(values);
    addInput(form, <span class="hljs-string">"HIDDEN"</span>, <span class="hljs-string">"sysparm_query"</span>, ec);
    addInput(form, <span class="hljs-string">"HIDDEN"</span>, <span class="hljs-string">"sysparm_query_encoced"</span>, ec);
    <span class="hljs-keyword">return</span>;
  }
  <span class="hljs-keyword">var</span> vNames = names.split(<span class="hljs-string">"."</span>);
  <span class="hljs-keyword">var</span> vValues = values.split(<span class="hljs-string">"."</span>);
  <span class="hljs-keyword">if</span> (names.indexOf(<span class="hljs-string">"name.element"</span>) == <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">if</span> (vValues.length &gt; <span class="hljs-number">2</span>) {
      <span class="hljs-keyword">var</span> tableElement = TableElement.get(values);
      vValues[<span class="hljs-number">0</span>] = tableElement.getTableName();
      vValues[<span class="hljs-number">1</span>] = tableElement.getName();
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">var</span> tableR = <span class="hljs-keyword">new</span> Table(vValues[<span class="hljs-number">0</span>]);
      <span class="hljs-keyword">var</span> element = tableR.getElement(vValues[<span class="hljs-number">1</span>]);
      <span class="hljs-keyword">var</span> label = <span class="hljs-string">''</span>;
      <span class="hljs-keyword">if</span> (formName &amp;&amp; formName.indexOf(<span class="hljs-string">"sys_documentation"</span>) == <span class="hljs-number">0</span>)
        label = getTableLabel(tableR.getName(), element.getName());
      <span class="hljs-keyword">if</span> (label == <span class="hljs-string">''</span> &amp;&amp; element != <span class="hljs-literal">null</span>)
        vValues[<span class="hljs-number">0</span>] = element.getTableName();
    }
  }
  <span class="hljs-keyword">if</span> (names.indexOf(<span class="hljs-string">"name.element.language"</span>) == <span class="hljs-number">0</span>) {
    vValues[<span class="hljs-number">2</span>] = g_lang;
  }
  <span class="hljs-keyword">var</span> query = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>();
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; vNames.length; i++) {
    <span class="hljs-keyword">if</span> (<span class="hljs-string">"sys_choice"</span> == tableName &amp;&amp; <span class="hljs-string">"name"</span> == vNames[i]) {
      query.push(<span class="hljs-string">"nameINjavascript:getTableExtensions('"</span> + vValues[i] + <span class="hljs-string">"')"</span>);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-string">"sys_ui_style"</span> == tableName &amp;&amp; <span class="hljs-string">"name"</span> == vNames[i]) {
      query.push(buildQueryClause(values.split(<span class="hljs-string">"."</span>)[<span class="hljs-number">0</span>], <span class="hljs-string">"name"</span>));
    } <span class="hljs-keyword">else</span>
      query.push(vNames[i] + <span class="hljs-string">"="</span> + vValues[i]);
  }
  <span class="hljs-keyword">if</span> (tableName)
    <span class="hljs-keyword">return</span> query.join(<span class="hljs-string">'^'</span>);
  addInput(form, <span class="hljs-string">"HIDDEN"</span>, <span class="hljs-string">"sysparm_query"</span>, query.join(<span class="hljs-string">'^'</span>));
  addInput(form, <span class="hljs-string">"HIDDEN"</span>, <span class="hljs-string">"sysparm_query_encoded"</span>, query.join(<span class="hljs-string">'^'</span>));
  setStack(form);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getTableLabel</span>(<span class="hljs-params">tabel, element</span>) </span>{
  <span class="hljs-keyword">var</span> ajax = <span class="hljs-keyword">new</span> GlideAjax(<span class="hljs-string">'ContextActionsAjax'</span>);
  ajax.addParam(<span class="hljs-string">"sysparm_name"</span>, <span class="hljs-string">"getLabel"</span>);
  ajax.addParam(<span class="hljs-string">"sysparm_type"</span>, tabel);
  ajax.addParam(<span class="hljs-string">"sysparm_value"</span>, element);
  ajax.getXMLWait();
  <span class="hljs-keyword">return</span> ajax.getAnswer();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">collectionQueryCalculator</span>(<span class="hljs-params">args</span>) </span>{
  <span class="hljs-keyword">var</span> sa = args.split(<span class="hljs-string">","</span>);
  <span class="hljs-keyword">var</span> tableName = sa[<span class="hljs-number">0</span>];
  <span class="hljs-keyword">var</span> collField = sa[<span class="hljs-number">1</span>];
  <span class="hljs-keyword">return</span> buildQueryClause(tableName, collField);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">buildQueryClause</span>(<span class="hljs-params">tableName, collField</span>) </span>{
  <span class="hljs-keyword">var</span> tableDef = Table.get(tableName);
  <span class="hljs-keyword">var</span> tables = tableDef.getTables();
  <span class="hljs-keyword">var</span> result = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>();
  result.push(collField);
  result.push(<span class="hljs-string">"="</span>);
  result.push(tableName);
  result.push(<span class="hljs-string">"^OR"</span>);
  result.push(collField);
  result.push(<span class="hljs-string">"IN"</span>);
  result.push(tables.join());
  <span class="hljs-keyword">return</span> result.join(<span class="hljs-string">""</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">securityQueryCalculator</span>(<span class="hljs-params">values</span>) </span>{
  <span class="hljs-keyword">var</span> sa = values.split(<span class="hljs-string">"."</span>);
  <span class="hljs-keyword">var</span> fieldName = <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">var</span> element = <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">var</span> tableName = sa[<span class="hljs-number">0</span>];
  <span class="hljs-keyword">if</span> (sa.length &gt; <span class="hljs-number">1</span>)
    fieldName = sa[<span class="hljs-number">1</span>];
  <span class="hljs-keyword">var</span> allTables = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>();
  <span class="hljs-keyword">var</span> table = <span class="hljs-keyword">new</span> Table(tableName);
  <span class="hljs-keyword">if</span> (fieldName == <span class="hljs-literal">null</span>)
    allTables = table.getTables();
  <span class="hljs-keyword">else</span> {
    allTables.push(tableName);
    element = table.getElement(fieldName);
    <span class="hljs-keyword">if</span> (element != <span class="hljs-literal">null</span> &amp;&amp; element.getTableName() != tableName)
      allTables.push(element.getTableName());
    allTables.push(<span class="hljs-string">"*"</span>);
  }
  <span class="hljs-keyword">var</span> rc = getRules(allTables, fieldName);
  <span class="hljs-keyword">return</span> rc;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getRules</span>(<span class="hljs-params">allTables, fieldName</span>) </span>{
  <span class="hljs-keyword">var</span> rules = <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">if</span> (fieldName == <span class="hljs-literal">null</span>) {
    rules = <span class="hljs-string">"name=*^ORnameSTARTSWITH*."</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; allTables.length; i++)
      rules += <span class="hljs-string">"^ORname="</span> + allTables[i] + <span class="hljs-string">"^ORnameSTARTSWITH"</span> + allTables[i] + <span class="hljs-string">"."</span>;
    <span class="hljs-keyword">return</span> rules;
  }
  <span class="hljs-keyword">var</span> rc = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>();
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> x = <span class="hljs-number">0</span>; x &lt; allTables.length; x++) {
    <span class="hljs-keyword">var</span> tableName = allTables[x];
    rc.push(tableName);
    rc.push(tableName + <span class="hljs-string">".*"</span>);
    <span class="hljs-keyword">if</span> (fieldName != <span class="hljs-literal">null</span>)
      rc.push(tableName + <span class="hljs-string">"."</span> + fieldName);
  }
  rules = <span class="hljs-string">"nameIN"</span> + rc.join();
  <span class="hljs-keyword">return</span> rules;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setWatchField</span>(<span class="hljs-params">id</span>) </span>{
  <span class="hljs-keyword">var</span> ajax = <span class="hljs-keyword">new</span> GlideAjax(<span class="hljs-string">'ContextActionsAjax'</span>);
  ajax.addParam(<span class="hljs-string">"sysparm_name"</span>, <span class="hljs-string">"setWatchField"</span>);
  ajax.addParam(<span class="hljs-string">"sysparm_id"</span>, id);
  ajax.getXML(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    CustomEvent.fire(<span class="hljs-string">'glide_optics_inspect_watchfield'</span>, id)
  });
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">showWatchField</span>(<span class="hljs-params">id</span>) </span>{
  <span class="hljs-keyword">var</span> ajax = <span class="hljs-keyword">new</span> GlideAjax(<span class="hljs-string">'ContextActionsAjax'</span>);
  ajax.addParam(<span class="hljs-string">"sysparm_name"</span>, <span class="hljs-string">"setWatchField"</span>);
  ajax.addParam(<span class="hljs-string">"sysparm_id"</span>, id);
  ajax.getXML(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    CustomEvent.fire(<span class="hljs-string">'glide_optics_inspect_show_watchfield'</span>, id)
  });
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">clearWatchField</span>(<span class="hljs-params">id</span>) </span>{
  <span class="hljs-keyword">var</span> ajax = <span class="hljs-keyword">new</span> GlideAjax(<span class="hljs-string">'ContextActionsAjax'</span>);
  ajax.addParam(<span class="hljs-string">"sysparm_name"</span>, <span class="hljs-string">"clearWatchField"</span>);
  ajax.getXML();
  ajax.getXML(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    CustomEvent.fire(<span class="hljs-string">'glide_optics_inspect_clear_watchfield'</span>, id)
  });
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setStack</span>(<span class="hljs-params">form</span>) </span>{
  <span class="hljs-keyword">var</span> url = <span class="hljs-keyword">new</span> GlideURL(<span class="hljs-built_in">window</span>.location.href);
  <span class="hljs-keyword">var</span> stack = url.getParam(<span class="hljs-string">'sysparm_nameofstack'</span>);
  <span class="hljs-keyword">if</span> (stack)
    addInput(form, <span class="hljs-string">'HIDDEN'</span>, <span class="hljs-string">'sysparm_nameofstack'</span>, stack);
};
<span class="hljs-comment">/*! RESOURCE: /scripts/depends.js */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getNameFromElement</span>(<span class="hljs-params">elementName</span>) </span>{
  <span class="hljs-keyword">var</span> names = elementName.split(<span class="hljs-string">"."</span>);
  names = names.slice(<span class="hljs-number">1</span>);
  <span class="hljs-keyword">return</span> names.join(<span class="hljs-string">"."</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">loadFilterColumns</span>(<span class="hljs-params">fname, dependent</span>) </span>{
  <span class="hljs-keyword">var</span> value = resolveDependentValue(fname, dependent);
  <span class="hljs-keyword">var</span> names = fname.split(<span class="hljs-string">"."</span>);
  serverRequest(<span class="hljs-string">"xmlhttp.do?sysparm_include_sysid=true&amp;sysparm_processor=SysMeta&amp;sysparm_table_name=false&amp;sysparm_type=column&amp;sysparm_nomax=true&amp;sysparm_value="</span> + names[<span class="hljs-number">0</span>], getFilterColumnsResponse, [fname, dependent]);
  CustomEvent.fire(<span class="hljs-string">'conditions:dependent_change'</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getFilterColumnsResponse</span>(<span class="hljs-params">evt, args</span>) </span>{
  <span class="hljs-keyword">var</span> fname = args[<span class="hljs-number">0</span>];
  <span class="hljs-keyword">var</span> dep = args[<span class="hljs-number">1</span>];
  <span class="hljs-keyword">var</span> hinput = <span class="hljs-built_in">document</span>.getElementById(fname);
  filterExpanded = <span class="hljs-literal">true</span>;
  <span class="hljs-keyword">var</span> table = resolveDependentValue(fname, dep);
  <span class="hljs-keyword">var</span> xfilter = <span class="hljs-built_in">unescape</span>(hinput.value);
  <span class="hljs-keyword">var</span> form = findParentByTag(hinput, <span class="hljs-string">"FORM"</span>);
  <span class="hljs-keyword">if</span> (table) {
    firstTable = table;
    createCondFilter(table + <span class="hljs-string">"."</span> + fname, xfilter, fname);
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onSelChange</span>(<span class="hljs-params">elementName</span>) </span>{
  <span class="hljs-keyword">var</span> vName = <span class="hljs-string">"ni.dependent."</span> + getNameFromElement(elementName);
  <span class="hljs-keyword">var</span> eDeps = <span class="hljs-built_in">document</span>.getElementsByName(vName);
  jslog(<span class="hljs-string">"*************----&gt;"</span> + eDeps.length);
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; eDeps.length; i++) {
    <span class="hljs-keyword">var</span> eDep = eDeps[i];
    <span class="hljs-keyword">if</span> (eDep == <span class="hljs-literal">null</span>)
      <span class="hljs-keyword">continue</span>;
    <span class="hljs-keyword">var</span> f = eDep.attributes.getNamedItem(<span class="hljs-string">'onDependentChange'</span>);
    <span class="hljs-keyword">if</span> (f) {
      <span class="hljs-built_in">eval</span>(f.nodeValue);
      <span class="hljs-keyword">continue</span>;
    }
    <span class="hljs-keyword">var</span> name = eDep.value;
    <span class="hljs-keyword">var</span> eChanged = gel(elementName);
    <span class="hljs-keyword">var</span> value;
    <span class="hljs-keyword">if</span> (eChanged.options) {
      <span class="hljs-keyword">var</span> selected = eChanged.selectedIndex;
      value = eChanged.options[selected].value;
    } <span class="hljs-keyword">else</span>
      value = eChanged.value;
    <span class="hljs-keyword">var</span> retFunc = selResponse;
    <span class="hljs-keyword">var</span> ajax = <span class="hljs-keyword">new</span> GlideAjax(<span class="hljs-string">"set_from_attributes"</span>);
    <span class="hljs-keyword">var</span> argCnt = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> ac = <span class="hljs-number">0</span>; ac &lt; eDep.attributes.length; ac++) {
      <span class="hljs-keyword">var</span> itemName = eDep.attributes[ac].name;
      <span class="hljs-keyword">if</span> (itemName.substring(<span class="hljs-number">0</span>, <span class="hljs-number">7</span>).toLowerCase() == <span class="hljs-string">"sysparm"</span>) {
        <span class="hljs-keyword">var</span> pvalue = eDep.attributes[ac].value;
        ajax.addParam(itemName, pvalue);
        argCnt++;
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (itemName == <span class="hljs-string">"function"</span>) {
        <span class="hljs-keyword">var</span> fdef = eDep.attributes[ac].value;
        <span class="hljs-keyword">var</span> index = fdef.indexOf(<span class="hljs-string">"("</span>);
        <span class="hljs-keyword">if</span> (index == <span class="hljs-number">-1</span>)
          retFunc = <span class="hljs-built_in">eval</span>(eDep.attributes[ac].value);
        <span class="hljs-keyword">else</span>
          retFunc = fdef;
      }
    }
    <span class="hljs-keyword">if</span> (argCnt == <span class="hljs-number">0</span>)
      <span class="hljs-keyword">continue</span>;
    ajax.addParam(<span class="hljs-string">"sysparm_value"</span>, value);
    ajax.addParam(<span class="hljs-string">"sysparm_name"</span>, name);
    ajax.addParam(<span class="hljs-string">"sysparm_chars"</span>, <span class="hljs-string">"*"</span>);
    ajax.addParam(<span class="hljs-string">"sysparm_nomax"</span>, <span class="hljs-string">"true"</span>);
    <span class="hljs-keyword">var</span> scopeElement = gel(<span class="hljs-string">'sysparm_domain_scope'</span>);
    <span class="hljs-keyword">if</span> (scopeElement &amp;&amp; scopeElement.value) {
      ajax.addParam(<span class="hljs-string">"sysparm_domain_scope"</span>, scopeElement.value);
    }
    <span class="hljs-keyword">var</span> domainElement = gel(<span class="hljs-string">'sysparm_domain'</span>);
    <span class="hljs-keyword">if</span> (domainElement &amp;&amp; domainElement.value) {
      ajax.addParam(<span class="hljs-string">"sysparm_domain"</span>, domainElement.value);
    }
    ajax.getXML(retFunc, <span class="hljs-literal">null</span>, eChanged);
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">selResponse</span>(<span class="hljs-params">request</span>) </span>{
  <span class="hljs-keyword">if</span> (!request || !request.responseXML)
    <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">var</span> e = request.responseXML.documentElement;
  <span class="hljs-keyword">var</span> elementName = e.getAttribute(<span class="hljs-string">"sysparm_name"</span>);
  <span class="hljs-keyword">var</span> processorName = e.getAttribute(<span class="hljs-string">"sysparm_processor"</span>);
  <span class="hljs-keyword">var</span> defaultOption = e.getAttribute(<span class="hljs-string">"default_option"</span>);
  <span class="hljs-keyword">var</span> selectedItem = e.getAttribute(<span class="hljs-string">"select_option"</span>);
  <span class="hljs-keyword">var</span> select = gel(elementName);
  <span class="hljs-keyword">var</span> currentValue = select.value;
  <span class="hljs-keyword">try</span> {
    select.options.length = <span class="hljs-number">0</span>;
  } <span class="hljs-keyword">catch</span> (e) {}
  <span class="hljs-keyword">if</span> (processorName == <span class="hljs-string">"PickList"</span>)
    appendSelectOption(select, <span class="hljs-string">""</span>, <span class="hljs-built_in">document</span>.createTextNode((defaultOption ? defaultOption : getMessage(<span class="hljs-string">'-- None --'</span>))));
  <span class="hljs-keyword">var</span> items = request.responseXML.getElementsByTagName(<span class="hljs-string">"item"</span>);
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; items.length; i++) {
    <span class="hljs-keyword">var</span> item = items[i];
    <span class="hljs-keyword">var</span> t = item.getAttribute(<span class="hljs-string">"value"</span>);
    <span class="hljs-keyword">var</span> label = item.getAttribute(<span class="hljs-string">"label"</span>);
    <span class="hljs-keyword">var</span> hint = item.getAttribute(<span class="hljs-string">"hint"</span>);
    <span class="hljs-keyword">var</span> opt = appendSelectOption(select, t, <span class="hljs-built_in">document</span>.createTextNode(label));
    <span class="hljs-keyword">if</span> (hint != <span class="hljs-string">''</span>)
      opt.title = hint;
    <span class="hljs-keyword">if</span> (selectedItem &amp;&amp; label == selectedItem)
      opt.selected = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (currentValue &amp;&amp; t == currentValue) {
      opt.selected = <span class="hljs-literal">true</span>;
      currentValue = <span class="hljs-string">''</span>;
    }
  }
  <span class="hljs-keyword">if</span> (select[<span class="hljs-string">'onchange'</span>])
    select.onchange();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hasDepends</span>(<span class="hljs-params">elementName</span>) </span>{
  <span class="hljs-keyword">var</span> vName = <span class="hljs-string">"ni.dependent."</span> + getNameFromElement(elementName);
  <span class="hljs-keyword">var</span> eDep = <span class="hljs-built_in">document</span>.getElementsByName(vName)[<span class="hljs-number">0</span>];
  <span class="hljs-keyword">return</span> eDep;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">resolveDependentValue</span>(<span class="hljs-params">id, depname, deptable</span>) </span>{
  <span class="hljs-keyword">var</span> systable = id.split(<span class="hljs-string">"."</span>)[<span class="hljs-number">0</span>];
  <span class="hljs-keyword">var</span> table = <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">var</span> dep = <span class="hljs-built_in">document</span>.getElementById(systable + <span class="hljs-string">'.'</span> + depname);
  <span class="hljs-keyword">if</span> (dep != <span class="hljs-literal">null</span>) {
    <span class="hljs-keyword">if</span> (dep.tagName == <span class="hljs-string">'SELECT'</span>)
      table = dep.options[dep.selectedIndex].value
    <span class="hljs-keyword">else</span>
      table = dep.value;
    table = table.split(<span class="hljs-string">"."</span>)[<span class="hljs-number">0</span>];
  } <span class="hljs-keyword">else</span> {
    table = deptable;
  }
  <span class="hljs-keyword">if</span> (table == <span class="hljs-string">'*'</span> || table == <span class="hljs-string">''</span> || table == <span class="hljs-string">'null'</span>)
    table = <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">return</span> table;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">loadFields</span>(<span class="hljs-params">fname, dependent, types, script_types, ref_types, script_ref_types, script_ref_types_dependent, field_choices_script, show_field_name_on_label, access_table</span>) </span>{
  <span class="hljs-keyword">var</span> depValue = resolveDependentValue(fname, dependent, dependent);
  loadFieldsWithValue(fname, depValue, types, script_types, ref_types, script_ref_types, script_ref_types_dependent, field_choices_script, show_field_name_on_label, access_table);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">loadFieldsWithValue</span>(<span class="hljs-params">fname, table, types, script_types, ref_types, script_ref_types, script_ref_types_dependent, field_choices_script, show_field_name_on_label, access_table</span>) </span>{
  <span class="hljs-keyword">var</span> script_ref_types_dependent_value = <span class="hljs-string">""</span>;
  <span class="hljs-keyword">if</span> (script_ref_types_dependent) {
    <span class="hljs-keyword">var</span> systable = fname.split(<span class="hljs-string">"."</span>)[<span class="hljs-number">0</span>];
    <span class="hljs-keyword">var</span> s_dep = gel(systable + <span class="hljs-string">'.'</span> + script_ref_types_dependent);
    <span class="hljs-keyword">if</span> (s_dep != <span class="hljs-literal">null</span>) {
      <span class="hljs-keyword">if</span> (s_dep.tagName == <span class="hljs-string">'SELECT'</span>)
        script_ref_types_dependent_value = s_dep.options[s_dep.selectedIndex].value;
      <span class="hljs-keyword">else</span>
        script_ref_types_dependent_value = s_dep.value;
    }
  }
  <span class="hljs-keyword">if</span> (table != <span class="hljs-literal">null</span>)
    getTableColumns(table, fname, types, script_types, ref_types, script_ref_types, script_ref_types_dependent_value, field_choices_script, show_field_name_on_label, access_table);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getTableColumns</span>(<span class="hljs-params">table, ref, types, script_types, ref_types, script_ref_types, script_ref_types_dependent_value, field_choices_script, show_field_name_on_label, access_table</span>) </span>{
  <span class="hljs-keyword">if</span> (!types)
    types = <span class="hljs-string">""</span>;
  <span class="hljs-keyword">if</span> (!script_types)
    script_types = <span class="hljs-string">""</span>;
  <span class="hljs-keyword">if</span> (!ref_types)
    ref_types = <span class="hljs-string">""</span>;
  <span class="hljs-keyword">if</span> (!script_ref_types)
    script_ref_types = <span class="hljs-string">""</span>;
  <span class="hljs-keyword">if</span> (!script_ref_types_dependent_value)
    script_ref_types_dependent_value = <span class="hljs-string">""</span>;
  <span class="hljs-keyword">var</span> serverRequestString = <span class="hljs-string">"xmlhttp.do?sysparm_include_sysid=true&amp;sysparm_processor=SysMeta&amp;sysparm_table_name=false&amp;sysparm_type=column&amp;sysparm_nomax=true"</span> +
    <span class="hljs-string">"&amp;sysparm_value="</span> + table +
    <span class="hljs-string">"&amp;sysparm_types="</span> + types +
    <span class="hljs-string">"&amp;sysparm_script_types="</span> + script_types +
    <span class="hljs-string">"&amp;sysparm_script_ref_types_dependent_value="</span> + script_ref_types_dependent_value +
    <span class="hljs-string">"&amp;sysparm_script_ref_types="</span> + script_ref_types +
    <span class="hljs-string">"&amp;sysparm_ref_types="</span> + ref_types +
    <span class="hljs-string">"&amp;sysparm_containing_table="</span> + $(<span class="hljs-string">'sys_target'</span>).value;
  <span class="hljs-keyword">if</span> (field_choices_script &amp;&amp; field_choices_script != <span class="hljs-string">""</span>)
    serverRequestString += <span class="hljs-string">"&amp;sysparm_field_choices_script="</span> + field_choices_script;
  <span class="hljs-keyword">if</span> (show_field_name_on_label &amp;&amp; show_field_name_on_label != <span class="hljs-string">""</span>)
    serverRequestString += <span class="hljs-string">"&amp;sysparm_show_field_name_on_label="</span> + show_field_name_on_label;
  <span class="hljs-keyword">if</span> (access_table)
    serverRequestString += <span class="hljs-string">"&amp;sysparm_access_table="</span> + access_table;
  serverRequestString += <span class="hljs-string">"&amp;sysparm_ref_field="</span> + <span class="hljs-built_in">encodeURIComponent</span>(ref);
  serverRequest(serverRequestString, getTableColumnsResponse, ref);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getTableColumnsResponse</span>(<span class="hljs-params">request, ref</span>) </span>{
  <span class="hljs-keyword">var</span> fname = ref;
  <span class="hljs-keyword">var</span> tcols = request.responseXML;
  <span class="hljs-keyword">var</span> scols = gel(fname);
  <span class="hljs-keyword">var</span> currentvis = scols.style.visibility;
  scols.style.visibility = <span class="hljs-string">"hidden"</span>;
  <span class="hljs-keyword">var</span> cfield = gel(<span class="hljs-string">'sys_original.'</span> + fname);
  cValue = cfield.value;
  scols.options.length = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">var</span> includeNone = scols.attributes.getNamedItem(<span class="hljs-string">'include_none'</span>);
  <span class="hljs-keyword">if</span> (includeNone) {
    <span class="hljs-keyword">if</span> (includeNone.nodeValue == <span class="hljs-string">'true'</span>)
      scols.options[scols.options.length] = <span class="hljs-keyword">new</span> Option(getMessage(<span class="hljs-string">'-- None --'</span>), <span class="hljs-string">''</span>);
  }
  <span class="hljs-keyword">var</span> items = tcols.getElementsByTagName(<span class="hljs-string">"item"</span>);
  <span class="hljs-keyword">var</span> sindex = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i != items.length; i++) {
    <span class="hljs-keyword">var</span> item = items[i];
    <span class="hljs-keyword">var</span> value = item.getAttribute(<span class="hljs-string">"value"</span>);
    <span class="hljs-keyword">var</span> label = item.getAttribute(<span class="hljs-string">"label"</span>);
    scols.options[scols.options.length] = <span class="hljs-keyword">new</span> Option(label, value);
    <span class="hljs-keyword">if</span> (cValue == value)
      sindex = scols.options.length - <span class="hljs-number">1</span>;
  }
  scols.selectedIndex = sindex;
  scols.style.visibility = currentvis;
  CustomEvent.fire(<span class="hljs-string">'getTableColumnsResponse.received'</span>);
  fireSetValueEvent();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fireSetValueEvent</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> g_form != <span class="hljs-string">'undefined'</span>) {
    <span class="hljs-keyword">var</span> form = g_form.getFormElement();
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> form != <span class="hljs-string">'undefined'</span>)
      $(form).fire(<span class="hljs-string">'glideform:setvalue'</span>);
  }
};
<span class="hljs-comment">/*! RESOURCE: /scripts/email_activity.js */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setEmailBody</span>(<span class="hljs-params">id</span>) </span>{
  <span class="hljs-keyword">var</span> iframeID = id + <span class="hljs-string">".body"</span>;
  <span class="hljs-keyword">var</span> iframe = gel(iframeID);
  <span class="hljs-keyword">if</span> (iframe)
    <span class="hljs-keyword">return</span>;
  iframe = cel(<span class="hljs-string">"iframe"</span>);
  iframe.id = iframeID;
  iframe.width = <span class="hljs-string">"100%"</span>;
  iframe.frameBorder = <span class="hljs-string">"0"</span>;
  Event.observe(iframe, <span class="hljs-string">"load"</span>, emailResizeObserved.bind(iframe), <span class="hljs-literal">true</span>);
  iframe.src = <span class="hljs-string">"email_display.do?email_id="</span> + id;
  iframe.email_id = id;
  <span class="hljs-keyword">var</span> cellID = id + <span class="hljs-string">".mail_cell"</span>;
  <span class="hljs-keyword">var</span> td = gel(cellID);
  <span class="hljs-keyword">if</span> (!td) {
    alert(<span class="hljs-string">"email_activity.js: TD missing for '"</span> + cellID + <span class="hljs-string">"'"</span>);
    <span class="hljs-keyword">return</span>;
  }
  td.appendChild(iframe);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">emailResizeObserved</span>(<span class="hljs-params"></span>) </span>{
  adjustEmailHeight(<span class="hljs-keyword">this</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">adjustEmailHeight</span>(<span class="hljs-params">frame</span>) </span>{
  frame.style.height = frame.contentWindow.document.body.scrollHeight + <span class="hljs-string">'px'</span>;
};
<span class="hljs-comment">/*! RESOURCE: /scripts/doctype/condition_global_variables14.js */</span>
<span class="hljs-keyword">var</span> MAIN_LAYER = <span class="hljs-string">"filterdiv"</span>;
<span class="hljs-keyword">var</span> TEXTQUERY = <span class="hljs-string">"123TEXTQUERY321"</span>;
<span class="hljs-keyword">var</span> PLACEHOLDER = <span class="hljs-string">"123PLACEHOLDER321"</span>;
<span class="hljs-keyword">var</span> PLACEHOLDERFIELD = <span class="hljs-string">'-- choose field --'</span>;
<span class="hljs-keyword">var</span> DEFAULT_NAME = <span class="hljs-string">"report"</span>;
<span class="hljs-keyword">var</span> DEFAULT_WIDTH = <span class="hljs-string">"10px"</span>;
<span class="hljs-keyword">var</span> DEFAULT_BORDER = <span class="hljs-number">0</span>;
<span class="hljs-keyword">var</span> JS_GS = <span class="hljs-string">'javascript:gs.'</span>;
<span class="hljs-keyword">var</span> useTextareas = <span class="hljs-literal">false</span>;
<span class="hljs-keyword">var</span> noConditionals = <span class="hljs-literal">false</span>;
<span class="hljs-keyword">var</span> noOps = <span class="hljs-literal">false</span>;
<span class="hljs-keyword">var</span> noSort = <span class="hljs-literal">false</span>;
<span class="hljs-keyword">var</span> gotShowRelated = <span class="hljs-literal">false</span>;
<span class="hljs-keyword">var</span> gotoPart = <span class="hljs-literal">false</span>;
<span class="hljs-keyword">var</span> calendars = <span class="hljs-number">0</span>;
<span class="hljs-keyword">var</span> refcount = <span class="hljs-number">0</span>;
<span class="hljs-keyword">var</span> sortIndex = <span class="hljs-number">0</span>;
<span class="hljs-keyword">var</span> queryNumber = <span class="hljs-number">0</span>;
<span class="hljs-keyword">var</span> calendarPopups = [];
<span class="hljs-keyword">var</span> filter;
<span class="hljs-keyword">var</span> orderBy;
<span class="hljs-keyword">var</span> columns = <span class="hljs-literal">null</span>;
<span class="hljs-keyword">var</span> currentTable = <span class="hljs-string">''</span>;
<span class="hljs-keyword">var</span> firstTable = <span class="hljs-string">''</span>;
<span class="hljs-keyword">var</span> oldStatus = <span class="hljs-string">''</span>;
<span class="hljs-keyword">var</span> showRelated = <span class="hljs-string">''</span>;
<span class="hljs-keyword">var</span> filterExpanded = <span class="hljs-literal">false</span>;
<span class="hljs-keyword">var</span> queueTables = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>();
<span class="hljs-keyword">var</span> queueFilters = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>();
<span class="hljs-keyword">var</span> queueColumns = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>();
<span class="hljs-keyword">var</span> operators = [
  <span class="hljs-string">"BETWEEN"</span>,
  <span class="hljs-string">"!="</span>,
  <span class="hljs-string">"&gt;="</span>,
  <span class="hljs-string">"&lt;="</span>,
  <span class="hljs-string">"="</span>,
  <span class="hljs-string">"&gt;"</span>,
  <span class="hljs-string">"&lt;"</span>,
  <span class="hljs-string">"NOT IN"</span>,
  <span class="hljs-string">"IN"</span>,
  <span class="hljs-string">"NOT LIKE"</span>,
  <span class="hljs-string">"LIKE"</span>,
  <span class="hljs-string">"ON"</span>,
  <span class="hljs-string">"NOTON"</span>,
  <span class="hljs-string">"DATEPART"</span>,
  <span class="hljs-string">"RELATIVE"</span>,
  <span class="hljs-string">"STARTSWITH"</span>,
  <span class="hljs-string">"ENDSWITH"</span>,
  <span class="hljs-string">"EMPTYSTRING"</span>,
  <span class="hljs-string">"ISEMPTY"</span>,
  <span class="hljs-string">"ISNOTEMPTY"</span>,
  <span class="hljs-string">"INSTANCEOF"</span>,
  <span class="hljs-string">"ANYTHING"</span>,
  <span class="hljs-string">"VALCHANGES"</span>,
  <span class="hljs-string">"CHANGESFROM"</span>,
  <span class="hljs-string">"CHANGESTO"</span>,
  <span class="hljs-string">"MATCH_PAT"</span>,
  <span class="hljs-string">"MATCH_RGX"</span>,
  <span class="hljs-string">"SAMEAS"</span>,
  <span class="hljs-string">"NSAMEAS"</span>,
  <span class="hljs-string">"MORETHAN"</span>,
  <span class="hljs-string">"LESSTHAN"</span>,
  <span class="hljs-string">"DYNAMIC"</span>,
  <span class="hljs-string">"GT_FIELD"</span>,
  <span class="hljs-string">"LT_FIELD"</span>,
  <span class="hljs-string">"GT_OR_EQUALS_FIELD"</span>,
  <span class="hljs-string">"LT_OR_EQUALS_FIELD"</span>,
  <span class="hljs-string">"HASVARIABLE"</span>,
  <span class="hljs-string">"HASITEMVARIABLE"</span>,
  <span class="hljs-string">"HASQUESTION"</span>,
  <span class="hljs-string">"HASLABEL"</span>
];
<span class="hljs-keyword">var</span> fieldComparisonOperators = [<span class="hljs-string">"SAMEAS"</span>, <span class="hljs-string">"NSAMEAS"</span>, <span class="hljs-string">"MORETHAN"</span>, <span class="hljs-string">"LESSTHAN"</span>, <span class="hljs-string">"GT_FIELD"</span>, <span class="hljs-string">"LT_FIELD"</span>, <span class="hljs-string">"GT_OR_EQUALS_FIELD"</span>, <span class="hljs-string">"LT_OR_EQUALS_FIELD"</span>];
<span class="hljs-keyword">var</span> dateTypes = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>();
dateTypes[<span class="hljs-string">'glide_date_time'</span>] = <span class="hljs-number">1</span>;
dateTypes[<span class="hljs-string">'glide_date'</span>] = <span class="hljs-number">1</span>;
dateTypes[<span class="hljs-string">'date'</span>] = <span class="hljs-number">1</span>;
dateTypes[<span class="hljs-string">'datetime'</span>] = <span class="hljs-number">1</span>;
dateTypes[<span class="hljs-string">'due_date'</span>] = <span class="hljs-number">1</span>;
<span class="hljs-keyword">var</span> dateOnlyTypes = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Object</span>();
dateOnlyTypes[<span class="hljs-string">'glide_date'</span>] = <span class="hljs-number">1</span>;
dateOnlyTypes[<span class="hljs-string">'date'</span>] = <span class="hljs-number">1</span>;
<span class="hljs-keyword">var</span> dateTimeTypes = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Object</span>();
dateTimeTypes[<span class="hljs-string">'glide_date_time'</span>] = <span class="hljs-number">1</span>;
dateTimeTypes[<span class="hljs-string">'datetime'</span>] = <span class="hljs-number">1</span>;
dateTimeTypes[<span class="hljs-string">'due_date'</span>] = <span class="hljs-number">1</span>;
<span class="hljs-keyword">var</span> numericTypes = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>();
numericTypes[<span class="hljs-string">'integer'</span>] = <span class="hljs-number">1</span>;
numericTypes[<span class="hljs-string">'decimal'</span>] = <span class="hljs-number">1</span>;
numericTypes[<span class="hljs-string">'numeric'</span>] = <span class="hljs-number">1</span>;
numericTypes[<span class="hljs-string">'float'</span>] = <span class="hljs-number">1</span>;
numericTypes[<span class="hljs-string">'domain_number'</span>] = <span class="hljs-number">1</span>;
numericTypes[<span class="hljs-string">'auto_increment'</span>] = <span class="hljs-number">1</span>;
numericTypes[<span class="hljs-string">'percent_complete'</span>] = <span class="hljs-number">1</span>;
<span class="hljs-keyword">var</span> opersNS = {};
opersNS.opdef = {
  <span class="hljs-string">'af'</span>: [<span class="hljs-string">'&gt;'</span>, <span class="hljs-string">'after'</span>],
  <span class="hljs-string">'ataf'</span>: [<span class="hljs-string">'&gt;='</span>, <span class="hljs-string">'at or after'</span>],
  <span class="hljs-string">'any'</span>: [<span class="hljs-string">'ANYTHING'</span>, <span class="hljs-string">'is anything'</span>],
  <span class="hljs-string">'are'</span>: [<span class="hljs-string">'='</span>, <span class="hljs-string">'are'</span>],
  <span class="hljs-string">'asc'</span>: [<span class="hljs-string">'ascending'</span>, <span class="hljs-string">'a to z'</span>],
  <span class="hljs-string">'avg'</span>: [<span class="hljs-string">'avg'</span>, <span class="hljs-string">'average'</span>],
  <span class="hljs-string">'bf'</span>: [<span class="hljs-string">'&lt;'</span>, <span class="hljs-string">'before'</span>],
  <span class="hljs-string">'atbf'</span>: [<span class="hljs-string">'&lt;='</span>, <span class="hljs-string">'at or before'</span>],
  <span class="hljs-string">'btw'</span>: [<span class="hljs-string">'BETWEEN'</span>, <span class="hljs-string">'between'</span>],
  <span class="hljs-string">'dsc'</span>: [<span class="hljs-string">'descending'</span>, <span class="hljs-string">'z to a'</span>],
  <span class="hljs-string">'dtpt'</span>: [<span class="hljs-string">'DATEPART'</span>, <span class="hljs-string">'trend'</span>],
  <span class="hljs-string">'em'</span>: [<span class="hljs-string">'ISEMPTY'</span>, <span class="hljs-string">'is empty'</span>],
  <span class="hljs-string">'es'</span>: [<span class="hljs-string">'EMPTYSTRING'</span>, <span class="hljs-string">'is empty string'</span>],
  <span class="hljs-string">'enwt'</span>: [<span class="hljs-string">'ENDSWITH'</span>, <span class="hljs-string">'ends with'</span>],
  <span class="hljs-string">'eq'</span>: [<span class="hljs-string">'='</span>, <span class="hljs-string">'is'</span>],
  <span class="hljs-string">'eqd'</span>: [<span class="hljs-string">'DYNAMIC'</span>, <span class="hljs-string">'is (dynamic)'</span>],
  <span class="hljs-string">'fvc'</span>: [<span class="hljs-string">'VALCHANGES'</span>, <span class="hljs-string">'changes'</span>],
  <span class="hljs-string">'fvf'</span>: [<span class="hljs-string">'CHANGESFROM'</span>, <span class="hljs-string">'changes from'</span>],
  <span class="hljs-string">'fvt'</span>: [<span class="hljs-string">'CHANGESTO'</span>, <span class="hljs-string">'changes to'</span>],
  <span class="hljs-string">'gt'</span>: [<span class="hljs-string">'&gt;'</span>, <span class="hljs-string">'greater than'</span>],
  <span class="hljs-string">'gteq'</span>: [<span class="hljs-string">'&gt;='</span>, <span class="hljs-string">'greater than or is'</span>],
  <span class="hljs-string">'inna'</span>: [<span class="hljs-string">'IN'</span>, <span class="hljs-string">'is one of'</span>],
  <span class="hljs-string">'inst'</span>: [<span class="hljs-string">'INSTANCEOF'</span>, <span class="hljs-string">'is a'</span>],
  <span class="hljs-string">'lk'</span>: [<span class="hljs-string">'LIKE'</span>, <span class="hljs-string">'contains'</span>],
  <span class="hljs-string">'lt'</span>: [<span class="hljs-string">'&lt;'</span>, <span class="hljs-string">'less than'</span>],
  <span class="hljs-string">'lteq'</span>: [<span class="hljs-string">'&lt;='</span>, <span class="hljs-string">'less than or is'</span>],
  <span class="hljs-string">'max'</span>: [<span class="hljs-string">'max'</span>, <span class="hljs-string">'maximum'</span>],
  <span class="hljs-string">'min'</span>: [<span class="hljs-string">'min'</span>, <span class="hljs-string">'minimum'</span>],
  <span class="hljs-string">'mpat'</span>: [<span class="hljs-string">'MATCH_PAT'</span>, <span class="hljs-string">'matches pattern'</span>],
  <span class="hljs-string">'mreg'</span>: [<span class="hljs-string">'MATCH_RGX'</span>, <span class="hljs-string">'matches regex'</span>],
  <span class="hljs-string">'ntem'</span>: [<span class="hljs-string">'ISNOTEMPTY'</span>, <span class="hljs-string">'is not empty'</span>],
  <span class="hljs-string">'nteq'</span>: [<span class="hljs-string">'!='</span>, <span class="hljs-string">'is not'</span>],
  <span class="hljs-string">'ntin'</span>: [<span class="hljs-string">'NOT IN'</span>, <span class="hljs-string">'is not one of'</span>],
  <span class="hljs-string">'ntlk'</span>: [<span class="hljs-string">'NOT LIKE'</span>, <span class="hljs-string">'does not contain'</span>],
  <span class="hljs-string">'nton'</span>: [<span class="hljs-string">'NOTON'</span>, <span class="hljs-string">'not on'</span>],
  <span class="hljs-string">'on'</span>: [<span class="hljs-string">'ON'</span>, <span class="hljs-string">'on'</span>],
  <span class="hljs-string">'oper'</span>: [<span class="hljs-string">'-- oper --'</span>, <span class="hljs-string">'-- oper --'</span>],
  <span class="hljs-string">'rltv'</span>: [<span class="hljs-string">'RELATIVE'</span>, <span class="hljs-string">'relative'</span>],
  <span class="hljs-string">'saas'</span>: [<span class="hljs-string">'SAMEAS'</span>, <span class="hljs-string">'is same'</span>],
  <span class="hljs-string">'nsas'</span>: [<span class="hljs-string">'NSAMEAS'</span>, <span class="hljs-string">'is different'</span>],
  <span class="hljs-string">'snc'</span>: [<span class="hljs-string">'SINCE'</span>, <span class="hljs-string">'since baseline'</span>],
  <span class="hljs-string">'stwt'</span>: [<span class="hljs-string">'STARTSWITH'</span>, <span class="hljs-string">'starts with'</span>],
  <span class="hljs-string">'sum'</span>: [<span class="hljs-string">'sum'</span>, <span class="hljs-string">'Total'</span>],
  <span class="hljs-string">'date_more'</span>: [<span class="hljs-string">'MORETHAN'</span>, <span class="hljs-string">'is more than'</span>],
  <span class="hljs-string">'date_less'</span>: [<span class="hljs-string">'LESSTHAN'</span>, <span class="hljs-string">'is less than'</span>],
  <span class="hljs-string">'gtfd'</span>: [<span class="hljs-string">'GT_FIELD'</span>, <span class="hljs-string">'greater than field'</span>],
  <span class="hljs-string">'ltfd'</span>: [<span class="hljs-string">'LT_FIELD'</span>, <span class="hljs-string">'less than field'</span>],
  <span class="hljs-string">'gteqfd'</span>: [<span class="hljs-string">'GT_OR_EQUALS_FIELD'</span>, <span class="hljs-string">'greater than or is field'</span>],
  <span class="hljs-string">'lteqfd'</span>: [<span class="hljs-string">'LT_OR_EQUALS_FIELD'</span>, <span class="hljs-string">'less than or is field'</span>]
};
opersNS.opdef_template = {
  <span class="hljs-string">'eq'</span>: [<span class="hljs-string">'='</span>, <span class="hljs-string">'To'</span>],
  <span class="hljs-string">'saas'</span>: [<span class="hljs-string">'SAMEAS'</span>, <span class="hljs-string">'Same as'</span>],
  <span class="hljs-string">'eqd'</span>: [<span class="hljs-string">'DYNAMIC'</span>, <span class="hljs-string">'To (dynamic)'</span>]
}
opersNS.compile = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">ops_input, opsdef</span>) </span>{
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> fieldType <span class="hljs-keyword">in</span> ops_input) {
    <span class="hljs-keyword">var</span> proto = ops_input[fieldType];
    <span class="hljs-keyword">if</span> (proto.charAt(<span class="hljs-number">0</span>) == <span class="hljs-string">'='</span>)
      <span class="hljs-keyword">continue</span>;
    <span class="hljs-keyword">var</span> opers = proto.split(<span class="hljs-string">","</span>);
    <span class="hljs-keyword">var</span> opArray = [];
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; opers.length; i++) {
      <span class="hljs-keyword">var</span> oper = opers[i];
      <span class="hljs-keyword">if</span> (oper)
        opArray.push(opsdef[oper]);
    }
    ops_input[fieldType] = opArray;
  }
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> fieldType <span class="hljs-keyword">in</span> ops_input) {
    <span class="hljs-keyword">var</span> proto = ops_input[fieldType];
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> proto != <span class="hljs-string">'string'</span>)
      <span class="hljs-keyword">continue</span>;
    ops_input[fieldType] = ops_input[proto.substring(<span class="hljs-number">1</span>)];
  }
}
<span class="hljs-keyword">var</span> sysopers = {
  <span class="hljs-string">'auto_increment'</span>: <span class="hljs-string">'=integer'</span>,
  <span class="hljs-string">'aggspec'</span>: <span class="hljs-string">'sum,avg,min,max,any,fvc,fvf,fvt'</span>,
  <span class="hljs-string">'boolean'</span>: <span class="hljs-string">'eq,nteq,em,ntem,any,fvc,fvf,fvt,saas,nsas'</span>,
  <span class="hljs-string">'calendar'</span>: <span class="hljs-string">'on,nton,bf,atbf,af,ataf,btw,dtpt,rltv,snc,em,ntem,any,fvc,saas,nsas,date_more,date_less'</span>,
  <span class="hljs-string">'choice'</span>: <span class="hljs-string">'eq,nteq,inna,ntin,lk,stwt,enwt,ntlk,any,fvc,fvf,fvt,saas,nsas'</span>,
  <span class="hljs-string">'referencechoice'</span>: <span class="hljs-string">'eq,nteq,inna,ntin,lk,stwt,enwt,ntlk,any'</span>,
  <span class="hljs-string">'composite_field'</span>: <span class="hljs-string">'stwt,lk,ntlk,any'</span>,
  <span class="hljs-string">'composite_name'</span>: <span class="hljs-string">'=string'</span>,
  <span class="hljs-string">'conditions'</span>: <span class="hljs-string">'=string'</span>,
  <span class="hljs-string">'condition_string'</span>: <span class="hljs-string">'=string'</span>,
  <span class="hljs-string">'css'</span>: <span class="hljs-string">'=html'</span>,
  <span class="hljs-string">'decimal'</span>: <span class="hljs-string">'=integer'</span>,
  <span class="hljs-string">'currency'</span>: <span class="hljs-string">'eq,nteq,em,ntem,lt,gt,lteq,gteq,btw'</span>,
  <span class="hljs-string">'default'</span>: <span class="hljs-string">'eq,nteq,any,fvc,fvf,fvt'</span>,
  <span class="hljs-string">'edgeEncryptionOrder'</span>: <span class="hljs-string">'eq,nteq,em,ntem,lt,gt,lteq,gteq'</span>,
  <span class="hljs-string">'edgeEncryptionEq'</span>: <span class="hljs-string">'eq,nteq,em,ntem'</span>,
  <span class="hljs-string">'email'</span>: <span class="hljs-string">'=string'</span>,
  <span class="hljs-string">'email_script'</span>: <span class="hljs-string">'=string'</span>,
  <span class="hljs-string">'field_name'</span>: <span class="hljs-string">'=string'</span>,
  <span class="hljs-string">'glide_duration'</span>: <span class="hljs-string">'eq,nteq,em,ntem,lt,gt,lteq,gteq,btw,any,fvc'</span>,
  <span class="hljs-string">'glide_list'</span>: <span class="hljs-string">'lk,ntlk,em,ntem,fvc,fvf,fvt'</span>,
  <span class="hljs-string">'GUID'</span>: <span class="hljs-string">'=string'</span>,
  <span class="hljs-string">'html'</span>: <span class="hljs-string">'lk,ntlk,em,ntem,any,fvc,fvf,fvt'</span>,
  <span class="hljs-string">'html_script'</span>: <span class="hljs-string">'=string'</span>,
  <span class="hljs-string">'html_template'</span>: <span class="hljs-string">'=script'</span>,
  <span class="hljs-string">'integer'</span>: <span class="hljs-string">'eq,nteq,em,ntem,lt,gt,lteq,gteq,btw,any,fvc,fvf,fvt,saas,nsas,gtfd,ltfd,gteqfd,lteqfd'</span>,
  <span class="hljs-string">'integer_choice'</span>: <span class="hljs-string">'eq,nteq,inna,ntin,em,ntem,lt,gt,lteq,gteq,btw,any,fvc,fvf,fvt,saas,nsas'</span>,
  <span class="hljs-string">'journal'</span>: <span class="hljs-string">'fvc'</span>,
  <span class="hljs-string">'journal_input'</span>: <span class="hljs-string">'=journal'</span>,
  <span class="hljs-string">'keyword'</span>: <span class="hljs-string">'are'</span>,
  <span class="hljs-string">'multi_two_lines'</span>: <span class="hljs-string">'=string'</span>,
  <span class="hljs-string">'percent_complete'</span>: <span class="hljs-string">'=integer'</span>,
  <span class="hljs-string">'ph_number'</span>: <span class="hljs-string">'=string'</span>,
  <span class="hljs-string">'phone_number_e164'</span>: <span class="hljs-string">'=string'</span>,
  <span class="hljs-string">'placeholder'</span>: <span class="hljs-string">'oper'</span>,
  <span class="hljs-string">'price'</span>: <span class="hljs-string">'eq,nteq,em,ntem,lt,gt,lteq,gteq,btw'</span>,
  <span class="hljs-string">'reference'</span>: <span class="hljs-string">'eq,nteq,em,ntem,stwt,enwt,lk,ntlk,any,saas,nsas,es,eqd,fvc,fvf,fvt'</span>,
  <span class="hljs-string">'referencevariable'</span>: <span class="hljs-string">'eq,nteq,em,ntem'</span>,
  <span class="hljs-string">'replication_payload'</span>: <span class="hljs-string">'=string'</span>,
  <span class="hljs-string">'script'</span>: <span class="hljs-string">'lk,ntlk,ntem,any,fvc,fvf,fvt'</span>,
  <span class="hljs-string">'script_plain'</span>: <span class="hljs-string">'=script'</span>,
  <span class="hljs-string">'script_server'</span>: <span class="hljs-string">'=script'</span>,
  <span class="hljs-string">'sortspec'</span>: <span class="hljs-string">'asc,dsc,fvc,fvf,fvt'</span>,
  <span class="hljs-string">'string'</span>: <span class="hljs-string">'stwt,enwt,lk,ntlk,eq,nteq,em,ntem,mpat,mreg,any,inna,es,fvc,fvf,fvt,lteq,gteq,btw,saas,nsas'</span>,
  <span class="hljs-string">'string_choice'</span>: <span class="hljs-string">'=choice'</span>,
  <span class="hljs-string">'string_clob'</span>: <span class="hljs-string">'lk,ntlk,stwt,enwt,em,ntem,any,fvc,fvf,fvt'</span>,
  <span class="hljs-string">'string_numeric'</span>: <span class="hljs-string">'eq,nteq,lk,ntlk,stwt,enwt,btw,any,fvc,fvf,fvt,saas,nsas'</span>,
  <span class="hljs-string">'sys_class_name'</span>: <span class="hljs-string">'eq,nteq,inst,any,fvc,fvf,fvt'</span>,
  <span class="hljs-string">'sysevent_name'</span>: <span class="hljs-string">'=string'</span>,
  <span class="hljs-string">'table_name'</span>: <span class="hljs-string">'=string'</span>,
  <span class="hljs-string">'timer'</span>: <span class="hljs-string">'=integer'</span>,
  <span class="hljs-string">'translated_field'</span>: <span class="hljs-string">'=string'</span>,
  <span class="hljs-string">'translated_html'</span>: <span class="hljs-string">'=html'</span>,
  <span class="hljs-string">'translated_text'</span>: <span class="hljs-string">'=string'</span>,
  <span class="hljs-string">'translated_basic'</span>: <span class="hljs-string">'eq,nteq,em,ntem'</span>,
  <span class="hljs-string">'url'</span>: <span class="hljs-string">'=string'</span>,
  <span class="hljs-string">'workflow'</span>: <span class="hljs-string">'=choice'</span>,
  <span class="hljs-string">'xml'</span>: <span class="hljs-string">'=html'</span>,
  <span class="hljs-string">'domain_path'</span>: <span class="hljs-string">'=string'</span>,
  <span class="hljs-string">'tree_code'</span>: <span class="hljs-string">'=string'</span>,
  <span class="hljs-string">'tree_path'</span>: <span class="hljs-string">'=string'</span>,
  <span class="hljs-string">'source_id'</span>: <span class="hljs-string">'=string'</span>,
  <span class="hljs-string">'source_name'</span>: <span class="hljs-string">'=string'</span>,
  <span class="hljs-string">'source_table'</span>: <span class="hljs-string">'=string'</span>
};
<span class="hljs-keyword">var</span> sysopers_template = {
  <span class="hljs-string">'default'</span>: <span class="hljs-string">'eq,saas,eqd'</span>
}
opersNS.compile(sysopers, opersNS.opdef);
opersNS.compile(sysopers_template, opersNS.opdef_template);
<span class="hljs-keyword">var</span> extopers = {};
extopers[<span class="hljs-string">'MATCH_PAT'</span>] = <span class="hljs-literal">true</span>;
extopers[<span class="hljs-string">'MATCH_RGX'</span>] = <span class="hljs-literal">true</span>;
extopers[<span class="hljs-string">'VALCHANGES'</span>] = <span class="hljs-literal">true</span>;
extopers[<span class="hljs-string">'CHANGESTO'</span>] = <span class="hljs-literal">true</span>;
extopers[<span class="hljs-string">'CHANGESFROM'</span>] = <span class="hljs-literal">true</span>;
<span class="hljs-keyword">var</span> calNS = {};
calNS.protoVal = [
  <span class="hljs-string">'Today: [0d   ]0d  ]0d  '</span>,
  <span class="hljs-string">'Yesterday: [1d   ]1d  ]1d  '</span>,
  <span class="hljs-string">'Tomorrow: [-1d  ]-1d ]-1d '</span>,
  <span class="hljs-string">'This week: [=w   ]=w  ]=w  '</span>,
  <span class="hljs-string">'Last week: [&lt;w   ]&lt;w  ]&lt;w  '</span>,
  <span class="hljs-string">'Next week: [&gt;w   ]&gt;w  ]&gt;w  '</span>,
  <span class="hljs-string">'This month: [=m   ]=m  ]=m  '</span>,
  <span class="hljs-string">'Last month: [&lt;m   ]&lt;m  ]&lt;m  '</span>,
  <span class="hljs-string">'Next month: [&gt;m   ]&gt;m  ]&gt;m  '</span>,
  <span class="hljs-string">'Last 3 months: [3m   ]=m  [3m  '</span>,
  <span class="hljs-string">'Last 6 months: [6m   ]=m  [6m  '</span>,
  <span class="hljs-string">'Last 9 months: [9m   ]=m  [9m  '</span>,
  <span class="hljs-string">'Last 12 months: [12m  ]=m  [12m '</span>,
  <span class="hljs-string">'This quarter: [=q   ]=q  ]=q  '</span>,
  <span class="hljs-string">'Last quarter: [1q   ]1q  ]1q  '</span>,
  <span class="hljs-string">'Last 2 quarters: [1q   ]=q  ]2q  '</span>,
  <span class="hljs-string">'Next quarter: [-1q  ]-1q ]-1q '</span>,
  <span class="hljs-string">'Next 2 quarters: [-1q  ]-2q ]-2q '</span>,
  <span class="hljs-string">'This year: [=y   ]=y  ]=y  '</span>,
  <span class="hljs-string">'Next year: [&gt;y   ]&gt;y  ]&gt;y  '</span>,
  <span class="hljs-string">'Last year: [&lt;y   ]&lt;y  ]&lt;y  '</span>,
  <span class="hljs-string">'Last 2 years: [&lt;y   ]=y  [&lt;y  '</span>,
  <span class="hljs-string">'Last 7 days: [7d   ]0d  [7d  '</span>,
  <span class="hljs-string">'Last 30 days: [30d  ]0d  [30d '</span>,
  <span class="hljs-string">'Last 60 days: [60d  ]0d  [60d '</span>,
  <span class="hljs-string">'Last 90 days: [90d  ]0d  [90d '</span>,
  <span class="hljs-string">'Last 120 days: [120d ]0d  [120d'</span>,
  <span class="hljs-string">'Current hour: [0h   ]0h  ]0h  '</span>,
  <span class="hljs-string">'Last hour: [1h   ]1h  ]1h  '</span>,
  <span class="hljs-string">'Last 2 hours: |2h   |0h  |2h  '</span>,
  <span class="hljs-string">'Current minute: [0n   ]0n  ]0n  '</span>,
  <span class="hljs-string">'Last minute: [1n   ]1n  [1n  '</span>,
  <span class="hljs-string">'Last 15 minutes: [15n  ]0n  [15n '</span>,
  <span class="hljs-string">'Last 30 minutes: [30n  ]0n  [30n '</span>,
  <span class="hljs-string">'Last 45 minutes: [45n  ]0n  [45n '</span>,
  <span class="hljs-string">'One year ago: |12m  ]=m  |12m '</span>
];
calNS.agoUnits = {
  <span class="hljs-attr">d</span>: <span class="hljs-string">'days'</span>,
  <span class="hljs-attr">m</span>: <span class="hljs-string">'months'</span>,
  <span class="hljs-attr">q</span>: <span class="hljs-string">'quarters'</span>,
  <span class="hljs-attr">h</span>: <span class="hljs-string">'hours'</span>,
  <span class="hljs-attr">n</span>: <span class="hljs-string">'minutes'</span>
};
calNS.agoStartEnd = {
  <span class="hljs-string">'['</span>: <span class="hljs-string">'Start'</span>,
  <span class="hljs-string">']'</span>: <span class="hljs-string">'End'</span>,
  <span class="hljs-string">'|'</span>: <span class="hljs-string">''</span>
};
calNS.ofUnits = {
  <span class="hljs-attr">w</span>: <span class="hljs-string">'Week'</span>,
  <span class="hljs-attr">m</span>: <span class="hljs-string">'Month'</span>,
  <span class="hljs-attr">q</span>: <span class="hljs-string">'Quarter'</span>,
  <span class="hljs-attr">y</span>: <span class="hljs-string">'Year'</span>
};
calNS.ofBeginningEnd = {
  <span class="hljs-string">'['</span>: <span class="hljs-string">'beginning'</span>,
  <span class="hljs-string">']'</span>: <span class="hljs-string">'end'</span>,
  <span class="hljs-string">'|'</span>: <span class="hljs-string">''</span>
};
calNS.ofWhich = {
  <span class="hljs-string">'&lt;'</span>: <span class="hljs-string">'Last'</span>,
  <span class="hljs-string">'='</span>: <span class="hljs-string">'This'</span>,
  <span class="hljs-string">'&gt;'</span>: <span class="hljs-string">'Next'</span>
};
calNS.compileCal = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">compileCal</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> result = [];
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; calNS.protoVal.length; i++) {
    <span class="hljs-keyword">var</span> proto = calNS.protoVal[i];
    <span class="hljs-keyword">var</span> parts = <span class="hljs-regexp">/^(.*?)\: *([^ ]*) *([^ ]*) *([^ ]*) *$/</span>.exec(proto);
    <span class="hljs-keyword">var</span> row = [];
    row.push(parts[<span class="hljs-number">1</span>]);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> j = <span class="hljs-number">2</span>; j &lt;= <span class="hljs-number">4</span>; j++)
      row.push(encode(parts[j]));
    result.push(row);
  }
  result.BETWEEN = [<span class="hljs-string">'Now'</span>, JS_GS + <span class="hljs-string">'nowNoTZ()'</span>, JS_GS + <span class="hljs-string">'nowNoTZ()'</span>];
  result.RELATIVE = [
    [<span class="hljs-string">'on or after'</span>, <span class="hljs-string">'GE'</span>],
    [<span class="hljs-string">'on or before'</span>, <span class="hljs-string">'LE'</span>],
    [<span class="hljs-string">'after'</span>, <span class="hljs-string">'GT'</span>],
    [<span class="hljs-string">'before'</span>, <span class="hljs-string">'LT'</span>],
    [<span class="hljs-string">'on'</span>, <span class="hljs-string">'EE'</span>]
  ];
  result.TRENDVALUES = [
    [<span class="hljs-string">'Hours'</span>, <span class="hljs-string">'hour'</span>],
    [<span class="hljs-string">'Minutes'</span>, <span class="hljs-string">'minute'</span>],
    [<span class="hljs-string">'Days'</span>, <span class="hljs-string">'dayofweek'</span>],
    [<span class="hljs-string">'Months'</span>, <span class="hljs-string">'month'</span>],
    [<span class="hljs-string">'Quarters'</span>, <span class="hljs-string">'quarter'</span>],
    [<span class="hljs-string">'Years'</span>, <span class="hljs-string">'year'</span>]
  ];
  result.WHEN = [
    [<span class="hljs-string">'ago'</span>, <span class="hljs-string">'ago'</span>],
    [<span class="hljs-string">'from now'</span>, <span class="hljs-string">'ahead'</span>]
  ];
  result.TRENDVALUES_WITH_FIELDS_PLURIAL = [
    [<span class="hljs-string">'Days'</span>, <span class="hljs-string">'day'</span>],
    [<span class="hljs-string">'Weeks'</span>, <span class="hljs-string">'week'</span>],
    [<span class="hljs-string">'Months'</span>, <span class="hljs-string">'month'</span>],
    [<span class="hljs-string">'Quarters'</span>, <span class="hljs-string">'quarter'</span>],
    [<span class="hljs-string">'Years'</span>, <span class="hljs-string">'year'</span>],
    [<span class="hljs-string">'Hours'</span>, <span class="hljs-string">'hour'</span>]
  ];
  result.TRENDVALUES_WITH_FIELDS = [
    [<span class="hljs-string">'Day'</span>, <span class="hljs-string">'day'</span>],
    [<span class="hljs-string">'Week'</span>, <span class="hljs-string">'week'</span>],
    [<span class="hljs-string">'Month'</span>, <span class="hljs-string">'month'</span>],
    [<span class="hljs-string">'Quarter'</span>, <span class="hljs-string">'quarter'</span>],
    [<span class="hljs-string">'Year'</span>, <span class="hljs-string">'year'</span>],
    [<span class="hljs-string">'Hour'</span>, <span class="hljs-string">'hour'</span>]
  ];
  result.WHEN_WITH_FIELDS = [
    [<span class="hljs-string">'before'</span>, <span class="hljs-string">'before'</span>],
    [<span class="hljs-string">'after'</span>, <span class="hljs-string">'after'</span>],
    [<span class="hljs-string">'before or after'</span>, <span class="hljs-string">'before or after'</span>]
  ];
  result.DATEPART = compileDatePart();
  <span class="hljs-keyword">return</span> result;

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">encode</span>(<span class="hljs-params">part</span>) </span>{
    <span class="hljs-keyword">var</span> parts = <span class="hljs-regexp">/^([\[\]\|])([\-0-9]+)([dmqhn])$/</span>.exec(part);
    <span class="hljs-keyword">return</span> parts ?
      JS_GS + calNS.agoUnits[parts[<span class="hljs-number">3</span>]] + <span class="hljs-string">'Ago'</span> + calNS.agoStartEnd[parts[<span class="hljs-number">1</span>]] + <span class="hljs-string">'('</span> + parts[<span class="hljs-number">2</span>] + <span class="hljs-string">')'</span> :
      JS_GS + calNS.ofBeginningEnd[part.charAt(<span class="hljs-number">0</span>)] + <span class="hljs-string">'Of'</span> + calNS.ofWhich[part.charAt(<span class="hljs-number">1</span>)] +
      calNS.ofUnits[part.charAt(<span class="hljs-number">2</span>)] + <span class="hljs-string">'()'</span>;
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">compileDatePart</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> result = [];
    compileDaysOfWeek(result);
    compileMonths(result);
    compileQuarters(result);
    compileYears(result);
    compileWeeks(result);
    compileHours(result);
    <span class="hljs-keyword">return</span> result;

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">compileDaysOfWeek</span>(<span class="hljs-params">result</span>) </span>{
      <span class="hljs-keyword">var</span> dow = [<span class="hljs-string">'Monday'</span>, <span class="hljs-string">'Tuesday'</span>, <span class="hljs-string">'Wednesday'</span>, <span class="hljs-string">'Thursday'</span>, <span class="hljs-string">'Friday'</span>, <span class="hljs-string">'Saturday'</span>, <span class="hljs-string">'Sunday'</span>];
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; dow.length; i++)
        result.push([dow[i], JS_GS + <span class="hljs-string">"datePart('dayofweek','"</span> + dow[i].toLowerCase() + <span class="hljs-string">"')"</span>]);
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">compileMonths</span>(<span class="hljs-params">result</span>) </span>{
      <span class="hljs-keyword">var</span> ml = [<span class="hljs-string">'January'</span>, <span class="hljs-string">'February'</span>, <span class="hljs-string">'March'</span>, <span class="hljs-string">'April'</span>, <span class="hljs-string">'May'</span>, <span class="hljs-string">'June'</span>, <span class="hljs-string">'July'</span>, <span class="hljs-string">'August'</span>, <span class="hljs-string">'September'</span>, <span class="hljs-string">'October'</span>, <span class="hljs-string">'November'</span>, <span class="hljs-string">'December'</span>];
      <span class="hljs-keyword">var</span> ms = [<span class="hljs-string">'jan'</span>, <span class="hljs-string">'feb'</span>, <span class="hljs-string">'mar'</span>, <span class="hljs-string">'apr'</span>, <span class="hljs-string">'may'</span>, <span class="hljs-string">'june'</span>, <span class="hljs-string">'july'</span>, <span class="hljs-string">'aug'</span>, <span class="hljs-string">'sep'</span>, <span class="hljs-string">'oct'</span>, <span class="hljs-string">'nov'</span>, <span class="hljs-string">'dec'</span>];
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; ml.length; i++)
        result.push([ml[i], JS_GS + <span class="hljs-string">"datePart('month', '"</span> + ms[i] + <span class="hljs-string">"')"</span>]);
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">compileQuarters</span>(<span class="hljs-params">result</span>) </span>{
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">1</span>; i &lt;= <span class="hljs-number">4</span>; i++)
        result.push([<span class="hljs-string">'Quarter '</span> + i, JS_GS + <span class="hljs-string">"datePart('quarter','"</span> + i + <span class="hljs-string">"')"</span>]);
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">compileYears</span>(<span class="hljs-params">result</span>) </span>{
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">2000</span>; i &lt;= <span class="hljs-number">2020</span>; i++)
        result.push([<span class="hljs-string">''</span> + i, JS_GS + <span class="hljs-string">"datePart('year','"</span> + i + <span class="hljs-string">"')"</span>]);
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">compileWeeks</span>(<span class="hljs-params">result</span>) </span>{
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">53</span>; i++)
        result.push([<span class="hljs-string">'Week '</span> + i, JS_GS + <span class="hljs-string">"datePart('week','"</span> + i + <span class="hljs-string">"')"</span>]);
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">compileHours</span>(<span class="hljs-params">result</span>) </span>{
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">24</span>; i++) {
        <span class="hljs-keyword">var</span> hr = (i == <span class="hljs-number">0</span>) ? <span class="hljs-string">'Midnight hour'</span> : ((i &lt; <span class="hljs-number">12</span>) ? <span class="hljs-string">''</span> + i + <span class="hljs-string">' am hour'</span> : ((i == <span class="hljs-number">12</span>) ? <span class="hljs-string">'Noon hour'</span> : <span class="hljs-string">''</span> + (i - <span class="hljs-number">12</span>) + <span class="hljs-string">' pm hour'</span>));
        result.push([hr, JS_GS + <span class="hljs-string">"datePart('hour', '"</span> + i + <span class="hljs-string">"')"</span>]);
      }
    }
  }
}
<span class="hljs-keyword">var</span> sysvalues = {};
sysvalues[<span class="hljs-string">'boolean'</span>] = [
  [<span class="hljs-string">"true"</span>, <span class="hljs-string">"true"</span>],
  [<span class="hljs-string">"false"</span>, <span class="hljs-string">"false"</span>]
];
sysvalues[<span class="hljs-string">'catalog_boolean'</span>] = [
  [<span class="hljs-string">"Yes"</span>, <span class="hljs-string">"Yes"</span>],
  [<span class="hljs-string">"No"</span>, <span class="hljs-string">"No"</span>]
];
sysvalues[<span class="hljs-string">'string_boolean'</span>] = [
  [<span class="hljs-string">"1"</span>, <span class="hljs-string">"true"</span>],
  [<span class="hljs-string">"0"</span>, <span class="hljs-string">"false"</span>]
];
sysvalues[<span class="hljs-string">'calendar'</span>] = calNS.compileCal();
<span class="hljs-keyword">var</span> MESSAGES_CONDITION_RELATED_FILES = [<span class="hljs-string">'lowercase_fields'</span>, <span class="hljs-string">'Keywords'</span>, <span class="hljs-string">'Show Related Fields'</span>, <span class="hljs-string">'Remove Related Fields'</span>, <span class="hljs-string">'-- choose field --'</span>, <span class="hljs-string">'-- value --'</span>, <span class="hljs-string">'-- None --'</span>];
<span class="hljs-keyword">var</span> g_current_table = <span class="hljs-string">''</span>;
<span class="hljs-keyword">var</span> g_filter_extension_map = {};;
<span class="hljs-comment">/*! RESOURCE: /scripts/doctype/popupdivs14.js */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">popListDiv</span>(<span class="hljs-params">e, tableName, sys_id, viewName, width</span>) </span>{
  ScriptLoader.getScripts(<span class="hljs-string">'scripts/doctype/GlidePopup.js'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    g_popup_manager.popListDiv(e, tableName, sys_id, viewName, width);
  })
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">popReferenceDiv</span>(<span class="hljs-params">e, inputid, viewName, formTable, refKey</span>) </span>{
  ScriptLoader.getScripts(<span class="hljs-string">'scripts/doctype/GlidePopup.js'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    g_popup_manager.popReferenceDiv(e, inputid, viewName, formTable, refKey);
  })
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">popForm</span>(<span class="hljs-params">e, tableName, sys_id, viewName, width</span>) </span>{
  ScriptLoader.getScripts(<span class="hljs-string">'scripts/doctype/GlidePopup.js'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    g_popup_manager.popForm(e, tableName, sys_id, viewName, width);
  })
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">popHistoryDiv</span>(<span class="hljs-params">e, tableName, sys_id, checkpoint, internalCP</span>) </span>{
  ScriptLoader.getScripts(<span class="hljs-string">'scripts/doctype/GlidePopup.js'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    g_popup_manager.popHistoryDiv(e, tableName, sys_id, checkpoint, internalCP);
  })
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">lockPopup</span>(<span class="hljs-params">e</span>) </span>{
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.g_popup_manager)
    g_popup_manager.exitPopup(e);
  <span class="hljs-keyword">else</span>
    <span class="hljs-built_in">window</span>.NOW.popupLock = <span class="hljs-literal">true</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">lockPopupID</span>(<span class="hljs-params">e, sys_id</span>) </span>{
  <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">window</span>.g_popup_manager)
    <span class="hljs-keyword">return</span>;
  g_popup_manager.sys_id = sys_id;
  lockPopup(e);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">popDiv</span>(<span class="hljs-params">e, sys_id</span>) </span>{
  ScriptLoader.getScripts(<span class="hljs-string">'scripts/doctype/GlidePopup.js'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    g_popup_manager.popDiv(e, sys_id);
  })
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">popCatDiv</span>(<span class="hljs-params">e, sys_id</span>) </span>{
  ScriptLoader.getScripts(<span class="hljs-string">'scripts/doctype/GlidePopup.js'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    g_popup_manager.popCatDiv(e, sys_id);
  })
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">popKnowledgeDiv</span>(<span class="hljs-params">e, sys_id</span>) </span>{
  ScriptLoader.getScripts(<span class="hljs-string">'scripts/doctype/GlidePopup.js'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    g_popup_manager.popKnowledgeDiv(e, sys_id);
  })
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">popReportInfoDiv</span>(<span class="hljs-params">e, reportId</span>) </span>{
  ScriptLoader.getScripts(<span class="hljs-string">'scripts/doctype/GlidePopup.js'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    g_popup_manager.popReportInfoDiv(e, reportId);
  })
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">popRecordDiv</span>(<span class="hljs-params">e, tableName, sys_id, viewName, width</span>) </span>{
  ScriptLoader.getScripts(<span class="hljs-string">'scripts/doctype/GlidePopup.js'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    g_popup_manager.popRecordDiv(e, tableName, sys_id, viewName, width);
  })
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">popIssueDiv</span>(<span class="hljs-params">e, issues</span>) </span>{
  ScriptLoader.getScripts(<span class="hljs-string">'scripts/doctype/GlidePopup.js'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    g_popup_manager.popIssueDiv(e, issues);
  })
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">popLightWeightReferenceDiv</span>(<span class="hljs-params">e, inputid</span>) </span>{
  ScriptLoader.getScripts(<span class="hljs-string">'scripts/doctype/GlidePopup.js'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    g_popup_manager.popLightWeightReferenceDiv(e, inputid);
  })
};
<span class="hljs-comment">/*! RESOURCE: /scripts/scrollable.js */</span>
<span class="hljs-keyword">var</span> HOME_SCROLL_SPEED = <span class="hljs-number">1</span>;
<span class="hljs-keyword">var</span> HOME_PAUSE_SPEED = <span class="hljs-number">0</span>;
<span class="hljs-keyword">var</span> HOME_RESUME_SPEED = <span class="hljs-number">1</span>;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">scroller</span>(<span class="hljs-params">divName</span>) </span>{
  <span class="hljs-keyword">var</span> target = gel(divName);
  <span class="hljs-keyword">if</span> (!target)
    <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">var</span> wrapper = gel(divName + <span class="hljs-string">"_wrap"</span>);
  <span class="hljs-keyword">var</span> wrapperHeight = wrapper.offsetHeight;
  <span class="hljs-keyword">var</span> containerHeight = target.offsetHeight;
  <span class="hljs-keyword">var</span> actualheight = wrapperHeight
  <span class="hljs-keyword">if</span> (wrapperHeight &lt; containerHeight)
    actualheight = containerHeight;
  <span class="hljs-keyword">var</span> currentScroll = <span class="hljs-built_in">parseInt</span>(target.style.top) - HOME_SCROLL_SPEED;
  <span class="hljs-keyword">var</span> bottom = actualheight + <span class="hljs-built_in">parseInt</span>(target.style.top);
  <span class="hljs-keyword">if</span> (bottom &lt; <span class="hljs-number">20</span>)
    currentScroll = wrapperHeight;
  target.style.top = currentScroll + <span class="hljs-string">"px"</span>;
};
<span class="hljs-comment">/*! RESOURCE: /scripts/classes/util/StopWatch.js */</span>
<span class="hljs-keyword">var</span> StopWatch = Class.create({
  <span class="hljs-attr">MILLIS_IN_SECOND</span>: <span class="hljs-number">1000</span>,
  <span class="hljs-attr">MILLIS_IN_MINUTE</span>: <span class="hljs-number">60</span> * <span class="hljs-number">1000</span>,
  <span class="hljs-attr">MILLIS_IN_HOUR</span>: <span class="hljs-number">60</span> * <span class="hljs-number">60</span> * <span class="hljs-number">1000</span>,
  <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">started</span>) </span>{
    <span class="hljs-keyword">this</span>.started = started || <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>();
  },
  <span class="hljs-attr">getTime</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> now = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>();
    <span class="hljs-keyword">return</span> now.getTime() - <span class="hljs-keyword">this</span>.started.getTime();
  },
  <span class="hljs-attr">restart</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>.initialize();
  },
  <span class="hljs-attr">jslog</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">msg, src, date</span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.jslog) {
      jslog(<span class="hljs-string">'['</span> + <span class="hljs-keyword">this</span>.toString() + <span class="hljs-string">'] '</span> + msg, src, date);
      <span class="hljs-keyword">return</span>;
    }
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.console &amp;&amp; <span class="hljs-built_in">window</span>.console.log)
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'['</span> + <span class="hljs-keyword">this</span>.toString() + <span class="hljs-string">'] '</span> + msg);
  },
  <span class="hljs-attr">toString</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.formatISO(<span class="hljs-keyword">this</span>.getTime());
  },
  <span class="hljs-attr">formatISO</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">millis</span>) </span>{
    <span class="hljs-keyword">var</span> hours = <span class="hljs-number">0</span>,
      minutes = <span class="hljs-number">0</span>,
      seconds = <span class="hljs-number">0</span>,
      milliseconds = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">if</span> (millis &gt;= <span class="hljs-keyword">this</span>.MILLIS_IN_HOUR) {
      hours = <span class="hljs-built_in">parseInt</span>(millis / <span class="hljs-keyword">this</span>.MILLIS_IN_HOUR);
      millis = millis - (hours * <span class="hljs-keyword">this</span>.MILLIS_IN_HOUR);
    }
    <span class="hljs-keyword">if</span> (millis &gt;= <span class="hljs-keyword">this</span>.MILLIS_IN_MINUTE) {
      minutes = <span class="hljs-built_in">parseInt</span>(millis / <span class="hljs-keyword">this</span>.MILLIS_IN_MINUTE);
      millis = millis - (minutes * <span class="hljs-keyword">this</span>.MILLIS_IN_MINUTE);
    }
    <span class="hljs-keyword">if</span> (millis &gt;= <span class="hljs-keyword">this</span>.MILLIS_IN_SECOND) {
      seconds = <span class="hljs-built_in">parseInt</span>(millis / <span class="hljs-keyword">this</span>.MILLIS_IN_SECOND);
      millis = millis - (seconds * <span class="hljs-keyword">this</span>.MILLIS_IN_SECOND);
    }
    milliseconds = <span class="hljs-built_in">parseInt</span>(millis);
    <span class="hljs-keyword">return</span> doubleDigitFormat(hours) + <span class="hljs-string">":"</span> + doubleDigitFormat(minutes) + <span class="hljs-string">":"</span> + doubleDigitFormat(seconds) +
      <span class="hljs-string">"."</span> + tripleDigitFormat(milliseconds);
  },
  <span class="hljs-attr">type</span>: <span class="hljs-string">"StopWatch"</span>
});;
<span class="hljs-comment">/*! RESOURCE: /scripts/classes/Table.js */</span>
<span class="hljs-keyword">var</span> Table = Class.create({
  <span class="hljs-attr">REF_ELEMENT_PREFIX</span>: <span class="hljs-string">'ref_'</span>,
  <span class="hljs-attr">REFERENCE</span>: <span class="hljs-string">"reference"</span>,
  <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">tableName, parentTable, cols, callback, accessTable, isTemplate</span>) </span>{
    <span class="hljs-keyword">this</span>.tableName = tableName;
    <span class="hljs-keyword">this</span>.parentTable = parentTable;
    <span class="hljs-keyword">this</span>.label = tableName;
    <span class="hljs-keyword">this</span>.callback = callback;
    <span class="hljs-keyword">this</span>.accessTable = accessTable;
    <span class="hljs-keyword">this</span>.columns = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">this</span>.elements = {};
    <span class="hljs-keyword">this</span>.elementsArray = [];
    <span class="hljs-keyword">this</span>.extensions = {};
    <span class="hljs-keyword">this</span>.extensionsArray = [];
    <span class="hljs-keyword">this</span>.choiceExtensions = {};
    <span class="hljs-keyword">this</span>.choiceExtensionsArray = [];
    <span class="hljs-keyword">this</span>.tablesArray = [];
    <span class="hljs-keyword">this</span>.sys_id = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">this</span>.set_id = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">this</span>.isTemplate = isTemplate;
    Table.setCachable(<span class="hljs-keyword">this</span>);
    <span class="hljs-keyword">if</span> (cols &amp;&amp; <span class="hljs-keyword">this</span>.cacheable)
      <span class="hljs-keyword">this</span>.readResponse(cols);
    <span class="hljs-keyword">else</span>
      <span class="hljs-keyword">this</span>.readColumns();
    <span class="hljs-keyword">this</span>.textIndex = <span class="hljs-literal">null</span>;
  },
  <span class="hljs-attr">readColumns</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> ajax = <span class="hljs-keyword">new</span> GlideAjax(<span class="hljs-string">"SysMeta"</span>);
    ajax.addParam(<span class="hljs-string">"sysparm_type"</span>, <span class="hljs-string">"column"</span>);
    ajax.addParam(<span class="hljs-string">"sysparm_include_sysid"</span>, <span class="hljs-string">"true"</span>);
    ajax.addParam(<span class="hljs-string">"sysparm_table_name"</span>, <span class="hljs-string">"false"</span>);
    ajax.addParam(<span class="hljs-string">"sysparm_is_template"</span>, <span class="hljs-keyword">this</span>.isTemplate ? <span class="hljs-string">'true'</span> : <span class="hljs-string">'false'</span>);
    ajax.addParam(<span class="hljs-string">"sysparm_value"</span>, <span class="hljs-keyword">this</span>.tableName);
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.sys_id)
      ajax.addParam(<span class="hljs-string">"sysparm_sys_id"</span>, <span class="hljs-keyword">this</span>.sys_id);
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.set_id)
      ajax.addParam(<span class="hljs-string">"sysparm_set_id"</span>, <span class="hljs-keyword">this</span>.set_id);
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.parentTable)
      ajax.addParam(<span class="hljs-string">"sysparm_parent_table"</span>, <span class="hljs-keyword">this</span>.parentTable);
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.accessTable)
      ajax.addParam(<span class="hljs-string">"sysparm_access_table"</span>, <span class="hljs-keyword">this</span>.accessTable);
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.callback)
      ajax.getXML(<span class="hljs-keyword">this</span>.readColumnsResponse.bind(<span class="hljs-keyword">this</span>));
    <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">var</span> xml = ajax.getXMLWait();
      <span class="hljs-keyword">this</span>.readResponse(xml);
    }
  },
  <span class="hljs-attr">readColumnsResponse</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">response</span>) </span>{
    <span class="hljs-keyword">if</span> (!response || !response.responseXML)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">var</span> xml = response.responseXML;
    <span class="hljs-keyword">this</span>.readResponse(xml);
    <span class="hljs-keyword">this</span>.callback();
  },
  <span class="hljs-attr">readResponse</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">xml</span>) </span>{
    <span class="hljs-keyword">this</span>.columns = xml;
    <span class="hljs-keyword">var</span> root = <span class="hljs-keyword">this</span>.columns.getElementsByTagName(<span class="hljs-string">"xml"</span>);
    <span class="hljs-keyword">if</span> (root != <span class="hljs-literal">null</span> &amp;&amp; root.length == <span class="hljs-number">1</span>) {
      root = root[<span class="hljs-number">0</span>];
      <span class="hljs-keyword">this</span>.textIndex = root.getAttribute(<span class="hljs-string">"textIndex"</span>);
      <span class="hljs-keyword">this</span>.label = root.getAttribute(<span class="hljs-string">"label"</span>);
    }
    <span class="hljs-keyword">var</span> items = xml.getElementsByTagName(<span class="hljs-string">"item"</span>);
    <span class="hljs-keyword">this</span>.elements = {};
    <span class="hljs-keyword">this</span>.elementsArray = [];
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; items.length; i++) {
      <span class="hljs-keyword">var</span> item = items[i];
      <span class="hljs-keyword">var</span> t = item.getAttribute(<span class="hljs-string">"value"</span>);
      <span class="hljs-keyword">var</span> label = item.getAttribute(<span class="hljs-string">"label"</span>);
      <span class="hljs-keyword">var</span> e = <span class="hljs-keyword">new</span> TableElement(t, label);
      e.setClearLabel(item.getAttribute(<span class="hljs-string">"cl"</span>));
      e.setType(item.getAttribute(<span class="hljs-string">"type"</span>));
      e.setReference(item.getAttribute(<span class="hljs-string">"reference"</span>));
      e.setDynamicCreation(item.getAttribute(<span class="hljs-string">"dynamic_creation"</span>) == <span class="hljs-string">"true"</span>);
      e.setRefQual(item.getAttribute(<span class="hljs-string">"reference_qual"</span>));
      e.setRefKey(item.getAttribute(<span class="hljs-string">"reference_key"</span>));
      e.setArray(item.getAttribute(<span class="hljs-string">"array"</span>));
      e.setChoice(item.getAttribute(<span class="hljs-string">"choice"</span>));
      e.setMulti(item.getAttribute(<span class="hljs-string">"multitext"</span>));
      e.setDependent(item.getAttribute(<span class="hljs-string">"dependent"</span>));
      e.setMaxLength(item.getAttribute(<span class="hljs-string">"max_length"</span>));
      e.setDisplayChars(item.getAttribute(<span class="hljs-string">"display_chars"</span>));
      e.setNamedAttributes(item.getAttribute(<span class="hljs-string">"attributes"</span>));
      e.setTableName(item.getAttribute(<span class="hljs-string">"table"</span>));
      e.setTable(<span class="hljs-keyword">this</span>);
      <span class="hljs-keyword">if</span> (e.isReference()) {
        e.setRefLabel(item.getAttribute(<span class="hljs-string">"reflabel"</span>));
        e.setRefDisplay(item.getAttribute(<span class="hljs-string">"refdisplay"</span>));
        e.setRefRotated(item.getAttribute(<span class="hljs-string">"reference_rotated"</span>));
      }
      <span class="hljs-keyword">this</span>.elements[t] = e;
      <span class="hljs-keyword">this</span>.elementsArray[<span class="hljs-keyword">this</span>.elementsArray.length] = e;
      <span class="hljs-keyword">var</span> attrs = item.attributes;
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> x = <span class="hljs-number">0</span>; x &lt; attrs.length; x++)
        e.addAttribute(attrs[x].nodeName, attrs[x].nodeValue);
    }
    <span class="hljs-keyword">var</span> tables = xml.getElementsByTagName(<span class="hljs-string">"tables"</span>);
    <span class="hljs-keyword">if</span> (tables.length != <span class="hljs-number">0</span>)
      <span class="hljs-keyword">this</span>.setTables(tables);
    <span class="hljs-keyword">var</span> choice_items = xml.getElementsByTagName(<span class="hljs-string">"sys_choice_extensions"</span>);
    <span class="hljs-keyword">if</span> (choice_items.length != <span class="hljs-number">0</span>)
      <span class="hljs-keyword">this</span>.setChoiceExtensions(choice_items);
    <span class="hljs-keyword">var</span> items = xml.getElementsByTagName(<span class="hljs-string">"extensions"</span>);
    <span class="hljs-keyword">if</span> (items.length != <span class="hljs-number">0</span>)
      <span class="hljs-keyword">this</span>.setExtensions(items);
    <span class="hljs-keyword">this</span>.setDependencies();
  },
  <span class="hljs-attr">setExtensions</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">items</span>) </span>{
    items = items[<span class="hljs-number">0</span>].getElementsByTagName(<span class="hljs-string">"extension"</span>);
    <span class="hljs-keyword">this</span>.extensionsArray = [];
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; items.length; i++) {
      <span class="hljs-keyword">var</span> item = items[i];
      <span class="hljs-keyword">var</span> t = item.getAttribute(<span class="hljs-string">"name"</span>);
      <span class="hljs-keyword">var</span> label = item.getAttribute(<span class="hljs-string">"label"</span>);
      <span class="hljs-keyword">var</span> e = <span class="hljs-keyword">new</span> TableExtension(t, label);
      e.setTable(<span class="hljs-keyword">this</span>);
      <span class="hljs-keyword">this</span>.extensions[t] = e;
      <span class="hljs-keyword">this</span>.extensionsArray[<span class="hljs-keyword">this</span>.extensionsArray.length] = e;
    }
  },
  <span class="hljs-attr">setChoiceExtensions</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">items</span>) </span>{
    items = items[<span class="hljs-number">0</span>].getElementsByTagName(<span class="hljs-string">"extension"</span>);
    <span class="hljs-keyword">this</span>.choiceExtensionsArray = [];
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; items.length; i++) {
      <span class="hljs-keyword">var</span> item = items[i];
      <span class="hljs-keyword">var</span> t = item.getAttribute(<span class="hljs-string">"name"</span>);
      <span class="hljs-keyword">var</span> label = item.getAttribute(<span class="hljs-string">"label"</span>);
      <span class="hljs-keyword">var</span> e = <span class="hljs-keyword">new</span> TableExtension(t, label);
      e.setTable(<span class="hljs-keyword">this</span>);
      <span class="hljs-keyword">this</span>.choiceExtensions[t] = e;
      <span class="hljs-keyword">this</span>.choiceExtensionsArray[<span class="hljs-keyword">this</span>.choiceExtensionsArray.length] = e;
    }
  },
  <span class="hljs-attr">setDependencies</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-keyword">this</span>.elementsArray.length; i++) {
      <span class="hljs-keyword">var</span> element = <span class="hljs-keyword">this</span>.elementsArray[i];
      <span class="hljs-keyword">if</span> (element.isDependent()) {
        <span class="hljs-keyword">var</span> parent = <span class="hljs-keyword">this</span>.getElement(element.getDependent());
        <span class="hljs-keyword">if</span> (parent)
          parent.addDependentChild(element.getName())
      }
    }
  },
  <span class="hljs-attr">setTables</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">tables</span>) </span>{
    <span class="hljs-keyword">var</span> tableList = tables[<span class="hljs-number">0</span>].getAttribute(<span class="hljs-string">"table_list"</span>);
    <span class="hljs-keyword">this</span>.tablesArray = [];
    <span class="hljs-keyword">this</span>.tablesArray = tableList.split(<span class="hljs-string">','</span>);
  },
  <span class="hljs-attr">getColumns</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.columns;
  },
  <span class="hljs-attr">getElements</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.elementsArray;
  },
  <span class="hljs-attr">getTableElements</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">tableName</span>) </span>{
    jslog(<span class="hljs-string">"Getting fields for table "</span> + tableName);
    <span class="hljs-keyword">var</span> elements = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>();
    <span class="hljs-keyword">var</span> items = <span class="hljs-keyword">this</span>.getElements();
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; items.length; i++) {
      <span class="hljs-keyword">var</span> item = items[i];
      <span class="hljs-keyword">if</span> (item.getTableName() != tableName)
        <span class="hljs-keyword">continue</span>;
      elements.push(item);
    }
    <span class="hljs-keyword">return</span> elements;
  },
  <span class="hljs-attr">getElement</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">elementName</span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.elements[elementName])
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.elements[elementName];
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._nameIsExtension(elementName))
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._genExtensionElement(elementName);
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  },
  <span class="hljs-attr">_genExtensionElement</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name</span>) </span>{
    name = name.substring(<span class="hljs-keyword">this</span>.REF_ELEMENT_PREFIX.length);
    <span class="hljs-keyword">var</span> ext = <span class="hljs-keyword">this</span>.extensions[name];
    <span class="hljs-keyword">var</span> e = <span class="hljs-keyword">new</span> TableElement(ext.getExtName(), ext.getLabel());
    e.setType(<span class="hljs-keyword">this</span>.REFERENCE);
    e.setReference(ext.getName());
    e.setRefLabel(ext.getLabel());
    e.setExtensionElement(<span class="hljs-literal">true</span>);
    <span class="hljs-keyword">return</span> e;
  },
  <span class="hljs-attr">_nameIsExtension</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name</span>) </span>{
    <span class="hljs-keyword">if</span> (name.indexOf(<span class="hljs-keyword">this</span>.REF_ELEMENT_PREFIX) != <span class="hljs-number">0</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    name = name.substring(<span class="hljs-keyword">this</span>.REF_ELEMENT_PREFIX.length);
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.extensions[name])
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  },
  <span class="hljs-attr">getExtensions</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.extensionsArray;
  },
  <span class="hljs-attr">getChoiceExtensions</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.choiceExtensionsArray;
  },
  <span class="hljs-attr">getTables</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.tablesArray;
  },
  <span class="hljs-attr">getName</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.tableName;
  },
  <span class="hljs-attr">getLabel</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.label;
  },
  <span class="hljs-attr">getDisplayName</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">column</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.getElement(column).getRefDisplay();
  },
  <span class="hljs-attr">getSysId</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.sys_id;
  },
  <span class="hljs-attr">setSysId</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.sys_id;
  },
  <span class="hljs-attr">type</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-string">"Table"</span>;
  }
});
Table.get = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">tableName, parentTable, isTemplate</span>) </span>{
  <span class="hljs-keyword">var</span> topWindow = getTopWindow(tableName, parentTable, isTemplate);
  <span class="hljs-keyword">return</span> !topWindow.Table ? Table.getInTopWindow(tableName, parentTable, isTemplate) : topWindow.Table.getInTopWindow(tableName, parentTable, isTemplate);
}
Table.setColumns = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">tableName, parentTable, xmlString</span>) </span>{
  <span class="hljs-keyword">var</span> cachedName = (parentTable ? parentTable + <span class="hljs-string">"."</span> : <span class="hljs-string">""</span>) + tableName;
  <span class="hljs-keyword">var</span> parentCache = Table.getCache();
  <span class="hljs-keyword">if</span> (parentCache) {
    <span class="hljs-keyword">var</span> table = parentCache.get(cachedName);
    <span class="hljs-keyword">if</span> (table)
      <span class="hljs-keyword">return</span> table;
  }
  <span class="hljs-keyword">var</span> xml = loadXML(xmlString);
  <span class="hljs-keyword">var</span> answer = <span class="hljs-keyword">new</span> Table(tableName, parentTable, xml);
  <span class="hljs-keyword">if</span> (parentCache &amp;&amp; answer.cacheable)
    parentCache.put(cachedName, answer);
}
Table.isCached = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">tableName, parentTable, isTemplate</span>) </span>{
  <span class="hljs-keyword">var</span> cachedName = Table.getCacheKey(tableName, parentTable, isTemplate);
  <span class="hljs-keyword">var</span> parentCache = Table.getCache();
  <span class="hljs-keyword">if</span> (parentCache) {
    <span class="hljs-keyword">var</span> table = parentCache.get(cachedName);
    <span class="hljs-keyword">if</span> (table)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  }
  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}
Table.getInTopWindow = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">tableName, parentTable, isTemplate</span>) </span>{
  <span class="hljs-keyword">var</span> t = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Object</span>();
  Table.setCachable(t);
  <span class="hljs-keyword">if</span> (t.cacheable) {
    <span class="hljs-keyword">var</span> cachedName = Table.getCacheKey(tableName, parentTable, isTemplate);
    <span class="hljs-keyword">var</span> parentCache = Table.getCache();
    <span class="hljs-keyword">if</span> (parentCache) {
      <span class="hljs-keyword">var</span> table = parentCache.get(cachedName);
      <span class="hljs-keyword">if</span> (table)
        <span class="hljs-keyword">return</span> table;
    }
  }
  <span class="hljs-keyword">var</span> answer = <span class="hljs-keyword">new</span> Table(tableName, parentTable, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, isTemplate);
  <span class="hljs-keyword">if</span> (parentCache &amp;&amp; answer.cacheable)
    parentCache.put(cachedName, answer);
  <span class="hljs-keyword">return</span> answer;
}
Table.setCachable = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">t</span>) </span>{
  t.cacheable = <span class="hljs-literal">true</span>;
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> g_table_sys_id != <span class="hljs-string">'undefined'</span>) {
    t.sys_id = g_table_sys_id;
    t.cacheable = <span class="hljs-literal">false</span>;
  }
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> g_table_set_id != <span class="hljs-string">'undefined'</span>) {
    t.set_id = g_table_set_id;
    t.cacheable = <span class="hljs-literal">false</span>;
  }
}
Table.getCacheKey = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">tableName, parentTable, isTemplate</span>) </span>{
  <span class="hljs-keyword">return</span> (parentTable ? parentTable + <span class="hljs-string">"."</span> : <span class="hljs-string">""</span>) + tableName + <span class="hljs-string">"."</span> + !!isTemplate;
}
Table.getCache = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> cache = getTopWindow().g_cache_td;
  <span class="hljs-keyword">if</span> (cache)
    <span class="hljs-keyword">return</span> cache;
  <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">window</span>.g_cache_td)
    <span class="hljs-built_in">window</span>.g_cache_td = <span class="hljs-keyword">new</span> GlideClientCache(<span class="hljs-number">50</span>);
  <span class="hljs-keyword">return</span> <span class="hljs-built_in">window</span>.g_cache_td;
};
<span class="hljs-comment">/*! RESOURCE: /scripts/classes/TableElement.js */</span>
<span class="hljs-keyword">var</span> TableElement = Class.create({
  <span class="hljs-attr">REF_ELEMENT_PREFIX</span>: <span class="hljs-string">'ref_'</span>,
  <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">elementName, elementLabel</span>) </span>{
    <span class="hljs-keyword">this</span>.name = elementName;
    <span class="hljs-keyword">this</span>.label = elementLabel;
    <span class="hljs-keyword">this</span>.clearLabel = <span class="hljs-string">''</span>;
    <span class="hljs-keyword">this</span>.tableName = <span class="hljs-string">''</span>;
    <span class="hljs-keyword">this</span>.type = <span class="hljs-string">'string'</span>;
    <span class="hljs-keyword">this</span>.isRef = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">this</span>.refLabel = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">this</span>.refDisplay = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">this</span>.refQual = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">this</span>.reference = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">this</span>.refKey = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">this</span>.refRotated = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">this</span>.array = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">this</span>.canread = <span class="hljs-string">'unknown'</span>;
    <span class="hljs-keyword">this</span>.canwrite = <span class="hljs-string">'unknown'</span>;
    <span class="hljs-keyword">this</span>.saveastemplate = <span class="hljs-string">'unknown'</span>;
    <span class="hljs-keyword">this</span>.choice = <span class="hljs-string">''</span>;
    <span class="hljs-keyword">this</span>.multi = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">this</span>.active = <span class="hljs-string">'unknown'</span>;
    <span class="hljs-keyword">this</span>.table = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">this</span>.dependent = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">this</span>.maxLength = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">this</span>.displayChars = <span class="hljs-string">"-1"</span>;
    <span class="hljs-keyword">this</span>.attributes = {};
    <span class="hljs-keyword">this</span>.dependentChildren = {};
    <span class="hljs-keyword">this</span>.namedAttributes = {};
    <span class="hljs-keyword">this</span>.extensionElement = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">this</span>.dynamicCreation = <span class="hljs-literal">false</span>;
  },
  <span class="hljs-attr">addAttribute</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name, value</span>) </span>{
    <span class="hljs-keyword">this</span>.attributes[name] = value;
  },
  <span class="hljs-attr">getAttribute</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.attributes[name];
  },
  <span class="hljs-attr">getBooleanAttribute</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name, defaultValue</span>) </span>{
    <span class="hljs-keyword">var</span> v = <span class="hljs-keyword">this</span>.getAttribute(name);
    <span class="hljs-keyword">if</span> (v == <span class="hljs-literal">null</span>)
      <span class="hljs-keyword">return</span> (<span class="hljs-keyword">typeof</span> defaultValue !== <span class="hljs-string">'undefined'</span>) ? defaultValue : <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">if</span> (v == <span class="hljs-string">'false'</span> || v == <span class="hljs-string">'no'</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  },
  <span class="hljs-attr">isDependent</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.dependent != <span class="hljs-literal">null</span>;
  },
  <span class="hljs-attr">hasDependentChildren</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> key <span class="hljs-keyword">in</span> <span class="hljs-keyword">this</span>.dependentChildren)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  },
  <span class="hljs-attr">getDependentChildren</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.dependentChildren;
  },
  <span class="hljs-attr">setTable</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">t</span>) </span>{
    <span class="hljs-keyword">this</span>.table = t;
  },
  <span class="hljs-attr">setType</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">type</span>) </span>{
    <span class="hljs-keyword">this</span>.type = type;
    <span class="hljs-keyword">if</span> (type == <span class="hljs-string">'glide_list'</span>)
      <span class="hljs-keyword">this</span>.isRef = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">if</span> (type == <span class="hljs-string">'glide_var'</span>)
      <span class="hljs-keyword">this</span>.isRef = <span class="hljs-literal">true</span>;
  },
  <span class="hljs-attr">setReference</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">reference</span>) </span>{
    <span class="hljs-keyword">if</span> (reference &amp;&amp; reference != <span class="hljs-string">''</span>)
      <span class="hljs-keyword">this</span>.reference = reference;
    <span class="hljs-keyword">if</span> ((<span class="hljs-keyword">this</span>.type == <span class="hljs-string">'glide_list'</span> &amp;&amp; <span class="hljs-keyword">this</span>.reference) || <span class="hljs-keyword">this</span>.type == <span class="hljs-string">'reference'</span> || <span class="hljs-keyword">this</span>.type == <span class="hljs-string">'domain_id'</span> || <span class="hljs-keyword">this</span>.type == <span class="hljs-string">'glide_var'</span>)
      <span class="hljs-keyword">this</span>.isRef = <span class="hljs-literal">true</span>;
  },
  <span class="hljs-attr">setRefRotated</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">rotated</span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-string">'yes'</span> == rotated)
      <span class="hljs-keyword">this</span>.refRotated = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">else</span>
      <span class="hljs-keyword">this</span>.refRotated = <span class="hljs-literal">false</span>;
  },
  <span class="hljs-attr">setCanWrite</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">ra</span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-string">'no'</span> == ra)
      <span class="hljs-keyword">this</span>.canwrite = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">else</span>
      <span class="hljs-keyword">this</span>.canwrite = <span class="hljs-literal">true</span>;
  },
  <span class="hljs-attr">setSaveAsTemplate</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">ra</span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-string">'no'</span> == ra)
      <span class="hljs-keyword">this</span>.saveastemplate = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">else</span>
      <span class="hljs-keyword">this</span>.saveastemplate = <span class="hljs-literal">true</span>;
  },
  <span class="hljs-attr">setCanRead</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">ra</span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-string">'no'</span> == ra)
      <span class="hljs-keyword">this</span>.canread = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">else</span>
      <span class="hljs-keyword">this</span>.canread = <span class="hljs-literal">true</span>;
  },
  <span class="hljs-attr">setActive</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">active</span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-string">'no'</span> == active)
      <span class="hljs-keyword">this</span>.active = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">else</span>
      <span class="hljs-keyword">this</span>.active = <span class="hljs-literal">true</span>;
  },
  <span class="hljs-attr">setRefQual</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">refQual</span>) </span>{
    <span class="hljs-keyword">this</span>.refQual = refQual;
  },
  <span class="hljs-attr">setRefKey</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">refKey</span>) </span>{
    <span class="hljs-keyword">this</span>.refKey = refKey;
  },
  <span class="hljs-attr">setRefLabel</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">label</span>) </span>{
    <span class="hljs-keyword">this</span>.refLabel = label;
  },
  <span class="hljs-attr">setRefDisplay</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">display</span>) </span>{
    <span class="hljs-keyword">this</span>.refDisplay = display;
  },
  <span class="hljs-attr">setArray</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">array</span>) </span>{
    <span class="hljs-keyword">this</span>.array = array;
  },
  <span class="hljs-attr">setClearLabel</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">cl</span>) </span>{
    <span class="hljs-keyword">this</span>.clearLabel = cl;
  },
  <span class="hljs-attr">setChoice</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">choice</span>) </span>{
    <span class="hljs-keyword">this</span>.choice = choice;
  },
  <span class="hljs-attr">setMulti</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">multi</span>) </span>{
    <span class="hljs-keyword">this</span>.multi = multi;
  },
  <span class="hljs-attr">setExtensionElement</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">b</span>) </span>{
    <span class="hljs-keyword">this</span>.extensionElement = b;
  },
  <span class="hljs-attr">setDependent</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">dep</span>) </span>{
    <span class="hljs-keyword">if</span> (dep &amp;&amp; dep != <span class="hljs-string">''</span>)
      <span class="hljs-keyword">this</span>.dependent = dep;
  },
  <span class="hljs-attr">addDependentChild</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name</span>) </span>{
    <span class="hljs-keyword">if</span> (name)
      <span class="hljs-keyword">this</span>.dependentChildren[name] = <span class="hljs-literal">true</span>;
  },
  <span class="hljs-attr">setMaxLength</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">maxLength</span>) </span>{
    <span class="hljs-keyword">this</span>.maxLength = maxLength;
  },
  <span class="hljs-attr">setDisplayChars</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">displayChars</span>) </span>{
    <span class="hljs-keyword">this</span>.displayChars = displayChars;
  },
  <span class="hljs-attr">setNamedAttributes</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">attrs</span>) </span>{
    <span class="hljs-keyword">if</span> (!attrs)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">var</span> pairs = attrs.split(<span class="hljs-string">','</span>);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; pairs.length; i++) {
      <span class="hljs-keyword">var</span> parts = pairs[i].split(<span class="hljs-string">'='</span>);
      <span class="hljs-keyword">if</span> (parts.length == <span class="hljs-number">2</span>)
        <span class="hljs-keyword">this</span>.namedAttributes[parts[<span class="hljs-number">0</span>]] = parts[<span class="hljs-number">1</span>];
    }
  },
  <span class="hljs-attr">setDynamicCreation</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">dynamic</span>) </span>{
    <span class="hljs-keyword">this</span>.dynamicCreation = dynamic;
  },
  <span class="hljs-attr">isReference</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.isRef;
  },
  <span class="hljs-attr">isRefRotated</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.refRotated;
  },
  <span class="hljs-attr">isExtensionElement</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.extensionElement;
  },
  <span class="hljs-attr">isDate</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> dateTypes[<span class="hljs-keyword">this</span>.type];
  },
  <span class="hljs-attr">isDateOnly</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (dateOnlyTypes[<span class="hljs-keyword">this</span>.type])
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">else</span>
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  },
  <span class="hljs-attr">isDateTime</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (dateTimeTypes[<span class="hljs-keyword">this</span>.type])
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">else</span>
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  },
  <span class="hljs-attr">getName</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.name;
  },
  <span class="hljs-attr">getLabel</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.label;
  },
  <span class="hljs-attr">getClearLabel</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.clearLabel;
  },
  <span class="hljs-attr">getReference</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.reference;
  },
  <span class="hljs-attr">getMulti</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.multi;
  },
  <span class="hljs-attr">isMulti</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.getMulti() == <span class="hljs-string">'yes'</span>;
  },
  <span class="hljs-attr">getDependent</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.dependent;
  },
  <span class="hljs-attr">getRefQual</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.refQual;
  },
  <span class="hljs-attr">getRefKey</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.refKey;
  },
  <span class="hljs-attr">getRefLabel</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.refLabel;
  },
  <span class="hljs-attr">getRefDisplay</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.refDisplay;
  },
  <span class="hljs-attr">getType</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.type;
  },
  <span class="hljs-attr">getChoice</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.choice;
  },
  <span class="hljs-attr">getTable</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.table;
  },
  <span class="hljs-attr">getTableName</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.tableName;
  },
  <span class="hljs-attr">setTableName</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">t</span>) </span>{
    <span class="hljs-keyword">this</span>.tableName = t;
  },
  <span class="hljs-attr">isChoice</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> (<span class="hljs-keyword">this</span>.choice == <span class="hljs-number">1</span> ||
      <span class="hljs-keyword">this</span>.choice == <span class="hljs-number">3</span> ||
      <span class="hljs-keyword">this</span>.type == <span class="hljs-string">"day_of_week"</span> ||
      <span class="hljs-keyword">this</span>.type == <span class="hljs-string">"week_of_month"</span> ||
      <span class="hljs-keyword">this</span>.type == <span class="hljs-string">"month_of_year"</span>);
  },
  <span class="hljs-attr">getMaxLength</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.maxLength;
  },
  <span class="hljs-attr">getDisplayChars</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.displayChars;
  },
  <span class="hljs-attr">canRead</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.canread == <span class="hljs-string">'unknown'</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.getBooleanAttribute(<span class="hljs-string">"canread"</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.canread;
  },
  <span class="hljs-attr">canSaveAsTemplate</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.saveastemplate == <span class="hljs-string">'unknown'</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.getBooleanAttribute(<span class="hljs-string">"save_as_template"</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.saveastemplate;
  },
  <span class="hljs-attr">canWrite</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.canwrite == <span class="hljs-string">'unknown'</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.getBooleanAttribute(<span class="hljs-string">"canwrite"</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.canwrite;
  },
  <span class="hljs-attr">canMatch</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.getBooleanAttribute(<span class="hljs-string">"canmatch"</span>);
  },
  <span class="hljs-attr">isEdgeEncrypted</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.getBooleanAttribute(<span class="hljs-string">"edge_encrypted"</span>, <span class="hljs-literal">false</span>);
  },
  <span class="hljs-attr">isActive</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.active == <span class="hljs-string">'unknown'</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.getBooleanAttribute(<span class="hljs-string">"active"</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.active;
  },
  <span class="hljs-attr">isNumber</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.type == <span class="hljs-string">'integer'</span> ||
      <span class="hljs-keyword">this</span>.type == <span class="hljs-string">'decimal'</span> ||
      <span class="hljs-keyword">this</span>.type == <span class="hljs-string">'numeric'</span> ||
      <span class="hljs-keyword">this</span>.type == <span class="hljs-string">'float'</span> ||
      <span class="hljs-keyword">this</span>.type == <span class="hljs-string">'percent_complete'</span>;
  },
  <span class="hljs-attr">isArray</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.array &amp;&amp; <span class="hljs-keyword">this</span>.array == <span class="hljs-string">'yes'</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  },
  <span class="hljs-attr">canSort</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.getBooleanAttribute(<span class="hljs-string">"cansort"</span>))
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.name.indexOf(<span class="hljs-string">"password"</span>) &gt; <span class="hljs-number">-1</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.name == <span class="hljs-string">'sys_id'</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.type == <span class="hljs-string">"journal"</span> || <span class="hljs-keyword">this</span>.type == <span class="hljs-string">"journal_input"</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.isArray())
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  },
  <span class="hljs-attr">canSortI18N</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.getBooleanAttribute(<span class="hljs-string">"cansorti18n"</span>);
  },
  <span class="hljs-attr">canGroup</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.getNamedAttribute(<span class="hljs-string">"can_group"</span>) == <span class="hljs-string">"true"</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.isEdgeEncrypted() &amp;&amp; <span class="hljs-keyword">this</span>.canMatch())
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.canSort())
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.isMulti())
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.name.indexOf(<span class="hljs-string">"."</span>) &gt; <span class="hljs-number">-1</span> &amp;&amp; <span class="hljs-keyword">this</span>.name.indexOf(<span class="hljs-keyword">this</span>.REF_ELEMENT_PREFIX) &gt; <span class="hljs-number">-1</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.type == <span class="hljs-string">"glide_duration"</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.type == <span class="hljs-string">'glide_date_time'</span> ||
      <span class="hljs-keyword">this</span>.type == <span class="hljs-string">'glide_date'</span> ||
      <span class="hljs-keyword">this</span>.type == <span class="hljs-string">'glide_time'</span> ||
      <span class="hljs-keyword">this</span>.type == <span class="hljs-string">'due_date'</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  },
  <span class="hljs-attr">getAttributes</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.attributes[<span class="hljs-string">'attributes'</span>];
  },
  <span class="hljs-attr">getNamedAttribute</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name</span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.namedAttributes[name])
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.namedAttributes[name];
    <span class="hljs-keyword">else</span>
      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  },
  <span class="hljs-attr">type</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-string">"TableElement"</span>;
  },
  <span class="hljs-attr">isDynamicCreation</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.dynamicCreation;
  }
});
TableElement.get = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name</span>) </span>{
  <span class="hljs-keyword">var</span> names = name.split(<span class="hljs-string">'.'</span>);
  <span class="hljs-keyword">var</span> table = names[<span class="hljs-number">0</span>];
  <span class="hljs-keyword">var</span> tableDef = Table.get(table);
  <span class="hljs-keyword">var</span> e = <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">1</span>; i &lt; names.length; i++) {
    e = tableDef.getElement(names[i]);
    <span class="hljs-keyword">if</span> (i == names.length - <span class="hljs-number">1</span>)
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">if</span> (!e.isReference())
      <span class="hljs-keyword">break</span>;
    tableDef = Table.get(e.getReference());
  }
  <span class="hljs-keyword">return</span> e;
};
<span class="hljs-comment">/*! RESOURCE: /scripts/classes/TableExtension.js */</span>
<span class="hljs-keyword">var</span> TableExtension = Class.create({
  <span class="hljs-attr">REF_ELEMENT_PREFIX</span>: <span class="hljs-string">'ref_'</span>,
  <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">elementName, elementLabel</span>) </span>{
    <span class="hljs-keyword">this</span>.name = elementName;
    <span class="hljs-keyword">this</span>.label = elementLabel;
    <span class="hljs-keyword">this</span>.table = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">this</span>.fields = <span class="hljs-literal">null</span>;
  },
  <span class="hljs-attr">getName</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.name;
  },
  <span class="hljs-attr">getExtName</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.REF_ELEMENT_PREFIX + <span class="hljs-keyword">this</span>.getName();
  },
  <span class="hljs-attr">getLabel</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.label;
  },
  <span class="hljs-attr">setTable</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">t</span>) </span>{
    <span class="hljs-keyword">this</span>.table = t;
  },
  <span class="hljs-attr">addOption</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">select, namePrefix, labelPrefix</span>) </span>{
    <span class="hljs-keyword">var</span> t = <span class="hljs-keyword">this</span>.getName();
    <span class="hljs-keyword">var</span> ext = <span class="hljs-keyword">this</span>.getExtName();
    <span class="hljs-keyword">if</span> (namePrefix &amp;&amp; namePrefix != <span class="hljs-string">''</span>) {
      <span class="hljs-keyword">var</span> idx = namePrefix.lastIndexOf(<span class="hljs-string">"."</span>);
      <span class="hljs-keyword">var</span> s = namePrefix.substring(idx + <span class="hljs-number">1</span>);
      <span class="hljs-keyword">var</span> previousIsExtension = <span class="hljs-literal">true</span>;
      <span class="hljs-keyword">if</span> (s.indexOf(<span class="hljs-keyword">this</span>.REF_ELEMENT_PREFIX) == <span class="hljs-number">0</span>)
        ext = namePrefix.substring(<span class="hljs-number">0</span>, idx + <span class="hljs-number">1</span>) + ext;
      <span class="hljs-keyword">else</span> {
        ext = namePrefix + <span class="hljs-string">"."</span> + ext;
        previousIsExtension = <span class="hljs-literal">false</span>;
      }
    }
    <span class="hljs-keyword">var</span> label = <span class="hljs-keyword">this</span>.getLabel();
    <span class="hljs-keyword">var</span> reflabel = label;
    <span class="hljs-keyword">if</span> (labelPrefix &amp;&amp; labelPrefix != <span class="hljs-string">''</span>)
      <span class="hljs-keyword">if</span> (previousIsExtension)
        reflabel = labelPrefix.substring(<span class="hljs-number">0</span>, labelPrefix.lastIndexOf(<span class="hljs-string">"."</span>)) + <span class="hljs-string">"."</span> + reflabel;
      <span class="hljs-keyword">else</span>
        reflabel = labelPrefix + <span class="hljs-string">"."</span> + reflabel;
    tlabel = label + <span class="hljs-string">" (+)"</span>;
    appendSelectOption(select, ext, <span class="hljs-built_in">document</span>.createTextNode(tlabel));
    <span class="hljs-keyword">var</span> opt = select.options[select.options.length - <span class="hljs-number">1</span>];
    <span class="hljs-keyword">if</span> (labelPrefix != <span class="hljs-string">''</span>)
      opt.innerHTML = <span class="hljs-string">"&amp;nbsp;&amp;nbsp;&amp;nbsp;"</span> + tlabel;
    <span class="hljs-keyword">else</span>
      opt.innerHTML = tlabel;
    opt.cl = reflabel;
    opt.cv = ext;
    opt.tl = reflabel;
    opt.style.color = <span class="hljs-string">'darkred'</span>;
    opt.style.cursor = <span class="hljs-string">'pointer'</span>;
    opt.title = <span class="hljs-string">"Show extended fields from "</span> + label + <span class="hljs-string">" table"</span>;
    opt.doNotDelete = <span class="hljs-string">'true'</span>;
    opt.doNotMove = <span class="hljs-string">'true'</span>
    opt.reference = t;
    opt.bt = <span class="hljs-keyword">this</span>.table.getName();
    opt.btl = <span class="hljs-keyword">this</span>.table.getLabel();
    opt.headerAttr = <span class="hljs-string">'true'</span>;
    opt.tl = reflabel;
  },
  <span class="hljs-attr">type</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-string">"TableExtension"</span>;
  }
});;
<span class="hljs-comment">/*! RESOURCE: /scripts/classes/GlideDecoration.js */</span>
<span class="hljs-keyword">var</span> GlideDecoration = Class.create({
  <span class="hljs-attr">EDIT_DECORATION</span>: <span class="hljs-string">"images/editor_view_small.gifx"</span>,
  <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">node</span>) </span>{
    <span class="hljs-keyword">this</span>.type = node.getAttribute(<span class="hljs-string">'type'</span>);
    <span class="hljs-keyword">this</span>.iconSRC = node.getAttribute(<span class="hljs-string">'iconSRC'</span>);
    <span class="hljs-keyword">var</span> left = node.getAttribute(<span class="hljs-string">'left'</span>);
    <span class="hljs-keyword">if</span> (left == <span class="hljs-string">'true'</span>)
      <span class="hljs-keyword">this</span>.left = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">else</span>
      <span class="hljs-keyword">this</span>.left = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.type == <span class="hljs-string">'popup'</span>) {
      <span class="hljs-keyword">this</span>.onMouseMove = node.getAttribute(<span class="hljs-string">'onMouseMove'</span>);
      <span class="hljs-keyword">this</span>.onMouseExit = node.getAttribute(<span class="hljs-string">'onMouseOut'</span>);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.type == <span class="hljs-string">'expandCollapseDecoration'</span>) {
      <span class="hljs-keyword">this</span>.expandedIcon = node.getAttribute(<span class="hljs-string">'expandedIcon'</span>);
      <span class="hljs-keyword">this</span>.collapsedIcon = node.getAttribute(<span class="hljs-string">'collapsedIcon'</span>);
      <span class="hljs-keyword">this</span>.expandedIconAlt = node.getAttribute(<span class="hljs-string">'expandedIconAlt'</span>);
      <span class="hljs-keyword">this</span>.collapsedIconAlt = node.getAttribute(<span class="hljs-string">'collapsedIconAlt'</span>);
      <span class="hljs-keyword">this</span>.memory = node.getAttribute(<span class="hljs-string">'memory'</span>);
      <span class="hljs-keyword">this</span>.expanded = node.getAttribute(<span class="hljs-string">'expanded'</span>);
      <span class="hljs-keyword">this</span>.altText = node.getAttribute(<span class="hljs-string">"collapsedText"</span>);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.type == <span class="hljs-string">'editDecoration'</span>) {
      <span class="hljs-keyword">this</span>.editLink = node.getAttribute(<span class="hljs-string">'editLink'</span>);
    }
  },
  <span class="hljs-attr">attach</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">window</span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.type == <span class="hljs-string">'image'</span>)
      <span class="hljs-keyword">this</span>.attachImage(<span class="hljs-built_in">window</span>);
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.type == <span class="hljs-string">'popup'</span>)
      <span class="hljs-keyword">this</span>.attachPopup(<span class="hljs-built_in">window</span>);
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.type == <span class="hljs-string">'expandCollapseDecoration'</span>)
      <span class="hljs-keyword">this</span>.attachExpandCollapse(<span class="hljs-built_in">window</span>);
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.type == <span class="hljs-string">'editDecoration'</span>)
      <span class="hljs-keyword">this</span>.attachEdit(<span class="hljs-built_in">window</span>);
  },
  <span class="hljs-attr">attachImage</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">window</span>) </span>{
    <span class="hljs-keyword">var</span> decoration = cel(<span class="hljs-string">'img'</span>);
    decoration.setAttribute(<span class="hljs-string">'src'</span>, <span class="hljs-keyword">this</span>.iconSRC);
    decoration.setAttribute(<span class="hljs-string">'alt'</span>, <span class="hljs-string">''</span>);
    <span class="hljs-built_in">window</span>.addDecoration(decoration, <span class="hljs-keyword">this</span>.left);
  },
  <span class="hljs-attr">attachEdit</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">window</span>) </span>{
    <span class="hljs-keyword">var</span> an = cel(<span class="hljs-string">'a'</span>);
    <span class="hljs-keyword">var</span> d = cel(<span class="hljs-string">'img'</span>);
    d.src = <span class="hljs-keyword">this</span>.EDIT_DECORATION;
    d.alt = getMessage(<span class="hljs-string">'Edit'</span>);
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.editLink.indexOf(<span class="hljs-string">'javascript:'</span>) == <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">var</span> toEval = <span class="hljs-keyword">this</span>.editLink.substring(<span class="hljs-string">'javascript:'</span>.length);
      toEval = <span class="hljs-string">"var f = function(e) { if (!e) { e = event;}; "</span> + toEval + <span class="hljs-string">"}"</span>;
      <span class="hljs-built_in">eval</span>(toEval);
      an.onclick = f;
    } <span class="hljs-keyword">else</span>
      an.href = <span class="hljs-keyword">this</span>.editLink;
    an.appendChild(d);
    <span class="hljs-built_in">window</span>.addDecoration(an, <span class="hljs-keyword">this</span>.left);
  },
  <span class="hljs-attr">attachPopup</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">window</span>) </span>{
    <span class="hljs-keyword">var</span> span = cel(<span class="hljs-string">'span'</span>);
    <span class="hljs-keyword">var</span> toEval = <span class="hljs-keyword">this</span>.onMouseMove;
    toEval = <span class="hljs-string">"var f = function(e) { if (!e) { e = event;}; "</span> + toEval + <span class="hljs-string">"}"</span>;
    <span class="hljs-built_in">eval</span>(toEval);
    span.onmousemove = f;
    toEval = <span class="hljs-keyword">this</span>.onMouseExit;
    toEval = <span class="hljs-string">"var f = function(e) { if (!e) { e = event;}; "</span> + toEval + <span class="hljs-string">"}"</span>;
    <span class="hljs-built_in">eval</span>(toEval);
    span.onmouseout = f;
    <span class="hljs-keyword">var</span> decoration = cel(<span class="hljs-string">'img'</span>);
    decoration.setAttribute(<span class="hljs-string">'src'</span>, <span class="hljs-keyword">this</span>.iconSRC);
    decoration.setAttribute(<span class="hljs-string">'alt'</span>, <span class="hljs-string">''</span>);
    span.appendChild(decoration);
    <span class="hljs-built_in">window</span>.addDecoration(span, <span class="hljs-keyword">this</span>.left);
  },
  <span class="hljs-attr">attachExpandCollapse</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">window</span>) </span>{
    <span class="hljs-keyword">this</span>.img = cel(<span class="hljs-string">'img'</span>);
    <span class="hljs-keyword">this</span>.img.onclick = <span class="hljs-keyword">this</span>.toggleExpand.bind(<span class="hljs-keyword">this</span>);
    <span class="hljs-keyword">this</span>.img.setAttribute(<span class="hljs-string">'src'</span>, <span class="hljs-keyword">this</span>.iconSRC);
    <span class="hljs-keyword">this</span>.img.setAttribute(<span class="hljs-string">'alt'</span>, getMessage(<span class="hljs-string">'Collapse'</span>));
    <span class="hljs-keyword">this</span>.img.style.verticalAlign = <span class="hljs-string">"top"</span>;
    <span class="hljs-keyword">this</span>.gwtWindow = <span class="hljs-built_in">window</span>;
    <span class="hljs-built_in">window</span>.addDecoration(<span class="hljs-keyword">this</span>.img, <span class="hljs-keyword">this</span>.left);
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.expanded == <span class="hljs-string">'false'</span>) {
      <span class="hljs-keyword">this</span>.expanded = <span class="hljs-literal">true</span>;
      <span class="hljs-keyword">this</span>.toggleExpand();
    }
  },
  <span class="hljs-attr">toggleExpand</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
    <span class="hljs-keyword">this</span>.expanded = !<span class="hljs-keyword">this</span>.expanded;
    <span class="hljs-keyword">var</span> localExpanded;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.expanded) {
      <span class="hljs-keyword">this</span>.img.setAttribute(<span class="hljs-string">'src'</span>, <span class="hljs-keyword">this</span>.expandedIcon);
      <span class="hljs-keyword">this</span>.img.setAttribute(<span class="hljs-string">'alt'</span>, <span class="hljs-keyword">this</span>.expandedIconAlt)
      <span class="hljs-keyword">var</span> span = <span class="hljs-keyword">this</span>.gwtWindow.body;
      <span class="hljs-keyword">var</span> temp = span.innerHTML;
      span.innerHTML = <span class="hljs-keyword">this</span>.altText;
      <span class="hljs-keyword">this</span>.altText = temp;
      localExpanded = <span class="hljs-string">'true'</span>;
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">this</span>.img.setAttribute(<span class="hljs-string">'src'</span>, <span class="hljs-keyword">this</span>.collapsedIcon);
      <span class="hljs-keyword">this</span>.img.setAttribute(<span class="hljs-string">'alt'</span>, <span class="hljs-keyword">this</span>.collapsedIconAlt)
      <span class="hljs-keyword">var</span> span = <span class="hljs-keyword">this</span>.gwtWindow.body;
      <span class="hljs-keyword">var</span> temp = span.innerHTML;
      span.innerHTML = <span class="hljs-keyword">this</span>.altText;
      <span class="hljs-keyword">this</span>.altText = temp;
      localExpanded = <span class="hljs-string">'false'</span>;
    }
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.memory != <span class="hljs-literal">null</span> &amp;&amp; <span class="hljs-keyword">this</span>.memory != <span class="hljs-string">''</span>)
      setPreference(<span class="hljs-string">'render_'</span> + <span class="hljs-keyword">this</span>.memory + <span class="hljs-string">'.expanded'</span>, localExpanded);
  }
});;
<span class="hljs-comment">/*! RESOURCE: /scripts/classes/GwtCellSelector.js */</span>
<span class="hljs-keyword">var</span> GwtCellSelector = Class.create({
  <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">tableElement</span>) </span>{
    <span class="hljs-keyword">this</span>.tableElement = tableElement;
    <span class="hljs-keyword">this</span>.setDisable(<span class="hljs-literal">false</span>);
    <span class="hljs-keyword">this</span>.setSelectColumnOnly(<span class="hljs-literal">false</span>);
    <span class="hljs-keyword">this</span>.setSelectNonContiguous(<span class="hljs-literal">false</span>);
    <span class="hljs-keyword">this</span>.setSelectColor(<span class="hljs-string">"#DFDFDF"</span>);
    <span class="hljs-keyword">this</span>.browserColor = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">this</span>.setUnselectColor(<span class="hljs-string">"#FAFAFA"</span>);
    <span class="hljs-keyword">this</span>.setCursor(<span class="hljs-string">"crosshair"</span>);
    <span class="hljs-keyword">this</span>.setBorderSize(<span class="hljs-string">"2px solid black"</span>);
    <span class="hljs-keyword">this</span>.onSelect = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">this</span>.beforeSelect = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">this</span>.selectMultipleColumns = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">this</span>.selectMiscCells = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">this</span>.isMouseDown = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">this</span>.centerCellColVal = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">this</span>.centerCellRowVal = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">this</span>.atCol = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">this</span>.atRow = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">this</span>.colFrom = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">this</span>.colTo = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">this</span>.rowFrom = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">this</span>.rowTo = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">this</span>.maxCol = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">this</span>.maxRow = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">this</span>.selectCount = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">this</span>.returnObjects = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Object</span>();
    <span class="hljs-keyword">this</span>.cellBackgroundXref = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Object</span>();
    <span class="hljs-keyword">this</span>.ignoreColumns = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Object</span>();
    <span class="hljs-keyword">this</span>.ignoreRows = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Object</span>();
    <span class="hljs-keyword">this</span>.getGridInfo()
    Event.observe(<span class="hljs-keyword">this</span>.tableElement, <span class="hljs-string">"mousedown"</span>, <span class="hljs-keyword">this</span>._dragStart.bind(<span class="hljs-keyword">this</span>));
    <span class="hljs-keyword">this</span>.mouseUpTableListener = <span class="hljs-keyword">this</span>._dragEnd.bindAsEventListener(<span class="hljs-keyword">this</span>);
    <span class="hljs-keyword">this</span>.mouseOverTableListener = <span class="hljs-keyword">this</span>._dragOver.bindAsEventListener(<span class="hljs-keyword">this</span>);
    <span class="hljs-keyword">this</span>.mouseUpDocListener = <span class="hljs-keyword">this</span>._dragCheck.bindAsEventListener(<span class="hljs-keyword">this</span>);
  },
  <span class="hljs-attr">_draw</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>._drawSelection(<span class="hljs-keyword">this</span>.colFrom, <span class="hljs-keyword">this</span>.colTo, <span class="hljs-keyword">this</span>.rowFrom, <span class="hljs-keyword">this</span>.rowTo);
  },
  <span class="hljs-attr">_dragStart</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
    <span class="hljs-keyword">if</span> (Event.isRightClick(e))
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">if</span> ($(<span class="hljs-string">"cell_edit_cancel"</span>))
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.disableGrid) {
      <span class="hljs-keyword">this</span>.getGridInfo();
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.selectNonContiguous)
        <span class="hljs-keyword">this</span>._contiguousCheck(e);
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.ignoreColumns[Event.element(e).cellIndex] ||
        <span class="hljs-keyword">this</span>.ignoreRows[<span class="hljs-keyword">this</span>._getRowIndex(Event.element(e).parentNode)]) {
        <span class="hljs-keyword">return</span>;
      }
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.beforeSelect) {
        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.handleBeforeSelect(e))
          <span class="hljs-keyword">return</span>;
      }
      <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.isSelectColumnOnly)
        <span class="hljs-keyword">this</span>.selectMultipleColumns = e.shiftKey;
      <span class="hljs-keyword">this</span>.isMouseDown = <span class="hljs-literal">true</span>;
      <span class="hljs-built_in">document</span>.body.style.cursor = <span class="hljs-keyword">this</span>.cursor;
      stopSelection(<span class="hljs-built_in">document</span>.body);
      <span class="hljs-keyword">this</span>._setEpicenter(e);
      <span class="hljs-keyword">this</span>._selectAndDrawCells(Event.element(e));
      Event.observe(<span class="hljs-keyword">this</span>.tableElement, <span class="hljs-string">"mouseup"</span>, <span class="hljs-keyword">this</span>.mouseUpTableListener);
      Event.observe(<span class="hljs-keyword">this</span>.tableElement, <span class="hljs-string">"mouseover"</span>, <span class="hljs-keyword">this</span>.mouseOverTableListener);
      Event.observe(<span class="hljs-built_in">document</span>, <span class="hljs-string">"mouseup"</span>, <span class="hljs-keyword">this</span>.mouseUpDocListener);
      e.preventDefault();
    }
  },
  <span class="hljs-attr">_dragOver</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.isMouseDown) {
      <span class="hljs-keyword">this</span>._selectAndDrawCells(Event.element(e));
    }
  },
  <span class="hljs-attr">_dragEnd</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
    <span class="hljs-keyword">this</span>.returnObjects = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Object</span>();
    <span class="hljs-keyword">this</span>.isMouseDown = <span class="hljs-literal">false</span>;
    <span class="hljs-built_in">document</span>.body.style.cursor = <span class="hljs-string">"default"</span>;
    <span class="hljs-keyword">this</span>._selectAndDrawCells(Event.element(e));
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.onSelect) {
      <span class="hljs-keyword">this</span>.handleOnSelect(<span class="hljs-keyword">this</span>.returnObjects);
    }
    restoreSelection(<span class="hljs-built_in">document</span>.body);
    Event.stopObserving(<span class="hljs-keyword">this</span>.tableElement, <span class="hljs-string">"mouseup"</span>, <span class="hljs-keyword">this</span>.mouseUpTableListener);
    Event.stopObserving(<span class="hljs-keyword">this</span>.tableElement, <span class="hljs-string">"mouseover"</span>, <span class="hljs-keyword">this</span>.mouseOverTableListener);
    Event.stopObserving(<span class="hljs-built_in">document</span>, <span class="hljs-string">"mouseup"</span>, <span class="hljs-keyword">this</span>.mouseUpDocListener);
  },
  <span class="hljs-attr">_dragCheck</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.isMouseDown) {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">this</span>._dragEnd(e);
      } <span class="hljs-keyword">catch</span> (err) {}
    }
  },
  <span class="hljs-attr">_contiguousCheck</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
    <span class="hljs-keyword">if</span> (e.ctrlKey)
      <span class="hljs-keyword">this</span>.selectMiscCells = e.ctrlKey;
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (e.metaKey)
      <span class="hljs-keyword">this</span>.selectMiscCells = e.metaKey;
    <span class="hljs-keyword">else</span>
      <span class="hljs-keyword">this</span>.selectMiscCells = <span class="hljs-literal">false</span>;
  },
  <span class="hljs-attr">getSelectedObjects</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.returnObjects;
  },
  <span class="hljs-attr">getColFrom</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.colFrom;
  },
  <span class="hljs-attr">getColTo</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.colTo;
  },
  <span class="hljs-attr">getRowFrom</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.rowFrom;
  },
  <span class="hljs-attr">getRowTo</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.rowTo;
  },
  <span class="hljs-attr">setIgnoreColumn</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">column</span>) </span>{
    <span class="hljs-keyword">this</span>.ignoreColumns[column] = column;
  },
  <span class="hljs-attr">setIgnoreRow</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">row</span>) </span>{
    <span class="hljs-keyword">this</span>.ignoreRows[row] = row;
  },
  <span class="hljs-attr">setSelectColor</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">selectColor</span>) </span>{
    <span class="hljs-keyword">this</span>.selectColor = selectColor;
  },
  <span class="hljs-attr">setUnselectColor</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">unselectColor</span>) </span>{
    <span class="hljs-keyword">this</span>.unselectColor = unselectColor;
  },
  <span class="hljs-attr">setCursor</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">cursor</span>) </span>{
    <span class="hljs-keyword">this</span>.cursor = cursor;
  },
  <span class="hljs-attr">setSelectColumnOnly</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">flag</span>) </span>{
    <span class="hljs-keyword">this</span>.isSelectColumnOnly = flag;
  },
  <span class="hljs-attr">setDisable</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">flag</span>) </span>{
    <span class="hljs-keyword">this</span>.disableGrid = flag;
  },
  <span class="hljs-attr">setSelectNonContiguous</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">flag</span>) </span>{
    <span class="hljs-keyword">this</span>.selectNonContiguous = flag;
  },
  <span class="hljs-attr">setBorderSize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">size</span>) </span>{
    <span class="hljs-keyword">this</span>.borderSize = size;
  },
  <span class="hljs-attr">_setSelectedCells</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">colFrom, colTo, rowFrom, rowTo</span>) </span>{
    <span class="hljs-keyword">this</span>.colFrom = colFrom;
    <span class="hljs-keyword">this</span>.colTo = colTo;
    <span class="hljs-keyword">this</span>.rowFrom = rowFrom;
    <span class="hljs-keyword">this</span>.rowTo = rowTo;
  },
  <span class="hljs-attr">_selectAndDrawCells</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
    <span class="hljs-keyword">this</span>._selectCells(e);
    <span class="hljs-keyword">this</span>._drawSelection(<span class="hljs-keyword">this</span>.colFrom, <span class="hljs-keyword">this</span>.colTo, <span class="hljs-keyword">this</span>.rowFrom, <span class="hljs-keyword">this</span>.rowTo);
  },
  <span class="hljs-attr">_selectCells</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
    <span class="hljs-keyword">this</span>.atColVal = e.cellIndex;
    <span class="hljs-keyword">this</span>.atRowVal = <span class="hljs-keyword">this</span>._getRowIndex(e.parentNode);
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.atColVal &lt;= <span class="hljs-number">0</span>)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.atRowVal &lt;= <span class="hljs-number">0</span>)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.selectMultipleColumns) {
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.atColVal &lt; <span class="hljs-keyword">this</span>.centerCellColVal) {
        <span class="hljs-keyword">this</span>.colFrom = <span class="hljs-keyword">this</span>.atColVal;
        <span class="hljs-keyword">this</span>.colTo = <span class="hljs-keyword">this</span>.centerCellColVal;
        <span class="hljs-keyword">this</span>._getRowSelection();
        <span class="hljs-keyword">return</span>;
      }
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.atColVal &gt; <span class="hljs-keyword">this</span>.centerCellColVal) {
        <span class="hljs-keyword">this</span>.colFrom = <span class="hljs-keyword">this</span>.centerCellColVal;
        <span class="hljs-keyword">this</span>.colTo = <span class="hljs-keyword">this</span>.atColVal;
        <span class="hljs-keyword">this</span>._getRowSelection();
        <span class="hljs-keyword">return</span>;
      }
    }
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.atColVal == <span class="hljs-keyword">this</span>.centerCellColVal) {
      <span class="hljs-keyword">this</span>.colFrom = <span class="hljs-keyword">this</span>.centerCellColVal;
      <span class="hljs-keyword">this</span>.colTo = <span class="hljs-keyword">this</span>.centerCellColVal;
      <span class="hljs-keyword">this</span>._getRowSelection();
      <span class="hljs-keyword">return</span>;
    }
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.atRowVal &lt; <span class="hljs-keyword">this</span>.centerCellRowVal) {
      <span class="hljs-keyword">this</span>.rowFrom = <span class="hljs-keyword">this</span>.atRowVal;
      <span class="hljs-keyword">this</span>.rowTo = <span class="hljs-keyword">this</span>.centerCellRowVal;
      <span class="hljs-keyword">this</span>._getColSelection();
      <span class="hljs-keyword">return</span>;
    }
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.atRowVal &gt; <span class="hljs-keyword">this</span>.centerCellRowVal) {
      <span class="hljs-keyword">this</span>.rowFrom = <span class="hljs-keyword">this</span>.centerCellRowVal;
      <span class="hljs-keyword">this</span>.rowTo = <span class="hljs-keyword">this</span>.atRowVal;
      <span class="hljs-keyword">this</span>._getColSelection();
      <span class="hljs-keyword">return</span>;
    }
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.atRowVal == <span class="hljs-keyword">this</span>.centerCellRowVal) {
      <span class="hljs-keyword">this</span>.rowFrom = <span class="hljs-keyword">this</span>.centerCellRowVal;
      <span class="hljs-keyword">this</span>.rowTo = <span class="hljs-keyword">this</span>.centerCellRowVal;
      <span class="hljs-keyword">this</span>._getColSelection();
      <span class="hljs-keyword">return</span>;
    }
  },
  <span class="hljs-attr">_getRowSelection</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.atRowVal &lt;= <span class="hljs-keyword">this</span>.centerCellRowVal) {
      <span class="hljs-keyword">this</span>.rowFrom = <span class="hljs-keyword">this</span>.atRowVal;
      <span class="hljs-keyword">this</span>.rowTo = <span class="hljs-keyword">this</span>.centerCellRowVal;
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">this</span>.rowFrom = <span class="hljs-keyword">this</span>.centerCellRowVal;
      <span class="hljs-keyword">this</span>.rowTo = <span class="hljs-keyword">this</span>.atRowVal;
    }
  },
  <span class="hljs-attr">_getColSelection</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.selectMultipleColumns) {
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.atColVal &lt; <span class="hljs-keyword">this</span>.centerCellColVal) {
        <span class="hljs-keyword">this</span>.colFrom = <span class="hljs-keyword">this</span>.atColVal;
        <span class="hljs-keyword">this</span>.colTo = <span class="hljs-keyword">this</span>.centerCellColVal;
        <span class="hljs-keyword">return</span>;
      }
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.atColVal &gt; <span class="hljs-keyword">this</span>.centerCellColVal) {
        <span class="hljs-keyword">this</span>.colFrom = <span class="hljs-keyword">this</span>.centerCellColVal;
        <span class="hljs-keyword">this</span>.colTo = <span class="hljs-keyword">this</span>.atColVal;
        <span class="hljs-keyword">return</span>;
      }
    }
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.atColVal == <span class="hljs-keyword">this</span>.centerCellColVal) {
      <span class="hljs-keyword">this</span>.colFrom = <span class="hljs-keyword">this</span>.centerCellColVal;
      <span class="hljs-keyword">this</span>.colTo = <span class="hljs-keyword">this</span>.centerCellColVal;
    }
  },
  <span class="hljs-attr">_drawSelection</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">colFrom, colTo, rowFrom, rowTo</span>) </span>{
    <span class="hljs-keyword">this</span>._highlightCells(colFrom, colTo, rowFrom, rowTo);
  },
  <span class="hljs-attr">restoreCellColors</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> key <span class="hljs-keyword">in</span> <span class="hljs-keyword">this</span>.returnObjects) {
      <span class="hljs-keyword">var</span> color = <span class="hljs-string">""</span>;
      <span class="hljs-keyword">var</span> cell = key.split(<span class="hljs-string">","</span>);
      <span class="hljs-keyword">var</span> e = <span class="hljs-keyword">this</span>.getTableCell(<span class="hljs-built_in">parseInt</span>(cell[<span class="hljs-number">1</span>]) - <span class="hljs-number">1</span>, cell[<span class="hljs-number">0</span>]);
      removeClassName(e, <span class="hljs-string">"list_edit_selected_cell"</span>);
    }
    <span class="hljs-keyword">this</span>.returnObjects = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Object</span>();
  },
  <span class="hljs-attr">_highlightCells</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">colFrom, colTo, rowFrom, rowTo</span>) </span>{
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.selectMiscCells)
      <span class="hljs-keyword">this</span>.restoreCellColors();
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> x = colFrom; x &lt;= colTo; x++) {
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> y = rowFrom; y &lt;= rowTo; y++) {
        <span class="hljs-keyword">try</span> {
          <span class="hljs-keyword">var</span> e = <span class="hljs-keyword">this</span>.tableElement.rows[y].cells[x];
          addClassName(e, <span class="hljs-string">"list_edit_selected_cell"</span>);
          <span class="hljs-keyword">this</span>.returnObjects[x + <span class="hljs-string">","</span> + y] = e.id;
        } <span class="hljs-keyword">catch</span> (err) {}
      }
    }
  },
  <span class="hljs-attr">_clearAllCells</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> x = <span class="hljs-number">1</span>; x &lt;= <span class="hljs-keyword">this</span>.maxCol; x++) {
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> y = <span class="hljs-number">1</span>; y &lt; <span class="hljs-keyword">this</span>.maxRow; y++) {
        <span class="hljs-keyword">try</span> {
          <span class="hljs-keyword">var</span> cell = <span class="hljs-keyword">this</span>.getTableCell(y, x);
          cell.style.backgroundColor = <span class="hljs-string">""</span>;
          cell.style.border = <span class="hljs-string">"0px"</span>;
        } <span class="hljs-keyword">catch</span> (err) {}
      }
    }
  },
  <span class="hljs-attr">clearRanges</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">if</span> (ie5)
        <span class="hljs-built_in">document</span>.selection.empty();
      <span class="hljs-keyword">else</span>
        <span class="hljs-built_in">window</span>.getSelection().removeAllRanges();
    } <span class="hljs-keyword">catch</span> (e) {}
  },
  <span class="hljs-attr">getGridInfo</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> rows = <span class="hljs-keyword">this</span>.getTableRows();
    <span class="hljs-keyword">this</span>.maxRow = rows.length;
    <span class="hljs-keyword">if</span> (rows.length &gt; <span class="hljs-number">0</span>)
      <span class="hljs-keyword">this</span>.maxCol = rows[<span class="hljs-number">0</span>].cells.length;
  },
  <span class="hljs-attr">setMaxRow</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">max</span>) </span>{
    <span class="hljs-keyword">this</span>.maxRow = max;
  },
  <span class="hljs-attr">_setEpicenter</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
    <span class="hljs-keyword">var</span> element = <span class="hljs-keyword">this</span>.retrieveCellFromNestedDOMElement(Event.element(e), <span class="hljs-string">'DIV'</span>);
    <span class="hljs-keyword">this</span>.centerCellColVal = element.cellIndex;
    <span class="hljs-keyword">this</span>.centerCellRowVal = <span class="hljs-keyword">this</span>._getRowIndex(element.parentNode);
  },
  <span class="hljs-attr">handleBeforeSelect</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{},
  <span class="hljs-attr">retrieveCellFromNestedDOMElement</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">element, tagName</span>) </span>{
    <span class="hljs-keyword">if</span> (element.tagName == tagName &amp;&amp; element.parentNode.tagName == <span class="hljs-string">'TD'</span>)
      <span class="hljs-keyword">return</span> element.parentNode;
    <span class="hljs-keyword">return</span> element;
  },
  <span class="hljs-attr">handleOnSelect</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">selectedCells</span>) </span>{},
  <span class="hljs-attr">setBeforeSelect</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">flag</span>) </span>{
    <span class="hljs-keyword">this</span>.beforeSelect = flag;
  },
  <span class="hljs-attr">setOnSelect</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">flag</span>) </span>{
    <span class="hljs-keyword">this</span>.onSelect = flag;
  },
  <span class="hljs-attr">_getRowIndex</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">element</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.getTableRows().indexOf(element) + <span class="hljs-number">1</span>;
  },
  <span class="hljs-attr">getTableRows</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> rows = <span class="hljs-keyword">this</span>.tableElement.rows;
    listRows = [];
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, n = rows.length; i &lt; n; i++) {
      <span class="hljs-keyword">var</span> row = rows[i];
      <span class="hljs-keyword">if</span> (!hasClassName(row, <span class="hljs-string">'list_row'</span>))
        <span class="hljs-keyword">continue</span>;
      listRows.push(row);
    }
    <span class="hljs-keyword">return</span> listRows;
  },
  <span class="hljs-attr">getTableCell</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">rowNdx, colNdx</span>) </span>{
    <span class="hljs-keyword">var</span> rows = <span class="hljs-keyword">this</span>.getTableRows();
    <span class="hljs-keyword">if</span> (!rows || !rows[rowNdx])
      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">return</span> rows[rowNdx].cells[colNdx];
  },
  <span class="hljs-attr">z</span>: <span class="hljs-literal">null</span>
});;
<span class="hljs-comment">/*! RESOURCE: /scripts/classes/GlideRecord.js */</span>
<span class="hljs-keyword">var</span> GlideRecord = Class.create({
  <span class="hljs-attr">AJAX_PROCESSOR</span>: <span class="hljs-string">"AJAXGlideRecord"</span>,
  <span class="hljs-attr">initialized</span>: <span class="hljs-literal">false</span>,
  <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">tableName</span>) </span>{
    <span class="hljs-keyword">this</span>.currentRow = <span class="hljs-number">-1</span>;
    <span class="hljs-keyword">this</span>.rows = [];
    <span class="hljs-keyword">this</span>.conditions = [];
    <span class="hljs-keyword">this</span>.encodedQuery = <span class="hljs-string">""</span>;
    <span class="hljs-keyword">this</span>.orderByFields = [];
    <span class="hljs-keyword">this</span>.orderByDescFields = [];
    <span class="hljs-keyword">this</span>.displayFields = [];
    <span class="hljs-keyword">this</span>.maxQuerySize = <span class="hljs-number">-1</span>;
    <span class="hljs-keyword">this</span>._wantSessionMessages = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">if</span> (tableName)
      <span class="hljs-keyword">this</span>.setTableName(tableName);
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.initialized == <span class="hljs-literal">false</span>) {
      <span class="hljs-keyword">this</span>.ignoreNames = {};
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> xname <span class="hljs-keyword">in</span> <span class="hljs-keyword">this</span>) {
        <span class="hljs-keyword">this</span>.ignoreNames[xname] = <span class="hljs-literal">true</span>;
      }
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> xname <span class="hljs-keyword">in</span> <span class="hljs-keyword">this</span>) {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.ignoreNames[xname] &amp;&amp; <span class="hljs-keyword">this</span>.ignoreNames[xname] == <span class="hljs-literal">true</span>)
          <span class="hljs-keyword">continue</span>;
        <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>[xname];
      }
    }
    <span class="hljs-keyword">this</span>.initialized = <span class="hljs-literal">true</span>;
  },
  <span class="hljs-attr">addQuery</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> fName;
    <span class="hljs-keyword">var</span> fOper;
    <span class="hljs-keyword">var</span> fValue;
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">arguments</span>.length == <span class="hljs-number">2</span>) {
      fName = <span class="hljs-built_in">arguments</span>[<span class="hljs-number">0</span>];
      fOper = <span class="hljs-string">'='</span>;
      fValue = <span class="hljs-built_in">arguments</span>[<span class="hljs-number">1</span>];
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-built_in">arguments</span>.length == <span class="hljs-number">3</span>) {
      fName = <span class="hljs-built_in">arguments</span>[<span class="hljs-number">0</span>];
      fOper = <span class="hljs-built_in">arguments</span>[<span class="hljs-number">1</span>];
      fValue = <span class="hljs-built_in">arguments</span>[<span class="hljs-number">2</span>];
    }
    <span class="hljs-keyword">this</span>.conditions.push({
      <span class="hljs-string">'name'</span>: fName,
      <span class="hljs-string">'oper'</span>: fOper,
      <span class="hljs-string">'value'</span>: fValue
    });
  },
  <span class="hljs-attr">getEncodedQuery</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> ec = <span class="hljs-keyword">this</span>.encodedQuery;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-keyword">this</span>.conditions.length; i++) {
      <span class="hljs-keyword">var</span> q = <span class="hljs-keyword">this</span>.conditions[i];
      ec += <span class="hljs-string">"^"</span> + q[<span class="hljs-string">'name'</span>] + q[<span class="hljs-string">'oper'</span>] + q[<span class="hljs-string">'value'</span>];
    }
    <span class="hljs-keyword">return</span> ec;
  },
  <span class="hljs-attr">deleteRecord</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">responseFunction</span>) </span>{
    <span class="hljs-keyword">var</span> ajax = <span class="hljs-keyword">new</span> GlideAjax(<span class="hljs-keyword">this</span>.AJAX_PROCESSOR);
    ajax.addParam(<span class="hljs-string">"sysparm_type"</span>, <span class="hljs-string">"delete"</span>);
    ajax.addParam(<span class="hljs-string">"sysparm_name"</span>, <span class="hljs-keyword">this</span>.getTableName());
    ajax.addParam(<span class="hljs-string">"sysparm_chars"</span>, <span class="hljs-keyword">this</span>._getXMLSerialized());
    ajax.addParam(<span class="hljs-string">'sysparm_want_session_messages'</span>, <span class="hljs-keyword">this</span>._wantSessionMessages);
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> responseFunction == <span class="hljs-string">'undefined'</span>) {
      <span class="hljs-keyword">var</span> sw = <span class="hljs-keyword">new</span> StopWatch();
      sw.jslog(<span class="hljs-string">"*** WARNING *** GlideRecord synchronous query for table: "</span> + <span class="hljs-keyword">this</span>.getTableName());
    }
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> responseFunction != <span class="hljs-string">'function'</span>) {
      ajax.getXML();
      <span class="hljs-keyword">return</span>;
    }
    ajax.getXML(<span class="hljs-keyword">this</span>._deleteRecord0.bind(<span class="hljs-keyword">this</span>), <span class="hljs-literal">null</span>, responseFunction);
  },
  <span class="hljs-attr">_deleteRecord0</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">response, responseFunction</span>) </span>{
    <span class="hljs-keyword">if</span> (!response || !response.responseXML)
      <span class="hljs-keyword">return</span>;
    responseFunction(<span class="hljs-keyword">this</span>);
  },
  <span class="hljs-attr">get</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">id</span>) </span>{
    <span class="hljs-keyword">this</span>.initialize();
    <span class="hljs-keyword">this</span>.addQuery(<span class="hljs-string">'sys_id'</span>, id);
    <span class="hljs-keyword">this</span>.query();
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.next();
  },
  <span class="hljs-attr">getTableName</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.tableName;
  },
  <span class="hljs-attr">hasNext</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> (<span class="hljs-keyword">this</span>.currentRow + <span class="hljs-number">1</span> &lt; <span class="hljs-keyword">this</span>.rows.length);
  },
  <span class="hljs-attr">insert</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">responseFunction</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.update(responseFunction);
  },
  <span class="hljs-attr">gotoTop</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>.currentRow = <span class="hljs-number">-1</span>;
  },
  <span class="hljs-attr">next</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.hasNext())
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">this</span>.currentRow++;
    <span class="hljs-keyword">this</span>.loadRow(<span class="hljs-keyword">this</span>.rows[<span class="hljs-keyword">this</span>.currentRow]);
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  },
  <span class="hljs-attr">loadRow</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">r</span>) </span>{
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; r.length; i++) {
      <span class="hljs-keyword">var</span> name = r[i].name;
      <span class="hljs-keyword">var</span> value = r[i].value;
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.isDotWalkField(name)) {
        <span class="hljs-keyword">var</span> start = <span class="hljs-keyword">this</span>;
        <span class="hljs-keyword">var</span> parts = name.split(<span class="hljs-regexp">/-/</span>);
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> p = <span class="hljs-number">0</span>; p &lt; parts.length - <span class="hljs-number">1</span>; p++) {
          <span class="hljs-keyword">var</span> part = parts[p];
          <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> start[part] != <span class="hljs-string">'object'</span>)
            start[part] = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Object</span>();
          start = start[part];
        }
        <span class="hljs-keyword">var</span> fieldName = parts[parts.length - <span class="hljs-number">1</span>];
        start[fieldName] = value;
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">this</span>[name] = value;
      }
    }
  },
  <span class="hljs-attr">getValue</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>[fieldName];
  },
  <span class="hljs-attr">setValue</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName, value</span>) </span>{
    <span class="hljs-keyword">this</span>[fieldName] = value;
  },
  <span class="hljs-attr">isDotWalkField</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name</span>) </span>{
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-keyword">this</span>.displayFields.length; i++) {
      <span class="hljs-keyword">var</span> fieldName = <span class="hljs-keyword">this</span>.displayFields[i];
      <span class="hljs-keyword">if</span> (fieldName.indexOf(<span class="hljs-string">"."</span>) == <span class="hljs-number">-1</span>)
        <span class="hljs-keyword">continue</span>;
      <span class="hljs-keyword">var</span> encodedFieldName = fieldName.replace(<span class="hljs-regexp">/\./g</span>, <span class="hljs-string">"-"</span>);
      <span class="hljs-keyword">if</span> (name == encodedFieldName)
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  },
  <span class="hljs-attr">addOrderBy</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">f</span>) </span>{
    <span class="hljs-keyword">this</span>.orderByFields.push(f);
  },
  <span class="hljs-attr">orderBy</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">f</span>) </span>{
    <span class="hljs-keyword">this</span>.orderByFields.push(f);
  },
  <span class="hljs-attr">orderByDesc</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">f</span>) </span>{
    <span class="hljs-keyword">this</span>.orderByDescFields.push(f);
  },
  <span class="hljs-attr">setDisplayFields</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fields</span>) </span>{
    <span class="hljs-keyword">this</span>.displayFields = fields;
  },
  <span class="hljs-attr">query</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> responseFunction = <span class="hljs-keyword">this</span>._parseArgs(<span class="hljs-built_in">arguments</span>);
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._getBaseLine()) {
      <span class="hljs-keyword">var</span> rxml = loadXML(g_filter_description.getBaseLine());
      <span class="hljs-keyword">this</span>._queryResponse(rxml);
      <span class="hljs-keyword">return</span>;
    }
    <span class="hljs-keyword">var</span> ajax = <span class="hljs-keyword">new</span> GlideAjax(<span class="hljs-keyword">this</span>.AJAX_PROCESSOR);
    ajax.addParam(<span class="hljs-string">"sysparm_type"</span>, <span class="hljs-string">"query"</span>);
    ajax.addParam(<span class="hljs-string">"sysparm_name"</span>, <span class="hljs-keyword">this</span>.getTableName());
    ajax.addParam(<span class="hljs-string">"sysparm_chars"</span>, <span class="hljs-keyword">this</span>.getEncodedQuery());
    ajax.addParam(<span class="hljs-string">'sysparm_want_session_messages'</span>, <span class="hljs-keyword">this</span>._wantSessionMessages);
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.getLimit() != <span class="hljs-number">-1</span>)
      ajax.addParam(<span class="hljs-string">"sysparm_max_query"</span>, <span class="hljs-keyword">this</span>.getLimit());
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.orderByFields.length &gt; <span class="hljs-number">0</span>)
      ajax.addParam(<span class="hljs-string">"sysparm_orderby"</span>, <span class="hljs-keyword">this</span>.orderByFields.join(<span class="hljs-string">","</span>));
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.orderByDescFields.length &gt; <span class="hljs-number">0</span>)
      ajax.addParam(<span class="hljs-string">"sysparm_orderby_desc"</span>, <span class="hljs-keyword">this</span>.orderByDescFields.join(<span class="hljs-string">","</span>));
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.displayFields.length &gt; <span class="hljs-number">0</span>)
      ajax.addParam(<span class="hljs-string">"sysparm_display_fields"</span>, <span class="hljs-keyword">this</span>.displayFields.join(<span class="hljs-string">","</span>));
    <span class="hljs-keyword">if</span> (!responseFunction) {
      <span class="hljs-keyword">var</span> sw = <span class="hljs-keyword">new</span> StopWatch();
      <span class="hljs-keyword">var</span> rxml = ajax.getXMLWait();
      sw.jslog(<span class="hljs-string">"*** WARNING *** GlideRecord synchronous query for table: "</span> + <span class="hljs-keyword">this</span>.getTableName());
      <span class="hljs-keyword">this</span>._queryResponse(rxml);
      <span class="hljs-keyword">return</span>;
    }
    ajax.getXML(<span class="hljs-keyword">this</span>._query0.bind(<span class="hljs-keyword">this</span>), <span class="hljs-literal">null</span>, responseFunction);
  },
  <span class="hljs-attr">_parseArgs</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">args</span>) </span>{
    <span class="hljs-keyword">var</span> responseFunction = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">while</span> (i &lt; args.length) {
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> args[i] == <span class="hljs-string">'function'</span>) {
        responseFunction = args[i];
        i++;
        <span class="hljs-keyword">continue</span>;
      }
      <span class="hljs-keyword">if</span> (i + <span class="hljs-number">1</span> &lt; args.length) {
        <span class="hljs-keyword">this</span>.conditions.push({
          <span class="hljs-string">'name'</span>: args[i],
          <span class="hljs-string">'oper'</span>: <span class="hljs-string">'='</span>,
          <span class="hljs-string">'value'</span>: args[i + <span class="hljs-number">1</span>]
        });
        i += <span class="hljs-number">2</span>;
      } <span class="hljs-keyword">else</span>
        i++;
    }
    <span class="hljs-keyword">return</span> responseFunction;
  },
  <span class="hljs-attr">_query0</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">response, responseFunction</span>) </span>{
    <span class="hljs-keyword">if</span> (!response || !response.responseXML)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">this</span>._queryResponse(response.responseXML);
    responseFunction(<span class="hljs-keyword">this</span>);
  },
  <span class="hljs-attr">_queryResponse</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">rxml</span>) </span>{
    <span class="hljs-keyword">var</span> rows = [];
    <span class="hljs-keyword">var</span> items = rxml.getElementsByTagName(<span class="hljs-string">"item"</span>);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; items.length; i++) {
      <span class="hljs-keyword">if</span> ((items[i].parentNode.parentNode == rxml)) {
        <span class="hljs-keyword">var</span> grData = items[i];
        <span class="hljs-keyword">var</span> cnodes = grData.childNodes;
        <span class="hljs-keyword">var</span> fields = [];
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> z = <span class="hljs-number">0</span>; z &lt; cnodes.length; z++) {
          <span class="hljs-keyword">var</span> field = cnodes[z];
          <span class="hljs-keyword">var</span> name = field.nodeName;
          <span class="hljs-keyword">var</span> value = getTextValue(field);
          <span class="hljs-keyword">if</span> (!value)
            value = <span class="hljs-string">""</span>;
          fields.push({
            <span class="hljs-string">'name'</span>: name,
            <span class="hljs-string">'value'</span>: value
          });
        }
        <span class="hljs-keyword">if</span> (cnodes.length &amp;&amp; cnodes.length &gt; <span class="hljs-number">0</span>)
          rows.push(fields);
      }
    }
    <span class="hljs-keyword">this</span>.setRows(rows);
  },
  <span class="hljs-attr">setRows</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">r</span>) </span>{
    <span class="hljs-keyword">this</span>.rows = r;
  },
  <span class="hljs-attr">setTableName</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">tableName</span>) </span>{
    <span class="hljs-keyword">this</span>.tableName = tableName;
  },
  <span class="hljs-attr">update</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">responseFunction</span>) </span>{
    <span class="hljs-keyword">var</span> ajax = <span class="hljs-keyword">new</span> GlideAjax(<span class="hljs-keyword">this</span>.AJAX_PROCESSOR);
    ajax.addParam(<span class="hljs-string">"sysparm_type"</span>, <span class="hljs-string">"save_list"</span>);
    ajax.addParam(<span class="hljs-string">"sysparm_name"</span>, <span class="hljs-keyword">this</span>.getTableName());
    ajax.addParam(<span class="hljs-string">"sysparm_chars"</span>, <span class="hljs-keyword">this</span>._getXMLSerialized());
    ajax.addParam(<span class="hljs-string">'sysparm_want_session_messages'</span>, <span class="hljs-keyword">this</span>._wantSessionMessages);
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> responseFunction == <span class="hljs-string">'undefined'</span>) {
      <span class="hljs-keyword">var</span> sw = <span class="hljs-keyword">new</span> StopWatch();
      sw.jslog(<span class="hljs-string">"*** WARNING *** GlideRecord synchronous update or insert for table: "</span> + <span class="hljs-keyword">this</span>.getTableName());
      <span class="hljs-keyword">var</span> rxml = ajax.getXMLWait();
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._updateResponse(rxml);
    }
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> responseFunction != <span class="hljs-string">'function'</span>)
      responseFunction = doNothing;
    ajax.getXML(<span class="hljs-keyword">this</span>._update0.bind(<span class="hljs-keyword">this</span>), <span class="hljs-literal">null</span>, responseFunction);
  },
  <span class="hljs-attr">_update0</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">response, responseFunction</span>) </span>{
    <span class="hljs-keyword">if</span> (!response || !response.responseXML)
      <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">var</span> answer = <span class="hljs-keyword">this</span>._updateResponse(response.responseXML);
    responseFunction(<span class="hljs-keyword">this</span>, answer);
  },
  <span class="hljs-attr">_updateResponse</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">rxml</span>) </span>{
    <span class="hljs-keyword">var</span> items = rxml.getElementsByTagName(<span class="hljs-string">"item"</span>);
    <span class="hljs-keyword">if</span> (items &amp;&amp; items.length &gt; <span class="hljs-number">0</span>)
      <span class="hljs-keyword">return</span> getTextValue(items[<span class="hljs-number">0</span>]);
  },
  <span class="hljs-attr">setLimit</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">maxQuery</span>) </span>{
    <span class="hljs-keyword">this</span>.maxQuerySize = maxQuery;
  },
  <span class="hljs-attr">getLimit</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.maxQuerySize;
  },
  <span class="hljs-attr">_getXMLSerialized</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> xml = loadXML(<span class="hljs-string">"&lt;record_update/&gt;"</span>);
    <span class="hljs-keyword">var</span> root = xml.documentElement;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.sys_id)
      root.setAttribute(<span class="hljs-string">"id"</span>, <span class="hljs-keyword">this</span>.sys_id);
    root.setAttribute(<span class="hljs-string">'table'</span>, <span class="hljs-keyword">this</span>.getTableName());
    <span class="hljs-keyword">var</span> item = xml.createElement(<span class="hljs-keyword">this</span>.getTableName());
    root.appendChild(item);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> xname <span class="hljs-keyword">in</span> <span class="hljs-keyword">this</span>) {
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.ignoreNames[xname])
        <span class="hljs-keyword">continue</span>;
      <span class="hljs-keyword">var</span> f = xml.createElement(xname);
      item.appendChild(f);
      <span class="hljs-keyword">var</span> v = <span class="hljs-keyword">this</span>[xname];
      <span class="hljs-keyword">if</span> (!v)
        v = <span class="hljs-string">"NULL"</span>;
      <span class="hljs-keyword">var</span> t = xml.createTextNode(v);
      f.appendChild(t);
    }
    <span class="hljs-keyword">return</span> getXMLString(xml);
  },
  <span class="hljs-attr">_getBaseLine</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">window</span>.g_filter_description &amp;&amp;
      <span class="hljs-keyword">typeof</span> g_filter_description.getBaseLine() != <span class="hljs-string">'undefined'</span> &amp;&amp;
      <span class="hljs-keyword">this</span>.getTableName() == <span class="hljs-string">'cmdb_baseline'</span> &amp;&amp;
      <span class="hljs-keyword">this</span>.getEncodedQuery() &amp;&amp;
      <span class="hljs-keyword">this</span>.orderByFields.length &lt; <span class="hljs-number">1</span> &amp;&amp;
      <span class="hljs-keyword">this</span>.displayFields.length &lt; <span class="hljs-number">1</span>;
  },
  <span class="hljs-attr">setWantSessionMessages</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">want</span>) </span>{
    <span class="hljs-keyword">this</span>._wantSessionMessages = want;
  },
  <span class="hljs-attr">z</span>: <span class="hljs-literal">null</span>
});;
<span class="hljs-comment">/*! RESOURCE: /scripts/classes/GlideWindow.js */</span>
<span class="hljs-keyword">var</span> GlideWindow = Class.create(GwtObservable, {
      <span class="hljs-attr">FORWARD_EVENTS</span>: {
        <span class="hljs-string">"mouseover"</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-string">"mouseout"</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-string">"mousemove"</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-string">"click"</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-string">"dblclick"</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-string">"keyup"</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-string">"mouseenter"</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-string">"mouseleave"</span>: <span class="hljs-literal">true</span>
      },
      <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">id, readOnly</span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-keyword">this</span>.DEFAULT_BODY == <span class="hljs-string">'undefined'</span>)
          <span class="hljs-keyword">this</span>.DEFAULT_BODY = <span class="hljs-string">"&lt;center&gt; "</span> + getMessage(<span class="hljs-string">"Loading..."</span>) + <span class="hljs-string">" &lt;br/&gt;&lt;img src='images/ajax-loader.gifx' alt='"</span> + getMessage(<span class="hljs-string">"Loading..."</span>) + <span class="hljs-string">"' /&gt;&lt;/center&gt;"</span>;
        <span class="hljs-keyword">this</span>._dir = $$(<span class="hljs-string">'html'</span>)[<span class="hljs-number">0</span>].readAttribute(<span class="hljs-string">'dir'</span>) === <span class="hljs-string">"rtl"</span> ? <span class="hljs-string">"right"</span> : <span class="hljs-string">"left"</span>;
        <span class="hljs-keyword">this</span>.id = id;
        <span class="hljs-keyword">this</span>.window = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">this</span>.windowClass = <span class="hljs-string">"drag_section_picker"</span>;
        <span class="hljs-keyword">this</span>.zIndex = <span class="hljs-number">1</span>;
        <span class="hljs-keyword">this</span>.position = <span class="hljs-string">"absolute"</span>;
        <span class="hljs-keyword">this</span>.padding = <span class="hljs-number">3</span>;
        <span class="hljs-keyword">this</span>.container = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">this</span>._readOnly = readOnly;
        <span class="hljs-keyword">this</span>.preferences = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Object</span>();
        <span class="hljs-keyword">this</span>.titleHTML = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">this</span>.elementToFocus = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">this</span>.offsetHorizontal = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.offsetTop = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.gd = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">this</span>.shim = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">this</span>.valid = <span class="hljs-literal">true</span>;
        <span class="hljs-keyword">this</span>.closeDecoration = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">this</span>._draw(id);
        <span class="hljs-keyword">this</span>.initDecorations();
        <span class="hljs-keyword">this</span>.headerWrap = <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">this</span>.setScope(<span class="hljs-string">"global"</span>);
        <span class="hljs-keyword">this</span>.doctype = <span class="hljs-built_in">document</span>.documentElement.getAttribute(<span class="hljs-string">'data-doctype'</span>) == <span class="hljs-string">'true'</span>;
        <span class="hljs-keyword">this</span>.nologValue = <span class="hljs-literal">false</span>;
      },
      <span class="hljs-attr">addDecoration</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">decorationElement, leftSide</span>) </span>{
        <span class="hljs-keyword">if</span> (leftSide) {
          <span class="hljs-keyword">var</span> ld = <span class="hljs-keyword">this</span>.leftDecorations;
          ld.style.display = <span class="hljs-string">"block"</span>;
          <span class="hljs-keyword">if</span> (ld.hasChildNodes()) {
            ld.insertBefore(decorationElement, ld.childNodes[<span class="hljs-number">0</span>].nextSibling);
          } <span class="hljs-keyword">else</span> {
            ld.appendChild(decorationElement);
          }
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.rightDecorations) {
            <span class="hljs-keyword">var</span> rd = <span class="hljs-keyword">this</span>.rightDecorations;
            <span class="hljs-keyword">if</span> (rd.hasChildNodes()) {
              rd.insertBefore(decorationElement, rd.childNodes[<span class="hljs-number">0</span>]);
            } <span class="hljs-keyword">else</span> {
              rd.appendChild(decorationElement);
            }
          } <span class="hljs-keyword">else</span> {}
        }
      },
      <span class="hljs-attr">addFunctionDecoration</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">imgSrc, imgAlt, func, side</span>) </span>{
        <span class="hljs-keyword">var</span> span = cel(<span class="hljs-string">'span'</span>);
        <span class="hljs-keyword">var</span> img = cel(<span class="hljs-string">"img"</span>, span);
        img.id = <span class="hljs-string">'popup_close_image'</span>;
        img.height = <span class="hljs-string">"12"</span>
        img.width = <span class="hljs-string">"13"</span>
        img.style.cursor = <span class="hljs-string">'pointer'</span>;
        img.src = imgSrc;
        img.alt = getMessage(imgAlt);
        img.gWindow = <span class="hljs-keyword">this</span>;
        img.onclick = func;
        <span class="hljs-keyword">this</span>.addDecoration(span, side);
        img = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">return</span> span;
      },
      <span class="hljs-attr">addHelpDecoration</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">func</span>) </span>{
        <span class="hljs-keyword">this</span>.addFunctionDecoration(<span class="hljs-string">'images/help.gif'</span>, <span class="hljs-string">'Help'</span>, func);
      },
      <span class="hljs-attr">clearLeftDecorations</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        clearNodes(<span class="hljs-keyword">this</span>.leftDecorations);
      },
      <span class="hljs-attr">clearRightDecorations</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        clearNodes(<span class="hljs-keyword">this</span>.rightDecorations);
      },
      <span class="hljs-attr">dragging</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">me, x, y</span>) </span>{
        x = <span class="hljs-built_in">Math</span>.max(x, <span class="hljs-number">0</span>);
        y = <span class="hljs-built_in">Math</span>.max(y, <span class="hljs-number">0</span>);
        <span class="hljs-keyword">this</span>.fireEvent(<span class="hljs-string">"dragging"</span>, <span class="hljs-keyword">this</span>);
        me.draggable.style.left = x + <span class="hljs-string">'px'</span>;
        me.draggable.style.top = y + <span class="hljs-string">'px'</span>;
        <span class="hljs-keyword">this</span>._setShimBounds(x, y, <span class="hljs-string">""</span>, <span class="hljs-string">""</span>);
      },
      <span class="hljs-attr">destroy</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">this</span>.fireEvent(<span class="hljs-string">"beforeclose"</span>, <span class="hljs-keyword">this</span>);
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.container) {
          <span class="hljs-keyword">var</span> parent = <span class="hljs-keyword">this</span>.container.parentNode;
          <span class="hljs-keyword">if</span> (parent)
            parent.removeChild(<span class="hljs-keyword">this</span>.container);
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">var</span> gWindow = <span class="hljs-keyword">this</span>.getWindowDOM();
          <span class="hljs-keyword">var</span> parent = gWindow.parentNode;
          <span class="hljs-keyword">if</span> (parent)
            parent.removeChild(gWindow);
        }
        <span class="hljs-keyword">this</span>.setShim(<span class="hljs-literal">false</span>);
        <span class="hljs-keyword">if</span> (isMSIE)
          <span class="hljs-keyword">this</span>.container.outerHTML = <span class="hljs-string">''</span>;
        <span class="hljs-keyword">this</span>.release();
        <span class="hljs-keyword">this</span>.valid = <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">this</span>.closeDecoration = <span class="hljs-literal">null</span>;
      },
      <span class="hljs-attr">getAbsoluteRect</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">addScroll</span>) </span>{
        <span class="hljs-keyword">return</span> getBounds(<span class="hljs-keyword">this</span>.getWindowDOM(), addScroll);
      },
      <span class="hljs-attr">getBody</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.body;
      },
      <span class="hljs-attr">getContainer</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> obj;
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.container) {
          obj = <span class="hljs-keyword">this</span>.container;
        } <span class="hljs-keyword">else</span> {
          obj = <span class="hljs-keyword">this</span>.getWindowDOM();
        }
        <span class="hljs-keyword">return</span> obj;
      },
      <span class="hljs-attr">getClassName</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.getWindowDOM().className;
      },
      <span class="hljs-attr">getDecorations</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">left</span>) </span>{
        <span class="hljs-keyword">if</span> (left)
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.leftDecorations;
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.rightDecorations;
      },
      <span class="hljs-attr">getDescribingXML</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> section = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"section"</span>);
        section.setAttribute(<span class="hljs-string">"name"</span>, <span class="hljs-keyword">this</span>.getID());
        <span class="hljs-keyword">var</span> preferences = <span class="hljs-keyword">this</span>.getPreferences();
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> name <span class="hljs-keyword">in</span> preferences) {
          <span class="hljs-keyword">var</span> p = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"preference"</span>);
          <span class="hljs-keyword">var</span> v = preferences[name];
          p.setAttribute(<span class="hljs-string">"name"</span>, name);
          <span class="hljs-keyword">if</span> (v != <span class="hljs-literal">null</span> &amp;&amp; <span class="hljs-keyword">typeof</span> v == <span class="hljs-string">'object'</span>) {
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> v.join == <span class="hljs-string">"function"</span>) {
              v = v.join(<span class="hljs-string">","</span>);
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> v.toString == <span class="hljs-string">"function"</span>) {
              v = v.toString();
            }
          }
          <span class="hljs-keyword">if</span> (v &amp;&amp; <span class="hljs-keyword">typeof</span> v.escapeHTML === <span class="hljs-string">"function"</span>)
            v = v.escapeHTML();
          <span class="hljs-keyword">if</span> (v)
            p.setAttribute(<span class="hljs-string">"value"</span>, v);
          section.appendChild(p);
        }
        <span class="hljs-keyword">return</span> section;
      },
      <span class="hljs-attr">getDescribingText</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> gxml = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"gxml"</span>);
        <span class="hljs-keyword">var</span> x = <span class="hljs-keyword">this</span>.getDescribingXML();
        gxml.appendChild(x);
        <span class="hljs-keyword">return</span> gxml.innerHTML;
      },
      <span class="hljs-attr">getHeader</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.header;
      },
      <span class="hljs-attr">getID</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.id;
      },
      <span class="hljs-attr">getPosition</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.position;
      },
      <span class="hljs-attr">getPreferences</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.preferences;
      },
      <span class="hljs-attr">getPreference</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">id</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.preferences[id];
      },
      <span class="hljs-attr">getTitle</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.title;
      },
      <span class="hljs-attr">locate</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">domElement</span>) </span>{
        <span class="hljs-keyword">while</span> (domElement.parentNode) {
          domElement = domElement.parentNode;
          <span class="hljs-keyword">if</span> (domElement.gWindow)
            <span class="hljs-keyword">return</span> domElement.gWindow;
          <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.$j &amp;&amp; $j(domElement).data(<span class="hljs-string">'gWindow'</span>)) {
            <span class="hljs-keyword">return</span> $j(domElement).data(<span class="hljs-string">'gWindow'</span>);
          }
        }
        alert(<span class="hljs-string">'GlideWindow.locate: window not found'</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
      },
      <span class="hljs-attr">get</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">id</span>) </span>{
        <span class="hljs-keyword">if</span> (!id || !gel(<span class="hljs-string">'window.'</span> + id))
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
        <span class="hljs-keyword">return</span> gel(<span class="hljs-string">'window.'</span> + id).gWindow;
      },
      <span class="hljs-attr">getWindowDOM</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.window;
      },
      <span class="hljs-attr">getZIndex</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.zIndex;
      },
      <span class="hljs-attr">initDecorations</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.isReadOnly()) {
          <span class="hljs-keyword">this</span>.closeDecoration = <span class="hljs-keyword">this</span>.addFunctionDecoration(<span class="hljs-string">"images/x.gifx"</span>, <span class="hljs-string">'Close'</span>, <span class="hljs-keyword">this</span>._onCloseClicked.bind(<span class="hljs-keyword">this</span>));
        }
      },
      <span class="hljs-attr">removeCloseDecoration</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.closeDecoration)
          <span class="hljs-keyword">this</span>.closeDecoration.parentNode.removeChild(<span class="hljs-keyword">this</span>.closeDecoration);
        <span class="hljs-keyword">this</span>.closeDecoration = <span class="hljs-literal">null</span>;
      },
      <span class="hljs-attr">showCloseOnMouseOver</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        Event.observe(<span class="hljs-keyword">this</span>.window, <span class="hljs-string">"mouseover"</span>, <span class="hljs-keyword">this</span>.showCloseButton.bind(<span class="hljs-keyword">this</span>));
        Event.observe(<span class="hljs-keyword">this</span>.window, <span class="hljs-string">"mouseout"</span>, <span class="hljs-keyword">this</span>.hideCloseButton.bind(<span class="hljs-keyword">this</span>));
        <span class="hljs-keyword">this</span>.hideCloseButton();
      },
      <span class="hljs-attr">showCloseButton</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.closeDecoration)
          <span class="hljs-keyword">this</span>.closeDecoration.style.visibility = <span class="hljs-string">"visible"</span>;
      },
      <span class="hljs-attr">hideCloseButton</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.closeDecoration)
          <span class="hljs-keyword">this</span>.closeDecoration.style.visibility = <span class="hljs-string">"hidden"</span>;
      },
      <span class="hljs-attr">insert</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">element, beforeElement, invisible</span>) </span>{
        <span class="hljs-keyword">var</span> id = <span class="hljs-keyword">this</span>.getID();
        element = $(element);
        <span class="hljs-keyword">var</span> div = $(id);
        <span class="hljs-keyword">if</span> (!div) {
          <span class="hljs-keyword">var</span> div = cel(<span class="hljs-string">"div"</span>);
          div.name = div.id = id;
          div.gWindow = <span class="hljs-keyword">this</span>;
          div.setAttribute(<span class="hljs-string">"dragpart"</span>, id);
          div.className += <span class="hljs-string">" drag_section_part"</span>;
          div.style.position = <span class="hljs-keyword">this</span>.getPosition();
          div.style.zIndex = <span class="hljs-keyword">this</span>.getZIndex();
          div.style[<span class="hljs-keyword">this</span>._dir] = <span class="hljs-keyword">this</span>.offsetHorizontal + <span class="hljs-string">"px"</span>;
          div.style.top = <span class="hljs-keyword">this</span>.offsetTop + <span class="hljs-string">"px"</span>;
          div.appendChild(<span class="hljs-keyword">this</span>.getWindowDOM());
          <span class="hljs-keyword">if</span> (invisible)
            div.style.visibility = <span class="hljs-string">"hidden"</span>;
          <span class="hljs-keyword">if</span> (beforeElement)
            element.insertBefore(div, beforeElement);
          <span class="hljs-keyword">else</span>
            element.appendChild(div);
        }
        <span class="hljs-keyword">this</span>.container = div;
        <span class="hljs-keyword">this</span>._enableDragging(div);
      },
      <span class="hljs-attr">isActive</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.active;
      },
      <span class="hljs-attr">isReadOnly</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._readOnly;
      },
      <span class="hljs-attr">isValid</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.valid;
      },
      <span class="hljs-attr">moveTo</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">x, y</span>) </span>{
        <span class="hljs-keyword">var</span> o = <span class="hljs-keyword">this</span>.getContainer();
        o.style[<span class="hljs-keyword">this</span>._dir] = x + <span class="hljs-string">'px'</span>;
        o.style.top = y + <span class="hljs-string">'px'</span>;
        <span class="hljs-keyword">this</span>._setShimBounds(x, y, <span class="hljs-string">""</span>, <span class="hljs-string">""</span>);
      },
      <span class="hljs-attr">release</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">this</span>.window.gWindow = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">this</span>.window = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">this</span>.container = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">this</span>.body = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.gd)
          <span class="hljs-keyword">this</span>.gd.destroy();
        <span class="hljs-keyword">this</span>.title = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">this</span>.header = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">this</span>.shim = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">this</span>.rightDecorations = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">this</span>.leftDecorations = <span class="hljs-literal">null</span>;
      },
      <span class="hljs-attr">removePreference</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name, value</span>) </span>{
        <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.preferences[name];
      },
      <span class="hljs-attr">render</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> id = <span class="hljs-keyword">this</span>.getID();
        <span class="hljs-keyword">var</span> description = <span class="hljs-keyword">this</span>.getDescribingText();
        <span class="hljs-keyword">var</span> ajax = <span class="hljs-keyword">new</span> GlideAjax(<span class="hljs-string">"RenderInfo"</span>);
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.getPreference(<span class="hljs-string">"sysparm_scope"</span>))
          ajax.setScope(<span class="hljs-keyword">this</span>.getPreference(<span class="hljs-string">"sysparm_scope"</span>))
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.nologValue)
          ajax.addParam(<span class="hljs-string">"ni.nolog.sysparm_value"</span>, <span class="hljs-literal">true</span>);
        ajax.addParam(<span class="hljs-string">"sysparm_value"</span>, description);
        ajax.addParam(<span class="hljs-string">"sysparm_name"</span>, id);
        ajax.getXML(<span class="hljs-keyword">this</span>._bodyRendered.bind(<span class="hljs-keyword">this</span>));
      },
      <span class="hljs-attr">invisible</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> e = <span class="hljs-keyword">this</span>.getContainer();
        e.style.visibility = <span class="hljs-string">"hidden"</span>;
      },
      <span class="hljs-attr">visible</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> e = <span class="hljs-keyword">this</span>.getContainer();
        e.style.visibility = <span class="hljs-string">"visible"</span>;
      },
      <span class="hljs-attr">setAlt</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">alt</span>) </span>{
        <span class="hljs-keyword">this</span>.window.title = alt;
      },
      <span class="hljs-attr">setEscapedBody</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">body</span>) </span>{
        <span class="hljs-keyword">if</span> (!body)
          <span class="hljs-keyword">return</span>;
        body = body.replace(<span class="hljs-regexp">/\t/g</span>, <span class="hljs-string">""</span>);
        body = body.replace(<span class="hljs-regexp">/\r/g</span>, <span class="hljs-string">""</span>);
        body = body.replace(<span class="hljs-regexp">/\n+/g</span>, <span class="hljs-string">"\n"</span>);
        body = body.replace(<span class="hljs-regexp">/%27/g</span>, <span class="hljs-string">"'"</span>);
        body = body.replace(<span class="hljs-regexp">/%3c/g</span>, <span class="hljs-string">"&lt;"</span>);
        body = body.replace(<span class="hljs-regexp">/%3e/g</span>, <span class="hljs-string">"&gt;"</span>);
        body = body.replace(<span class="hljs-regexp">/&amp;amp;/g</span>, <span class="hljs-string">"&amp;"</span>);
        <span class="hljs-keyword">this</span>.setBody(body, <span class="hljs-literal">true</span>);
      },
      <span class="hljs-attr">setBody</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">html, noEvaluate, setAlt</span>) </span>{
        <span class="hljs-keyword">this</span>.body.innerHTML = <span class="hljs-string">""</span>;
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> html == <span class="hljs-string">'string'</span>) {
          <span class="hljs-keyword">var</span> showBody = <span class="hljs-literal">true</span>;
          <span class="hljs-keyword">if</span> (html.length == <span class="hljs-number">0</span>)
            showBody = <span class="hljs-literal">false</span>;
          <span class="hljs-keyword">this</span>.showBody(showBody);
          html = <span class="hljs-keyword">this</span>._substituteGet(html);
          html = <span class="hljs-keyword">this</span>._fixBrowserTags(html);
          <span class="hljs-keyword">this</span>.body.innerHTML = html;
          <span class="hljs-keyword">if</span> (setAlt)
            <span class="hljs-keyword">this</span>.setBodyAlt(html);
          <span class="hljs-keyword">if</span> (!noEvaluate)
            <span class="hljs-keyword">this</span>._evalScripts(html);
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">this</span>.body.appendChild(html);
        }
        <span class="hljs-keyword">var</span> prefs = <span class="hljs-keyword">this</span>.body.getElementsByTagName(<span class="hljs-string">"renderpreference"</span>);
        <span class="hljs-keyword">if</span> (prefs.length &gt; <span class="hljs-number">0</span>) {
          <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; prefs.length; i++) {
            <span class="hljs-keyword">var</span> pref = prefs[i];
            <span class="hljs-keyword">var</span> name = pref.getAttribute(<span class="hljs-string">"name"</span>);
            <span class="hljs-keyword">var</span> valu = pref.getAttribute(<span class="hljs-string">"value"</span>);
            <span class="hljs-keyword">if</span> (name == <span class="hljs-string">"render_time"</span>) {
              <span class="hljs-keyword">this</span>.debugTD.innerHTML = valu;
              <span class="hljs-keyword">this</span>.debugTD.style.display = <span class="hljs-string">"table-cell"</span>;
              <span class="hljs-keyword">continue</span>;
            }
            <span class="hljs-keyword">this</span>.setPreference(name, valu);
            <span class="hljs-keyword">if</span> (name == <span class="hljs-string">"title"</span>)
              <span class="hljs-keyword">this</span>.setTitle(valu);
            <span class="hljs-keyword">if</span> (name == <span class="hljs-string">"render_title"</span> &amp;&amp; valu == <span class="hljs-string">"false"</span>)
              <span class="hljs-keyword">this</span>.header.style.display = <span class="hljs-string">"none"</span>;
            <span class="hljs-keyword">if</span> (name == <span class="hljs-string">"hide_close_decoration"</span> &amp;&amp; valu == <span class="hljs-string">"true"</span>)
              <span class="hljs-keyword">this</span>.removeCloseDecoration();
          }
        }
        <span class="hljs-keyword">var</span> decorations = <span class="hljs-keyword">this</span>.body.getElementsByTagName(<span class="hljs-string">"decoration"</span>);
        <span class="hljs-keyword">if</span> (decorations.length &gt; <span class="hljs-number">0</span>) {
          <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> x = <span class="hljs-number">0</span>; x &lt; decorations.length; x++) {
            <span class="hljs-keyword">var</span> thisDecoration = <span class="hljs-keyword">new</span> GlideDecoration(decorations[x]);
            thisDecoration.attach(<span class="hljs-keyword">this</span>);
          }
        }
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.elementToFocus) {
          <span class="hljs-keyword">if</span> (gel(<span class="hljs-keyword">this</span>.elementToFocus)) {
            self.focus();
            gel(<span class="hljs-keyword">this</span>.elementToFocus).focus();
          }
        }
        <span class="hljs-keyword">this</span>._shimResize();
      },
      <span class="hljs-attr">showBody</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">show</span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.divMode)
          <span class="hljs-keyword">var</span> tr = <span class="hljs-keyword">this</span>.body;
        <span class="hljs-keyword">else</span>
          <span class="hljs-keyword">var</span> tr = <span class="hljs-keyword">this</span>.body.parentNode.parentNode;
        <span class="hljs-keyword">if</span> (show)
          tr.style.display = <span class="hljs-string">""</span>;
        <span class="hljs-keyword">else</span>
          tr.style.display = <span class="hljs-string">"none"</span>;
      },
      <span class="hljs-attr">setBodyAlt</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">alt</span>) </span>{
        <span class="hljs-keyword">this</span>.body.title = alt;
      },
      <span class="hljs-attr">setClassName</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">className</span>) </span>{
        <span class="hljs-keyword">this</span>.windowClass = className;
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.getWindowDOM())
          <span class="hljs-keyword">this</span>.getWindowDOM().className = className;
      },
      <span class="hljs-attr">setColor</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">color</span>) </span>{
        <span class="hljs-keyword">this</span>.windowBackground = color;
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.getBody())
          <span class="hljs-keyword">this</span>.getBody().parentNode.style.backgroundColor = color;
      },
      <span class="hljs-attr">setFocus</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">id</span>) </span>{
        <span class="hljs-keyword">this</span>.elementToFocus = id;
      },
      <span class="hljs-attr">setFont</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">family, size, fontUnit, weight</span>) </span>{
        <span class="hljs-keyword">this</span>.setFontSize(size, fontUnit);
        <span class="hljs-keyword">this</span>.setStyle(<span class="hljs-string">"fontFamily"</span>, family);
        <span class="hljs-keyword">this</span>.setFontWeight(weight);
      },
      <span class="hljs-attr">setFontSize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">size, fontUnit</span>) </span>{
        <span class="hljs-keyword">if</span> (!fontUnit)
          fontUnit = <span class="hljs-string">"pt"</span>;
        <span class="hljs-keyword">this</span>.setStyle(<span class="hljs-string">"fontSize"</span>, size + fontUnit);
      },
      <span class="hljs-attr">setFontWeight</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">weight</span>) </span>{
        <span class="hljs-keyword">this</span>.setStyle(<span class="hljs-string">"fontWeight"</span>, weight);
      },
      <span class="hljs-attr">setStyle</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name, value</span>) </span>{
        <span class="hljs-keyword">if</span> (!value)
          <span class="hljs-keyword">return</span>;
        <span class="hljs-keyword">this</span>.getTitle().style[name] = value;
        <span class="hljs-keyword">this</span>.getBody().style[name] = value;
      },
      <span class="hljs-attr">setHeaderClassName</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">className</span>) </span>{
        <span class="hljs-keyword">this</span>.getHeader().className = className;
      },
      <span class="hljs-attr">setHeaderColor</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">background</span>) </span>{
        <span class="hljs-keyword">this</span>.header.style.backgroundColor = background;
      },
      <span class="hljs-attr">setHeaderColors</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">color, background</span>) </span>{
        <span class="hljs-keyword">this</span>.setHeaderColor(background);
        <span class="hljs-keyword">this</span>.title.style.color = color;
      },
      <span class="hljs-attr">setOpacity</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">opacity</span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.divMode) {
          <span class="hljs-keyword">var</span> element = <span class="hljs-keyword">this</span>.getBody().parentNode;
          element.style.filter = <span class="hljs-string">"alpha(opacity="</span> + (opacity * <span class="hljs-number">100</span>) + <span class="hljs-string">")"</span>;
          element.style.MozOpacity = opacity + <span class="hljs-string">""</span>;
          element.style.opacity = opacity + <span class="hljs-string">""</span>;
          element.style.opacity = opacity;
        }
      },
      <span class="hljs-attr">setPreferences</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">preferences</span>) </span>{
        <span class="hljs-keyword">this</span>.preferences = preferences;
      },
      <span class="hljs-attr">setPreference</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name, value</span>) </span>{
        <span class="hljs-keyword">this</span>.preferences[name] = value;
      },
      <span class="hljs-attr">setPosition</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name</span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.getContainer() != <span class="hljs-keyword">this</span>.getWindowDOM())
          <span class="hljs-keyword">this</span>.getContainer().style.position = name;
        <span class="hljs-keyword">this</span>.position = name;
      },
      <span class="hljs-attr">setReadOnly</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">r</span>) </span>{
        <span class="hljs-keyword">this</span>._readOnly = r;
      },
      <span class="hljs-attr">setWidth</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">width</span>) </span>{
        <span class="hljs-keyword">this</span>.setSize(width, <span class="hljs-string">""</span>);
      },
      <span class="hljs-attr">getWidth</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.window)
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.window.clientWidth;
        <span class="hljs-keyword">else</span>
          <span class="hljs-keyword">return</span>;
      },
      <span class="hljs-attr">setHeight</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">height</span>) </span>{
        <span class="hljs-keyword">this</span>.definedHeight = height;
        <span class="hljs-keyword">this</span>.setSize(<span class="hljs-string">""</span>, height);
      },
      <span class="hljs-attr">removeHeight</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
          <span class="hljs-keyword">this</span>.definedHeight = <span class="hljs-literal">null</span>;
          <span class="hljs-keyword">var</span> obj = <span class="hljs-keyword">this</span>.getContainer();
          obj.style.height = <span class="hljs-string">""</span>;
          <span class="hljs-keyword">this</span>.window.style.height = <span class="hljs-string">""</span>;
          <span class="hljs-keyword">var</span> bo = t</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
